!function(e){define("modernizr",[],function(){return function(){return window.Modernizr=function(e,t,n){function i(e){d.cssText=e}function r(e,t){return typeof e===t}var o,a,s={},u=t.documentElement,l="modernizr",c=t.createElement(l),d=c.style,h=" -webkit- -moz- -o- -ms- ".split(" "),f={},p=[],g=p.slice,m=function(e,n,i,r){var o,a,s,c,d=t.createElement("div"),h=t.body,f=h||t.createElement("body");if(parseInt(i,10))for(;i--;)s=t.createElement("div"),s.id=r?r[i]:l+(i+1),d.appendChild(s);return o=["&#173;",'<style id="s',l,'">',e,"</style>"].join(""),d.id=l,(h?d:f).innerHTML+=o,f.appendChild(d),h||(f.style.background="",f.style.overflow="hidden",c=u.style.overflow,u.style.overflow="hidden",u.appendChild(f)),a=n(d,e),h?d.parentNode.removeChild(d):(f.parentNode.removeChild(f),u.style.overflow=c),!!a},v={}.hasOwnProperty;a=r(v,"undefined")||r(v.call,"undefined")?function(e,t){return t in e&&r(e.constructor.prototype[t],"undefined")}:function(e,t){return v.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=g.call(arguments,1),i=function(){if(this instanceof i){var r=function(){};r.prototype=t.prototype;var o=new r,a=t.apply(o,n.concat(g.call(arguments)));return Object(a)===a?a:o}return t.apply(e,n.concat(g.call(arguments)))};return i}),f.canvas=function(){var e=t.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},f.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:m(["@media (",h.join("touch-enabled),("),l,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=9===e.offsetTop}),n},f.video=function(){var e=t.createElement("video"),n=!1;try{(n=!!e.canPlayType)&&(n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(e){}return n};for(var y in f)a(f,y)&&(o=y.toLowerCase(),s[o]=f[y](),p.push((s[o]?"":"no-")+o));return s.addTest=function(e,t){if("object"==typeof e)for(var i in e)a(e,i)&&s.addTest(i,e[i]);else{if(e=e.toLowerCase(),s[e]!==n)return s;t="function"==typeof t?t():t,"undefined"!=typeof enableClasses&&enableClasses&&(u.className+=" "+(t?"":"no-")+e),s[e]=t}return s},i(""),c=null,function(e,t){function n(e,t){var n=e.createElement("p"),i=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",i.insertBefore(n.lastChild,i.firstChild)}function i(){var e=v.elements;return"string"==typeof e?e.split(" "):e}function r(e){var t=m[e[p]];return t||(t={},g++,e[p]=g,m[g]=t),t}function o(e,n,i){if(n||(n=t),c)return n.createElement(e);i||(i=r(n));var o;return o=i.cache[e]?i.cache[e].cloneNode():f.test(e)?(i.cache[e]=i.createElem(e)).cloneNode():i.createElem(e),o.canHaveChildren&&!h.test(e)?i.frag.appendChild(o):o}function a(e,n){if(e||(e=t),c)return e.createDocumentFragment();n=n||r(e);for(var o=n.frag.cloneNode(),a=0,s=i(),u=s.length;a<u;a++)o.createElement(s[a]);return o}function s(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return v.shivMethods?o(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+i().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(v,t.frag)}function u(e){e||(e=t);var i=r(e);return!v.shivCSS||l||i.hasCSS||(i.hasCSS=!!n(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),c||s(e,i),e}var l,c,d=e.html5||{},h=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,p="_html5shiv",g=0,m={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",l="hidden"in e,c=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return void 0===e.cloneNode||void 0===e.createDocumentFragment||void 0===e.createElement}()}catch(e){l=!0,c=!0}}();var v={elements:d.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:!1!==d.shivCSS,supportsUnknownElements:c,shivMethods:!1!==d.shivMethods,type:"default",shivDocument:u,createElement:o,createDocumentFragment:a};e.html5=v,u(t)}(this,t),s._version="2.6.2",s._prefixes=h,s.testStyles=m,s}(this,this.document),e.Modernizr=Modernizr}.apply(e,arguments)})}(this),function(){function e(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function t(e,t,n,i){for(var r=-1,o=null==e?0:e.length;++r<o;){var a=e[r];t(i,a,n(a),e)}return i}function n(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e}function i(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function r(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function o(e,t){for(var n=-1,i=null==e?0:e.length,r=0,o=[];++n<i;){var a=e[n];t(a,n,e)&&(o[r++]=a)}return o}function a(e,t){return!!(null==e?0:e.length)&&v(e,t,0)>-1}function s(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)if(n(t,e[i]))return!0;return!1}function u(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}function l(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}function c(e,t,n,i){var r=-1,o=null==e?0:e.length;for(i&&o&&(n=e[++r]);++r<o;)n=t(n,e[r],r,e);return n}function d(e,t,n,i){var r=null==e?0:e.length;for(i&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}function h(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function f(e){return e.split("")}function p(e){return e.match(Pt)||[]}function g(e,t,n){var i;return n(e,function(e,n,r){if(t(e,n,r))return i=n,!1}),i}function m(e,t,n,i){for(var r=e.length,o=n+(i?1:-1);i?o--:++o<r;)if(t(e[o],o,e))return o;return-1}function v(e,t,n){return t===t?H(e,t,n):m(e,b,n)}function y(e,t,n,i){for(var r=n-1,o=e.length;++r<o;)if(i(e[r],t))return r;return-1}function b(e){return e!==e}function w(e,t){var n=null==e?0:e.length;return n?P(e,t)/n:Ie}function _(e){return function(t){return null==t?X:t[e]}}function E(e){return function(t){return null==e?X:e[t]}}function S(e,t,n,i,r){return r(e,function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)}),n}function T(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function P(e,t){for(var n,i=-1,r=e.length;++i<r;){var o=t(e[i]);o!==X&&(n=n===X?o:n+o)}return n}function A(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function I(e,t){return u(t,function(t){return[t,e[t]]})}function x(e){return function(t){return e(t)}}function O(e,t){return u(t,function(t){return e[t]})}function C(e,t){return e.has(t)}function R(e,t){for(var n=-1,i=e.length;++n<i&&v(t,e[n],0)>-1;);return n}function L(e,t){for(var n=e.length;n--&&v(t,e[n],0)>-1;);return n}function k(e,t){for(var n=e.length,i=0;n--;)e[n]===t&&++i;return i}function M(e,t){return null==e?X:e[t]}function D(e){return en.test(e)}function N(e){return tn.test(e)}function F(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function V(e){var t=-1,n=Array(e.size);return e.forEach(function(e,i){n[++t]=[i,e]}),n}function U(e,t){return function(n){return e(t(n))}}function B(e,t){for(var n=-1,i=e.length,r=0,o=[];++n<i;){var a=e[n];a!==t&&a!==ne||(e[n]=ne,o[r++]=n)}return o}function j(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function G(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function H(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}function W(e,t,n){for(var i=n+1;i--;)if(e[i]===t)return i;return i}function q(e){return D(e)?Y(e):Pn(e)}function $(e){return D(e)?z(e):f(e)}function Y(e){for(var t=Qt.lastIndex=0;Qt.test(e);)++t;return t}function z(e){return e.match(Qt)||[]}function K(e){return e.match(Jt)||[]}var X,Z=200,Q="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",J="Expected a function",ee="__lodash_hash_undefined__",te=500,ne="__lodash_placeholder__",ie=1,re=2,oe=4,ae=1,se=2,ue=1,le=2,ce=4,de=8,he=16,fe=32,pe=64,ge=128,me=256,ve=512,ye=30,be="...",we=800,_e=16,Ee=1,Se=2,Te=1/0,Pe=9007199254740991,Ae=1.7976931348623157e308,Ie=NaN,xe=4294967295,Oe=xe-1,Ce=xe>>>1,Re=[["ary",ge],["bind",ue],["bindKey",le],["curry",de],["curryRight",he],["flip",ve],["partial",fe],["partialRight",pe],["rearg",me]],Le="[object Arguments]",ke="[object Array]",Me="[object AsyncFunction]",De="[object Boolean]",Ne="[object Date]",Fe="[object DOMException]",Ve="[object Error]",Ue="[object Function]",Be="[object GeneratorFunction]",je="[object Map]",Ge="[object Number]",He="[object Null]",We="[object Object]",qe="[object Proxy]",$e="[object RegExp]",Ye="[object Set]",ze="[object String]",Ke="[object Symbol]",Xe="[object Undefined]",Ze="[object WeakMap]",Qe="[object WeakSet]",Je="[object ArrayBuffer]",et="[object DataView]",tt="[object Float32Array]",nt="[object Float64Array]",it="[object Int8Array]",rt="[object Int16Array]",ot="[object Int32Array]",at="[object Uint8Array]",st="[object Uint8ClampedArray]",ut="[object Uint16Array]",lt="[object Uint32Array]",ct=/&(?:amp|lt|gt|quot|#39);/g,dt=/[&<>"']/g,ht=RegExp(ct.source),ft=RegExp(dt.source),pt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gt=/^\w*$/,mt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vt=/[\\^$.*+?()[\]{}|]/g,yt=RegExp(vt.source),bt=/^\s+|\s+$/g,wt=/^\s+/,_t=/\s+$/,Et=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,St=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,Pt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,At=/\\(\\)?/g,It=/\w*$/,xt=/^[-+]0x[0-9a-f]+$/i,Ot=/^0b[01]+$/i,Ct=/^\[object .+?Constructor\]$/,Rt=/^0o[0-7]+$/i,Lt=/^(?:0|[1-9]\d*)$/,kt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Mt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Dt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Nt="["+Dt+"]",Ft="["+Mt+"]",Vt="[a-z\\xdf-\\xf6\\xf8-\\xff]",Ut="[^\\ud800-\\udfff"+Dt+"\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Bt="\\ud83c[\\udffb-\\udfff]",jt="(?:\\ud83c[\\udde6-\\uddff]){2}",Gt="[\\ud800-\\udbff][\\udc00-\\udfff]",Ht="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Wt="(?:"+Vt+"|"+Ut+")",qt="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",$t="(?:\\u200d(?:"+["[^\\ud800-\\udfff]",jt,Gt].join("|")+")[\\ufe0e\\ufe0f]?"+qt+")*",Yt="[\\ufe0e\\ufe0f]?"+qt+$t,zt="(?:"+["[\\u2700-\\u27bf]",jt,Gt].join("|")+")"+Yt,Kt="(?:"+["[^\\ud800-\\udfff]"+Ft+"?",Ft,jt,Gt,"[\\ud800-\\udfff]"].join("|")+")",Xt=RegExp("['’]","g"),Zt=RegExp(Ft,"g"),Qt=RegExp(Bt+"(?="+Bt+")|"+Kt+Yt,"g"),Jt=RegExp([Ht+"?"+Vt+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[Nt,Ht,"$"].join("|")+")","(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[Nt,Ht+Wt,"$"].join("|")+")",Ht+"?"+Wt+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Ht+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",zt].join("|"),"g"),en=RegExp("[\\u200d\\ud800-\\udfff"+Mt+"\\ufe0e\\ufe0f]"),tn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,nn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],rn={};rn[tt]=rn[nt]=rn[it]=rn[rt]=rn[ot]=rn[at]=rn[st]=rn[ut]=rn[lt]=!0,rn[Le]=rn[ke]=rn[Je]=rn[De]=rn[et]=rn[Ne]=rn[Ve]=rn[Ue]=rn[je]=rn[Ge]=rn[We]=rn[$e]=rn[Ye]=rn[ze]=rn[Ze]=!1;var on={};on[Le]=on[ke]=on[Je]=on[et]=on[De]=on[Ne]=on[tt]=on[nt]=on[it]=on[rt]=on[ot]=on[je]=on[Ge]=on[We]=on[$e]=on[Ye]=on[ze]=on[Ke]=on[at]=on[st]=on[ut]=on[lt]=!0,on[Ve]=on[Ue]=on[Ze]=!1;var an={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},sn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},un={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ln=parseFloat,cn=parseInt,dn="object"==typeof global&&global&&global.Object===Object&&global,hn="object"==typeof self&&self&&self.Object===Object&&self,fn=dn||hn||Function("return this")(),pn="object"==typeof exports&&exports&&!exports.nodeType&&exports,gn=pn&&"object"==typeof module&&module&&!module.nodeType&&module,mn=gn&&gn.exports===pn,vn=mn&&dn.process,yn=function(){try{var e=gn&&gn.require&&gn.require("util").types;return e||vn&&vn.binding&&vn.binding("util")}catch(e){}}(),bn=yn&&yn.isArrayBuffer,wn=yn&&yn.isDate,_n=yn&&yn.isMap,En=yn&&yn.isRegExp,Sn=yn&&yn.isSet,Tn=yn&&yn.isTypedArray,Pn=_("length"),An=E(an),In=E(sn),xn=E(un),On=function f(E){function H(e){if(Hs(e)&&!Jd(e)&&!(e instanceof Pt)){if(e instanceof z)return e;if(Jl.call(e,"__wrapped__"))return Bo(e)}return new z(e)}function Y(){}function z(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=X}function Pt(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=xe,this.__views__=[]}function Mt(){var e=new Pt(this.__wrapped__);return e.__actions__=_r(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=_r(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=_r(this.__views__),e}function Dt(){if(this.__filtered__){var e=new Pt(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Nt(){var e=this.__wrapped__.value(),t=this.__dir__,n=Jd(e),i=t<0,r=n?e.length:0,o=lo(0,r,this.__views__),a=o.start,s=o.end,u=s-a,l=i?s:a-1,c=this.__iteratees__,d=c.length,h=0,f=Oc(u,this.__takeCount__);if(!n||!i&&r==u&&f==u)return rr(e,this.__actions__);var p=[];e:for(;u--&&h<f;){l+=t;for(var g=-1,m=e[l];++g<d;){var v=c[g],y=v.iteratee,b=v.type,w=y(m);if(b==Se)m=w;else if(!w){if(b==Ee)continue e;break e}}p[h++]=m}return p}function Ft(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Vt(){this.__data__=Uc?Uc(null):{},this.size=0}function Ut(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Bt(e){var t=this.__data__;if(Uc){var n=t[e];return n===ee?X:n}return Jl.call(t,e)?t[e]:X}function jt(e){var t=this.__data__;return Uc?t[e]!==X:Jl.call(t,e)}function Gt(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Uc&&t===X?ee:t,this}function Ht(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Wt(){this.__data__=[],this.size=0}function qt(e){var t=this.__data__,n=Nn(t,e);return!(n<0)&&(n==t.length-1?t.pop():fc.call(t,n,1),--this.size,!0)}function $t(e){var t=this.__data__,n=Nn(t,e);return n<0?X:t[n][1]}function Yt(e){return Nn(this.__data__,e)>-1}function zt(e,t){var n=this.__data__,i=Nn(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}function Kt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Qt(){this.size=0,this.__data__={hash:new Ft,map:new(Dc||Ht),string:new Ft}}function Jt(e){var t=oo(this,e).delete(e);return this.size-=t?1:0,t}function en(e){return oo(this,e).get(e)}function tn(e){return oo(this,e).has(e)}function an(e,t){var n=oo(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}function sn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Kt;++t<n;)this.add(e[t])}function un(e){return this.__data__.set(e,ee),this}function dn(e){return this.__data__.has(e)}function hn(e){var t=this.__data__=new Ht(e);this.size=t.size}function pn(){this.__data__=new Ht,this.size=0}function gn(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function vn(e){return this.__data__.get(e)}function yn(e){return this.__data__.has(e)}function Pn(e,t){var n=this.__data__;if(n instanceof Ht){var i=n.__data__;if(!Dc||i.length<Z-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Kt(i)}return n.set(e,t),this.size=n.size,this}function Cn(e,t){var n=Jd(e),i=!n&&Qd(e),r=!n&&!i&&th(e),o=!n&&!i&&!r&&ah(e),a=n||i||r||o,s=a?A(e.length,$l):[],u=s.length;for(var l in e)!t&&!Jl.call(e,l)||a&&("length"==l||r&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||yo(l,u))||s.push(l);return s}function Rn(e){var t=e.length;return t?e[Ui(0,t-1)]:X}function Ln(e,t){return No(_r(e),Gn(t,0,e.length))}function kn(e){return No(_r(e))}function Mn(e,t,n){(n===X||Os(e[t],n))&&(n!==X||t in e)||Bn(e,t,n)}function Dn(e,t,n){var i=e[t];Jl.call(e,t)&&Os(i,n)&&(n!==X||t in e)||Bn(e,t,n)}function Nn(e,t){for(var n=e.length;n--;)if(Os(e[n][0],t))return n;return-1}function Fn(e,t,n,i){return Zc(e,function(e,r,o){t(i,e,n(e),o)}),i}function Vn(e,t){return e&&Er(t,Tu(t),e)}function Un(e,t){return e&&Er(t,Pu(t),e)}function Bn(e,t,n){"__proto__"==t&&vc?vc(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function jn(e,t){for(var n=-1,i=t.length,r=Ul(i),o=null==e;++n<i;)r[n]=o?X:_u(e,t[n]);return r}function Gn(e,t,n){return e===e&&(n!==X&&(e=e<=n?e:n),t!==X&&(e=e>=t?e:t)),e}function Hn(e,t,i,r,o,a){var s,u=t&ie,l=t&re,c=t&oe;if(i&&(s=o?i(e,r,o,a):i(e)),s!==X)return s;if(!Gs(e))return e;var d=Jd(e);if(d){if(s=fo(e),!u)return _r(e,s)}else{var h=ld(e),f=h==Ue||h==Be;if(th(e))return dr(e,u);if(h==We||h==Le||f&&!o){if(s=l||f?{}:po(e),!u)return l?Tr(e,Un(s,e)):Sr(e,Vn(s,e))}else{if(!on[h])return o?e:{};s=go(e,h,u)}}a||(a=new hn);var p=a.get(e);if(p)return p;a.set(e,s),oh(e)?e.forEach(function(n){s.add(Hn(n,t,i,n,e,a))}):ih(e)&&e.forEach(function(n,r){s.set(r,Hn(n,t,i,r,e,a))});var g=c?l?to:eo:l?Pu:Tu,m=d?X:g(e);return n(m||e,function(n,r){m&&(r=n,n=e[r]),Dn(s,r,Hn(n,t,i,r,e,a))}),s}function Wn(e){var t=Tu(e);return function(n){return qn(n,e,t)}}function qn(e,t,n){var i=n.length;if(null==e)return!i;for(e=Wl(e);i--;){var r=n[i],o=t[r],a=e[r];if(a===X&&!(r in e)||!o(a))return!1}return!0}function $n(e,t,n){if("function"!=typeof e)throw new Yl(J);return hd(function(){e.apply(X,n)},t)}function Yn(e,t,n,i){var r=-1,o=a,l=!0,c=e.length,d=[],h=t.length;if(!c)return d;n&&(t=u(t,x(n))),i?(o=s,l=!1):t.length>=Z&&(o=C,l=!1,t=new sn(t));e:for(;++r<c;){var f=e[r],p=null==n?f:n(f);if(f=i||0!==f?f:0,l&&p===p){for(var g=h;g--;)if(t[g]===p)continue e;d.push(f)}else o(t,p,i)||d.push(f)}return d}function zn(e,t){var n=!0;return Zc(e,function(e,i,r){return n=!!t(e,i,r)}),n}function Kn(e,t,n){for(var i=-1,r=e.length;++i<r;){var o=e[i],a=t(o);if(null!=a&&(s===X?a===a&&!eu(a):n(a,s)))var s=a,u=o}return u}function Xn(e,t,n,i){var r=e.length;for(n=au(n),n<0&&(n=-n>r?0:r+n),i=i===X||i>r?r:au(i),i<0&&(i+=r),i=n>i?0:su(i);n<i;)e[n++]=t;return e}function Zn(e,t){var n=[];return Zc(e,function(e,i,r){t(e,i,r)&&n.push(e)}),n}function Qn(e,t,n,i,r){var o=-1,a=e.length;for(n||(n=vo),r||(r=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?Qn(s,t-1,n,i,r):l(r,s):i||(r[r.length]=s)}return r}function Jn(e,t){return e&&Jc(e,t,Tu)}function ei(e,t){return e&&ed(e,t,Tu)}function ti(e,t){return o(t,function(t){return Us(e[t])})}function ni(e,t){t=lr(t,e);for(var n=0,i=t.length;null!=e&&n<i;)e=e[Fo(t[n++])];return n&&n==i?e:X}function ii(e,t,n){var i=t(e);return Jd(e)?i:l(i,n(e))}function ri(e){return null==e?e===X?Xe:He:mc&&mc in Wl(e)?uo(e):Oo(e)}function oi(e,t){return e>t}function ai(e,t){return null!=e&&Jl.call(e,t)}function si(e,t){return null!=e&&t in Wl(e)}function ui(e,t,n){return e>=Oc(t,n)&&e<xc(t,n)}function li(e,t,n){for(var i=n?s:a,r=e[0].length,o=e.length,l=o,c=Ul(o),d=1/0,h=[];l--;){var f=e[l];l&&t&&(f=u(f,x(t))),d=Oc(f.length,d),c[l]=!n&&(t||r>=120&&f.length>=120)?new sn(l&&f):X}f=e[0];var p=-1,g=c[0];e:for(;++p<r&&h.length<d;){var m=f[p],v=t?t(m):m;if(m=n||0!==m?m:0,!(g?C(g,v):i(h,v,n))){for(l=o;--l;){var y=c[l];if(!(y?C(y,v):i(e[l],v,n)))continue e}g&&g.push(v),h.push(m)}}return h}function ci(e,t,n,i){return Jn(e,function(e,r,o){t(i,n(e),r,o)}),i}function di(t,n,i){n=lr(n,t),t=Ro(t,n);var r=null==t?t:t[Fo(oa(n))];return null==r?X:e(r,t,i)}function hi(e){return Hs(e)&&ri(e)==Le}function fi(e){return Hs(e)&&ri(e)==Je}function pi(e){return Hs(e)&&ri(e)==Ne}function gi(e,t,n,i,r){return e===t||(null==e||null==t||!Hs(e)&&!Hs(t)?e!==e&&t!==t:mi(e,t,n,i,gi,r))}function mi(e,t,n,i,r,o){var a=Jd(e),s=Jd(t),u=a?ke:ld(e),l=s?ke:ld(t);u=u==Le?We:u,l=l==Le?We:l;var c=u==We,d=l==We,h=u==l;if(h&&th(e)){if(!th(t))return!1;a=!0,c=!1}if(h&&!c)return o||(o=new hn),a||ah(e)?Xr(e,t,n,i,r,o):Zr(e,t,u,n,i,r,o);if(!(n&ae)){var f=c&&Jl.call(e,"__wrapped__"),p=d&&Jl.call(t,"__wrapped__");if(f||p){var g=f?e.value():e,m=p?t.value():t;return o||(o=new hn),r(g,m,n,i,o)}}return!!h&&(o||(o=new hn),Qr(e,t,n,i,r,o))}function vi(e){return Hs(e)&&ld(e)==je}function yi(e,t,n,i){var r=n.length,o=r,a=!i;if(null==e)return!o;for(e=Wl(e);r--;){var s=n[r];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++r<o;){s=n[r];var u=s[0],l=e[u],c=s[1];if(a&&s[2]){if(l===X&&!(u in e))return!1}else{var d=new hn;if(i)var h=i(l,c,u,e,t,d);if(!(h===X?gi(c,l,ae|se,i,d):h))return!1}}return!0}function bi(e){return!(!Gs(e)||So(e))&&(Us(e)?oc:Ct).test(Vo(e))}function wi(e){return Hs(e)&&ri(e)==$e}function _i(e){return Hs(e)&&ld(e)==Ye}function Ei(e){return Hs(e)&&js(e.length)&&!!rn[ri(e)]}function Si(e){return"function"==typeof e?e:null==e?fl:"object"==typeof e?Jd(e)?Oi(e[0],e[1]):xi(e):_l(e)}function Ti(e){if(!To(e))return Ic(e);var t=[];for(var n in Wl(e))Jl.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Pi(e){if(!Gs(e))return xo(e);var t=To(e),n=[];for(var i in e)("constructor"!=i||!t&&Jl.call(e,i))&&n.push(i);return n}function Ai(e,t){return e<t}function Ii(e,t){var n=-1,i=Cs(e)?Ul(e.length):[];return Zc(e,function(e,r,o){i[++n]=t(e,r,o)}),i}function xi(e){var t=ao(e);return 1==t.length&&t[0][2]?Ao(t[0][0],t[0][1]):function(n){return n===e||yi(n,e,t)}}function Oi(e,t){return wo(e)&&Po(t)?Ao(Fo(e),t):function(n){var i=_u(n,e);return i===X&&i===t?Su(n,e):gi(t,i,ae|se)}}function Ci(e,t,n,i,r){e!==t&&Jc(t,function(o,a){if(r||(r=new hn),Gs(o))Ri(e,t,a,n,Ci,i,r);else{var s=i?i(ko(e,a),o,a+"",e,t,r):X;s===X&&(s=o),Mn(e,a,s)}},Pu)}function Ri(e,t,n,i,r,o,a){var s=ko(e,n),u=ko(t,n),l=a.get(u);if(l)return void Mn(e,n,l);var c=o?o(s,u,n+"",e,t,a):X,d=c===X;if(d){var h=Jd(u),f=!h&&th(u),p=!h&&!f&&ah(u);c=u,h||f||p?Jd(s)?c=s:Rs(s)?c=_r(s):f?(d=!1,c=dr(u,!0)):p?(d=!1,c=mr(u,!0)):c=[]:Zs(u)||Qd(u)?(c=s,Qd(s)?c=lu(s):Gs(s)&&!Us(s)||(c=po(u))):d=!1}d&&(a.set(u,c),r(c,u,i,o,a),a.delete(u)),Mn(e,n,c)}function Li(e,t){var n=e.length;if(n)return t+=t<0?n:0,yo(t,n)?e[t]:X}function ki(e,t,n){var i=-1;return t=u(t.length?t:[fl],x(ro())),T(Ii(e,function(e,n,r){return{criteria:u(t,function(t){return t(e)}),index:++i,value:e}}),function(e,t){return yr(e,t,n)})}function Mi(e,t){return Di(e,t,function(t,n){return Su(e,n)})}function Di(e,t,n){for(var i=-1,r=t.length,o={};++i<r;){var a=t[i],s=ni(e,a);n(s,a)&&qi(o,lr(a,e),s)}return o}function Ni(e){return function(t){return ni(t,e)}}function Fi(e,t,n,i){var r=i?y:v,o=-1,a=t.length,s=e;for(e===t&&(t=_r(t)),n&&(s=u(e,x(n)));++o<a;)for(var l=0,c=t[o],d=n?n(c):c;(l=r(s,d,l,i))>-1;)s!==e&&fc.call(s,l,1),fc.call(e,l,1);return e}function Vi(e,t){for(var n=e?t.length:0,i=n-1;n--;){var r=t[n];if(n==i||r!==o){var o=r;yo(r)?fc.call(e,r,1):tr(e,r)}}return e}function Ui(e,t){return e+Ec(Lc()*(t-e+1))}function Bi(e,t,n,i){for(var r=-1,o=xc(_c((t-e)/(n||1)),0),a=Ul(o);o--;)a[i?o:++r]=e,e+=n;return a}function ji(e,t){var n="";if(!e||t<1||t>Pe)return n;do{t%2&&(n+=e),(t=Ec(t/2))&&(e+=e)}while(t);return n}function Gi(e,t){return fd(Co(e,t,fl),e+"")}function Hi(e){return Rn(Fu(e))}function Wi(e,t){var n=Fu(e);return No(n,Gn(t,0,n.length))}function qi(e,t,n,i){if(!Gs(e))return e;t=lr(t,e);for(var r=-1,o=t.length,a=o-1,s=e;null!=s&&++r<o;){var u=Fo(t[r]),l=n;if(r!=a){var c=s[u];l=i?i(c,u,s):X,l===X&&(l=Gs(c)?c:yo(t[r+1])?[]:{})}Dn(s,u,l),s=s[u]}return e}function $i(e){return No(Fu(e))}function Yi(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),n=n>r?r:n,n<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var o=Ul(r);++i<r;)o[i]=e[i+t];return o}function zi(e,t){var n;return Zc(e,function(e,i,r){return!(n=t(e,i,r))}),!!n}function Ki(e,t,n){var i=0,r=null==e?i:e.length;if("number"==typeof t&&t===t&&r<=Ce){for(;i<r;){var o=i+r>>>1,a=e[o];null!==a&&!eu(a)&&(n?a<=t:a<t)?i=o+1:r=o}return r}return Xi(e,t,fl,n)}function Xi(e,t,n,i){t=n(t);for(var r=0,o=null==e?0:e.length,a=t!==t,s=null===t,u=eu(t),l=t===X;r<o;){var c=Ec((r+o)/2),d=n(e[c]),h=d!==X,f=null===d,p=d===d,g=eu(d);if(a)var m=i||p;else m=l?p&&(i||h):s?p&&h&&(i||!f):u?p&&h&&!f&&(i||!g):!f&&!g&&(i?d<=t:d<t);m?r=c+1:o=c}return Oc(o,Oe)}function Zi(e,t){for(var n=-1,i=e.length,r=0,o=[];++n<i;){var a=e[n],s=t?t(a):a;if(!n||!Os(s,u)){var u=s;o[r++]=0===a?0:a}}return o}function Qi(e){return"number"==typeof e?e:eu(e)?Ie:+e}function Ji(e){if("string"==typeof e)return e;if(Jd(e))return u(e,Ji)+"";if(eu(e))return Kc?Kc.call(e):"";var t=e+"";return"0"==t&&1/e==-Te?"-0":t}function er(e,t,n){var i=-1,r=a,o=e.length,u=!0,l=[],c=l;if(n)u=!1,r=s;else if(o>=Z){var d=t?null:od(e);if(d)return j(d);u=!1,r=C,c=new sn}else c=t?[]:l;e:for(;++i<o;){var h=e[i],f=t?t(h):h;if(h=n||0!==h?h:0,u&&f===f){for(var p=c.length;p--;)if(c[p]===f)continue e;t&&c.push(f),l.push(h)}else r(c,f,n)||(c!==l&&c.push(f),l.push(h))}return l}function tr(e,t){return t=lr(t,e),null==(e=Ro(e,t))||delete e[Fo(oa(t))]}function nr(e,t,n,i){return qi(e,t,n(ni(e,t)),i)}function ir(e,t,n,i){for(var r=e.length,o=i?r:-1;(i?o--:++o<r)&&t(e[o],o,e););return n?Yi(e,i?0:o,i?o+1:r):Yi(e,i?o+1:0,i?r:o)}function rr(e,t){var n=e;return n instanceof Pt&&(n=n.value()),c(t,function(e,t){return t.func.apply(t.thisArg,l([e],t.args))},n)}function or(e,t,n){var i=e.length;if(i<2)return i?er(e[0]):[];for(var r=-1,o=Ul(i);++r<i;)for(var a=e[r],s=-1;++s<i;)s!=r&&(o[r]=Yn(o[r]||a,e[s],t,n));return er(Qn(o,1),t,n)}function ar(e,t,n){for(var i=-1,r=e.length,o=t.length,a={};++i<r;){var s=i<o?t[i]:X;n(a,e[i],s)}return a}function sr(e){return Rs(e)?e:[]}function ur(e){return"function"==typeof e?e:fl}function lr(e,t){return Jd(e)?e:wo(e,t)?[e]:pd(du(e))}function cr(e,t,n){var i=e.length;return n=n===X?i:n,!t&&n>=i?e:Yi(e,t,n)}function dr(e,t){if(t)return e.slice();var n=e.length,i=lc?lc(n):new e.constructor(n);return e.copy(i),i}function hr(e){var t=new e.constructor(e.byteLength);return new uc(t).set(new uc(e)),t}function fr(e,t){var n=t?hr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function pr(e){var t=new e.constructor(e.source,It.exec(e));return t.lastIndex=e.lastIndex,t}function gr(e){return zc?Wl(zc.call(e)):{}}function mr(e,t){var n=t?hr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function vr(e,t){if(e!==t){var n=e!==X,i=null===e,r=e===e,o=eu(e),a=t!==X,s=null===t,u=t===t,l=eu(t);if(!s&&!l&&!o&&e>t||o&&a&&u&&!s&&!l||i&&a&&u||!n&&u||!r)return 1;if(!i&&!o&&!l&&e<t||l&&n&&r&&!i&&!o||s&&n&&r||!a&&r||!u)return-1}return 0}function yr(e,t,n){for(var i=-1,r=e.criteria,o=t.criteria,a=r.length,s=n.length;++i<a;){var u=vr(r[i],o[i]);if(u){if(i>=s)return u;return u*("desc"==n[i]?-1:1)}}return e.index-t.index}function br(e,t,n,i){for(var r=-1,o=e.length,a=n.length,s=-1,u=t.length,l=xc(o-a,0),c=Ul(u+l),d=!i;++s<u;)c[s]=t[s];for(;++r<a;)(d||r<o)&&(c[n[r]]=e[r]);for(;l--;)c[s++]=e[r++];return c}function wr(e,t,n,i){for(var r=-1,o=e.length,a=-1,s=n.length,u=-1,l=t.length,c=xc(o-s,0),d=Ul(c+l),h=!i;++r<c;)d[r]=e[r];for(var f=r;++u<l;)d[f+u]=t[u];for(;++a<s;)(h||r<o)&&(d[f+n[a]]=e[r++]);return d}function _r(e,t){var n=-1,i=e.length;for(t||(t=Ul(i));++n<i;)t[n]=e[n];return t}function Er(e,t,n,i){var r=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],u=i?i(n[s],e[s],s,n,e):X;u===X&&(u=e[s]),r?Bn(n,s,u):Dn(n,s,u)}return n}function Sr(e,t){return Er(e,sd(e),t)}function Tr(e,t){return Er(e,ud(e),t)}function Pr(e,n){return function(i,r){var o=Jd(i)?t:Fn,a=n?n():{};return o(i,e,ro(r,2),a)}}function Ar(e){return Gi(function(t,n){var i=-1,r=n.length,o=r>1?n[r-1]:X,a=r>2?n[2]:X;for(o=e.length>3&&"function"==typeof o?(r--,o):X,a&&bo(n[0],n[1],a)&&(o=r<3?X:o,r=1),t=Wl(t);++i<r;){var s=n[i];s&&e(t,s,i,o)}return t})}function Ir(e,t){return function(n,i){if(null==n)return n;if(!Cs(n))return e(n,i);for(var r=n.length,o=t?r:-1,a=Wl(n);(t?o--:++o<r)&&!1!==i(a[o],o,a););return n}}function xr(e){return function(t,n,i){for(var r=-1,o=Wl(t),a=i(t),s=a.length;s--;){var u=a[e?s:++r];if(!1===n(o[u],u,o))break}return t}}function Or(e,t,n){function i(){return(this&&this!==fn&&this instanceof i?o:e).apply(r?n:this,arguments)}var r=t&ue,o=Lr(e);return i}function Cr(e){return function(t){t=du(t);var n=D(t)?$(t):X,i=n?n[0]:t.charAt(0),r=n?cr(n,1).join(""):t.slice(1);return i[e]()+r}}function Rr(e){return function(t){return c(ul(Hu(t).replace(Xt,"")),e,"")}}function Lr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Xc(e.prototype),i=e.apply(n,t);return Gs(i)?i:n}}function kr(t,n,i){function r(){for(var a=arguments.length,s=Ul(a),u=a,l=io(r);u--;)s[u]=arguments[u];var c=a<3&&s[0]!==l&&s[a-1]!==l?[]:B(s,l);return(a-=c.length)<i?Wr(t,n,Nr,r.placeholder,X,s,c,X,X,i-a):e(this&&this!==fn&&this instanceof r?o:t,this,s)}var o=Lr(t);return r}function Mr(e){return function(t,n,i){var r=Wl(t);if(!Cs(t)){var o=ro(n,3);t=Tu(t),n=function(e){return o(r[e],e,r)}}var a=e(t,n,i);return a>-1?r[o?t[a]:a]:X}}function Dr(e){return Jr(function(t){var n=t.length,i=n,r=z.prototype.thru;for(e&&t.reverse();i--;){var o=t[i]
;if("function"!=typeof o)throw new Yl(J);if(r&&!a&&"wrapper"==no(o))var a=new z([],!0)}for(i=a?i:n;++i<n;){o=t[i];var s=no(o),u="wrapper"==s?ad(o):X;a=u&&Eo(u[0])&&u[1]==(ge|de|fe|me)&&!u[4].length&&1==u[9]?a[no(u[0])].apply(a,u[3]):1==o.length&&Eo(o)?a[s]():a.thru(o)}return function(){var e=arguments,i=e[0];if(a&&1==e.length&&Jd(i))return a.plant(i).value();for(var r=0,o=n?t[r].apply(this,e):i;++r<n;)o=t[r].call(this,o);return o}})}function Nr(e,t,n,i,r,o,a,s,u,l){function c(){for(var v=arguments.length,y=Ul(v),b=v;b--;)y[b]=arguments[b];if(p)var w=io(c),_=k(y,w);if(i&&(y=br(y,i,r,p)),o&&(y=wr(y,o,a,p)),v-=_,p&&v<l){var E=B(y,w);return Wr(e,t,Nr,c.placeholder,n,y,E,s,u,l-v)}var S=h?n:this,T=f?S[e]:e;return v=y.length,s?y=Lo(y,s):g&&v>1&&y.reverse(),d&&u<v&&(y.length=u),this&&this!==fn&&this instanceof c&&(T=m||Lr(T)),T.apply(S,y)}var d=t&ge,h=t&ue,f=t&le,p=t&(de|he),g=t&ve,m=f?X:Lr(e);return c}function Fr(e,t){return function(n,i){return ci(n,e,t(i),{})}}function Vr(e,t){return function(n,i){var r;if(n===X&&i===X)return t;if(n!==X&&(r=n),i!==X){if(r===X)return i;"string"==typeof n||"string"==typeof i?(n=Ji(n),i=Ji(i)):(n=Qi(n),i=Qi(i)),r=e(n,i)}return r}}function Ur(t){return Jr(function(n){return n=u(n,x(ro())),Gi(function(i){var r=this;return t(n,function(t){return e(t,r,i)})})})}function Br(e,t){t=t===X?" ":Ji(t);var n=t.length;if(n<2)return n?ji(t,e):t;var i=ji(t,_c(e/q(t)));return D(t)?cr($(i),0,e).join(""):i.slice(0,e)}function jr(t,n,i,r){function o(){for(var n=-1,u=arguments.length,l=-1,c=r.length,d=Ul(c+u),h=this&&this!==fn&&this instanceof o?s:t;++l<c;)d[l]=r[l];for(;u--;)d[l++]=arguments[++n];return e(h,a?i:this,d)}var a=n&ue,s=Lr(t);return o}function Gr(e){return function(t,n,i){return i&&"number"!=typeof i&&bo(t,n,i)&&(n=i=X),t=ou(t),n===X?(n=t,t=0):n=ou(n),i=i===X?t<n?1:-1:ou(i),Bi(t,n,i,e)}}function Hr(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=uu(t),n=uu(n)),e(t,n)}}function Wr(e,t,n,i,r,o,a,s,u,l){var c=t&de,d=c?a:X,h=c?X:a,f=c?o:X,p=c?X:o;t|=c?fe:pe,(t&=~(c?pe:fe))&ce||(t&=~(ue|le));var g=[e,t,r,f,d,p,h,s,u,l],m=n.apply(X,g);return Eo(e)&&dd(m,g),m.placeholder=i,Mo(m,e,t)}function qr(e){var t=Hl[e];return function(e,n){if(e=uu(e),(n=null==n?0:Oc(au(n),292))&&Pc(e)){var i=(du(e)+"e").split("e");return i=(du(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"),+(i[0]+"e"+(+i[1]-n))}return t(e)}}function $r(e){return function(t){var n=ld(t);return n==je?V(t):n==Ye?G(t):I(t,e(t))}}function Yr(e,t,n,i,r,o,a,s){var u=t&le;if(!u&&"function"!=typeof e)throw new Yl(J);var l=i?i.length:0;if(l||(t&=~(fe|pe),i=r=X),a=a===X?a:xc(au(a),0),s=s===X?s:au(s),l-=r?r.length:0,t&pe){var c=i,d=r;i=r=X}var h=u?X:ad(e),f=[e,t,n,i,r,c,d,o,a,s];if(h&&Io(f,h),e=f[0],t=f[1],n=f[2],i=f[3],r=f[4],s=f[9]=f[9]===X?u?0:e.length:xc(f[9]-l,0),!s&&t&(de|he)&&(t&=~(de|he)),t&&t!=ue)p=t==de||t==he?kr(e,t,s):t!=fe&&t!=(ue|fe)||r.length?Nr.apply(X,f):jr(e,t,n,i);else var p=Or(e,t,n);return Mo((h?td:dd)(p,f),e,t)}function zr(e,t,n,i,r,o){return Gs(e)&&Gs(t)&&(o.set(t,e),Ci(e,t,X,zr,o),o.delete(t)),e}function Kr(e){return Zs(e)?X:e}function Xr(e,t,n,i,r,o){var a=n&ae,s=e.length,u=t.length;if(s!=u&&!(a&&u>s))return!1;var l=o.get(e);if(l&&o.get(t))return l==t;var c=-1,d=!0,f=n&se?new sn:X;for(o.set(e,t),o.set(t,e);++c<s;){var p=e[c],g=t[c];if(i)var m=a?i(g,p,c,t,e,o):i(p,g,c,e,t,o);if(m!==X){if(m)continue;d=!1;break}if(f){if(!h(t,function(e,t){if(!C(f,t)&&(p===e||r(p,e,n,i,o)))return f.push(t)})){d=!1;break}}else if(p!==g&&!r(p,g,n,i,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function Zr(e,t,n,i,r,o,a){switch(n){case et:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Je:return!(e.byteLength!=t.byteLength||!o(new uc(e),new uc(t)));case De:case Ne:case Ge:return Os(+e,+t);case Ve:return e.name==t.name&&e.message==t.message;case $e:case ze:return e==t+"";case je:var s=V;case Ye:var u=i&ae;if(s||(s=j),e.size!=t.size&&!u)return!1;var l=a.get(e);if(l)return l==t;i|=se,a.set(e,t);var c=Xr(s(e),s(t),i,r,o,a);return a.delete(e),c;case Ke:if(zc)return zc.call(e)==zc.call(t)}return!1}function Qr(e,t,n,i,r,o){var a=n&ae,s=eo(e),u=s.length;if(u!=eo(t).length&&!a)return!1;for(var l=u;l--;){var c=s[l];if(!(a?c in t:Jl.call(t,c)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var h=!0;o.set(e,t),o.set(t,e);for(var f=a;++l<u;){c=s[l];var p=e[c],g=t[c];if(i)var m=a?i(g,p,c,t,e,o):i(p,g,c,e,t,o);if(!(m===X?p===g||r(p,g,n,i,o):m)){h=!1;break}f||(f="constructor"==c)}if(h&&!f){var v=e.constructor,y=t.constructor;v!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y)&&(h=!1)}return o.delete(e),o.delete(t),h}function Jr(e){return fd(Co(e,X,Zo),e+"")}function eo(e){return ii(e,Tu,sd)}function to(e){return ii(e,Pu,ud)}function no(e){for(var t=e.name+"",n=jc[t],i=Jl.call(jc,t)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==e)return r.name}return t}function io(e){return(Jl.call(H,"placeholder")?H:e).placeholder}function ro(){var e=H.iteratee||pl;return e=e===pl?Si:e,arguments.length?e(arguments[0],arguments[1]):e}function oo(e,t){var n=e.__data__;return _o(t)?n["string"==typeof t?"string":"hash"]:n.map}function ao(e){for(var t=Tu(e),n=t.length;n--;){var i=t[n],r=e[i];t[n]=[i,r,Po(r)]}return t}function so(e,t){var n=M(e,t);return bi(n)?n:X}function uo(e){var t=Jl.call(e,mc),n=e[mc];try{e[mc]=X;var i=!0}catch(e){}var r=nc.call(e);return i&&(t?e[mc]=n:delete e[mc]),r}function lo(e,t,n){for(var i=-1,r=n.length;++i<r;){var o=n[i],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=Oc(t,e+a);break;case"takeRight":e=xc(e,t-a)}}return{start:e,end:t}}function co(e){var t=e.match(St);return t?t[1].split(Tt):[]}function ho(e,t,n){t=lr(t,e);for(var i=-1,r=t.length,o=!1;++i<r;){var a=Fo(t[i]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++i!=r?o:!!(r=null==e?0:e.length)&&js(r)&&yo(a,r)&&(Jd(e)||Qd(e))}function fo(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Jl.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function po(e){return"function"!=typeof e.constructor||To(e)?{}:Xc(cc(e))}function go(e,t,n){var i=e.constructor;switch(t){case Je:return hr(e);case De:case Ne:return new i(+e);case et:return fr(e,n);case tt:case nt:case it:case rt:case ot:case at:case st:case ut:case lt:return mr(e,n);case je:return new i;case Ge:case ze:return new i(e);case $e:return pr(e);case Ye:return new i;case Ke:return gr(e)}}function mo(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(Et,"{\n/* [wrapped with "+t+"] */\n")}function vo(e){return Jd(e)||Qd(e)||!!(pc&&e&&e[pc])}function yo(e,t){var n=typeof e;return!!(t=null==t?Pe:t)&&("number"==n||"symbol"!=n&&Lt.test(e))&&e>-1&&e%1==0&&e<t}function bo(e,t,n){if(!Gs(n))return!1;var i=typeof t;return!!("number"==i?Cs(n)&&yo(t,n.length):"string"==i&&t in n)&&Os(n[t],e)}function wo(e,t){if(Jd(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!eu(e))||(gt.test(e)||!pt.test(e)||null!=t&&e in Wl(t))}function _o(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function Eo(e){var t=no(e),n=H[t];if("function"!=typeof n||!(t in Pt.prototype))return!1;if(e===n)return!0;var i=ad(n);return!!i&&e===i[0]}function So(e){return!!tc&&tc in e}function To(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Xl)}function Po(e){return e===e&&!Gs(e)}function Ao(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==X||e in Wl(n)))}}function Io(e,t){var n=e[1],i=t[1],r=n|i,o=r<(ue|le|ge),a=i==ge&&n==de||i==ge&&n==me&&e[7].length<=t[8]||i==(ge|me)&&t[7].length<=t[8]&&n==de;if(!o&&!a)return e;i&ue&&(e[2]=t[2],r|=n&ue?0:ce);var s=t[3];if(s){var u=e[3];e[3]=u?br(u,s,t[4]):s,e[4]=u?B(e[3],ne):t[4]}return s=t[5],s&&(u=e[5],e[5]=u?wr(u,s,t[6]):s,e[6]=u?B(e[5],ne):t[6]),s=t[7],s&&(e[7]=s),i&ge&&(e[8]=null==e[8]?t[8]:Oc(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r,e}function xo(e){var t=[];if(null!=e)for(var n in Wl(e))t.push(n);return t}function Oo(e){return nc.call(e)}function Co(t,n,i){return n=xc(n===X?t.length-1:n,0),function(){for(var r=arguments,o=-1,a=xc(r.length-n,0),s=Ul(a);++o<a;)s[o]=r[n+o];o=-1;for(var u=Ul(n+1);++o<n;)u[o]=r[o];return u[n]=i(s),e(t,this,u)}}function Ro(e,t){return t.length<2?e:ni(e,Yi(t,0,-1))}function Lo(e,t){for(var n=e.length,i=Oc(t.length,n),r=_r(e);i--;){var o=t[i];e[i]=yo(o,n)?r[o]:X}return e}function ko(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Mo(e,t,n){var i=t+"";return fd(e,mo(i,Uo(co(i),n)))}function Do(e){var t=0,n=0;return function(){var i=Cc(),r=_e-(i-n);if(n=i,r>0){if(++t>=we)return arguments[0]}else t=0;return e.apply(X,arguments)}}function No(e,t){var n=-1,i=e.length,r=i-1;for(t=t===X?i:t;++n<t;){var o=Ui(n,r),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}function Fo(e){if("string"==typeof e||eu(e))return e;var t=e+"";return"0"==t&&1/e==-Te?"-0":t}function Vo(e){if(null!=e){try{return Ql.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Uo(e,t){return n(Re,function(n){var i="_."+n[0];t&n[1]&&!a(e,i)&&e.push(i)}),e.sort()}function Bo(e){if(e instanceof Pt)return e.clone();var t=new z(e.__wrapped__,e.__chain__);return t.__actions__=_r(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function jo(e,t,n){t=(n?bo(e,t,n):t===X)?1:xc(au(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var r=0,o=0,a=Ul(_c(i/t));r<i;)a[o++]=Yi(e,r,r+=t);return a}function Go(e){for(var t=-1,n=null==e?0:e.length,i=0,r=[];++t<n;){var o=e[t];o&&(r[i++]=o)}return r}function Ho(){var e=arguments.length;if(!e)return[];for(var t=Ul(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return l(Jd(n)?_r(n):[n],Qn(t,1))}function Wo(e,t,n){var i=null==e?0:e.length;return i?(t=n||t===X?1:au(t),Yi(e,t<0?0:t,i)):[]}function qo(e,t,n){var i=null==e?0:e.length;return i?(t=n||t===X?1:au(t),t=i-t,Yi(e,0,t<0?0:t)):[]}function $o(e,t){return e&&e.length?ir(e,ro(t,3),!0,!0):[]}function Yo(e,t){return e&&e.length?ir(e,ro(t,3),!0):[]}function zo(e,t,n,i){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&bo(e,t,n)&&(n=0,i=r),Xn(e,t,n,i)):[]}function Ko(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:au(n);return r<0&&(r=xc(i+r,0)),m(e,ro(t,3),r)}function Xo(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=i-1;return n!==X&&(r=au(n),r=n<0?xc(i+r,0):Oc(r,i-1)),m(e,ro(t,3),r,!0)}function Zo(e){return(null==e?0:e.length)?Qn(e,1):[]}function Qo(e){return(null==e?0:e.length)?Qn(e,Te):[]}function Jo(e,t){return(null==e?0:e.length)?(t=t===X?1:au(t),Qn(e,t)):[]}function ea(e){for(var t=-1,n=null==e?0:e.length,i={};++t<n;){var r=e[t];i[r[0]]=r[1]}return i}function ta(e){return e&&e.length?e[0]:X}function na(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:au(n);return r<0&&(r=xc(i+r,0)),v(e,t,r)}function ia(e){return(null==e?0:e.length)?Yi(e,0,-1):[]}function ra(e,t){return null==e?"":Ac.call(e,t)}function oa(e){var t=null==e?0:e.length;return t?e[t-1]:X}function aa(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=i;return n!==X&&(r=au(n),r=r<0?xc(i+r,0):Oc(r,i-1)),t===t?W(e,t,r):m(e,b,r,!0)}function sa(e,t){return e&&e.length?Li(e,au(t)):X}function ua(e,t){return e&&e.length&&t&&t.length?Fi(e,t):e}function la(e,t,n){return e&&e.length&&t&&t.length?Fi(e,t,ro(n,2)):e}function ca(e,t,n){return e&&e.length&&t&&t.length?Fi(e,t,X,n):e}function da(e,t){var n=[];if(!e||!e.length)return n;var i=-1,r=[],o=e.length;for(t=ro(t,3);++i<o;){var a=e[i];t(a,i,e)&&(n.push(a),r.push(i))}return Vi(e,r),n}function ha(e){return null==e?e:kc.call(e)}function fa(e,t,n){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&bo(e,t,n)?(t=0,n=i):(t=null==t?0:au(t),n=n===X?i:au(n)),Yi(e,t,n)):[]}function pa(e,t){return Ki(e,t)}function ga(e,t,n){return Xi(e,t,ro(n,2))}function ma(e,t){var n=null==e?0:e.length;if(n){var i=Ki(e,t);if(i<n&&Os(e[i],t))return i}return-1}function va(e,t){return Ki(e,t,!0)}function ya(e,t,n){return Xi(e,t,ro(n,2),!0)}function ba(e,t){if(null==e?0:e.length){var n=Ki(e,t,!0)-1;if(Os(e[n],t))return n}return-1}function wa(e){return e&&e.length?Zi(e):[]}function _a(e,t){return e&&e.length?Zi(e,ro(t,2)):[]}function Ea(e){var t=null==e?0:e.length;return t?Yi(e,1,t):[]}function Sa(e,t,n){return e&&e.length?(t=n||t===X?1:au(t),Yi(e,0,t<0?0:t)):[]}function Ta(e,t,n){var i=null==e?0:e.length;return i?(t=n||t===X?1:au(t),t=i-t,Yi(e,t<0?0:t,i)):[]}function Pa(e,t){return e&&e.length?ir(e,ro(t,3),!1,!0):[]}function Aa(e,t){return e&&e.length?ir(e,ro(t,3)):[]}function Ia(e){return e&&e.length?er(e):[]}function xa(e,t){return e&&e.length?er(e,ro(t,2)):[]}function Oa(e,t){return t="function"==typeof t?t:X,e&&e.length?er(e,X,t):[]}function Ca(e){if(!e||!e.length)return[];var t=0;return e=o(e,function(e){if(Rs(e))return t=xc(e.length,t),!0}),A(t,function(t){return u(e,_(t))})}function Ra(t,n){if(!t||!t.length)return[];var i=Ca(t);return null==n?i:u(i,function(t){return e(n,X,t)})}function La(e,t){return ar(e||[],t||[],Dn)}function ka(e,t){return ar(e||[],t||[],qi)}function Ma(e){var t=H(e);return t.__chain__=!0,t}function Da(e,t){return t(e),e}function Na(e,t){return t(e)}function Fa(){return Ma(this)}function Va(){return new z(this.value(),this.__chain__)}function Ua(){this.__values__===X&&(this.__values__=ru(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?X:this.__values__[this.__index__++]}}function Ba(){return this}function ja(e){for(var t,n=this;n instanceof Y;){var i=Bo(n);i.__index__=0,i.__values__=X,t?r.__wrapped__=i:t=i;var r=i;n=n.__wrapped__}return r.__wrapped__=e,t}function Ga(){var e=this.__wrapped__;if(e instanceof Pt){var t=e;return this.__actions__.length&&(t=new Pt(this)),t=t.reverse(),t.__actions__.push({func:Na,args:[ha],thisArg:X}),new z(t,this.__chain__)}return this.thru(ha)}function Ha(){return rr(this.__wrapped__,this.__actions__)}function Wa(e,t,n){var i=Jd(e)?r:zn;return n&&bo(e,t,n)&&(t=X),i(e,ro(t,3))}function qa(e,t){return(Jd(e)?o:Zn)(e,ro(t,3))}function $a(e,t){return Qn(Qa(e,t),1)}function Ya(e,t){return Qn(Qa(e,t),Te)}function za(e,t,n){return n=n===X?1:au(n),Qn(Qa(e,t),n)}function Ka(e,t){return(Jd(e)?n:Zc)(e,ro(t,3))}function Xa(e,t){return(Jd(e)?i:Qc)(e,ro(t,3))}function Za(e,t,n,i){e=Cs(e)?e:Fu(e),n=n&&!i?au(n):0;var r=e.length;return n<0&&(n=xc(r+n,0)),Js(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&v(e,t,n)>-1}function Qa(e,t){return(Jd(e)?u:Ii)(e,ro(t,3))}function Ja(e,t,n,i){return null==e?[]:(Jd(t)||(t=null==t?[]:[t]),n=i?X:n,Jd(n)||(n=null==n?[]:[n]),ki(e,t,n))}function es(e,t,n){var i=Jd(e)?c:S,r=arguments.length<3;return i(e,ro(t,4),n,r,Zc)}function ts(e,t,n){var i=Jd(e)?d:S,r=arguments.length<3;return i(e,ro(t,4),n,r,Qc)}function ns(e,t){return(Jd(e)?o:Zn)(e,ms(ro(t,3)))}function is(e){return(Jd(e)?Rn:Hi)(e)}function rs(e,t,n){return t=(n?bo(e,t,n):t===X)?1:au(t),(Jd(e)?Ln:Wi)(e,t)}function os(e){return(Jd(e)?kn:$i)(e)}function as(e){if(null==e)return 0;if(Cs(e))return Js(e)?q(e):e.length;var t=ld(e);return t==je||t==Ye?e.size:Ti(e).length}function ss(e,t,n){var i=Jd(e)?h:zi;return n&&bo(e,t,n)&&(t=X),i(e,ro(t,3))}function us(e,t){if("function"!=typeof t)throw new Yl(J);return e=au(e),function(){if(--e<1)return t.apply(this,arguments)}}function ls(e,t,n){return t=n?X:t,t=e&&null==t?e.length:t,Yr(e,ge,X,X,X,X,t)}function cs(e,t){var n;if("function"!=typeof t)throw new Yl(J);return e=au(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=X),n}}function ds(e,t,n){t=n?X:t;var i=Yr(e,de,X,X,X,X,X,t);return i.placeholder=ds.placeholder,i}function hs(e,t,n){t=n?X:t;var i=Yr(e,he,X,X,X,X,X,t);return i.placeholder=hs.placeholder,i}function fs(e,t,n){function i(t){var n=h,i=f;return h=f=X,y=t,g=e.apply(i,n)}function r(e){return y=e,m=hd(s,t),b?i(e):g}function o(e){var n=e-v,i=e-y,r=t-n;return w?Oc(r,p-i):r}function a(e){var n=e-v,i=e-y;return v===X||n>=t||n<0||w&&i>=p}function s(){var e=jd();if(a(e))return u(e);m=hd(s,o(e))}function u(e){return m=X,_&&h?i(e):(h=f=X,g)}function l(){m!==X&&rd(m),y=0,h=v=f=m=X}function c(){return m===X?g:u(jd())}function d(){var e=jd(),n=a(e);if(h=arguments,f=this,v=e,n){if(m===X)return r(v);if(w)return rd(m),m=hd(s,t),i(v)}return m===X&&(m=hd(s,t)),g}var h,f,p,g,m,v,y=0,b=!1,w=!1,_=!0;if("function"!=typeof e)throw new Yl(J);return t=uu(t)||0,Gs(n)&&(b=!!n.leading,w="maxWait"in n,p=w?xc(uu(n.maxWait)||0,t):p,_="trailing"in n?!!n.trailing:_),d.cancel=l,d.flush=c,d}function ps(e){return Yr(e,ve)}function gs(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Yl(J);var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var a=e.apply(this,i);return n.cache=o.set(r,a)||o,a};return n.cache=new(gs.Cache||Kt),n}function ms(e){if("function"!=typeof e)throw new Yl(J);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function vs(e){return cs(2,e)}function ys(e,t){if("function"!=typeof e)throw new Yl(J);return t=t===X?t:au(t),Gi(e,t)}function bs(t,n){if("function"!=typeof t)throw new Yl(J);return n=null==n?0:xc(au(n),0),Gi(function(i){var r=i[n],o=cr(i,0,n);return r&&l(o,r),e(t,this,o)})}function ws(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new Yl(J);return Gs(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),fs(e,t,{leading:i,maxWait:t,trailing:r})}function _s(e){return ls(e,1)}function Es(e,t){return Yd(ur(t),e)}function Ss(){if(!arguments.length)return[];var e=arguments[0];return Jd(e)?e:[e]}function Ts(e){return Hn(e,oe)}function Ps(e,t){return t="function"==typeof t?t:X,Hn(e,oe,t)}function As(e){return Hn(e,ie|oe)}function Is(e,t){return t="function"==typeof t?t:X,Hn(e,ie|oe,t)}function xs(e,t){return null==t||qn(e,t,Tu(t))}function Os(e,t){return e===t||e!==e&&t!==t}function Cs(e){return null!=e&&js(e.length)&&!Us(e)}function Rs(e){return Hs(e)&&Cs(e)}function Ls(e){return!0===e||!1===e||Hs(e)&&ri(e)==De}function ks(e){return Hs(e)&&1===e.nodeType&&!Zs(e)}function Ms(e){if(null==e)return!0;if(Cs(e)&&(Jd(e)||"string"==typeof e||"function"==typeof e.splice||th(e)||ah(e)||Qd(e)))return!e.length;var t=ld(e);if(t==je||t==Ye)return!e.size;if(To(e))return!Ti(e).length;for(var n in e)if(Jl.call(e,n))return!1;return!0}function Ds(e,t){return gi(e,t)}function Ns(e,t,n){n="function"==typeof n?n:X;var i=n?n(e,t):X;return i===X?gi(e,t,X,n):!!i}function Fs(e){if(!Hs(e))return!1;var t=ri(e);return t==Ve||t==Fe||"string"==typeof e.message&&"string"==typeof e.name&&!Zs(e)}function Vs(e){return"number"==typeof e&&Pc(e)}function Us(e){if(!Gs(e))return!1;var t=ri(e);return t==Ue||t==Be||t==Me||t==qe}function Bs(e){return"number"==typeof e&&e==au(e)}function js(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Pe}function Gs(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Hs(e){return null!=e&&"object"==typeof e}function Ws(e,t){return e===t||yi(e,t,ao(t))}function qs(e,t,n){return n="function"==typeof n?n:X,yi(e,t,ao(t),n)}function $s(e){return Xs(e)&&e!=+e}function Ys(e){if(cd(e))throw new jl(Q);return bi(e)}function zs(e){return null===e}function Ks(e){return null==e}function Xs(e){return"number"==typeof e||Hs(e)&&ri(e)==Ge}function Zs(e){if(!Hs(e)||ri(e)!=We)return!1;var t=cc(e);if(null===t)return!0;var n=Jl.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ql.call(n)==ic}function Qs(e){return Bs(e)&&e>=-Pe&&e<=Pe}function Js(e){return"string"==typeof e||!Jd(e)&&Hs(e)&&ri(e)==ze}function eu(e){return"symbol"==typeof e||Hs(e)&&ri(e)==Ke}function tu(e){return e===X}function nu(e){return Hs(e)&&ld(e)==Ze}function iu(e){return Hs(e)&&ri(e)==Qe}function ru(e){if(!e)return[];if(Cs(e))return Js(e)?$(e):_r(e);if(gc&&e[gc])return F(e[gc]());var t=ld(e);return(t==je?V:t==Ye?j:Fu)(e)}function ou(e){if(!e)return 0===e?e:0;if((e=uu(e))===Te||e===-Te){return(e<0?-1:1)*Ae}return e===e?e:0}function au(e){var t=ou(e),n=t%1;return t===t?n?t-n:t:0}function su(e){return e?Gn(au(e),0,xe):0}function uu(e){if("number"==typeof e)return e;if(eu(e))return Ie;if(Gs(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Gs(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(bt,"");var n=Ot.test(e);return n||Rt.test(e)?cn(e.slice(2),n?2:8):xt.test(e)?Ie:+e}function lu(e){return Er(e,Pu(e))}function cu(e){return e?Gn(au(e),-Pe,Pe):0===e?e:0}function du(e){return null==e?"":Ji(e)}function hu(e,t){var n=Xc(e);return null==t?n:Vn(n,t)}function fu(e,t){return g(e,ro(t,3),Jn)}function pu(e,t){return g(e,ro(t,3),ei)}function gu(e,t){return null==e?e:Jc(e,ro(t,3),Pu)}function mu(e,t){return null==e?e:ed(e,ro(t,3),Pu)}function vu(e,t){return e&&Jn(e,ro(t,3))}function yu(e,t){return e&&ei(e,ro(t,3))}function bu(e){return null==e?[]:ti(e,Tu(e))}function wu(e){return null==e?[]:ti(e,Pu(e))}function _u(e,t,n){var i=null==e?X:ni(e,t);return i===X?n:i}function Eu(e,t){return null!=e&&ho(e,t,ai)}function Su(e,t){return null!=e&&ho(e,t,si)}function Tu(e){return Cs(e)?Cn(e):Ti(e)}function Pu(e){return Cs(e)?Cn(e,!0):Pi(e)}function Au(e,t){var n={};return t=ro(t,3),Jn(e,function(e,i,r){Bn(n,t(e,i,r),e)}),n}function Iu(e,t){var n={};return t=ro(t,3),Jn(e,function(e,i,r){Bn(n,i,t(e,i,r))}),n}function xu(e,t){return Ou(e,ms(ro(t)))}function Ou(e,t){if(null==e)return{};var n=u(to(e),function(e){return[e]});return t=ro(t),Di(e,n,function(e,n){return t(e,n[0])})}function Cu(e,t,n){t=lr(t,e);var i=-1,r=t.length;for(r||(r=1,e=X);++i<r;){var o=null==e?X:e[Fo(t[i])];o===X&&(i=r,o=n),e=Us(o)?o.call(e):o}return e}function Ru(e,t,n){return null==e?e:qi(e,t,n)}function Lu(e,t,n,i){return i="function"==typeof i?i:X,null==e?e:qi(e,t,n,i)}function ku(e,t,i){var r=Jd(e),o=r||th(e)||ah(e);if(t=ro(t,4),null==i){var a=e&&e.constructor;i=o?r?new a:[]:Gs(e)&&Us(a)?Xc(cc(e)):{}}return(o?n:Jn)(e,function(e,n,r){return t(i,e,n,r)}),i}function Mu(e,t){return null==e||tr(e,t)}function Du(e,t,n){return null==e?e:nr(e,t,ur(n))}function Nu(e,t,n,i){return i="function"==typeof i?i:X,null==e?e:nr(e,t,ur(n),i)}function Fu(e){return null==e?[]:O(e,Tu(e))}function Vu(e){return null==e?[]:O(e,Pu(e))}function Uu(e,t,n){return n===X&&(n=t,t=X),n!==X&&(n=uu(n),n=n===n?n:0),t!==X&&(t=uu(t),t=t===t?t:0),Gn(uu(e),t,n)}function Bu(e,t,n){return t=ou(t),n===X?(n=t,t=0):n=ou(n),e=uu(e),ui(e,t,n)}function ju(e,t,n){if(n&&"boolean"!=typeof n&&bo(e,t,n)&&(t=n=X),n===X&&("boolean"==typeof t?(n=t,t=X):"boolean"==typeof e&&(n=e,e=X)),e===X&&t===X?(e=0,t=1):(e=ou(e),t===X?(t=e,e=0):t=ou(t)),e>t){var i=e;e=t,t=i}if(n||e%1||t%1){var r=Lc();return Oc(e+r*(t-e+ln("1e-"+((r+"").length-1))),t)}return Ui(e,t)}function Gu(e){return Lh(du(e).toLowerCase())}function Hu(e){return(e=du(e))&&e.replace(kt,An).replace(Zt,"")}function Wu(e,t,n){e=du(e),t=Ji(t);var i=e.length;n=n===X?i:Gn(au(n),0,i);var r=n;return(n-=t.length)>=0&&e.slice(n,r)==t}function qu(e){return e=du(e),e&&ft.test(e)?e.replace(dt,In):e}function $u(e){return e=du(e),e&&yt.test(e)?e.replace(vt,"\\$&"):e}function Yu(e,t,n){e=du(e),t=au(t);var i=t?q(e):0;if(!t||i>=t)return e;var r=(t-i)/2;return Br(Ec(r),n)+e+Br(_c(r),n)}function zu(e,t,n){e=du(e),t=au(t);var i=t?q(e):0;return t&&i<t?e+Br(t-i,n):e}function Ku(e,t,n){e=du(e),t=au(t);var i=t?q(e):0;return t&&i<t?Br(t-i,n)+e:e}function Xu(e,t,n){return n||null==t?t=0:t&&(t=+t),Rc(du(e).replace(wt,""),t||0)}function Zu(e,t,n){return t=(n?bo(e,t,n):t===X)?1:au(t),ji(du(e),t)}function Qu(){var e=arguments,t=du(e[0]);return e.length<3?t:t.replace(e[1],e[2])}function Ju(e,t,n){return n&&"number"!=typeof n&&bo(e,t,n)&&(t=n=X),(n=n===X?xe:n>>>0)?(e=du(e),e&&("string"==typeof t||null!=t&&!rh(t))&&!(t=Ji(t))&&D(e)?cr($(e),0,n):e.split(t,n)):[]}function el(e,t,n){return e=du(e),n=null==n?0:Gn(au(n),0,e.length),t=Ji(t),e.slice(n,n+t.length)==t}function tl(e){return du(e).toLowerCase()}function nl(e){return du(e).toUpperCase()}function il(e,t,n){if((e=du(e))&&(n||t===X))return e.replace(bt,"");if(!e||!(t=Ji(t)))return e;var i=$(e),r=$(t);return cr(i,R(i,r),L(i,r)+1).join("")}function rl(e,t,n){if((e=du(e))&&(n||t===X))return e.replace(_t,"");if(!e||!(t=Ji(t)))return e;var i=$(e);return cr(i,0,L(i,$(t))+1).join("")}function ol(e,t,n){if((e=du(e))&&(n||t===X))return e.replace(wt,"");if(!e||!(t=Ji(t)))return e;var i=$(e);return cr(i,R(i,$(t))).join("")}function al(e,t){var n=ye,i=be;if(Gs(t)){var r="separator"in t?t.separator:r;n="length"in t?au(t.length):n,i="omission"in t?Ji(t.omission):i}e=du(e);var o=e.length;if(D(e)){var a=$(e);o=a.length}if(n>=o)return e;var s=n-q(i);if(s<1)return i;var u=a?cr(a,0,s).join(""):e.slice(0,s);if(r===X)return u+i;if(a&&(s+=u.length-s),rh(r)){if(e.slice(s).search(r)){var l,c=u;for(r.global||(r=ql(r.source,du(It.exec(r))+"g")),r.lastIndex=0;l=r.exec(c);)var d=l.index;u=u.slice(0,d===X?s:d)}}else if(e.indexOf(Ji(r),s)!=s){var h=u.lastIndexOf(r);h>-1&&(u=u.slice(0,h))}return u+i}function sl(e){return e=du(e),e&&ht.test(e)?e.replace(ct,xn):e}function ul(e,t,n){return e=du(e),t=n?X:t,t===X?N(e)?K(e):p(e):e.match(t)||[]}function ll(t){var n=null==t?0:t.length,i=ro();return t=n?u(t,function(e){if("function"!=typeof e[1])throw new Yl(J);return[i(e[0]),e[1]]}):[],Gi(function(i){for(var r=-1;++r<n;){var o=t[r];if(e(o[0],this,i))return e(o[1],this,i)}})}function cl(e){return Wn(Hn(e,ie))}function dl(e){return function(){return e}}function hl(e,t){return null==e||e!==e?t:e}function fl(e){return e}function pl(e){return Si("function"==typeof e?e:Hn(e,ie))}function gl(e){return xi(Hn(e,ie))}function ml(e,t){return Oi(e,Hn(t,ie))}function vl(e,t,i){var r=Tu(t),o=ti(t,r);null!=i||Gs(t)&&(o.length||!r.length)||(i=t,t=e,e=this,o=ti(t,Tu(t)));var a=!(Gs(i)&&"chain"in i&&!i.chain),s=Us(e);return n(o,function(n){var i=t[n];e[n]=i,s&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__);return(n.__actions__=_r(this.__actions__)).push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,l([this.value()],arguments))})}),e}function yl(){return fn._===this&&(fn._=rc),this}function bl(){}function wl(e){return e=au(e),Gi(function(t){return Li(t,e)})}function _l(e){return wo(e)?_(Fo(e)):Ni(e)}function El(e){return function(t){return null==e?X:ni(e,t)}}function Sl(){return[]}function Tl(){return!1}function Pl(){return{}}function Al(){return""}function Il(){return!0}function xl(e,t){if((e=au(e))<1||e>Pe)return[];var n=xe,i=Oc(e,xe);t=ro(t),e-=xe;for(var r=A(i,t);++n<e;)t(n);return r}function Ol(e){return Jd(e)?u(e,Fo):eu(e)?[e]:_r(pd(du(e)))}function Cl(e){var t=++ec;return du(e)+t}function Rl(e){return e&&e.length?Kn(e,fl,oi):X}function Ll(e,t){return e&&e.length?Kn(e,ro(t,2),oi):X}function kl(e){return w(e,fl)}function Ml(e,t){return w(e,ro(t,2))}function Dl(e){return e&&e.length?Kn(e,fl,Ai):X}function Nl(e,t){return e&&e.length?Kn(e,ro(t,2),Ai):X}function Fl(e){return e&&e.length?P(e,fl):0}function Vl(e,t){return e&&e.length?P(e,ro(t,2)):0}E=null==E?fn:On.defaults(fn.Object(),E,On.pick(fn,nn));var Ul=E.Array,Bl=E.Date,jl=E.Error,Gl=E.Function,Hl=E.Math,Wl=E.Object,ql=E.RegExp,$l=E.String,Yl=E.TypeError,zl=Ul.prototype,Kl=Gl.prototype,Xl=Wl.prototype,Zl=E["__core-js_shared__"],Ql=Kl.toString,Jl=Xl.hasOwnProperty,ec=0,tc=function(){var e=/[^.]+$/.exec(Zl&&Zl.keys&&Zl.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),nc=Xl.toString,ic=Ql.call(Wl),rc=fn._,oc=ql("^"+Ql.call(Jl).replace(vt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ac=mn?E.Buffer:X,sc=E.Symbol,uc=E.Uint8Array,lc=ac?ac.allocUnsafe:X,cc=U(Wl.getPrototypeOf,Wl),dc=Wl.create,hc=Xl.propertyIsEnumerable,fc=zl.splice,pc=sc?sc.isConcatSpreadable:X,gc=sc?sc.iterator:X,mc=sc?sc.toStringTag:X,vc=function(){try{var e=so(Wl,"defineProperty");return e({},"",{}),e}catch(e){}}(),yc=E.clearTimeout!==fn.clearTimeout&&E.clearTimeout,bc=Bl&&Bl.now!==fn.Date.now&&Bl.now,wc=E.setTimeout!==fn.setTimeout&&E.setTimeout,_c=Hl.ceil,Ec=Hl.floor,Sc=Wl.getOwnPropertySymbols,Tc=ac?ac.isBuffer:X,Pc=E.isFinite,Ac=zl.join,Ic=U(Wl.keys,Wl),xc=Hl.max,Oc=Hl.min,Cc=Bl.now,Rc=E.parseInt,Lc=Hl.random,kc=zl.reverse,Mc=so(E,"DataView"),Dc=so(E,"Map"),Nc=so(E,"Promise"),Fc=so(E,"Set"),Vc=so(E,"WeakMap"),Uc=so(Wl,"create"),Bc=Vc&&new Vc,jc={},Gc=Vo(Mc),Hc=Vo(Dc),Wc=Vo(Nc),qc=Vo(Fc),$c=Vo(Vc),Yc=sc?sc.prototype:X,zc=Yc?Yc.valueOf:X,Kc=Yc?Yc.toString:X,Xc=function(){function e(){}return function(t){if(!Gs(t))return{};if(dc)return dc(t);e.prototype=t;var n=new e;return e.prototype=X,n}}();H.prototype=Y.prototype,H.prototype.constructor=H,z.prototype=Xc(Y.prototype),z.prototype.constructor=z,Pt.prototype=Xc(Y.prototype),Pt.prototype.constructor=Pt,Ft.prototype.clear=Vt,Ft.prototype.delete=Ut,Ft.prototype.get=Bt,Ft.prototype.has=jt,Ft.prototype.set=Gt,Ht.prototype.clear=Wt,Ht.prototype.delete=qt,Ht.prototype.get=$t,Ht.prototype.has=Yt,Ht.prototype.set=zt,Kt.prototype.clear=Qt,Kt.prototype.delete=Jt,Kt.prototype.get=en,Kt.prototype.has=tn,Kt.prototype.set=an,sn.prototype.add=sn.prototype.push=un,sn.prototype.has=dn,hn.prototype.clear=pn,hn.prototype.delete=gn,hn.prototype.get=vn,hn.prototype.has=yn,hn.prototype.set=Pn;var Zc=Ir(Jn),Qc=Ir(ei,!0),Jc=xr(),ed=xr(!0),td=Bc?function(e,t){return Bc.set(e,t),e}:fl,nd=vc?function(e,t){return vc(e,"toString",{configurable:!0,enumerable:!1,value:dl(t),writable:!0})}:fl,id=Gi,rd=yc||function(e){return fn.clearTimeout(e)},od=Fc&&1/j(new Fc([,-0]))[1]==Te?function(e){return new Fc(e)}:bl,ad=Bc?function(e){return Bc.get(e)}:bl,sd=Sc?function(e){return null==e?[]:(e=Wl(e),o(Sc(e),function(t){return hc.call(e,t)}))}:Sl,ud=Sc?function(e){for(var t=[];e;)l(t,sd(e)),e=cc(e);return t}:Sl,ld=ri;(Mc&&ld(new Mc(new ArrayBuffer(1)))!=et||Dc&&ld(new Dc)!=je||Nc&&"[object Promise]"!=ld(Nc.resolve())||Fc&&ld(new Fc)!=Ye||Vc&&ld(new Vc)!=Ze)&&(ld=function(e){var t=ri(e),n=t==We?e.constructor:X,i=n?Vo(n):"";if(i)switch(i){case Gc:return et;case Hc:return je;case Wc:return"[object Promise]";case qc:return Ye;case $c:return Ze}return t});var cd=Zl?Us:Tl,dd=Do(td),hd=wc||function(e,t){return fn.setTimeout(e,t)},fd=Do(nd),pd=function(e){var t=gs(e,function(e){return n.size===te&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(mt,function(e,n,i,r){t.push(i?r.replace(At,"$1"):n||e)}),t}),gd=Gi(function(e,t){return Rs(e)?Yn(e,Qn(t,1,Rs,!0)):[]}),md=Gi(function(e,t){var n=oa(t);return Rs(n)&&(n=X),Rs(e)?Yn(e,Qn(t,1,Rs,!0),ro(n,2)):[]}),vd=Gi(function(e,t){var n=oa(t);return Rs(n)&&(n=X),Rs(e)?Yn(e,Qn(t,1,Rs,!0),X,n):[]}),yd=Gi(function(e){var t=u(e,sr);return t.length&&t[0]===e[0]?li(t):[]}),bd=Gi(function(e){var t=oa(e),n=u(e,sr);return t===oa(n)?t=X:n.pop(),n.length&&n[0]===e[0]?li(n,ro(t,2)):[]}),wd=Gi(function(e){var t=oa(e),n=u(e,sr);return t="function"==typeof t?t:X,t&&n.pop(),n.length&&n[0]===e[0]?li(n,X,t):[]}),_d=Gi(ua),Ed=Jr(function(e,t){var n=null==e?0:e.length,i=jn(e,t);return Vi(e,u(t,function(e){return yo(e,n)?+e:e}).sort(vr)),i}),Sd=Gi(function(e){return er(Qn(e,1,Rs,!0))}),Td=Gi(function(e){var t=oa(e);return Rs(t)&&(t=X),er(Qn(e,1,Rs,!0),ro(t,2))}),Pd=Gi(function(e){var t=oa(e);return t="function"==typeof t?t:X,er(Qn(e,1,Rs,!0),X,t)}),Ad=Gi(function(e,t){return Rs(e)?Yn(e,t):[]}),Id=Gi(function(e){return or(o(e,Rs))}),xd=Gi(function(e){var t=oa(e);return Rs(t)&&(t=X),or(o(e,Rs),ro(t,2))}),Od=Gi(function(e){var t=oa(e);return t="function"==typeof t?t:X,or(o(e,Rs),X,t)}),Cd=Gi(Ca),Rd=Gi(function(e){var t=e.length,n=t>1?e[t-1]:X;return n="function"==typeof n?(e.pop(),n):X,Ra(e,n)}),Ld=Jr(function(e){var t=e.length,n=t?e[0]:0,i=this.__wrapped__,r=function(t){return jn(t,e)};return!(t>1||this.__actions__.length)&&i instanceof Pt&&yo(n)?(i=i.slice(n,+n+(t?1:0)),i.__actions__.push({func:Na,args:[r],thisArg:X}),new z(i,this.__chain__).thru(function(e){return t&&!e.length&&e.push(X),e})):this.thru(r)}),kd=Pr(function(e,t,n){Jl.call(e,n)?++e[n]:Bn(e,n,1)}),Md=Mr(Ko),Dd=Mr(Xo),Nd=Pr(function(e,t,n){
Jl.call(e,n)?e[n].push(t):Bn(e,n,[t])}),Fd=Gi(function(t,n,i){var r=-1,o="function"==typeof n,a=Cs(t)?Ul(t.length):[];return Zc(t,function(t){a[++r]=o?e(n,t,i):di(t,n,i)}),a}),Vd=Pr(function(e,t,n){Bn(e,n,t)}),Ud=Pr(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),Bd=Gi(function(e,t){if(null==e)return[];var n=t.length;return n>1&&bo(e,t[0],t[1])?t=[]:n>2&&bo(t[0],t[1],t[2])&&(t=[t[0]]),ki(e,Qn(t,1),[])}),jd=bc||function(){return fn.Date.now()},Gd=Gi(function(e,t,n){var i=ue;if(n.length){var r=B(n,io(Gd));i|=fe}return Yr(e,i,t,n,r)}),Hd=Gi(function(e,t,n){var i=ue|le;if(n.length){var r=B(n,io(Hd));i|=fe}return Yr(t,i,e,n,r)}),Wd=Gi(function(e,t){return $n(e,1,t)}),qd=Gi(function(e,t,n){return $n(e,uu(t)||0,n)});gs.Cache=Kt;var $d=id(function(t,n){n=1==n.length&&Jd(n[0])?u(n[0],x(ro())):u(Qn(n,1),x(ro()));var i=n.length;return Gi(function(r){for(var o=-1,a=Oc(r.length,i);++o<a;)r[o]=n[o].call(this,r[o]);return e(t,this,r)})}),Yd=Gi(function(e,t){var n=B(t,io(Yd));return Yr(e,fe,X,t,n)}),zd=Gi(function(e,t){var n=B(t,io(zd));return Yr(e,pe,X,t,n)}),Kd=Jr(function(e,t){return Yr(e,me,X,X,X,t)}),Xd=Hr(oi),Zd=Hr(function(e,t){return e>=t}),Qd=hi(function(){return arguments}())?hi:function(e){return Hs(e)&&Jl.call(e,"callee")&&!hc.call(e,"callee")},Jd=Ul.isArray,eh=bn?x(bn):fi,th=Tc||Tl,nh=wn?x(wn):pi,ih=_n?x(_n):vi,rh=En?x(En):wi,oh=Sn?x(Sn):_i,ah=Tn?x(Tn):Ei,sh=Hr(Ai),uh=Hr(function(e,t){return e<=t}),lh=Ar(function(e,t){if(To(t)||Cs(t))return void Er(t,Tu(t),e);for(var n in t)Jl.call(t,n)&&Dn(e,n,t[n])}),ch=Ar(function(e,t){Er(t,Pu(t),e)}),dh=Ar(function(e,t,n,i){Er(t,Pu(t),e,i)}),hh=Ar(function(e,t,n,i){Er(t,Tu(t),e,i)}),fh=Jr(jn),ph=Gi(function(e,t){e=Wl(e);var n=-1,i=t.length,r=i>2?t[2]:X;for(r&&bo(t[0],t[1],r)&&(i=1);++n<i;)for(var o=t[n],a=Pu(o),s=-1,u=a.length;++s<u;){var l=a[s],c=e[l];(c===X||Os(c,Xl[l])&&!Jl.call(e,l))&&(e[l]=o[l])}return e}),gh=Gi(function(t){return t.push(X,zr),e(wh,X,t)}),mh=Fr(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=nc.call(t)),e[t]=n},dl(fl)),vh=Fr(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=nc.call(t)),Jl.call(e,t)?e[t].push(n):e[t]=[n]},ro),yh=Gi(di),bh=Ar(function(e,t,n){Ci(e,t,n)}),wh=Ar(function(e,t,n,i){Ci(e,t,n,i)}),_h=Jr(function(e,t){var n={};if(null==e)return n;var i=!1;t=u(t,function(t){return t=lr(t,e),i||(i=t.length>1),t}),Er(e,to(e),n),i&&(n=Hn(n,ie|re|oe,Kr));for(var r=t.length;r--;)tr(n,t[r]);return n}),Eh=Jr(function(e,t){return null==e?{}:Mi(e,t)}),Sh=$r(Tu),Th=$r(Pu),Ph=Rr(function(e,t,n){return t=t.toLowerCase(),e+(n?Gu(t):t)}),Ah=Rr(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),Ih=Rr(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),xh=Cr("toLowerCase"),Oh=Rr(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Ch=Rr(function(e,t,n){return e+(n?" ":"")+Lh(t)}),Rh=Rr(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Lh=Cr("toUpperCase"),kh=Gi(function(t,n){try{return e(t,X,n)}catch(e){return Fs(e)?e:new jl(e)}}),Mh=Jr(function(e,t){return n(t,function(t){t=Fo(t),Bn(e,t,Gd(e[t],e))}),e}),Dh=Dr(),Nh=Dr(!0),Fh=Gi(function(e,t){return function(n){return di(n,e,t)}}),Vh=Gi(function(e,t){return function(n){return di(e,n,t)}}),Uh=Ur(u),Bh=Ur(r),jh=Ur(h),Gh=Gr(),Hh=Gr(!0),Wh=Vr(function(e,t){return e+t},0),qh=qr("ceil"),$h=Vr(function(e,t){return e/t},1),Yh=qr("floor"),zh=Vr(function(e,t){return e*t},1),Kh=qr("round"),Xh=Vr(function(e,t){return e-t},0);return H.after=us,H.ary=ls,H.assign=lh,H.assignIn=ch,H.assignInWith=dh,H.assignWith=hh,H.at=fh,H.before=cs,H.bind=Gd,H.bindAll=Mh,H.bindKey=Hd,H.castArray=Ss,H.chain=Ma,H.chunk=jo,H.compact=Go,H.concat=Ho,H.cond=ll,H.conforms=cl,H.constant=dl,H.countBy=kd,H.create=hu,H.curry=ds,H.curryRight=hs,H.debounce=fs,H.defaults=ph,H.defaultsDeep=gh,H.defer=Wd,H.delay=qd,H.difference=gd,H.differenceBy=md,H.differenceWith=vd,H.drop=Wo,H.dropRight=qo,H.dropRightWhile=$o,H.dropWhile=Yo,H.fill=zo,H.filter=qa,H.flatMap=$a,H.flatMapDeep=Ya,H.flatMapDepth=za,H.flatten=Zo,H.flattenDeep=Qo,H.flattenDepth=Jo,H.flip=ps,H.flow=Dh,H.flowRight=Nh,H.fromPairs=ea,H.functions=bu,H.functionsIn=wu,H.groupBy=Nd,H.initial=ia,H.intersection=yd,H.intersectionBy=bd,H.intersectionWith=wd,H.invert=mh,H.invertBy=vh,H.invokeMap=Fd,H.iteratee=pl,H.keyBy=Vd,H.keys=Tu,H.keysIn=Pu,H.map=Qa,H.mapKeys=Au,H.mapValues=Iu,H.matches=gl,H.matchesProperty=ml,H.memoize=gs,H.merge=bh,H.mergeWith=wh,H.method=Fh,H.methodOf=Vh,H.mixin=vl,H.negate=ms,H.nthArg=wl,H.omit=_h,H.omitBy=xu,H.once=vs,H.orderBy=Ja,H.over=Uh,H.overArgs=$d,H.overEvery=Bh,H.overSome=jh,H.partial=Yd,H.partialRight=zd,H.partition=Ud,H.pick=Eh,H.pickBy=Ou,H.property=_l,H.propertyOf=El,H.pull=_d,H.pullAll=ua,H.pullAllBy=la,H.pullAllWith=ca,H.pullAt=Ed,H.range=Gh,H.rangeRight=Hh,H.rearg=Kd,H.reject=ns,H.remove=da,H.rest=ys,H.reverse=ha,H.sampleSize=rs,H.set=Ru,H.setWith=Lu,H.shuffle=os,H.slice=fa,H.sortBy=Bd,H.sortedUniq=wa,H.sortedUniqBy=_a,H.split=Ju,H.spread=bs,H.tail=Ea,H.take=Sa,H.takeRight=Ta,H.takeRightWhile=Pa,H.takeWhile=Aa,H.tap=Da,H.throttle=ws,H.thru=Na,H.toArray=ru,H.toPairs=Sh,H.toPairsIn=Th,H.toPath=Ol,H.toPlainObject=lu,H.transform=ku,H.unary=_s,H.union=Sd,H.unionBy=Td,H.unionWith=Pd,H.uniq=Ia,H.uniqBy=xa,H.uniqWith=Oa,H.unset=Mu,H.unzip=Ca,H.unzipWith=Ra,H.update=Du,H.updateWith=Nu,H.values=Fu,H.valuesIn=Vu,H.without=Ad,H.words=ul,H.wrap=Es,H.xor=Id,H.xorBy=xd,H.xorWith=Od,H.zip=Cd,H.zipObject=La,H.zipObjectDeep=ka,H.zipWith=Rd,H.entries=Sh,H.entriesIn=Th,H.extend=ch,H.extendWith=dh,vl(H,H),H.add=Wh,H.attempt=kh,H.camelCase=Ph,H.capitalize=Gu,H.ceil=qh,H.clamp=Uu,H.clone=Ts,H.cloneDeep=As,H.cloneDeepWith=Is,H.cloneWith=Ps,H.conformsTo=xs,H.deburr=Hu,H.defaultTo=hl,H.divide=$h,H.endsWith=Wu,H.eq=Os,H.escape=qu,H.escapeRegExp=$u,H.every=Wa,H.find=Md,H.findIndex=Ko,H.findKey=fu,H.findLast=Dd,H.findLastIndex=Xo,H.findLastKey=pu,H.floor=Yh,H.forEach=Ka,H.forEachRight=Xa,H.forIn=gu,H.forInRight=mu,H.forOwn=vu,H.forOwnRight=yu,H.get=_u,H.gt=Xd,H.gte=Zd,H.has=Eu,H.hasIn=Su,H.head=ta,H.identity=fl,H.includes=Za,H.indexOf=na,H.inRange=Bu,H.invoke=yh,H.isArguments=Qd,H.isArray=Jd,H.isArrayBuffer=eh,H.isArrayLike=Cs,H.isArrayLikeObject=Rs,H.isBoolean=Ls,H.isBuffer=th,H.isDate=nh,H.isElement=ks,H.isEmpty=Ms,H.isEqual=Ds,H.isEqualWith=Ns,H.isError=Fs,H.isFinite=Vs,H.isFunction=Us,H.isInteger=Bs,H.isLength=js,H.isMap=ih,H.isMatch=Ws,H.isMatchWith=qs,H.isNaN=$s,H.isNative=Ys,H.isNil=Ks,H.isNull=zs,H.isNumber=Xs,H.isObject=Gs,H.isObjectLike=Hs,H.isPlainObject=Zs,H.isRegExp=rh,H.isSafeInteger=Qs,H.isSet=oh,H.isString=Js,H.isSymbol=eu,H.isTypedArray=ah,H.isUndefined=tu,H.isWeakMap=nu,H.isWeakSet=iu,H.join=ra,H.kebabCase=Ah,H.last=oa,H.lastIndexOf=aa,H.lowerCase=Ih,H.lowerFirst=xh,H.lt=sh,H.lte=uh,H.max=Rl,H.maxBy=Ll,H.mean=kl,H.meanBy=Ml,H.min=Dl,H.minBy=Nl,H.stubArray=Sl,H.stubFalse=Tl,H.stubObject=Pl,H.stubString=Al,H.stubTrue=Il,H.multiply=zh,H.nth=sa,H.noConflict=yl,H.noop=bl,H.now=jd,H.pad=Yu,H.padEnd=zu,H.padStart=Ku,H.parseInt=Xu,H.random=ju,H.reduce=es,H.reduceRight=ts,H.repeat=Zu,H.replace=Qu,H.result=Cu,H.round=Kh,H.runInContext=f,H.sample=is,H.size=as,H.snakeCase=Oh,H.some=ss,H.sortedIndex=pa,H.sortedIndexBy=ga,H.sortedIndexOf=ma,H.sortedLastIndex=va,H.sortedLastIndexBy=ya,H.sortedLastIndexOf=ba,H.startCase=Ch,H.startsWith=el,H.subtract=Xh,H.sum=Fl,H.sumBy=Vl,H.times=xl,H.toFinite=ou,H.toInteger=au,H.toLength=su,H.toLower=tl,H.toNumber=uu,H.toSafeInteger=cu,H.toString=du,H.toUpper=nl,H.trim=il,H.trimEnd=rl,H.trimStart=ol,H.truncate=al,H.unescape=sl,H.uniqueId=Cl,H.upperCase=Rh,H.upperFirst=Lh,H.each=Ka,H.eachRight=Xa,H.first=ta,vl(H,function(){var e={};return Jn(H,function(t,n){Jl.call(H.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),H.VERSION="4.17.14",n(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){H[e].placeholder=H}),n(["drop","take"],function(e,t){Pt.prototype[e]=function(n){n=n===X?1:xc(au(n),0);var i=this.__filtered__&&!t?new Pt(this):this.clone();return i.__filtered__?i.__takeCount__=Oc(n,i.__takeCount__):i.__views__.push({size:Oc(n,xe),type:e+(i.__dir__<0?"Right":"")}),i},Pt.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),n(["filter","map","takeWhile"],function(e,t){var n=t+1,i=n==Ee||3==n;Pt.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:ro(e,3),type:n}),t.__filtered__=t.__filtered__||i,t}}),n(["head","last"],function(e,t){var n="take"+(t?"Right":"");Pt.prototype[e]=function(){return this[n](1).value()[0]}}),n(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");Pt.prototype[e]=function(){return this.__filtered__?new Pt(this):this[n](1)}}),Pt.prototype.compact=function(){return this.filter(fl)},Pt.prototype.find=function(e){return this.filter(e).head()},Pt.prototype.findLast=function(e){return this.reverse().find(e)},Pt.prototype.invokeMap=Gi(function(e,t){return"function"==typeof e?new Pt(this):this.map(function(n){return di(n,e,t)})}),Pt.prototype.reject=function(e){return this.filter(ms(ro(e)))},Pt.prototype.slice=function(e,t){e=au(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Pt(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==X&&(t=au(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},Pt.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Pt.prototype.toArray=function(){return this.take(xe)},Jn(Pt.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),r=H[i?"take"+("last"==t?"Right":""):t],o=i||/^find/.test(t);r&&(H.prototype[t]=function(){var t=this.__wrapped__,a=i?[1]:arguments,s=t instanceof Pt,u=a[0],c=s||Jd(t),d=function(e){var t=r.apply(H,l([e],a));return i&&h?t[0]:t};c&&n&&"function"==typeof u&&1!=u.length&&(s=c=!1);var h=this.__chain__,f=!!this.__actions__.length,p=o&&!h,g=s&&!f;if(!o&&c){t=g?t:new Pt(this);var m=e.apply(t,a);return m.__actions__.push({func:Na,args:[d],thisArg:X}),new z(m,h)}return p&&g?e.apply(this,a):(m=this.thru(d),p?i?m.value()[0]:m.value():m)})}),n(["pop","push","shift","sort","splice","unshift"],function(e){var t=zl[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);H.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var r=this.value();return t.apply(Jd(r)?r:[],e)}return this[n](function(n){return t.apply(Jd(n)?n:[],e)})}}),Jn(Pt.prototype,function(e,t){var n=H[t];if(n){var i=n.name+"";Jl.call(jc,i)||(jc[i]=[]),jc[i].push({name:t,func:n})}}),jc[Nr(X,le).name]=[{name:"wrapper",func:X}],Pt.prototype.clone=Mt,Pt.prototype.reverse=Dt,Pt.prototype.value=Nt,H.prototype.at=Ld,H.prototype.chain=Fa,H.prototype.commit=Va,H.prototype.next=Ua,H.prototype.plant=ja,H.prototype.reverse=Ga,H.prototype.toJSON=H.prototype.valueOf=H.prototype.value=Ha,H.prototype.first=H.prototype.head,gc&&(H.prototype[gc]=Ba),H}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(fn._=On,define("lodash",[],function(){return On})):gn?((gn.exports=On)._=On,pn._=On):fn._=On}.call(this),define("jqueryajaxie9corsfix",["jquery"],function(e){if(e.support.cors||!e.ajaxTransport||!window.XDomainRequest)return e;var t=/^(https?:)?\/\//i,n=/^get|post$/i,i=new RegExp("^(//|"+location.protocol+")","i");return e.ajaxTransport("* text html xml json",function(r,o,a){if(r.crossDomain&&r.async&&n.test(r.type)&&t.test(r.url)&&i.test(r.url)){var s=null;return{send:function(t,n){var i="",a=(o.dataType||"").toLowerCase();s=new XDomainRequest,/^\d+$/.test(o.timeout)&&(s.timeout=o.timeout),s.ontimeout=function(){n(500,"timeout")},s.onload=function(){var e="Content-Length: "+s.responseText.length+"\r\nContent-Type: "+s.contentType,t={code:200,message:"success"},i={text:s.responseText};try{if("html"===a||/text\/html/i.test(s.contentType))i.html=s.responseText;else if("json"===a||"text"!==a&&/\/json/i.test(s.contentType))try{i.json=JSON.parse(s.responseText)}catch(e){t.code=500,t.message="parseerror"}else if("xml"===a||"text"!==a&&/\/xml/i.test(s.contentType)){var r=new ActiveXObject("Microsoft.XMLDOM");r.async=!1;try{r.loadXML(s.responseText)}catch(e){r=void 0}if(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)throw t.code=500,t.message="parseerror","Invalid XML: "+s.responseText;i.xml=r}}catch(e){throw e}finally{n(t.code,t.message,i,e)}},s.onprogress=function(){},s.onerror=function(){n(500,"error",{text:s.responseText})},o.data&&(i="string"===e.type(o.data)?o.data:e.param(o.data)),s.open(r.type,r.url),s.send(i)},abort:function(){s&&s.abort()}}}}),e}),define("base64",[],function(){!function(){function e(e){this.message=e}var t="undefined"!=typeof exports?exports:this,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var i,r,o=String(t),a=0,s=n,u="";o.charAt(0|a)||(s="=",a%1);u+=s.charAt(63&i>>8-a%1*8)){if((r=o.charCodeAt(a+=.75))>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");i=i<<8|r}return u}),t.atob||(t.atob=function(t){var i=String(t).replace(/=+$/,"");if(i.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,o,a=0,s=0,u="";o=i.charAt(s++);~o&&(r=a%4?64*r+o:o,a++%4)?u+=String.fromCharCode(255&r>>(-2*a&6)):0)o=n.indexOf(o);return u})}()}),define("polyfills",["lodash","jqueryajaxie9corsfix","base64"],function(e,t,n){"use strict";!function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var i=(new Date).getTime(),r=Math.max(0,16-(i-e)),o=window.setTimeout(function(){t(i+r)},r);return e=i+r,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(){function e(e,t){return this.slice(e,t)}function t(e,t){arguments.length<2&&(t=0);for(var n=0,i=e.length;n<i;++n,++t)this[t]=255&e[n]}function n(n){var i;if("number"==typeof n){i=new Array(n);for(var r=0;r<n;++r)i[r]=0}else i=n.slice(0);return i.subarray=e,i.buffer=i,i.byteLength=i.length,i.set=t,"object"==typeof n&&n.buffer&&(i.buffer=n.buffer),i}try{new Uint8Array(1);return}catch(e){}window.Uint8Array=n,window.Uint32Array=n,window.Int32Array=n}(),"undefined"==typeof console&&(window.console={log:function(){},warn:function(){},error:function(){},info:function(){},debug:function(){}}),Math.toRad=function(e){return e*(Math.PI/180)},Math.toDeg=function(e){return e*(180/Math.PI)},Math.format=function(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)},Math.hit=function(e,t,n,i,r,o,a){return a?e>=n-r/2&&e<=n-r/2+r&&t>=i-o/2&&t<=i-o/2+o:e>=n&&e<=n+r&&t>=i&&t<=i+o},Math.boxhit=function(e,t,n,i,r,o,a,s){return(e>=r&&e<=r+a||e+n>=r&&e+n<=r+a)&&(t>=o&&t<=o+s||t+i>=o&&t+i<=o+s)},Math.clamp=function(e,t,n){return e<t?t:e>n?n:e},Math.rotateCoord=function(e,t,n,i,r){var o=e-n,a=t-i;return e=Math.cos(r)*o+Math.sin(r)*a,t=-Math.sin(r)*o+Math.cos(r)*a,e+=n,t+=i,{x:e,y:t}},Math.pointInPoly=function(e,t,n){var i,r,o=!1,a=e.length;for(i=0,r=a-1;i<a;r=i++)e[i].y>n!=e[r].y>n&&t<(e[r].x-e[i].x)*(n-e[i].y)/(e[r].y-e[i].y)+e[i].x&&(o=!o);return o},Object.create||(Object.create=function(e,t){function n(){}if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object: "+e);if(null===e)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(void 0!==t)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");return n.prototype=e,new n}),!e.omitBy&&e.omit&&(e.omitBy=e.omit)}),function(e){"function"==typeof define&&define.amd?define("easing",["jquery"],function(t){return e(t)}):"object"==typeof module&&"object"==typeof module.exports?exports=e(require("jquery")):e(jQuery)}(function(e){function t(e){var t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375}void 0!==e.easing&&(e.easing.jswing=e.easing.swing);var n=Math.pow,i=Math.sqrt,r=Math.sin,o=Math.cos,a=Math.PI,s=1.70158,u=1.525*s,l=2*a/3,c=2*a/4.5;e.extend(e.easing,{def:"easeOutQuad",swing:function(t){return e.easing[e.easing.def](t)},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return 1-(1-e)*(1-e)},easeInOutQuad:function(e){return e<.5?2*e*e:1-n(-2*e+2,2)/2},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1-n(1-e,3)},easeInOutCubic:function(e){return e<.5?4*e*e*e:1-n(-2*e+2,3)/2},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1-n(1-e,4)},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-n(-2*e+2,4)/2},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1-n(1-e,5)},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1-n(-2*e+2,5)/2},easeInSine:function(e){return 1-o(e*a/2)},easeOutSine:function(e){return r(e*a/2)},easeInOutSine:function(e){return-(o(a*e)-1)/2},easeInExpo:function(e){return 0===e?0:n(2,10*e-10)},easeOutExpo:function(e){return 1===e?1:1-n(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:e<.5?n(2,20*e-10)/2:(2-n(2,-20*e+10))/2},easeInCirc:function(e){return 1-i(1-n(e,2))},easeOutCirc:function(e){return i(1-n(e-1,2))},easeInOutCirc:function(e){return e<.5?(1-i(1-n(2*e,2)))/2:(i(1-n(-2*e+2,2))+1)/2},easeInElastic:function(e){return 0===e?0:1===e?1:-n(2,10*e-10)*r((10*e-10.75)*l)},easeOutElastic:function(e){return 0===e?0:1===e?1:n(2,-10*e)*r((10*e-.75)*l)+1},easeInOutElastic:function(e){return 0===e?0:1===e?1:e<.5?-n(2,20*e-10)*r((20*e-11.125)*c)/2:n(2,-20*e+10)*r((20*e-11.125)*c)/2+1},easeInBack:function(e){return 2.70158*e*e*e-s*e*e},easeOutBack:function(e){return 1+2.70158*n(e-1,3)+s*n(e-1,2)},easeInOutBack:function(e){return e<.5?n(2*e,2)*(7.189819*e-u)/2:(n(2*e-2,2)*((u+1)*(2*e-2)+u)+2)/2},easeInBounce:function(e){return 1-t(1-e)},easeOutBounce:t,easeInOutBounce:function(e){return e<.5?(1-t(1-2*e))/2:(1+t(2*e-1))/2}})}),define("browser",[],function(){"use strict";return{isMobile:function(e){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}(navigator.userAgent||navigator.vendor||window.opera)}}),function(e){var t;if("function"==typeof define&&define.amd&&(define("cookie",e),t=!0),"object"==typeof exports&&(module.exports=e(),t=!0),!t){var n=window.Cookies,i=window.Cookies=e();i.noConflict=function(){return window.Cookies=n,i}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function n(i){function r(){}function o(t,n,o){if("undefined"!=typeof document){o=e({path:"/"},r.defaults,o),"number"==typeof o.expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=i.write?i.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var u in o)o[u]&&(s+="; "+u,!0!==o[u]&&(s+="="+o[u].split(";")[0]));return document.cookie=t+"="+n+s}}function a(e,n){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),u=s.slice(1).join("=");n||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var l=t(s[0]);if(u=(i.read||i)(u,l)||t(u),n)try{u=JSON.parse(u)}catch(e){}if(r[l]=u,e===l)break}catch(e){}}return e?r[e]:r}}return r.set=o,r.get=function(e){return a(e,!1)},r.getJSON=function(e){return a(e,!0)},r.remove=function(t,n){o(t,"",e(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}return n(function(){})}),define("libs/device/BrowserDetector",["jquery","lodash"],function(e,t){"use strict";var n="Microsoft Edge",i={Mozilla:"mozilla",Webkit:"webkit",Trident:"trident"};return function(){return{browser:function(e){var r,o={name:"unknown",version:"unknown",engine:null,isMsie:function(){return"MSIE"===this.name},isEdge:function(){return n===this.name},msieVersion:function(){return!!this.isMsie()&&Math.floor(this.version)},isWebkit:function(){return i.Webkit===this.engine},isMozilla:function(){return i.Mozilla===this.engine},isTrident:function(){return i.Trident===this.engine}};return(r=e.match(/(PhantomJS)\/([0-9.]*)/))?(o.name=r[1],o.version=r[2],o.engine=i.Webkit):(r=e.match(/(Edge)\/([0-9.]*)/))?(o.name=n,o.version=r[2],o.engine=i.Trident):(r=e.match(/(Firefox)\/([0-9.]*)/))?(o.name=r[1],o.version=r[2],o.engine=i.Mozilla):(r=e.match(/(Chrome|CriOS)\/([0-9.]*)/))?(o.name=r[1],o.version=r[2],o.engine=i.Webkit):/Safari/.test(e)?(r=e.match(/(Version)\/([0-9.]*)/))&&(o.name=(/Mobile/.test(e)?"Mobile ":"")+"Safari",o.version=r[2],o.engine=i.Webkit):(r=e.match(/(Silk)\/([0-9.]*)/))?(o.name=r[1],o.version=r[2],o.engine=i.Webkit):(r=e.match(/(MSIE) ([0-9]+)/))?(o.name=r[1],o.version=r[2],o.engine=i.Trident):(r=e.match(/Trident\/[0-9.]+;.*rv:([0-9.]*)/))&&(o.name="MSIE",o.version=r[1],o.engine=i.Trident),t.isNull(o.engine)&&e.match(/(webkit)[ \/]([\w.]+)/i)&&(o.engine=i.Webkit),o}}}()}),define("screenSize",["lodash"],function(e){"use strict";var t={setDimensions:function(e,t){window.cerosScreenDimensions={width:e,height:t}},getDimensions:function(){return window.cerosScreenDimensions}};return window.cerosScreenDimensions||t.setDimensions(window.screen.width,window.screen.height),t}),define("device",["jquery","lodash","modernizr","browser","cookie","libs/device/BrowserDetector","screenSize"],function(e,t,n,i,r,o,a){"use strict";return function(){var e=function(){return n.touch},s=function(){var e=a.getDimensions();return e.width*e.height<5e5},u=function(){return window.innerWidth*window.innerHeight<5e5},l=function(){return i.isMobile},c=function(){return!l()},d=function(){return l()&&s()},h=function(){return w(navigator.userAgent)||l()&&!s()},f=function(){return d()?"smartphone":h()?"tablet":c()?"desktop":"other"},p=function(){var e=1;return void 0!==window.devicePixelRatio&&(e=window.devicePixelRatio),e>=2},g=function(){return v().engine},m=function(){return n.canvas&&n.video},v=t.once(function(){return o.browser(navigator.userAgent)}),y=function(){return/(google web preview|google search console|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp)/i.test(window.navigator.userAgent)},b=function(){return window.navigator.maxTouchPoints||0},w=function(e){e=e||navigator.userAgent;var t=e.match(/(Macintosh; Intel Mac)(.*Version\/(\d+\.\d+\.\d+)\sSafari)/i);return!!(t&&b()>1)&&t},_=function(e){var t,n,i;/Windows/i.test(e)?(t=e.match(/Phone( (OS )?([\d.]+))?/))?(n="Windows Mobile",i=t[3]):(t=e.match(/Windows NT\s([0-9.]+)/))?(n="Windows",i=t[1]):n="Windows":(t=e.match(/(iPad|iPod|iPhone)(.*OS ([\d_]+))?/))?(n="iOS",t[3]&&(i=t[3].replace(/_/g,"."))):(t=w(e))?(n="iOS",i=t[3]):(t=e.match(/(Android ?([\d.]+)?)/))?(n="Android",i=t[2]):(t=e.match(/(BlackBerry|PlayBook|BB10)(.*Version\/(\d+\.\d+\.\d+))?/i))?(n="BlackBerry",i=t[3]):(t=e.match(/\(Macintosh(;\D*([\d_.]+)[);])?/))?(n="Mac OS X",t[2]&&(i=t[2].replace(/_/g,"."))):(t=e.match(/Linux\s([0-9._a-z]+)?/))?(n="Linux",i=t[1]):(t=e.match(/CrOS ?(\S+)?/))&&(n="Chrome OS",i=t[1]);var r={};return n&&(r.name=n),i&&(r.version=i),r},E=_(navigator.userAgent),S=function(){return!0===window.navigator.standalone},T=function(){return m()?"html5":"html4"},P=function(){return window.orientation%180==0?"portrait":"landscape"},A=u()?50:200,I=function(){return A},x=t.once(function(){r.set("testcookie",1);var e=r.get("testcookie");return e&&r.remove("testcookie"),e}),O=function(){return t.isNumber(window.devicePixelRatio)?window.devicePixelRatio:1},C=v().isMsie(),R=function(){return v().msieVersion()},L=v().isEdge(),k=v().isWebkit(),M=v().isMozilla(),D=v().isTrident(),N=function(){return"landscape"===P()},F=function(){return"portrait"===P()},V=function(){return"onorientationchange"in window},U=function(){return"Mac OS X"===E.name},B=function(){return"Windows"===E.name},j=function(){return"iOS"===E.name},G=function(){return"Android"===E.name},H=function(){return j()&&v().version.match(/^7\..*/)},W=function(e,t){if(!e)return!1;var n=e.split("."),i=Number(n[0]);return!isNaN(i)&&i<t},q=function(e,t){if(!e)return!1;var n=e.split("."),i=Number(n[0]);return!isNaN(i)&&i>=t},$=function(e,t){if(!e)return!1;var n=e.split("."),i=Number(n[0]),r=Number(n[1]),o=t.split("."),a=Number(o[0]),s=Number(o[1]);return!isNaN(i)&&!isNaN(a)&&(isNaN(r)&&(r=0),isNaN(s)&&(s=0),i!==a?i<a:r<s)},Y=function(e){return!!j()&&W(E.version,e)},z=function(e){return!!j()&&q(E.version,e)},K=function(e){return!!B()&&$(E.version,e)},X=function(e){return!!ce()&&W(v().version,e)},Z=function(e){return!!ce()&&q(v().version,e)},Q=function(e){return!!de()&&q(v().version,e)},J=function(e){return!!te()&&W(v().version,e)},ee=function(){return l()&&"Mobile Safari"===v().name},te=function(){return!l()&&"Safari"===v().name},ne=function(){return"PhantomJS"===v().name},ie=function(){return/iPhone/i.test(navigator.userAgent)},re=function(){return/iPad/i.test(navigator.userAgent)||!!w(navigator.userAgent)},oe=function(){return ie()&&!window.navigator.standalone&&ee()},ae=function(){return oe()&&H()},se=function(){return re()&&!window.navigator.standalone&&H()},ue=function(){return!1!==R()&&R()<=9},le=function(){return 11===R()},ce=function(){return"Chrome"===v().name},de=function(){return v().isMozilla()},he=function(e){var t=a.getDimensions();if(!pe()&&e<t.width){if(se())return-20;if(ae())return-65;if(oe())return 60}return 0},fe=function(e,t){var n=a.getDimensions();return oe()&&e===n.height&&t>=n.width},pe=function(){return top!=window};return{touch:e,mobile:l,desktop:c,smartPhone:d,tablet:h,retina:p,renderingEngine:g,msie:C,edge:L,msieVersion:R,webkit:k,mozilla:M,trident:D,html5:m,isBot:y,browser:v,os:E,parseOS:_,standalone:S,smallWindow:u,deviceType:f,playerType:T,orientation:P,portrait:F,landscape:N,supportsOrientationChange:V,getSlackHeight:he,getRubberBandLimit:I,cookies:x,pixelRatio:O,isIphoneFullscreenMobileSafari:fe,isIframe:pe,isMac:U,isWindows:B,isIos:j,isIosLessThan:Y,isIosGreaterThanOrEqualTo:z,isBrowserChromeLessThan:X,isBrowserChromeGreaterThanOrEqualTo:Z,isBrowserFirefoxGreaterThanOrEqualTo:Q,isDesktopSafariLessThan:J,isWindowsLessThan:K,isAndroid:G,isIphone:ie,isIpad:re,isPhantomJS:ne,isIE9OrEarlier:ue,isIE11:le,isBrowserChrome:ce,isBrowserFirefox:de,isDesktopSafari:te,isMobileSafari:ee,isIpadPretendingToBeDesktop:w,DEVICE_TYPE_SMARTPHONE:"smartphone",DEVICE_TYPE_TABLET:"tablet",DEVICE_TYPE_DESKTOP:"desktop",DEVICE_TYPE_OTHER:"other"}}()}),define("log",["lodash","device"],function(e,t){"use strict";var n=function(){for(var e="",t=0;t<arguments.length;t++)e+=arguments[t]+" ";return e},i={debug:!1,info:!1,warn:!1,error:!1},r=!1,o=!1,a={debug:function(){if(i.debug){var r=n.apply(null,arguments);window.Rollbar&&window.Rollbar.debug.apply(window.Rollbar,arguments),t.msie?e.isFunction(console.log)&&console.log(r):console.debug.apply(console,arguments)}},info:function(){if(i.info){var r=n.apply(null,arguments);window.Rollbar&&window.Rollbar.info.apply(window.Rollbar,arguments),t.msie?e.isFunction(console.info)&&console.info(r):console.info.apply(console,arguments)}},forceInfo:function(){var i=n.apply(null,arguments);window.Rollbar&&window.Rollbar.info.apply(window.Rollbar,arguments),t.msie?e.isFunction(console.info)&&console.info(i):console.info.apply(console,arguments)},devWarn:function(){return r?a.warn.apply(this,arguments):a.info.apply(this,arguments)},warn:function(){if(i.warn){var r=n.apply(null,arguments);window.Rollbar&&window.Rollbar.warn.apply(window.Rollbar,arguments),t.msie?e.isFunction(console.warn)&&console.warn(r):console.warn.apply(console,arguments)}},error:function(){if(i.error){var r=n.apply(null,arguments);window.Rollbar&&window.Rollbar.error.apply(window.Rollbar,arguments),t.msie?e.isFunction(console.error)&&console.error(r):console.error.apply(console,arguments)}},init:function(t){i=e.defaults(t.modes||{},i),r=t.emitDevWarnings,o=e.reduce(i,function(e,t,n){return e||t},o)},isEnabled:function(t){return e.isUndefined(t)?o:i[t]}};return a.d=a.debug,a.i=a.info,a.w=a.warn,a.e=a.error,a.fi=a.forceInfo,a}),define("cssHooksTransform",["log","jquery","lodash","device"],function(e,t,n,i){"use strict";var r="transform",o=r.charAt(0).toUpperCase()+r.slice(1),a="Float32Array"in window,s={transformToMatrix:function(e){var i,r,o,s=e.split(")"),u=[],l=s.length-1,c=a?new Float32Array(6):[],d=a?new Float32Array(6):[],h=a?new Float32Array(6):[1,0,0,1,0,0];c[0]=c[3]=h[0]=h[3]=1,c[1]=c[2]=c[4]=c[5]=0;for(var f=0;f<l;++f){switch(i=s[f].split("("),r=t.trim(i[0]),o=i[1],d[0]=d[3]=1,d[1]=d[2]=d[4]=d[5]=0,r){case"translateX":d[4]=parseInt(o,10);break;case"translateY":d[5]=parseInt(o,10);break;case"translate":o=o.split(","),d[4]=parseInt(o[0],10),d[5]=parseInt(o[1]||0,10);break;case"rotate":o=this.toRadian(o),d[0]=Math.cos(o),d[1]=Math.sin(o),d[2]=-Math.sin(o),d[3]=Math.cos(o);break;case"scaleX":d[0]=+o;break;case"scaleY":d[3]=o;break;case"scale":o=o.split(","),d[0]=o[0],d[3]=o.length>1?o[1]:o[0];break;case"skewX":d[2]=Math.tan(this.toRadian(o));break;case"skewY":d[1]=Math.tan(this.toRadian(o));break;default:continue}u.push(r),h[0]=c[0]*d[0]+c[2]*d[1],h[1]=c[1]*d[0]+c[3]*d[1],h[2]=c[0]*d[2]+c[2]*d[3],h[3]=c[1]*d[2]+c[3]*d[3],h[4]=c[0]*d[4]+c[2]*d[5]+c[4],h[5]=c[1]*d[4]+c[3]*d[5]+c[5],c=[h[0],h[1],h[2],h[3],h[4],h[5]]}return!(!n.isEmpty(e)&&n.isEmpty(u))&&h},buildTransformFunctions:function(e,i){var r,o,a,u={start:[],end:[]};if("none"==e&&(e=""),"none"==i&&(i=""),!e&&!i)return u;e&&(e=e.split(")"),r=e.length),i&&(i=i.split(")"),r=i.length),r-=1;for(var l=0;l<r;++l){e[l]&&(o=e[l].split("(")),i[l]&&(a=i[l].split("("));var c=t.trim(o[0]),d=t.trim(a[0]);s.isUnsupportedTransform(c)||s.isUnsupportedTransform(d)||(u.start=n.union(u.start,this.parseTransformFunction(c,o[1])),u.end=n.union(u.end,this.parseTransformFunction(d,a[1])))}return u},isUnsupportedTransform:function(e){
return n.indexOf(["perspective","rotateX","rotateY","rotateZ","rotate3d","scale3d","scaleZ","translateZ","translate3d"],e)>-1},parseTransformFunction:function(e,t){var n=e.indexOf("scale")>-1?1:0,i=e.replace(/e[XY]/,"e"),r=e.indexOf("scale")>-1?"":"px";switch(e){case"translateY":case"scaleY":t=[n,t?parseFloat(t):n];break;case"translateX":case"translate":t?(t=t.split(","),t=[parseFloat(t[0]),parseFloat(t.length>1?t[1]:n)]):t=[n,n];break;case"scaleX":case"scale":if(t){t=t.split(",");var o="scale"==e?t[0]:n;t=[parseFloat(t[0]),parseFloat(t.length>1?t[1]:o)]}else t=[n,n];break;case"skewX":case"skewY":case"rotate":r=~t.indexOf("deg")?"deg":~t.indexOf("grad")?"grad":"rad",t=t?parseFloat(t):0}return[[i,t,r]]},toRadian:function(e){return~e.indexOf("deg")?parseInt(e,10)*(2*Math.PI/360):~e.indexOf("grad")?parseInt(e,10)*(Math.PI/200):parseFloat(e)}};if(i.webkit||i.mozilla){var u=i.webkit?"Webkit":"Moz";t.cssNumber[r]=!0,t.cssHooks[r]={get:function(e){return t.css(e,u+o)},set:function(e,t){e.style[u+o]=t}}}return s}),define("crypto",[],function(){function e(e){for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",r=e.length,o=0;o<r;o+=3)for(var a=e.charCodeAt(o)<<16|(o+1<r?e.charCodeAt(o+1)<<8:0)|(o+2<r?e.charCodeAt(o+2):0),s=0;s<4;s++)8*o+6*s>8*e.length?i+=t:i+=n.charAt(a>>>6*(3-s)&63);return i}var t="";return{b64_encode:e}}),define("cssHooksGradients",["log","jquery","lodash","device","crypto"],function(e,t,n,i,r){"use strict";var o="backgroundImage",a=document.createElement("div"),s=a.style,u=/^(.*?)(:?linear-gradient)(\()([0-9]+)deg,([^,]+) ([0-9]+)%,([^,]+) ([0-9]+)%(\))(.*?)$/i,l=/(^|\s)linear-gradient/;if(s.cssText="background-image: linear-gradient(red, blue);",t.support.linearGradient=!!l.test(s.backgroundImage)&&"linear-gradient",a=s=null,!t.support.linearGradient){t.cssNumber[o]=!0;var c=function(e,t,n,r,o,a,s){var u="";return i.webkit?u="-webkit-":i.mozilla&&(u="-moz-"),n=90-parseInt(n,10),u+"linear-gradient("+n+"deg,"+r+" "+o+"%,"+a+" "+s+"%)"};t.cssHooks[o]={set:function(e,t){var i=u.exec(t);if(n.isEmpty(i))e.style[o]=t;else{var r=(i[0],i[4]),a=i[5],s=i[6],l=i[7],d=i[8];e.style[o]=c(0,0,r,a,s,l,d)}}}}}),function(e){var t="object"==typeof self&&self.self==self&&self||"object"==typeof global&&global.global==global&&global;if("function"==typeof define&&define.amd)define("backbone",["lodash","jquery","exports"],function(n,i,r){t.Backbone=e(t,r,n,i)});else if("undefined"!=typeof exports){var n,i=require("lodash");try{n=require("jquery")}catch(e){}e(t,exports,i,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(e,t,n,i){var r=e.Backbone,o=Array.prototype.slice;t.VERSION="1.2.3",t.$=i,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=function(e,t,i){switch(e){case 1:return function(){return n[t](this[i])};case 2:return function(e){return n[t](this[i],e)};case 3:return function(e,r){return n[t](this[i],u(e,this),r)};case 4:return function(e,r,o){return n[t](this[i],u(e,this),r,o)};default:return function(){var e=o.call(arguments);return e.unshift(this[i]),n[t].apply(n,e)}}},s=function(e,t,i){n.each(t,function(t,r){n[r]&&(e.prototype[r]=a(t,r,i))})},u=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?l(e):n.isString(e)?function(t){return t.get(e)}:e},l=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}},c=t.Events={},d=/\s+/,h=function(e,t,i,r,o){var a,s=0;if(i&&"object"==typeof i){void 0!==r&&"context"in o&&void 0===o.context&&(o.context=r);for(a=n.keys(i);s<a.length;s++)t=h(e,t,a[s],i[a[s]],o)}else if(i&&d.test(i))for(a=i.split(d);s<a.length;s++)t=e(t,a[s],r,o);else t=e(t,i,r,o);return t};c.on=function(e,t,n){return f(this,e,t,n)};var f=function(e,t,n,i,r){if(e._events=h(p,e._events||{},t,n,{context:i,ctx:e,listening:r}),r){(e._listeners||(e._listeners={}))[r.id]=r}return e};c.listenTo=function(e,t,i){if(!e)return this;var r=e._listenId||(e._listenId=n.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),a=o[r];if(!a){var s=this._listenId||(this._listenId=n.uniqueId("l"));a=o[r]={obj:e,objId:r,id:s,listeningTo:o,count:0}}return f(e,t,i,this,a),this};var p=function(e,t,n,i){if(n){var r=e[t]||(e[t]=[]),o=i.context,a=i.ctx,s=i.listening;s&&s.count++,r.push({callback:n,context:o,ctx:o||a,listening:s})}return e};c.off=function(e,t,n){return this._events?(this._events=h(g,this._events,e,t,{context:n,listeners:this._listeners}),this):this},c.stopListening=function(e,t,i){var r=this._listeningTo;if(!r)return this;for(var o=e?[e._listenId]:n.keys(r),a=0;a<o.length;a++){var s=r[o[a]];if(!s)break;s.obj.off(t,i,this)}return n.isEmpty(r)&&(this._listeningTo=void 0),this};var g=function(e,t,i,r){if(e){var o,a=0,s=r.context,u=r.listeners;if(t||i||s){for(var l=t?[t]:n.keys(e);a<l.length;a++){t=l[a];var c=e[t];if(!c)break;for(var d=[],h=0;h<c.length;h++){var f=c[h];i&&i!==f.callback&&i!==f.callback._callback||s&&s!==f.context?d.push(f):(o=f.listening)&&0==--o.count&&(delete u[o.id],delete o.listeningTo[o.objId])}d.length?e[t]=d:delete e[t]}return n.size(e)?e:void 0}for(var p=n.keys(u);a<p.length;a++)o=u[p[a]],delete u[o.id],delete o.listeningTo[o.objId]}};c.once=function(e,t,i){var r=h(m,{},e,t,n.bind(this.off,this));return this.on(r,void 0,i)},c.listenToOnce=function(e,t,i){var r=h(m,{},t,i,n.bind(this.stopListening,this,e));return this.listenTo(e,r)};var m=function(e,t,i,r){if(i){var o=e[t]=n.once(function(){r(t,o),i.apply(this,arguments)});o._callback=i}return e};c.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),n=Array(t),i=0;i<t;i++)n[i]=arguments[i+1];return h(v,this._events,e,void 0,n),this};var v=function(e,t,n,i){if(e){var r=e[t],o=e.all;r&&o&&(o=o.slice()),r&&y(r,i),o&&y(o,[t].concat(i))}return e},y=function(e,t){var n,i=-1,r=e.length,o=t[0],a=t[1],s=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t);return}};c.bind=c.on,c.unbind=c.off,n.extend(t,c);var b=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(b.prototype,c,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,i){if(null==e)return this;var r;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i||(i={}),!this._validate(r,i))return!1;var o=i.unset,a=i.silent,s=[],u=this._changing;this._changing=!0,u||(this._previousAttributes=n.clone(this.attributes),this.changed={});var l=this.attributes,c=this.changed,d=this._previousAttributes;for(var h in r)t=r[h],n.isEqual(l[h],t)||s.push(h),n.isEqual(d[h],t)?delete c[h]:c[h]=t,o?delete l[h]:l[h]=t;if(this.id=this.get(this.idAttribute),!a){s.length&&(this._pending=i);for(var f=0;f<s.length;f++)this.trigger("change:"+s[f],this,l[s[f]],i)}if(u)return this;if(!a)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&n.clone(this.changed);var t=this._changing?this._previousAttributes:this.attributes,i={};for(var r in e){var o=e[r];n.isEqual(t[r],o)||(i[r]=o)}return!!n.size(i)&&i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=n.extend({parse:!0},e);var t=this,i=e.success;return e.success=function(n){var r=e.parse?t.parse(n,e):n;if(!t.set(r,e))return!1;i&&i.call(e.context,t,n,e),t.trigger("sync",t,n,e)},U(this,e),this.sync("read",this,e)},save:function(e,t,i){var r;null==e||"object"==typeof e?(r=e,i=t):(r={})[e]=t,i=n.extend({validate:!0,parse:!0},i);var o=i.wait;if(r&&!o){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;var a=this,s=i.success,u=this.attributes;i.success=function(e){a.attributes=u;var t=i.parse?a.parse(e,i):e;if(o&&(t=n.extend({},r,t)),t&&!a.set(t,i))return!1;s&&s.call(i.context,a,e,i),a.trigger("sync",a,e,i)},U(this,i),r&&o&&(this.attributes=n.extend({},u,r));var l=this.isNew()?"create":i.patch?"patch":"update";"patch"!==l||i.attrs||(i.attrs=r);var c=this.sync(l,this,i);return this.attributes=u,c},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,r=e.wait,o=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){r&&o(),i&&i.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var a=!1;return this.isNew()?n.defer(e.success):(U(this,e),a=this.sync("delete",this,e)),r||o(),a},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||V();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.defaults({validate:!0},e))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return!i||(this.trigger("invalid",this,i,n.extend(t,{validationError:i})),!1)}}),s(b,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var w=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},_={add:!0,remove:!0,merge:!0},E={add:!0,remove:!1},S=function(e,t,n){n=Math.min(Math.max(n,0),e.length);for(var i=Array(e.length-n),r=t.length,o=0;o<i.length;o++)i[o]=e[o+n];for(o=0;o<r;o++)e[o+n]=t[o];for(o=0;o<i.length;o++)e[o+r+n]=i[o]};n.extend(w.prototype,c,{model:b,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,E))},remove:function(e,t){t=n.extend({},t);var i=!n.isArray(e);e=i?[e]:n.clone(e);var r=this._removeModels(e,t);return!t.silent&&r&&this.trigger("update",this,t),i?r[0]:r},set:function(e,t){if(null!=e){t=n.defaults({},t,_),t.parse&&!this._isModel(e)&&(e=this.parse(e,t));var i=!n.isArray(e);e=i?[e]:e.slice();var r=t.at;null!=r&&(r=+r),r<0&&(r+=this.length+1);for(var o,a=[],s=[],u=[],l={},c=t.add,d=t.merge,h=t.remove,f=!1,p=this.comparator&&null==r&&!1!==t.sort,g=n.isString(this.comparator)?this.comparator:null,m=0;m<e.length;m++){o=e[m];var v=this.get(o);if(v){if(d&&o!==v){var y=this._isModel(o)?o.attributes:o;t.parse&&(y=v.parse(y,t)),v.set(y,t),p&&!f&&(f=v.hasChanged(g))}l[v.cid]||(l[v.cid]=!0,a.push(v)),e[m]=v}else c&&(o=e[m]=this._prepareModel(o,t))&&(s.push(o),this._addReference(o,t),l[o.cid]=!0,a.push(o))}if(h){for(m=0;m<this.length;m++)o=this.models[m],l[o.cid]||u.push(o);u.length&&this._removeModels(u,t)}var b=!1,w=!p&&c&&h;if(a.length&&w?(b=this.length!=a.length||n.some(this.models,function(e,t){return e!==a[t]}),this.models.length=0,S(this.models,a,0),this.length=this.models.length):s.length&&(p&&(f=!0),S(this.models,s,null==r?this.length:r),this.length=this.models.length),f&&this.sort({silent:!0}),!t.silent){for(m=0;m<s.length;m++)null!=r&&(t.index=r+m),o=s[m],o.trigger("add",o,this,t);(f||b)&&this.trigger("sort",this,t),(s.length||u.length)&&this.trigger("update",this,t)}return i?e[0]:e}},reset:function(e,t){t=t?n.clone(t):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return o.apply(this.models,arguments)},get:function(e){if(null!=e){var t=this.modelId(this._isModel(e)?e.attributes:e);return this._byId[e]||this._byId[t]||this._byId[e.cid]}},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var i=t.length;return n.isFunction(t)&&(t=n.bind(t,this)),1===i||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=n.extend({parse:!0},e);var t=e.success,i=this;return e.success=function(n){var r=e.reset?"reset":"set";i[r](n,e),t&&t.call(e.context,i,n,e),i.trigger("sync",i,n,e)},U(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};var i=t.wait;if(!(e=this._prepareModel(e,t)))return!1;i||this.add(e,t);var r=this,o=t.success;return t.success=function(e,t,n){i&&r.add(e,n),o&&o.call(n.context,e,t,n)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeModels:function(e,t){for(var n=[],i=0;i<e.length;i++){var r=this.get(e[i]);if(r){var o=this.indexOf(r);this.models.splice(o,1),this.length--,t.silent||(t.index=o,r.trigger("remove",r,this,t)),n.push(r),this._removeReference(r,t)}}return!!n.length&&n},_isModel:function(e){return e instanceof b},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes);null!=n&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes);null!=n&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){if("add"!==e&&"remove"!==e||n===this){if("destroy"===e&&this.remove(t,i),"change"===e){var r=this.modelId(t._previousAttributes),o=this.modelId(t.attributes);r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=t))}this.trigger.apply(this,arguments)}}}),s(w,{forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3},"models");var T=t.View=function(e){this.cid=n.uniqueId("view"),n.extend(this,n.pick(e,A)),this._ensureElement(),this.initialize.apply(this,arguments)},P=/^(\S+)\s*(.*)$/,A=["model","collection","el","id","attributes","className","tagName","events"];n.extend(T.prototype,c,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=n.result(this,"events")),!e)return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[i]),i){var r=t.match(P);this.delegate(r[1],r[2],n.bind(i,this))}}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e.class=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,i,r){var o=I[e];n.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:o,dataType:"json"};if(r.url||(a.url=n.result(i,"url")||V()),null!=r.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",a.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",r.emulateJSON&&(a.data._method=o);var s=r.beforeSend;r.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",o),s)return s.apply(this,arguments)}}"GET"===a.type||r.emulateJSON||(a.processData=!1);var u=r.error;r.error=function(e,t,n){r.textStatus=t,r.errorThrown=n,u&&u.call(r.context,e,t,n)};var l=r.xhr=t.ajax(n.extend(a,r));return i.trigger("request",i,l,r),l};var I={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var x=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},O=/\((.*?)\)/g,C=/(\(\?)?:\w+/g,R=/\*\w+/g,L=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(x.prototype,c,{initialize:function(){},route:function(e,i,r){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return t.history.route(e,function(n){var a=o._extractParameters(e,n);!1!==o.execute(r,a,i)&&(o.trigger.apply(o,["route:"+i].concat(a)),o.trigger("route",i,a),t.history.trigger("route",o,i,a))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(L,"\\$&").replace(O,"(?:$1)?").replace(C,function(e,t){return t?e:"([^/?]+)"}).replace(R,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null})}});var k=t.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,N=/#.*$/;k.started=!1,n.extend(k.prototype,c,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(M,"")},start:function(e){if(k.started)throw new Error("Backbone.history has already been started");if(k.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(D,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,r=i.insertBefore(this.iframe,i.firstChild).contentWindow;r.document.open(),r.document.close(),r.location.hash="#"+this.fragment}var o=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),k.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),n.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(e,t){if(!k.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");var n=this.root;""!==e&&"?"!==e.charAt(0)||(n=n.slice(0,-1)||"/");var i=n+e;if(e=this.decodeFragment(e.replace(N,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;t.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new k;var F=function(e,t){var i,r=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,t);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};b.extend=w.extend=x.extend=T.extend=k.extend=F;var V=function(){throw new Error('A "url" property or function must be specified')},U=function(e,t){var n=t.error;t.error=function(i){n&&n.call(t.context,e,i,t),e.trigger("error",e,i,t)}};return t}),define("globals",["lodash"],function(e){"use strict";var t=function(){return{absorb:function(n){e.each(n,function(e,n){t[n]=e})},purge:function(e){delete t[e]}}}();return window.cerosContext&&t.absorb(window.cerosContext),t}),define("domReady",[],function(){"use strict";function e(e){var t;for(t=0;t<e.length;t+=1)e[t](l)}function t(){var t=c;u&&t.length&&(c=[],e(t))}function n(){u||(u=!0,a&&clearInterval(a),t())}function i(e){return u?e(l):c.push(e),i}var r,o,a,s="undefined"!=typeof window&&window.document,u=!s,l=s?document:null,c=[];if(s){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),o=document.createElement("div");try{r=null===window.frameElement}catch(e){}o.doScroll&&r&&window.external&&(a=setInterval(function(){try{o.doScroll(),n()}catch(e){}},30))}"complete"===document.readyState&&n()}return i.version="2.0.1",i.load=function(e,t,n,r){r.isBuild?n(null):i(n)},i}),define("playerApi",["log","lodash","jquery"],function(e,t,n){"use strict";var i={},r=[],o={bindToIframe:function(e){return new c(e)},on:function(n,o){return t.isFunction(o)?("*"===n?(r.push(o),t.each(i,function(e){e.push(o)})):(t.has(i,n)||(i[n]=r.slice()),i[n].push(o)),this):void e.warn("handler is not a function")},unbindAll:function(){i={},r=[]},handleRequest:function(n,r){if(!t.has(i,n.name))return void e.warn("No handler for "+n.name);var o=i[n.name].slice(),a={},s=function(){r(a)},u=function(t){e.warn("Error:",t),a={error:"Unable to process request due to an error"},s()},l=function(){try{var e=o.shift();if(!e)return void s();var i=e(n,a);if(i&&t.isFunction(i.done)&&t.isFunction(i.fail)&&t.isFunction(i.always)){var r=setTimeout(function(){u(new Error("handler timed out"))},1e4);i.done(function(){l()}).fail(function(){s()}).always(function(){clearTimeout(r)})}else!1===i?s():l()}catch(e){u(e)}};l()}},a=function(e){if(t.isUndefined(e.client))throw new Error("No client object given");if(t.isUndefined(e.name))throw new Error("No name given");this.name=e.name,this.client=e.client,this.params=e.params||{}},s=[],u=!1,l=function(){if(!u){if(u=!0,t.isUndefined(window.postMessage))return void e.warn("This browser does not support inter-frame communication");e.debug("listening for iframe messages"),n(window).on("message",function(n){var i=n.originalEvent.source,r=null;if(t.each(s,function(e){i===e.getWindow()&&(r=e)}),r&&t.isString(n.originalEvent.data)){var u;try{u=JSON.parse(n.originalEvent.data)}catch(t){return void e.warn("Could not parse data: ["+n.originalEvent.data+"]")}if(!u.name)return void e.warn('Data has no "name" property');if(0!==u.name.indexOf("ceros.sdk.player")){var l=u.uuid,c=function(e){var t=JSON.stringify({uuid:l,response:e});i.postMessage(t,"*")},d=new a({name:u.name,params:u.params,client:{type:"iframe",sdkVersion:u.version}});o.handleRequest(d,c)}}})}},c=function(e){s.push(this),this.iframe=e,l()};return c.prototype={getWindow:function(){return this.iframe.contentWindow}},o}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("whatInput",[],t):"object"==typeof exports?exports.whatInput=t():e.whatInput=t()}(this,function(){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}return n={},e.m=t=[function(e,t){"use strict";e.exports=function(){if("undefined"==typeof document||"undefined"==typeof window)return{ask:function(){return"initial"},element:function(){return null},ignoreKeys:function(){},specificKeys:function(){},registerOnChange:function(){},unRegisterOnChange:function(){}};var e=document.documentElement,t=null,n="initial",i=n,r=Date.now(),o="false",a=["button","input","select","textarea"],s=[],u=[16,17,18,91,93],l=[],c={keydown:"keyboard",keyup:"keyboard",mousedown:"mouse",mousemove:"mouse",MSPointerDown:"pointer",MSPointerMove:"pointer",pointerdown:"pointer",pointermove:"pointer",touchstart:"touch",touchend:"touch"},d=!1,h={x:null,y:null},f={2:"touch",3:"touch",4:"mouse"},p=!1;try{var g=Object.defineProperty({},"passive",{get:function(){p=!0}});window.addEventListener("test",null,g)}catch(g){}var m=function(){if(o=!(e.getAttribute("data-whatpersist")||"false"===document.body.getAttribute("data-whatpersist")))try{window.sessionStorage.getItem("what-input")&&(n=window.sessionStorage.getItem("what-input")),window.sessionStorage.getItem("what-intent")&&(i=window.sessionStorage.getItem("what-intent"))}catch(e){}y("input"),y("intent")},v=function(e){var t=e.which,r=c[e.type];"pointer"===r&&(r=S(e));var o=!l.length&&-1===u.indexOf(t),s=l.length&&-1!==l.indexOf(t),d="keyboard"===r&&t&&(o||s)||"mouse"===r||"touch"===r;if(T(r)&&(d=!1),d&&n!==r&&(E("input",n=r),y("input")),d&&i!==r){var h=document.activeElement;h&&h.nodeName&&(-1===a.indexOf(h.nodeName.toLowerCase())||"button"===h.nodeName.toLowerCase()&&!x(h,"form"))&&(E("intent",i=r),y("intent"))}},y=function(t){e.setAttribute("data-what"+t,"input"===t?n:i),A(t)},b=function(e){var t=c[e.type];"pointer"===t&&(t=S(e)),I(e),(!d&&!T(t)||d&&"wheel"===e.type||"mousewheel"===e.type||"DOMMouseScroll"===e.type)&&i!==t&&(E("intent",i=t),y("intent"))},w=function(n){n.target.nodeName?(t=n.target.nodeName.toLowerCase(),e.setAttribute("data-whatelement",t),n.target.classList&&n.target.classList.length&&e.setAttribute("data-whatclasses",n.target.classList.toString().replace(" ",","))):_()},_=function(){t=null,e.removeAttribute("data-whatelement"),e.removeAttribute("data-whatclasses")},E=function(e,t){if(o)try{window.sessionStorage.setItem("what-"+e,t)}catch(e){}},S=function(e){return"number"==typeof e.pointerType?f[e.pointerType]:"pen"===e.pointerType?"touch":e.pointerType},T=function(e){var t=Date.now(),i="mouse"===e&&"touch"===n&&t-r<200;return r=t,i},P=function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},A=function(e){for(var t=0,r=s.length;t<r;t++)s[t].type===e&&s[t].fn.call(void 0,"input"===e?n:i)},I=function(e){h.x!==e.screenX||h.y!==e.screenY?(d=!1,h.x=e.screenX,h.y=e.screenY):d=!0},x=function(e,t){var n=window.Element.prototype;if(n.matches||(n.matches=n.msMatchesSelector||n.webkitMatchesSelector),n.closest)return e.closest(t);do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null};return"addEventListener"in window&&Array.prototype.indexOf&&(c[P()]="mouse",function(){var e=!!p&&{passive:!0};document.addEventListener("DOMContentLoaded",m),window.PointerEvent?(window.addEventListener("pointerdown",v),window.addEventListener("pointermove",b)):window.MSPointerEvent?(window.addEventListener("MSPointerDown",v),window.addEventListener("MSPointerMove",b)):(window.addEventListener("mousedown",v),window.addEventListener("mousemove",b),"ontouchstart"in window&&(window.addEventListener("touchstart",v,e),window.addEventListener("touchend",v))),window.addEventListener(P(),b,e),window.addEventListener("keydown",v),window.addEventListener("keyup",v),window.addEventListener("focusin",w),window.addEventListener("focusout",_)}()),{ask:function(e){return"intent"===e?i:n},element:function(){return t},ignoreKeys:function(e){u=e},specificKeys:function(e){l=e},registerOnChange:function(e,t){s.push({fn:e,type:t||"input"})},unRegisterOnChange:function(e){var t=function(e){for(var t=0,n=s.length;t<n;t++)if(s[t].fn===e)return t}(e);!t&&0!==t||s.splice(t,1)},clearStorage:function(){window.sessionStorage.clear()}}}()}],e.c=n,e.p="",e(0);var t,n}),define("urlUtils",["lodash","globals"],function(e,t){"use strict"
;var n=/^(https?|ftp):\/\/[^\s\/$.?#].[^\s]*$/i,i={isValidUrl:function(e){return n.test(e)},beginsWithHttpOrHttps:function(e){return/^(http(s?))\:\/\//gi.test(e)},getUrlParams:function(t){var n,i={};if(t=String(t),-1===t.indexOf("?"))return i;var r=t.split("?"),o=r[1];if(e.isEmpty(o))return i;o=o.split("&");for(var a=0;a<o.length;a++)-1===o[a].indexOf("=")?i[decodeURIComponent(o[a])]=void 0:(n=o[a].split("="),i[decodeURIComponent(n[0])]=decodeURIComponent(n[1]));return i},removeEmbedParams:function(e){var t=e.replace(/heightOverride=\d+&?/g,"").replace(/tabletHeightOverride=\d+&?/g,"").replace(/mobileHeightOverride=\d+&?/g,"");return-1!==t.indexOf("?",t.length-1)&&(t=t.substring(0,t.length-1)),t},getBaseUrl:function(e){return e=String(e),-1===e.indexOf("?")?e:e.split("?")[0]},appendQueryParams:function(t,n,i){if(e.isEmpty(n))return t;var r="",o=t.lastIndexOf("#");-1!==o&&(r=t.substr(o),t=t.substr(0,o));var a=this.getUrlParams(t);n=e.extend({},a,n);var s=[];e.each(n,function(t,n){var r=i?n:encodeURIComponent(n);e.isUndefined(t)||(i||(t=encodeURIComponent(t)),r+="="+t),s.push(r)});var u=s.join("&");return this.getBaseUrl(t)+"?"+u+r},appendCacheBustingTimestamp:function(e,t){return e+(-1===e.indexOf("?")?"?":"&")+"_="+t},extractDomain:function(e){var t=e.match(/^https?:\/\/([^\/]+)/);return t?t[1]:""},replaceProtocolIfHttpsRequest:function(e){return"https:"===location.protocol&&(e=i.makeHttps(e)),e},makeHttps:function(e){return e.replace(/^http:/,"https:")},linkifyText:function(e,t){var n=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,i=/(^|[^\/])(www\.[\S]+(\b|$))/gim,r=/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gim,o=t?' target="_blank"':"";return e.replace(n,'<a href="$&"'+o+">$&</a>").replace(i,'$1<a href="http://$2"'+o+">$2</a>").replace(r,'<a href="mailto:$&"'+o+">$&</a>")},locationIsHtmlFile:function(){return!!window.location.pathname.match(/\.html$/)},makeUrlAbsolute:function(e){if(this.extractDomain(e))return e;if(!window.cerosBaseUrl)return e;var t="/"===e[0],n=window.cerosBaseUrl.lastIndexOf("/")===window.cerosBaseUrl.length-1;return n&&t?window.cerosBaseUrl+e.slice(1):n||t?window.cerosBaseUrl+e:window.cerosBaseUrl+"/"+e},hasQueryParam:function(t,n){return!e.isUndefined(this.getQueryParamValue(t,n))},getQueryParamValue:function(t,n){var r=i.getUrlParams(t);return e.find(r,function(e,t){if(t.toLowerCase()===n.toLowerCase())return!0})},prependProtocol:function(e,t){var n=t?"https://":"http://";return i.beginsWithHttpOrHttps(e)?e:n+e},replaceUrlContextVariables:function(e){return e.replace(/\{api-version\}/,t.apiVersion).replace(/\{account-slug\}/,t.accountSlug).replace(/\{scope\}/,t.accountSlug)}};return i}),define("shared/utils/NavigationUtils",["lodash","jquery","log","globals","urlUtils"],function(e,t,n,i,r){"use strict";var o={page_number:"/p/",page_slug:"/page/"};return{buildUri:function(e,t,n,i){return r.locationIsHtmlFile()?this.buildHtmlStyleUri(t,i):this.buildPathStyleUri(e,t,n,i)},buildHtmlStyleUri:function(e,t){t=t||"";var n,i=this.getWindowContext(),o=i.location.search;return 1===e?(o=o.replace(/page=(\d+)&?/,""),n=i.location.pathname+o):n=r.appendQueryParams(i.location.pathname+o,{page:e}),(n=n.replace(/[&|\?]$/,""))+t},buildPathStyleUri:function(e,t,r,a){if(!o[e])return n.warn("Mode is not supported"),null;a=a||"";var s=this.getWindowContext(),u=o[e]+t,l=i.previewMode&&r&&"desktop"!==r?"/layout/"+r:"",c=s.location.pathname,d=c+"";return d=d.replace(/\/$/,""),d=d.replace(/\/layout\/[a-z0-9-]+/,"")+l,d=d.replace(/\/(p|page)\/[a-z0-9-]*/,"")+u,(d+=s.location.search)+a},buildUriForPageNumber:function(e){var t=this.parseLayoutFromLocation();return this.buildUri("page_number",e,t)},parsePageFromLocation:function(){var e=this.getWindowContext(),t=null;if(r.locationIsHtmlFile()){var n=e.location.search.match(/page=(\d+)/);return t=1,n&&(t=parseInt(n[1],10)),t}var o=e.location.pathname.match(/\/p\/(\d+)\/?$/);if(o&&(t=parseInt(o[1],10)),!t&&i.usePageSlugsInNavigation){var a=e.location.pathname.match(/\/page\/([a-z0-9-]+)\/?$/);a&&(t=a[1])}return t||(t=1),t},parseLayoutFromLocation:function(){var e=this.getWindowContext(),t=e.location.pathname.match(/\/layout\/([a-z0-9-]+)\/?/);return t?t[1]:"desktop"},getLocationWithoutParamsAndLayoutOrPageNumber:function(){return this.getWindowContext().location.href.replace(/\?.*$/,"").replace(/\/(layout\/[0-9a-z-]+)\\?/,"").replace(/\/(page\/[0-9a-z-]+|p\/\d+)\\?$/,"")},getWindowContext:function(){return window}}}),define("libs/font/FontConstants",[],function(){"use strict";return{GOOGLE_API_ID:"Google",BUILTIN_API_ID:"BuiltIn",UPLOADED_API_ID:"Uploaded",DEFAULT_FONT_FAMILY_GUID:"Google|Roboto",DEFAULT_FONT_VARIANT_GUID:"Google|Roboto|400|normal",DEFAULT_FONT_WEIGHT:400,DEFAULT_FONT_STYLE:"normal",FONT_STYLE_ITALIC:"italic",FONT_STYLE_NORMAL:"normal",FONT_STYLE_OBLIQUE:"oblique",EXPERIENCE_FAMILY_GUIDS_KEY:"familyGuids"}}),define("libs/font/FontVariant",["lodash","jquery","libs/font/FontConstants"],function(e,t,n){"use strict";var i=function(e,t){t=t||{},this.name=e,this.fontFamily=t.fontFamily,this.familyName=t.familyName,this.fontWeight=t.fontWeight,this.fontStyle=t.fontStyle,this.guid=t.guid,this.metrics=t.metrics,this.webFontStylesLoaded=!!t.webFontStylesLoaded,this.metricsUrl=t.metricsUrl,this.cssFamilyName=t.cssFamilyName||t.familyName,this.crossAccount=!!t.crossAccount,this.cssUrl=t.cssUrl,this.unitsPerEm=t.unitsPerEm,this.ascent=t.ascent};return i.prototype={getFontFamily:function(){return this.fontFamily},getName:function(){return this.name},getCssFamilyName:function(){return this.cssFamilyName},getFontStyle:function(){return this.fontStyle},getFontWeight:function(){return this.fontWeight},getGuid:function(){return this.guid},isItalic:function(){return this.fontStyle===n.FONT_STYLE_ITALIC},isUploaded:function(){return this.fontFamily.isUploaded()},isBuiltIn:function(){return this.fontFamily.isBuiltIn()},getMetricsUrl:function(){return this.metricsUrl?(new t.Deferred).resolve(this.metricsUrl):t.ajax({url:"/rest/v1/font/font-metrics",dataType:"json",data:{variantGuids:[this.guid]}}).then(e.bind(function(e){return this.metricsUrl=e[0].metricsFileURL,this.metricsUrl},this))},getMetrics:function(){return this.metrics?t.Deferred().resolve(this.metrics):this.metricsLoadingDeferred?this.metricsLoadingDeferred.promise():(this.metricsLoadingDeferred=new t.Deferred,this.getMetricsUrl().then(e.bind(function(n){t.ajax({url:n,dataType:"json",cache:!0}).done(e.bind(function(e){this.metrics=e,this.metricsLoadingDeferred.resolve(e)},this)).fail(e.bind(function(e){this.metricsLoadingDeferred.reject(e)},this))},this)),this.metricsLoadingDeferred.promise())},setWebFontStylesLoaded:function(){this.webFontStylesLoaded=!0}},i}),define("libs/font/FontFamily",["lodash","jquery","libs/font/FontVariant","libs/font/FontConstants"],function(e,t,n,i){"use strict";var r=function(e){e=e||{},this.api=e.api,this.family=e.family,this.guid=e.guid,this.crossAccount=!!e.crossAccount,this.category=e.category,this.version=e.version,this.lastModified=e.lastModified,this.files=e.files,this.variants=[]};return r.prototype={isBuiltIn:function(){return this.api===i.BUILTIN_API_ID},isUploaded:function(){return this.api===i.UPLOADED_API_ID},isCrossAccount:function(){return this.crossAccount},getFamilyName:function(){return this.family},getVariants:function(){return this.variants},addVariant:function(t,i){var r=new n(t,e.extend({},i||{},{fontFamily:this}));return this.updateVariant(r),r},updateVariant:function(t){var n=e.findIndex(this.variants,function(e){return t.guid===e.guid});-1===n?this.variants.push(t):this.variants[n]=t},getVariantsCount:function(){return this.variants.length},getVariantNames:function(){return e.map(this.variants,function(e){return e.getName()})},getCssFamilyName:function(){return this.isUploaded()?this.variants[0].getCssFamilyName():this.getFamilyName()},getGuid:function(){return this.guid},getVariant:function(t){return e.find(this.variants,function(e){return e.guid===t})},getVariantByName:function(t){return e.find(this.variants,function(e){return e.getName()===t.toString()})},getWebFontStylesLoaded:function(){return e.every(this.variants,"webFontStylesLoaded")},setAllWebFontStylesLoaded:function(){e.each(this.variants,e.bind(function(e){e.setWebFontStylesLoaded()},this))},sortVariantsByName:function(){this.variants=e.sortBy(this.variants,["name"])},findVariantByWeightAndStyle:function(t,n){return e.find(this.variants,function(e){return e.getFontWeight()===t&&e.getFontStyle()===n})},findBestMatchVariant:function(e){var t=this.getVariantByName(e.getName());return t||(t=this.findVariantByWeightAndStyle(e.getFontWeight(),e.getFontStyle())),t||(t=this.findVariantByWeightAndStyle(i.DEFAULT_FONT_WEIGHT,i.DEFAULT_FONT_STYLE)),t||(t=this.variants[0]),t}},r}),define("modules/page/utils/TextUtil",["log","lodash","jquery","device","globals","libs/font/FontConstants","libs/font/FontFamily","libs/font/FontVariant"],function(e,t,n,i,r,o,a,s){"use strict";var u=function(t){var n=r.fontManifest[t];if(n||(n=r.fontManifest[o.DEFAULT_FONT_VARIANT_GUID])&&e.warn("Could not find font in the font manifest. Using default variant.",{variantGuid:t,defaultVariantGuid:o.DEFAULT_FONT_VARIANT_GUID}),n){var i=new a({family:n.familyName,guid:n.familyGuid,crossAccount:n.crossAccount,api:n.api});return new s(n.variantName,{fontFamily:i,familyName:n.familyName,fontWeight:n.fontWeight,fontStyle:n.fontStyle,guid:n.variantGuid,cssFamilyName:n.cssFamilyName,cssUrl:n.cssFileURL,unitsPerEm:n.unitsPerEm,ascent:n.ascent})}throw new Error("Could not find desired font "+t+" or default font "+o.DEFAULT_FONT_VARIANT_GUID+" in the font manifest.")},l=function(n,i,r,o){var a=n.find(".marker");if(0===a.length)return void e.info("could not find img baseline marker!");if(0===a.position().top)return void t.defer(function(){l(n,i,r,o)});var s=a.position().top+a.height(),u=r/i.unitsPerEm,c=Math.round(u*i.ascent-s),d=n.attr("data-baseline");if(t.isUndefined(d)||t.isUndefined(c)||parseInt(d,10)!==c)return n.attr("data-baseline",c),void t.defer(function(){l(n,i,r,o)});o.resolve(c)},c=function(e){return'"'+e.replace('"','\\"')+'"'};return{resolveFont:u,measureFontBaselineOffset:function(e,t,i){var r=new n.Deferred;if(t<=1)return r.resolve(0),r.promise();var o=n('<div><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAMAAAAoyzS7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF////AAAAVcLTfgAAAAxJREFUeNpiYAAIMAAAAgABT21Z4QAAAABJRU5ErkJggg==" style="position:relative;vertical-align:baseline;" class="marker"/><span>Mq</span></div>').css({width:"auto",height:"auto",lineHeight:i+"px",position:"absolute",top:0,left:0,fontSize:t+"px",fontFamily:c(e.getCssFamilyName()),fontWeight:e.getFontWeight(),fontStyle:e.getFontStyle(),opacity:0}).attr("data-baseline",null);return n("body").append(o),l(o,e,t,r),r.done(function(){o.remove()}),r.promise()},formatFamilyNameForCSS:c}}),define("libs/image/AbstractImageResource",["jquery"],function(e){"use strict";var t=function(t){this.resourceReady=e.Deferred(),this.image=new Image,this.data=this.image,t&&t.useCorsAnonymous&&(this.image.crossOrigin="Anonymous")};return t.prototype={onload:function(){return this.resourceReady.done.apply(this.resourceReady,arguments),this.resourceReady},onerror:function(){return this.resourceReady.fail.apply(this.resourceReady,arguments),this.resourceReady},ready:function(){return"resolved"===this.resourceReady.state()},getPromise:function(){return this.resourceReady.promise()},getImage:function(){return this.image},getWidth:function(){return this.image.width},getHeight:function(){return this.image.height},remove:function(){delete this.image},getSrc:function(){return this.image.src}},t}),define("libs/image/ImageResource",["jquery","lodash","libs/image/AbstractImageResource"],function(e,t,n){"use strict";var i=function(e,i){return n.call(this,i),this.url=e,i&&i.makeCORSCompatible&&this.image.setAttribute("crossOrigin","anonymous"),this.image.onload=t.bind(function(){this.resourceReady.resolve(this)},this),this.image.onerror=t.bind(function(){this.resourceReady.reject()},this),this.image.src=e,this};return i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i}),define("cerosMath",[],function(){"use strict";var e={};return e.BEZIER_CURVE_POINT_INCREMENT_DEFAULT=.01,e.Point=function(e,t){this.x=e,this.y=t,this.getX=function(){return this.x},this.getY=function(){return this.y},this.setX=function(e){this.x=e},this.setY=function(e){this.y=e},this.rotate=function(e,t,n){var i=Math.rotateCoord(this.x,this.y,e,t,n);this.setX(i.x),this.setY(i.y)}},e.Point.diff=function(t,n){return new e.Point(t.getX()-n.getX(),t.getY()-n.getY())},e.Point.sum=function(t,n){return new e.Point(t.getX()+n.getX(),t.getY()+n.getY())},e.Point.ORIGIN=new e.Point(0,0),e.calcRotatedLineIntersect=function(e,t,n){return{startPt:this.calcPointOnRect(e-270,t,n),endPt:this.calcPointOnRect(e-90,t,n)}},e.calcPointOnRect=function(t,n,i){var r={x:n/2,y:i/2};(t%=360)<0&&(t+=360);var o,a,s,u=Math.toRad(t),l=Math.tan(u),c=50*l,d=50/l;return Math.abs(c)<=50?(o=n/100*50,a=i/100*c,s=u<=Math.PI/2||u>3*Math.PI/2?{x:o,y:a}:{x:-o,y:-a}):(o=n/100*d,a=i/100*50,s=u<Math.PI?{x:o,y:a}:{x:-o,y:-a}),s.x+=r.x,s.y+=r.y,s.x=Math.round(s.x),s.y=Math.round(s.y),new e.Point(s.x,s.y)},e.scaleBoxToMaxDimension=function(e,t,n){var i=e,r=t;return e>0&&t>0&&(e>t?(i=n,r=Math.round(n/e*t)):(i=Math.round(n/t*e),r=n)),{width:i,height:r}},e.distance=function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},e.lineLength=function(t){return e.distance({x:t.x1,y:t.y1},{x:t.x2,y:t.y2})},e.closestPointOnBezierCurve=function(t,n,i,r,o,a){if(void 0!==a&&null!==a||(a=e.BEZIER_CURVE_POINT_INCREMENT_DEFAULT),a<=0)return null;for(var s=1/0,u=null,l=a;l<1;l+=a){var c=e.evaluateBezierCurve(n.x,i.cx2,o.cx1,r.x,l),d=e.evaluateBezierCurve(n.y,i.cy2,o.cy1,r.y,l),h={x:c,y:d},f=e.distance(t,h);f<s&&(s=f,u=h)}return u},e.closestPointOnLine=function(t,n){var i=[n.x2-n.x1,n.y2-n.y1],r=[n.x1-t.x,n.y1-t.y],o=i[0]*r[0]+i[1]*r[1],a=Math.pow(i[0],2)+Math.pow(i[1],2),s=-o/a;return s>=0&&s<=1?e.vectorToSegment2D(s,{x:0,y:0},n):e.sqDiag2D(e.vectorToSegment2D(0,t,n))<=e.sqDiag2D(e.vectorToSegment2D(1,t,n))?{x:n.x1,y:n.y1}:{x:n.x2,y:n.y2}},e.vectorToSegment2D=function(e,t,n){return{x:(1-e)*n.x1+e*n.x2-t.x,y:(1-e)*n.y1+e*n.y2-t.y}},e.sqDiag2D=function(e){return Math.pow(e.x,2)+Math.pow(e.y,2)},e.cubicBezierCurveFirstDerivativeRoots=function(t,n,i,r){var o=[],a=3*(3*n-t-3*i+r),s=6*(t-2*n+i),u=3*(n-t),l=s*s-4*a*u;if(l>=0){var c=(-s+Math.sqrt(l))/(2*a),d=(-s-Math.sqrt(l))/(2*a);c>0&&c<1&&o.push(e.evaluateBezierCurve(t,n,i,r,c)),d>0&&d<1&&o.push(e.evaluateBezierCurve(t,n,i,r,d))}return o},e.evaluateBezierCurve=function(e,t,n,i,r){return e*(1-r)*(1-r)*(1-r)+3*t*r*(1-r)*(1-r)+3*n*r*r*(1-r)+i*r*r*r},e.round=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n},e.toNextMultiple=function(e,t){return e>0?Math.ceil(e/t)*t:e<0?Math.floor(e/t)*t:0},e.maintainOffsetWhenRotated=function(e,t){var n=t.x,i=t.y;if(e&&0!==e&&void 0!==t.x&&void 0!==t.y){var r=t.x,o=t.y;e=Math.toRad(e),n=r*Math.cos(e)+o*Math.sin(e),i=o*Math.cos(e)-r*Math.sin(e)}return{x:n,y:i}},window.CerosMath=e,e}),define("VectorImageUtils",["jquery","lodash","cerosMath","device"],function(e,t,n,i){"use strict";var r=["svg","path","rect","circle","ellipse","line","polyline","polygon","text"];return{isVectorBased:function(e){return"image/svg+xml"===e},getImageAspectRatio:function(e){var t=this.getViewportDimensions(e);if(t&&t.height>0&&t.width>0)return t;var n=this.getViewBoxDimensions(e);return n&&n.height>0&&n.width>0?n:null},getViewBoxDimensions:function(e){var t=e.documentElement,n=(t.getAttribute("viewBox")||"").match(/-?[\d\.]+/g);if(n&&4===n.length){var i=parseInt(n[2],10),r=parseInt(n[3],10);if(i>0&&r>0)return{width:i,height:r}}return null},getViewportDimensions:function(e){var t=e.documentElement,n=parseInt(t.getAttribute("width"),10),i=parseInt(t.getAttribute("height"),10);return n>0&&i>0?{width:n,height:i}:null},setViewportDimensions:function(e,t,n){var i=e.documentElement;i.setAttribute("width",t+"px"),i.setAttribute("height",n+"px")},updateSVGColorStyle:function(e,n){t.each(r,t.bind(function(i){var r=e.getElementsByTagName(i);t.each(r,t.bind(function(e){this.canFillStyleBeUpdated(e)&&this.appendStyle(e,"fill",n),this.canStrokeStyleBeUpdated(e)&&this.appendStyle(e,"stroke",n)},this))},this))},canFillStyleBeUpdated:function(e){var t=this.getStyle(e,"fill");return!t||"none"!==t.trim()},canStrokeStyleBeUpdated:function(e){var t=this.getStyle(e,"stroke");return t&&"none"!==t.trim()},getStyle:function(e,t){var n=this.getStyleValue(e,t);return n||(n=e.getAttribute(t)),n},removeIllegalNodes:function(e){this.removeNodesByNodeName(e,"foreignObject")},removeNodesByNodeName:function(e,t){var n=e.getElementsByTagName(t);if(n)for(var i=n.length-1;i>=0;i--){var r=n[i];r.parentNode.removeChild(r)}},findChildNode:function(e,n){return t.find(e.childNodes,function(e){return e.nodeName===n})},appendNewChildNode:function(e,t,n){var i=this.createSVGNode(e,n);return t.appendChild(i,t.firstChild),i},prependNewChildNode:function(e,t,n){var i=this.createSVGNode(e,n);return t.insertBefore(i,t.firstChild),i},addLinearGradient:function(e,i,r){var o=e.documentElement,a=this.findChildNode(o,"defs");a||(a=this.prependNewChildNode(e,o,"defs"));var s=this.appendNewChildNode(e,a,"linearGradient");s.setAttribute("id",i);var u=n.calcRotatedLineIntersect(r.angle,100,100);s.setAttribute("x1",u.startPt.getX()+"%"),s.setAttribute("y1",u.startPt.getY()+"%"),s.setAttribute("x2",u.endPt.getX()+"%"),s.setAttribute("y2",u.endPt.getY()+"%"),t.each(r.stops,t.bind(function(t,n){var i=0;r.stops.length>1&&(i=100*n/(r.stops.length-1));var o=this.appendNewChildNode(e,s,"stop");o.setAttribute("offset",i+"%"),o.setAttribute("stop-color",t.color)},this))},createSVGNode:function(e,t){return e.createElementNS("http://www.w3.org/2000/svg",t)},supportsObjectURLs:function(){return!i.isPhantomJS()},createObjectURL:function(e){if(this.supportsObjectURLs()){var t=this.createBlob(e);return this.getDOMURL().createObjectURL(t)}var n=this.createXmlString(e);return"data:image/svg+xml;base64,"+window.btoa(n)},createBlob:function(e){var t=this.createXmlString(e);return new Blob([t],{type:"image/svg+xml"})},createXmlString:function(e){return(new XMLSerializer).serializeToString(e)},revokeObjectURL:function(e){this.supportsObjectURLs()&&this.getDOMURL().revokeObjectURL(e)},getDOMURL:function(){return window.URL||window.webkitURL||window},isDataURL:function(e){return t.isString(e)&&0===e.indexOf("data:")},isVectorDataURL:function(e){return t.isString(e)&&0===e.indexOf("data:image/svg+xml;base64,")},convertToXMLString:function(e){if(!this.isVectorDataURL(e))throw new Error("Expected data url to start with data:image/svg+xml;base64,");var t=e.substring("data:image/svg+xml;base64,".length);return window.atob(t)},appendStyle:function(e,t,n){var i=e.getAttribute("style"),r=t+":"+n+";";i&&i.length>0?(";"!==i.substr(i.length-1)&&(i+=";"),i+=r):i=r,e.setAttribute("style",i)},getStyleValue:function(e,t){var n=e.getAttribute("style");if(!n||0===n.length)return null;var i=n.split(";");if(!i)return null;for(var r=null,o=i.length-1;o>=0;o--){var a=i[o].split(":");if(a&&2==a.length){if(a[0].trim()===t){r=a[1].trim();break}}}return r},createImageElement:function(n,i){var r=e("<img/>");return i&&r.attr(i),r.on("error",t.bind(function(){this.revokeObjectURL(n)},this)),r.attr("src",n),r}}}),define("ThumbnailVariantUtils",["lodash"],function(e){"use strict";return{VARIANTS:{FULL:"full",HALF:"half",QUARTER:"quarter",TENTH:"tenth"},getThumbnailVariant:function(t,n){var i=null;return e.has(t,n)?i=t[n]:e.has(t,this.VARIANTS.FULL)&&(i=t[this.VARIANTS.FULL]),i},getComponentImageThumbnail:function(t,n){if(!n)return this.getThumbnailVariant(t,this.VARIANTS.FULL);var i=[];e.each(t,function(e){i.push(e)}),i.sort(function(e,t){return e.width<t.width?-1:e.width>t.width?1:0});var r=e.find(i,function(e){return e.width>=n});return e.isObject(r)||(r=this.getThumbnailVariant(t,this.VARIANTS.FULL)),r}}}),define("BasicCache",["lodash"],function(e){"use strict";function t(){this.cache={}}return e.extend(t.prototype,{get:function(t){return e.get(this.cache,t,null)},put:function(e,t){this.cache[e]=t},has:function(t){return e.has(this.cache,t)},purgeAll:function(){this.cache={}}}),t}),define("libs/media/MediaInfoCache",["jquery","lodash","BasicCache"],function(e,t,n){"use strict";var i=new n,r={get:function(e){return i.get(e)},getOriginalWidth:function(e){var n=r.get(e);return t.get(n,["original","width"],null)},getOriginalDimensions:function(e){var n=r.get(e),i=t.get(n,["original","width"],null),o=t.get(n,["original","height"],null);return i&&o?{width:i,height:o}:null},put:function(e,t){i.put(e,t)},putMediaArray:function(e){t.each(t.keyBy(e,"id"),function(e,t){i.put(t,e)})},putImageResource:function(e,t){if(!t.ready())return void window.console.warn("Tried to put image info into cache from an image resource that was not ready");r.putImageInfo(e,t.getSrc(),t.getWidth(),t.getHeight())},putImageInfo:function(e,t,n,r){var o={id:e,url:t,original:{width:n,height:r}};return i.put(e,o),o},purgeAll:function(){i.purgeAll()},has:function(e){return i.has(e)}};return r}),define("libs/media/MediaInfoService",["jquery","lodash","globals","libs/media/MediaInfoCache"],function(e,t,n,i){"use strict";var r=[],o={loadImagesForUri:function(e){return o.loadImagesForRestUri("/rest"+e)},loadImagesForRestUri:function(e){return o.loadMediaForRestUri(e,!0)},loadMediaForUri:function(e,t){return o.loadMediaForRestUri("/rest"+e,t)},loadMediaForRestUri:function(t,n){var o=t+"/media";n&&(o+="?imagesOnly=true");var a=e.ajax({url:o,type:"GET",dataType:"json"}).then(function(e){i.putMediaArray(e)}).fail(function(e,n,i){window.console.warn("Unable to load image info for uri: "+t+" due to error: "+i)});return r.push(a),a},loadImage:function(n){return e.ajax({url:"/rest"+n+"/metadata",type:"GET",dataType:"json"}).then(function(e){if(!t.isObject(e))return void window.console.warn("Unexpected image metadata format");var r=t.get(e,"url",null),o=t.get(e,["meta","width"],null),a=t.get(e,["meta","height"],null);return i.putImageInfo(n,r,o,a)}).fail(function(){window.console.warn("Unable to load info for image: "+n)})},getMediaInfo:function(t){var a=e.Deferred();return i.has(t)||!n.isStudio?(a.resolve(i.get(t)),a.promise()):(e.when.apply(e,r).always(function(){if(i.has(t))return void a.resolve(i.get(t));o.loadImage(t).always(function(){a.resolve(i.get(t))})}),a.promise())},getOriginalWidth:function(e){return o.getMediaInfo(e).then(function(e){return t.get(e,["original","width"],null)})},getOriginalDimensions:function(e){return o.getMediaInfo(e).then(function(e){var n=t.get(e,["original","width"]),i=t.get(e,["original","height"]);return n&&i?{width:n,height:i}:null})}};return o}),define("ImageCroppingUtils",["lodash"],function(e){"use strict";var t=["width","height","x","y"],n={isValidCropObject:function(n){if(!e.isObject(n))return!1;var i=e.keys(n);return 0===e.xor(i,t).length},createCropDimensionsString:function(e){return n.isValidCropObject(e)?[e.width,e.height,"x"+e.x,"y"+e.y].join(","):""},createOriginalDimensionsFromCropDimensions:function(e,t){return{width:Math.clamp(t.width,1,e.width),height:Math.clamp(t.height,1,e.height)}}};return n}),define("libs/image/RasterImageResourceCache",["lodash","BasicCache","ImageCroppingUtils"],function(e,t,n){"use strict";function i(){t.call(this)}return e.extend(i.prototype,t.prototype,{createCacheKey:function(t,i){var r=n.createCropDimensionsString(i);return e.isString(r)&&r.length>0?t+"|"+r:t}}),i}),define("libs/image/VectorImageResource",["jquery","lodash","VectorImageUtils","libs/image/AbstractImageResource"],function(e,t,n,i){"use strict";var r=function(e){i.call(this),e.done(t.bind(function(e){this.initImage(e)},this)).fail(t.bind(function(){this.resourceReady.reject()},this))};return r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.extend(r.prototype,{initImage:function(e){this.image.onerror=t.bind(function(){n.revokeObjectURL(e),this.resourceReady.reject()},this),this.image.onload=t.bind(function(){this.resourceReady.resolve(this)},this),this.image.src=e}}),r}),define("libs/image/VectorImageResourceFactory",["jquery","lodash","libs/image/VectorImageResource","VectorImageUtils","BasicCache"],function(e,t,n,i,r){"use strict";var o=function(n){this.url=n,this.vectorImageResourceCache=new r,this.objectUrlPromiseCache=new r,this.xmlString=null,this.resourceReady=e.Deferred(),this.loadImageXML(n).done(t.bind(function(e){this.xmlString=e,this.resourceReady.resolve(this)},this)).fail(t.bind(function(){this.resourceReady.reject()},this))};return t.extend(o.prototype,{vectorImageResourceCache:null,objectUrlPromiseCache:null,getPromise:function(){return this.resourceReady.promise()},getOrCreateImageResource:function(e){var t=this.getCacheKey(e);if(this.imageResourceCacheHas(t))return this.getFromImageResourceCache(t);var i=this.createObjectURL(e),r=new n(i);return this.putInImageResourceCache(t,r),r},getImageResource:function(e){var t=this.getCacheKey(e);return this.getFromImageResourceCache(t)},imageResourceCacheHas:function(e){return this.vectorImageResourceCache.has(e)},getFromImageResourceCache:function(e){return this.vectorImageResourceCache.get(e)},putInImageResourceCache:function(e,t){this.vectorImageResourceCache.put(e,t)},objectUrlPromiseCacheHas:function(e){return this.objectUrlPromiseCache.has(e)},getFromObjectUrlPromiseCache:function(e){return this.objectUrlPromiseCache.get(e)},putInObjectUrlPromiseCache:function(e,t){this.objectUrlPromiseCache.put(e,t)},getCacheKey:function(e){if(t.has(e,"gradient")){return"gradient|"+t.get(e,"gradient.angle",null)+"|"+t.get(e,"gradient.stops[0].color",null)+"|"+t.get(e,"gradient.stops[1].color",null)+"|"+t.get(e,"backgroundHasBeenSet",null)}return"solid|"+t.get(e,"color",null)+"|"+t.get(e,"backgroundHasBeenSet",!1)},createObjectURL:function(n){var r=this.getCacheKey(n);if(this.objectUrlPromiseCacheHas(r))return this.getFromObjectUrlPromiseCache(r);var o=e.Deferred();return this.resourceReady.done(t.bind(function(){var e=this.createXMLDoc(n);if(e){var t=i.createObjectURL(e);o.resolve(t)}else o.reject()},this)),this.resourceReady.fail(o.reject),this.putInObjectUrlPromiseCache(r,o),o},createBlob:function(n){var r=e.Deferred();return this.resourceReady.done(t.bind(function(){var e=this.createXMLDoc(n);if(e){var t=i.createBlob(e);r.resolve(t)}else r.reject()},this)),this.resourceReady.fail(r.reject),r},createImageElement:function(e,t){return this.createObjectURL(e).then(function(e){return i.createImageElement(e,t)})},createXMLDoc:function(t){var n;try{n=e.parseXML(this.xmlString)}catch(e){}if(!n||!e.isXMLDoc(n))return null;t&&(t.color?i.updateSVGColorStyle(n,t.color):t.gradient?(i.addLinearGradient(n,"CerosGradient_1234",t.gradient),i.updateSVGColorStyle(n,"url(#CerosGradient_1234)")):t.backgroundHasBeenSet&&i.updateSVGColorStyle(n,"rgba(0,0,0,0)")),i.removeIllegalNodes(n);var r=i.getImageAspectRatio(n);return r&&r.width>0&&r.height>0&&i.setViewportDimensions(n,r.width,r.height),n},loadImageXML:function(t){var n=e.Deferred();if(i.isDataURL(t))if(i.isVectorDataURL(t)){var r=i.convertToXMLString(t);n.resolve(r)}else n.reject();else e.ajax({type:"GET",url:t,dataType:"text",cache:!0,success:function(e){n.resolve(e)},error:function(){n.reject()}});return n},getVectorImageResourceCache:function(){return this.vectorImageResourceCache},getObjectUrlPromiseCache:function(){return this.objectUrlPromiseCache}}),o}),define("libs/image/ImageResourceService",["lodash","jquery","device","globals","VectorImageUtils","ThumbnailVariantUtils","urlUtils","BasicCache","libs/media/MediaInfoCache","libs/media/MediaInfoService","libs/image/ImageResource","libs/image/RasterImageResourceCache","libs/image/VectorImageResourceFactory","ImageCroppingUtils"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f){"use strict";var p=new d,g=new s,m={getOrCreateRasterImageResource:function(e,n,i){var r=t.Deferred();return l.getOriginalDimensions(e).then(function(t){if(!t)return window.console.warn("No info was found for image: "+e),void r.resolve(null);f.isValidCropObject(i)?t=f.createOriginalDimensionsFromCropDimensions(t,i):i=null;var o=m.getRasterImage(e,i),a=m.isUriForGif(e),s=m.calculateVariantDimensions(t,n,a);o?o.getPromise().then(function(){m.shouldRequestHigherResolution(t.width,o.getWidth(),s)?r.resolve(m.createRasterImageResource(e,s,i)):r.resolve(o)}).fail(r.reject):r.resolve(m.createRasterImageResource(e,s,i))}),r.promise().then(function(e){return e?e.getPromise():null})},getOrCreateRasterImageResourceSync:function(e,t){var n=p.get(e),i=m.isUriForGif(e),r=u.getOriginalDimensions(e);if(!r)return n&&(!n.ready()||n.getWidth()>=t)?n:m.createRasterImageResource(e,t);var o=m.calculateVariantDimensions(r,t,i);return n?n.ready()&&m.shouldRequestHigherResolution(r.width,n.getWidth(),o)?m.createRasterImageResource(e,o):n:m.createRasterImageResource(e,o)},getRasterImage:function(e,t){var n=p.createCacheKey(e,t);return p.get(n)},getOrCreateVectorImageResourceFactory:function(e){var t;if(g.has(e))return g.get(e);var n=m.createImageProxyUri(e);return t=new h(n),g.put(e,t),t},getVectorImageResourceFactory:function(e){return g.get(e)},createRasterImageResource:function(e,t,n){var i=m.createImageResourceUrl(e,t,n),r=new c(i),o=p.createCacheKey(e,n);return p.put(o,r),r},calculateOptimizedGifWidth:function(e,t){return e<=t/8?t/8:e<=t/4?t/4:e<=t/2?t/2:t},calculateOptimizedNonGifWidth:function(e,t){if(e>t)return t;var n=.05*Math.ceil(e/t/.05);return n=Math.max(n,.05),t*n},calculateVariantDimensions:function(e,t,r){if(i.isExported||(r?t=this.calculateOptimizedGifWidth(t,e.width):n.desktop()&&(t=this.calculateOptimizedNonGifWidth(t,e.width))),t>=e.width)return null;var o=Math.round(t),a=this._calculateMinimumValidWidth(e);return Math.max(a,o)},_calculateMinimumValidWidth:function(e){return e.height>=e.width?1:Math.ceil(e.width/e.height)},isUriForGif:function(e){return"gif"===e.substr(-"gif".length)},shouldRequestHigherResolution:function(t,n,i){return e.isNull(i)||i>=t?n<t:(i-n)/n>=.25},primeCachesWithOriginalImageResource:function(t,n){e.isNull(n)||(p.put(t,n),u.putImageResource(t,n))},primeCacheWithImageInfo:function(e,t,n,i){u.putImageInfo(e,t,n,i)},primeCacheWithVectorImageResourceFactory:function(e,t){g.put(e,t)},loadImageInfoForPage:function(e){return l.loadImagesForUri(e)},loadImageInfoForDocVersion:function(e){return l.loadImagesForRestUri(e)},createImageUri:function(e,t){return"/v1/account/"+i.accountSlug+"/"+e+"/"+t},createImageResourceUrl:function(e,t,n){return i.isStudio?m.createImageProxyUri(e,t,n):i.isExported?m.createExportUrl(e,t):m.createMediaUrl(e,t,n)},createImageProxyUri:function(t,n,i){t+="/proxy";var r={};return e.isNumber(n)&&(r.width=n),e.isObject(i)&&(r.crop=f.createCropDimensionsString(i)),a.appendQueryParams(t,r,!0)},createMediaUrl:function(t,n,i){var r=u.get(t),o=e.get(r,"url");if(!e.isString(o))return"";var s={imageOpt:1};return e.isNumber(n)&&(s.fit="bounds",s.width=n),e.isObject(i)&&(s.crop=f.createCropDimensionsString(i)),o=a.appendQueryParams(o,s,!0),a.replaceProtocolIfHttpsRequest(o)},createExportUrl:function(t,n){var i=u.get(t),r=e.get(i,"thumbnails");if(!e.isObject(r))return"";var a=o.getComponentImageThumbnail(r,n);return e.get(a,"url","")},getRasterImageResourceCache:function(){return p},getVectorImageResourceFactoryCache:function(){return g}};return m}),define("cssresource",["jquery","lodash"],function(e,t){"use strict";var n=function(n){return this.url=n,this.deferred=e.Deferred(),this.cssLinkResource=e("<link>",{rel:"stylesheet",type:"text/css",href:n}),this.data=this.cssLinkResource,this.cssLinkResource.on("load",t.bind(function(){this.deferred.resolve()},this)),this.cssLinkResource.appendTo("head"),this};return n.prototype={onload:function(){return this.deferred.done.apply(this.deferred,arguments),this.deferred},ready:function(){return"resolved"==this.deferred.state()},remove:function(){
delete this.cssLinkResource}},n}),define("shared/utils/ResourceLoader",["log","jquery","lodash","device"],function(e,t,n,i){"use strict";var r={},o=0,a=i.desktop()?2:1,s=!1,u={PENDING:1,LOADING:2,LOADED:3,ERROR:4,CANCELED:5},l=function(){this.queue=[],this.finished=t.Deferred()};l.prototype=n.extend(l.prototype,{push:function(e){this.queue.push(e)},getNextItem:function(){if(0===this.length())return null;var e=this.queue.shift();return 0===this.length()&&(this.finished.resolve(),this.finished=t.Deferred()),e},length:function(){return this.queue.length},flush:function(){this.queue=[],this.finished.resolve(),this.finished=t.Deferred()},onFinish:function(e){this.finished.done(e)}});var c=new l,d=new l,h=function(e){d.onFinish(e)},f=function(i,r,o){var a=u.PENDING,s=new t.Deferred;this.getStatus=function(){return a},this.setStatus=function(e){n.includes(n.values(u),e)&&(a=e)},this.getPromise=function(){return s.promise()},this.load=function(){a=u.LOADING;var l=n.isFunction(r)?r():t.noop();return l.promise?(l.then(function(){a=u.LOADED,s.resolve.apply(this,arguments)},function(){a=u.ERROR,s.reject(),e.devWarn("Resource failed to load",{key:i})}),l.always(function(){n.isFunction(o)&&o()}),this.getPromise()):(s.reject(),e.warn("onLoadBegin must be a function that returns a deferred promise and resolves with necessary resource data",{key:i}),this.getPromise())},this.getKey=function(){return i}};f.prototype.loadNow=function(){return this.getStatus()===u.PENDING&&(d.push(this),w()),this.getPromise()},f.prototype.isLoading=function(){return this.getStatus()===u.LOADING},f.prototype.isLoaded=function(){return this.getStatus()===u.LOADED},f.prototype.isError=function(){return this.getStatus()===u.ERROR},f.prototype.isPending=function(){return this.getStatus()==u.PENDING},f.prototype.isCanceled=function(){return this.getStatus()==u.CANCELED},f.prototype.cancel=function(){this.setStatus(u.CANCELED)};var p=function(e){return r.hasOwnProperty(e)},g=function(t){return n.isNull(t)||n.isUndefined(t)?null:r.hasOwnProperty(t)?r[t].isError()?(e.warn("An error was encountered while trying to load the resource",{key:t}),null):r[t]:(e.warn("No resource exists for the provided key",{key:t}),null)},m=function(){for(d.flush();c.length()>0;){c.getNextItem().status=u.CANCELED}},v=function(e,t,i){if(n.isNull(e)||n.isUndefined(e))return null;if(r.hasOwnProperty(e))r[e].isCanceled()&&(r[e].setStatus(u.PENDING),c.push(r[e]));else{var o=new f(e,t,i);r[e]=o,c.push(o)}return w(),r[e]},y=t.Deferred(),b=function(e){y.done(e)},w=function(){if(!(o>=a&&0===d.length())){var e=S();if(n.isNull(e))return void y.resolve();o++,e.load().always(function(){o--,w()})}},_=function(){s=!0},E=function(){s&&(s=!1,w())},S=function(){var e=null;return d.length()>0&&(e=T(d)),s?e:(n.isNull(e)&&(e=T(c)),e)},T=function(e){for(var t=null;e.length()>0&&(t=e.getNextItem(),!t.isPending());)t=null;return t};return{add:v,get:g,has:p,cancelPending:m,pause:_,resume:E,onPriorityQueueCompletion:h,onAllResourcesLoaded:b,purgeResourceCache:function(){r={}}}}),define("shared/utils/CerosResourceLoader",["log","jquery","lodash","device","globals","modules/page/utils/TextUtil","libs/image/ImageResource","libs/image/ImageResourceService","cssresource","shared/utils/ResourceLoader","VectorImageUtils","libs/image/VectorImageResourceFactory","webfont","ImageCroppingUtils"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f){"use strict";function p(e,t,n){var i=S(e,t,n),r=function(){return s.getOrCreateRasterImageResource(e,t,n)};return l.add(i,r)}function g(e){var t=function(){return new d(e).getPromise()};return l.add(e,t)}function m(e){if(l.has(e))return l.get(e);var t=function(){return new u(e).deferred.promise()};return l.add(e,t)}function v(e,i,r){if(l.has(i))return l.get(i);n.isArray(e)||(e=[e]),n.isArray(i)||(i=[i]);var o={families:e,urls:i};n.isUndefined(r)||(o.testStrings={},n.isObject(r)?n.each(e,function(e){n.isUndefined(r[e])||(o.testStrings[e]=r[e])}):n.each(e,function(e){o.testStrings[e]=r}));var a=function(){var i=[],r={};return n.each(e,function(e){var n=new t.Deferred;i.push(n),r[e]=n}),h.load({custom:o,async:!0,fontactive:function(e){r[e].resolve()},fontinactive:function(e){r[e].reject()}}),t.when.apply(t,i).promise()};return l.add(i,a)}function y(e){e=e.split(":")[0];var t=r.googleFontUrl+"/"+e+".css";return v(e,t,void 0)}function b(e){if(r.googleFontUrl)return y(e);if(l.has(e))return l.get(e);var n=function(){var n=new t.Deferred;return h.load({google:{families:[e]},async:!0,fontactive:function(){n.resolve()},fontinactive:function(){n.reject()}}),n.promise()};return l.add(e,n)}function w(e){return l.get(e)}function _(e){return l.has(e)}function E(){return l.cancelPending()}function S(e,t,i){n.isNull(t)&&(t="full");var r=e+"|"+t;return f.isValidCropObject(i)&&(r+="|"+f.createCropDimensionsString(i)),r}return{get:w,addRasterImage:p,addVectorImage:g,addCss:m,addGoogleWebFont:b,addCustomWebFont:v,has:_,cancelPending:E,pause:l.pause,resume:l.resume,onPriorityQueueCompletion:l.onPriorityQueueCompletion,onAllResourcesLoaded:l.onAllResourcesLoaded}}),define("shared/utils/ModuleEventManager",["lodash","jquery","log","backbone"],function(e,t,n,i){"use strict";return e.extend({events:{},unregisteredHandlers:{},registerEvents:function(t,n){e.each(t,e.bind(function(t){this.events[t]=n,this.unregisteredHandlers[t]&&(e.each(this.unregisteredHandlers[t],e.bind(function(e){this.on(t,e)},this)),this.unregisteredHandlers[t]=null)},this))}},i.Events)}),define("shared/models/EmbeddedViewportModel",["log","globals","lodash","backbone"],function(e,t,n,i){"use strict";var r=null,o=i.Model.extend({defaults:{top:null,bottom:null,windowWidth:null,windowHeight:null},validPositionProperties:["top","bottom","windowWidth","windowHeight"],setPositionData:function(e){var t=n.pick(e,this.validPositionProperties);this.set(t)},getTop:function(){return this.get("top")},getBottom:function(){return this.get("bottom")},getWindowWidth:function(){return this.get("windowWidth")},getWindowHeight:function(){return this.get("windowHeight")},getVerticalCenterOfVisibleArea:function(e){var t=Math.max(this.getTop(),0);return(Math.min(this.getBottom(),e)-t)/2+t},getEmbedContextDimensions:function(){var e=this.getWindowWidth(),i=this.getWindowHeight();return t.allowAdaptiveLayouts&&!1===n.isNull(e)&&!1===n.isNull(i)?{width:e,height:i}:{width:window.innerWidth,height:window.innerHeight}},isActive:function(){return null!==this.get("top")&&null!==this.get("bottom")}},{getInstance:function(){return r||(r=new o),r}});return o}),define("shared/utils/ScrollProxy",["log","lodash","jquery","backbone","shared/models/EmbeddedViewportModel","screenSize"],function(e,t,n,i,r,o){"use strict";var a="ceros-embedded-viewport:",s={PING:"ping",READY:"ready",POSITION:"position",SCROLL_TO:"scroll-to",UPDATE_POSITION:"update-position",GOTO_URL:"goto-url",VARIANT_DETECTION:"variant-detection",GLOBAL_FUNCTION_INVOKE:"global-function"},u=t.extend({EVENTS:s},i.Events),l=function(e){e.screenWidth&&e.screenHeight&&o.setDimensions(e.screenWidth,e.screenHeight),r.getInstance().setPositionData(e),u.trigger(s.UPDATE_POSITION,e)},c=function(e){var t=null;try{t=JSON.parse(e.originalEvent.data)}catch(e){}if(t&&t.event&&t.event.substr(0,a.length)===a)switch(t.event.substr(a.length)){case s.PING:f();break;case s.POSITION:l(t)}},d=function(e,n){var i=JSON.stringify(t.extend({event:a+e},n));window.parent.postMessage(i,"*")},h=null,f=function(){d(s.READY,{issueSlug:h})},p=function(e){d(s.VARIANT_DETECTION,{variant:e})};return u=t.extend(u,{init:function(e){h=e,f(),n(window).on("message",c)},announceScrollTo:function(e){d(s.SCROLL_TO,e)},announceGotoUrl:function(e,t){d(s.GOTO_URL,{url:e,urlOpenInNewWindow:t})},invokeGlobalFunctions:function(e){d(s.GLOBAL_FUNCTION_INVOKE,{globalFunctions:e})},announceVariantDetection:function(e){p(e)}})}),define("@frontend/common/libs/ImageEffects",["lodash"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=163)}({0:function(t,n){t.exports=e},163:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(){}return e.defaultValueOf=function(t){switch(t){case e.BRIGHTNESS.NAME:return e.BRIGHTNESS.DEFAULT;case e.CONTRAST.NAME:return e.CONTRAST.DEFAULT;case e.HUE.NAME:return e.HUE.DEFAULT;case e.SATURATION.NAME:return e.SATURATION.DEFAULT;case e.SEPIA.NAME:return e.SEPIA.DEFAULT;case e.INVERT.NAME:return e.INVERT.DEFAULT;default:return null}},e.getEffectsApplicationOrder=function(){return[this.BRIGHTNESS.NAME,this.CONTRAST.NAME,this.HUE.NAME,this.SATURATION.NAME,this.SEPIA.NAME,this.INVERT.NAME]},e.computeBrowserImageFilter=function(e){return this.getEffectsApplicationOrder().map(function(t){return e[t]}).join(" ").trim()},e.isDefaultEffects=function(e){return i.isEqual(this.getDefaults(),e)},e.getDefaults=function(){var e={};return e[this.BRIGHTNESS.NAME]=this.BRIGHTNESS.DEFAULT,e[this.CONTRAST.NAME]=this.CONTRAST.DEFAULT,e[this.HUE.NAME]=this.HUE.DEFAULT,e[this.SATURATION.NAME]=this.SATURATION.DEFAULT,e[this.SEPIA.NAME]=this.SEPIA.DEFAULT,e[this.INVERT.NAME]=this.INVERT.DEFAULT,e},e.BRIGHTNESS={NAME:"brightness",MIN:-100,MAX:100,DEFAULT:0,UNIT:"%"},e.CONTRAST={NAME:"contrast",MIN:-100,MAX:100,DEFAULT:0,UNIT:"%"},e.HUE={NAME:"hue-rotate",MIN:-180,MAX:180,DEFAULT:0,UNIT:"deg"},e.SATURATION={NAME:"saturate",MIN:-100,MAX:100,DEFAULT:0,UNIT:"%"},e.SEPIA={NAME:"sepia",MIN:0,MAX:100,DEFAULT:0,UNIT:"%"},e.INVERT={NAME:"invert",MIN:0,MAX:100,DEFAULT:0,UNIT:"%"},e}();t.ImageEffects=r}})}),define("@frontend/common/libs/BlendingModes",["lodash"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=162)}({0:function(t,n){t.exports=e},162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r,o=n(0);!function(e){e.NORMAL="normal",e.MULTIPLY="multiply",e.SCREEN="screen",e.OVERLAY="overlay",e.DARKEN="darken",e.LIGHTEN="lighten",e.COLOR_DODGE="color-dodge",e.COLOR_BURN="color-burn",e.HARD_LIGHT="hard-light",e.SOFT_LIGHT="soft-light",e.DIFFERENCE="difference",e.EXCLUSION="exclusion",e.HUE="hue",e.SATURATION="saturation",e.COLOR="color",e.LUMINOSITY="luminosity"}(i=t.BlendingModeName||(t.BlendingModeName={})),function(e){e.NORMAL="Normal",e.MULTIPLY="Multiply",e.SCREEN="Screen",e.OVERLAY="Overlay",e.DARKEN="Darken",e.LIGHTEN="Lighten",e.COLOR_DODGE="Color Dodge",e.COLOR_BURN="Color Burn",e.HARD_LIGHT="Hard Light",e.SOFT_LIGHT="Soft Light",e.DIFFERENCE="Difference",e.EXCLUSION="Exclusion",e.HUE="Hue",e.SATURATION="Saturation",e.COLOR="Color",e.LUMINOSITY="Luminosity"}(r=t.BlendingModeDisplayName||(t.BlendingModeDisplayName={}));var a,s=["image/jpeg","image/jpg","image/png","image/gif"],u=["jpeg","jpg","png","gif"];!function(e){e.PREVIOUS="previous",e.NEXT="next"}(a||(a={}));var l=function(){function e(){}return e.getBlendingModeChoices=function(){return[this.NORMAL,this.DARKEN,this.MULTIPLY,this.COLOR_BURN,this.LIGHTEN,this.SCREEN,this.COLOR_DODGE,this.OVERLAY,this.SOFT_LIGHT,this.HARD_LIGHT,this.DIFFERENCE,this.EXCLUSION]},e.getGroupedBlendingModeChoices=function(){return[[this.NORMAL],[this.DARKEN,this.MULTIPLY,this.COLOR_BURN],[this.LIGHTEN,this.SCREEN,this.COLOR_DODGE],[this.OVERLAY,this.SOFT_LIGHT,this.HARD_LIGHT],[this.DIFFERENCE,this.EXCLUSION]]},e.getDefault=function(){return this.NORMAL.value},e.isDefaultBlendingMode=function(e){return this.getDefault()===e},e.getAdjacentMode=function(e,t){var n=this.getBlendingModeChoices(),i=o.findIndex(n,{value:e}),r=0===i,s=i===n.length-1,u=-1===i;return t===a.PREVIOUS?u||r?null:n[i-1].value:u||s?null:n[i+1].value},e.getPreviousMode=function(e){return this.getAdjacentMode(e,a.PREVIOUS)},e.getNextMode=function(e){return this.getAdjacentMode(e,a.NEXT)},e.getTotalModes=function(){return this.getBlendingModeChoices().length},e.isSupportedImageType=function(e,t){if("string"==typeof e)return s.indexOf(e.toLowerCase())>-1;var n=t.split("."),i=n[n.length-1].toLowerCase();return u.indexOf(i)>-1},e.NORMAL={value:i.NORMAL,title:r.NORMAL},e.MULTIPLY={value:i.MULTIPLY,title:r.MULTIPLY},e.SCREEN={value:i.SCREEN,title:r.SCREEN},e.OVERLAY={value:i.OVERLAY,title:r.OVERLAY},e.DARKEN={value:i.DARKEN,title:r.DARKEN},e.LIGHTEN={value:i.LIGHTEN,title:r.LIGHTEN},e.COLOR_DODGE={value:i.COLOR_DODGE,title:r.COLOR_DODGE},e.COLOR_BURN={value:i.COLOR_BURN,title:r.COLOR_BURN},e.HARD_LIGHT={value:i.HARD_LIGHT,title:r.HARD_LIGHT},e.SOFT_LIGHT={value:i.SOFT_LIGHT,title:r.SOFT_LIGHT},e.DIFFERENCE={value:i.DIFFERENCE,title:r.DIFFERENCE},e.EXCLUSION={value:i.EXCLUSION,title:r.EXCLUSION},e.HUE={value:i.HUE,title:r.HUE},e.SATURATION={value:i.SATURATION,title:r.SATURATION},e.COLOR={value:i.COLOR,title:r.COLOR},e.LUMINOSITY={value:i.LUMINOSITY,title:r.LUMINOSITY},e}();t.BlendingModes=l}})}),define("@frontend/player/utils/KeepAlive",["jquery","globals"],function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=120)}({120:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(9),o=function(){var e=this;this.POLL_TIMEOUT=1e4,this.STATUS_SESSION_ENDED=410,this.STATUS_CONCURRENT_LOGIN=409,this.KEEP_ALIVE_URL="/rest/v1/keep-alive",this.pollForSession=function(){i.get(e.KEEP_ALIVE_URL).then(e.setPollTimeout).catch(e.onError)},this.setPollTimeout=function(){setTimeout(e.pollForSession,e.POLL_TIMEOUT)},this.onError=function(t){e.redirectToLogin(t.status)},this.redirectToLogin=function(t){var n="";switch(t){case e.STATUS_SESSION_ENDED:n="invalidSession";break;case e.STATUS_CONCURRENT_LOGIN:n="concurrentLogin"}var i=r.adminUrl+"/signin";n.length>0&&(i+="?"+n+"=yes"),e.redirect(i)},this.redirect=function(e){window.location.replace(e)}};t.KeepAlive=o},4:function(e,t){e.exports=require("jquery")},9:function(e,t){e.exports=require("globals")}})}),define("modules/page/utils/PlayerVariantService",["lodash","backbone","jquery","log","globals","urlUtils","cerosMath","shared/utils/NavigationUtils"],function(e,t,n,i,r,o,a,s){"use strict";var u,l={tablet:{height:4,width:3},mobile:{height:16,width:9}},c={tablet:{height:1.2,width:1.11},mobile:{height:1.2,width:1.11},desktop:{height:1,width:1}},d={tablet:110,mobile:90,desktop:70},h={tablet:50,mobile:50,desktop:0},f=["desktop","tablet","mobile"],p={CHANGE_PREVIEWER_FRAME_SIZE:"changePreviewerFrameSize",UPDATE_URL:"updateUrl",RELOAD_TRIGGERED:"reloadTriggered"};return e.extend({},t.Events,{fullScreenMode:!1,previewerFrameSize:"desktop",triggerReload:function(){u.trigger("reload"),this.trigger(p.RELOAD_TRIGGERED)},setPreviewerFrameSize:function(e){this.previewerFrameSize=e,this.triggerFrameSizeUrlUpdate(e),this.trigger(this.EVENTS.CHANGE_PREVIEWER_FRAME_SIZE,{variant:e})},getPreviewerFrameSize:function(){return this.previewerFrameSize},setDocVersion:function(e){u=e},isDocVersionSet:function(){return!e.isUndefined(u)},doesVariantExist:function(t){return e.includes(e.keys(u.get("overrides")),t)},hasVariants:function(){return r.allowAdaptiveLayouts&&this.getNumberOfExistingVariants()>0},getNumberOfExistingVariants:function(){return e.keys(u.get("overrides")).length},getExistingVariants:function(){return e.keys(u.get("overrides"))},getLayoutSettings:function(){return u.get("layoutSettings")},isViewportWidthDetection:function(){return"viewport-width"===this.getLayoutSettings().layoutPrimarySetting},getExperienceContainerDimensions:function(e){var t=this.fullScreenMode;if(r.previewMode&&r.allowAdaptiveLayouts&&!t){var n=this.getPreviewerFrameSize(),i=e.height()-(d[n]+h[n]),o=Math.max(i/c[n].height,300),s="desktop"===n?e.width():o*(l[n].width/l[n].height);return{width:a.toNextMultiple(s,2),height:a.toNextMultiple(o,2)}}return{width:e.width(),height:e.height()}},getExperienceContainerWidth:function(e){return this.getExperienceContainerDimensions(e).width},getExperienceContainerHeight:function(e){return this.getExperienceContainerDimensions(e).height},detectPreviewerFrameSizeFromUrl:function(){if(r.previewMode&&r.allowAdaptiveLayouts){var e=this.getPreviewerFrameSize(),t=this.getFrameSizeFromUrl();i.debug("Previewer frame size based on URL: "+t),this.isValidFrameSize(t)?t!==e&&this.setPreviewerFrameSize(t):(i.debug("Frame size from URL is invalid, updating URL to default frame size"),this.triggerFrameSizeUrlUpdate("desktop"))}},triggerFrameSizeUrlUpdate:function(e){this.trigger(this.EVENTS.UPDATE_URL,e)},getFrameSizeFromUrl:function(){return this.hasFrameSizeOnUrl()?s.parseLayoutFromLocation():"desktop"},hasFrameSizeOnUrl:function(){return!!s.parseLayoutFromLocation()},isValidVariantName:function(t){return e.includes(f,t)},isValidFrameSize:function(e){return this.isValidVariantName(e)},getLeftRightBorderWidth:function(e,t,n){return(n||this.getExperienceContainerDimensions(e).width)*(c[t].width-1)/2},getTopBottomBorderWidth:function(e,t,n){return(n||this.getExperienceContainerDimensions(e).height)*(c[t].height-1)/2},setFullScreenMode:function(e){this.fullScreenMode=e;var t=n(".adaptive-layouts-frame");this.fullScreenMode?(n(".previewer-selection-header").hide(),t.addClass("-full-screen-mode"),t.css({width:n(window).width(),height:n(window).height()}),n(window).trigger("resize")):(n(".previewer-selection-header").show(),t.removeClass("-full-screen-mode"),n(window).trigger("resize"))},VALID_VARIANT_NAMES:f,PREVIEWER_TOP_PADDING_BY_VARIANT:d,PREVIEWER_FRAME_PROPORTION_FACTORS_BY_VARIANT:c,EVENTS:p})}),function(e,t){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?t(exports):"function"==typeof define&&define.amd?define("mustache",["exports"],t):(e.Mustache={},t(e.Mustache))}(this,function(e){function t(e){return"function"==typeof e}function n(e){return g(e)?"array":typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"==typeof e&&t in e}function o(e,t){return m.call(e,t)}function a(e){return!o(v,e)}function s(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return y[e]})}function u(t,n){function r(e){if("string"==typeof e&&(e=e.split(w,2)),!g(e)||2!==e.length)throw new Error("Invalid tags: "+e);o=new RegExp(i(e[0])+"\\s*"),s=new RegExp("\\s*"+i(e[1])),u=new RegExp("\\s*"+i("}"+e[1]))}if(!t)return[];var o,s,u,h=[],f=[],p=[],m=!1,v=!1;r(n||e.tags);for(var y,T,P,A,I,x,O=new d(t);!O.eos();){if(y=O.pos,P=O.scanUntil(o))for(var C=0,R=P.length;C<R;++C)A=P.charAt(C),a(A)?p.push(f.length):v=!0,f.push(["text",A,y,y+1]),y+=1,"\n"===A&&function(){if(m&&!v)for(;p.length;)delete f[p.pop()];else p=[];m=!1,v=!1}();if(!O.scan(o))break;if(m=!0,T=O.scan(S)||"name",O.scan(b),"="===T?(P=O.scanUntil(_),O.scan(_),O.scanUntil(s)):"{"===T?(P=O.scanUntil(u),O.scan(E),O.scanUntil(s),T="&"):P=O.scanUntil(s),!O.scan(s))throw new Error("Unclosed tag at "+O.pos);if(I=[T,P,y,O.pos],f.push(I),"#"===T||"^"===T)h.push(I);else if("/"===T){if(!(x=h.pop()))throw new Error('Unopened section "'+P+'" at '+y);if(x[1]!==P)throw new Error('Unclosed section "'+x[1]+'" at '+y)}else"name"===T||"{"===T||"&"===T?v=!0:"="===T&&r(P)}if(x=h.pop())throw new Error('Unclosed section "'+x[1]+'" at '+O.pos);return c(l(f))}function l(e){for(var t,n,i=[],r=0,o=e.length;r<o;++r)(t=e[r])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(i.push(t),n=t));return i}function c(e){for(var t,n,i=[],r=i,o=[],a=0,s=e.length;a<s;++a)switch(t=e[a],t[0]){case"#":case"^":r.push(t),o.push(t),r=t[4]=[];break;case"/":n=o.pop(),n[5]=t[2],r=o.length>0?o[o.length-1][4]:i;break;default:r.push(t)}return i}function d(e){this.string=e,this.tail=e,this.pos=0}function h(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function f(){this.cache={}}var p=Object.prototype.toString,g=Array.isArray||function(e){return"[object Array]"===p.call(e)},m=RegExp.prototype.test,v=/\S/,y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},b=/\s*/,w=/\s+/,_=/\s*=/,E=/\s*\}/,S=/#|\^|\/|>|\{|&|=|!/;d.prototype.eos=function(){return""===this.tail},d.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},d.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},h.prototype.push=function(e){return new h(e,this)},h.prototype.lookup=function(e){var n,i=this.cache;if(i.hasOwnProperty(e))n=i[e];else{for(var o,a,s=this,u=!1;s;){if(e.indexOf(".")>0)for(n=s.view,o=e.split("."),a=0;null!=n&&a<o.length;)a===o.length-1&&(u=r(n,o[a])),n=n[o[a++]];else n=s.view[e],u=r(s.view,e);if(u)break;s=s.parent}i[e]=n}return t(n)&&(n=n.call(this.view)),n},f.prototype.clearCache=function(){this.cache={}},f.prototype.parse=function(e,t){var n=this.cache,i=n[e];return null==i&&(i=n[e]=u(e,t)),i},f.prototype.render=function(e,t,n){var i=this.parse(e),r=t instanceof h?t:new h(t);return this.renderTokens(i,r,n,e)},f.prototype.renderTokens=function(e,t,n,i){for(var r,o,a,s="",u=0,l=e.length;u<l;++u)a=void 0,r=e[u],o=r[0],"#"===o?a=this.renderSection(r,t,n,i):"^"===o?a=this.renderInverted(r,t,n,i):">"===o?a=this.renderPartial(r,t,n,i):"&"===o?a=this.unescapedValue(r,t):"name"===o?a=this.escapedValue(r,t):"text"===o&&(a=this.rawValue(r)),void 0!==a&&(s+=a);return s},f.prototype.renderSection=function(e,n,i,r){function o(e){return a.render(e,n,i)}var a=this,s="",u=n.lookup(e[1]);if(u){if(g(u))for(var l=0,c=u.length;l<c;++l)s+=this.renderTokens(e[4],n.push(u[l]),i,r);else if("object"==typeof u||"string"==typeof u||"number"==typeof u)s+=this.renderTokens(e[4],n.push(u),i,r);else if(t(u)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");u=u.call(n.view,r.slice(e[3],e[5]),o),null!=u&&(s+=u)}else s+=this.renderTokens(e[4],n,i,r);return s}},f.prototype.renderInverted=function(e,t,n,i){var r=t.lookup(e[1]);if(!r||g(r)&&0===r.length)return this.renderTokens(e[4],t,n,i)},f.prototype.renderPartial=function(e,n,i){if(i){var r=t(i)?i(e[1]):i[e[1]];return null!=r?this.renderTokens(this.parse(r),n,i,r):void 0}},f.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},f.prototype.escapedValue=function(t,n){var i=n.lookup(t[1]);if(null!=i)return e.escape(i)},f.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.2.1",e.tags=["{{","}}"];var T=new f;e.clearCache=function(){return T.clearCache()},e.parse=function(e,t){return T.parse(e,t)},e.render=function(e,t,i){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+n(e)+'" was given as the first argument for mustache#render(template, view, partials)');return T.render(e,t,i)},e.to_html=function(n,i,r,o){var a=e.render(n,i,r);if(!t(o))return a;o(a)},e.escape=s,e.Scanner=d,e.Context=h,e.Writer=f}),define("modules/page/utils/PlayerVariantDetector",["lodash","jquery","backbone","device","globals","log","modules/page/utils/PlayerVariantService","shared/models/EmbeddedViewportModel"],function(e,t,n,i,r,o,a,s){"use strict";function u(){var e=i.deviceType();return"smartphone"===e&&(e="mobile"),e}var l,c=function(){var e=window.innerWidth;return h(e)},d=function(){var e=s.getInstance().getEmbedContextDimensions();return h(e.width)},h=function(e){var t=a.getLayoutSettings();return a.doesVariantExist("mobile")&&e<=t.maxMobileWidthBreakpoint?"mobile":a.doesVariantExist("tablet")&&e<=t.maxTabletWidthBreakpoint?"tablet":"desktop"},f=function(){var e=a.getLayoutSettings(),n=u(),r=n!==i.DEVICE_TYPE_DESKTOP;if("device-type"===e.layoutPrimarySetting){if(r){var s=p(e,n);return o.debug("Resolved layout for touch device: "+n),s!==a.getPreviewerFrameSize()&&(o.debug("Forcing frame size as on touch device: "+s),a.setPreviewerFrameSize(s)),s}var l=a.getPreviewerFrameSize();return m(l)}var c=t(".adaptive-layouts-frame").width();return h(c)},p=function(e,t){return a.doesVariantExist(t)?t:a.doesVariantExist(e.deviceTypeMissingVariantFallback)?e.deviceTypeMissingVariantFallback:"desktop"},g=function(){return m(u())},m=function(e){var t=a.getLayoutSettings();return 0!==a.getNumberOfExistingVariants()&&a.isValidVariantName(e)?"desktop"===e||a.doesVariantExist(e)?e:v(t.deviceTypeMissingVariantFallback):"desktop"},v=function(e){return a.doesVariantExist(e)?e:(o.info("FALLBACK RECTIFIED"),"tablet"===e?"desktop":"mobile"===e&&a.doesVariantExist("tablet")?"tablet":"desktop")},y=function(){if(!r.allowAdaptiveLayouts)return"desktop";if(!a.isDocVersionSet())throw new Error("Trying to resolve variant before DocVersion set");return 0===a.getNumberOfExistingVariants()?"desktop":r.previewMode?f():"device-type"===a.getLayoutSettings().layoutPrimarySetting?g():r.isEmbedded?d():c()};return e.extend({},n.Events,{getVariant:function(){if(!l)throw new Error("Something wants to know the variant before detection");return l},hasDetectedVariant:function(){return!!l},detect:function(){var e=y();if(e!==l){var t=l;l=e,o.debug("Detected variant "+e+(t?", was "+t:"")),this.trigger("change",l,t)}return l}})}),define("text",["module"],function(e){"use strict";var t,n,i,r,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,c=l&&location.protocol&&location.protocol.replace(/\:/,""),d=l&&location.hostname,h=l&&(location.port||void 0),f={},p=e.config&&e.config()||{};return t={version:"2.0.14",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(u);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){n=a[t];try{e=new ActiveXObject(n)}catch(e){}if(e){a=[n];break}}return e},parseName:function(e){var t,n,i,r=!1,o=e.lastIndexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!a||o>1)?(t=e.substring(0,o),n=e.substring(o+1)):t=e,i=n||t,o=i.indexOf("!"),-1!==o&&(r="strip"===i.substring(o+1),i=i.substring(0,o),n?n=i:t=i),{moduleName:t,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,r){var o,a,s,u=t.xdRegExp.exec(e);return!u||(o=u[2],a=u[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==n||a&&a.toLowerCase()!==i.toLowerCase()||(s||a)&&s!==r))},finishLoad:function(e,n,i,r){i=n?t.strip(i):i,p.isBuild&&(f[e]=i),r(i)},load:function(e,n,i,r){if(r&&r.isBuild&&!r.inlineText)return void i();p.isBuild=r&&r.isBuild;var o=t.parseName(e),a=o.moduleName+(o.ext?"."+o.ext:""),s=n.toUrl(a),u=p.useXhr||t.useXhr;if(0===s.indexOf("empty:"))return void i();!l||u(s,c,d,h)?t.get(s,function(n){t.finishLoad(e,o.strip,n,i)},function(e){i.error&&i.error(e)}):n([a],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)})},write:function(e,n,i,r){if(f.hasOwnProperty(n)){var o=t.jsEscape(f[n]);i.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,i,r,o){var a=t.parseName(n),s=a.ext?"."+a.ext:"",u=a.moduleName+s,l=i.toUrl(a.moduleName+s)+".js";t.load(u,i,function(n){var i=function(e){return r(l,e)};i.asModule=function(e,t){return r.asModule(e,l,t)},t.write(e,u,i,o)},o)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var r=n.readFileSync(e,"utf8");"\ufeff"===r[0]&&(r=r.substring(1)),t(r)}catch(e){i&&i(e)}}):"xhr"===p.env||!p.env&&t.createXhr()?t.get=function(e,n,i,r){var o,a=t.createXhr();if(a.open("GET",e,!0),r)for(o in r)r.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),r[o]);p.onXhr&&p.onXhr(a,e),a.onreadystatechange=function(t){var r,o;4===a.readyState&&(r=a.status||0,r>399&&r<600?(o=new Error(e+" HTTP status: "+r),o.xhr=a,i&&i(o)):n(a.responseText),p.onXhrComplete&&p.onXhrComplete(a,e))},a.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,r=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),"utf-8")),s="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=a.readLine());)n.append(o),n.append(i);s=String(n.toString())}finally{a.close()}t(s)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,r=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,a,s,u={};o&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),n.init(s,1,0,!1),a=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),a.init(n,"utf-8",n.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(n.available(),u),a.close(),n.close(),t(u.value)}catch(e){throw new Error((s&&s.path||"")+": "+e)}}),t}),define("text!applications/html5-player/templates/previewer-selection.html",[],function(){
return'<ul class="previewer-options-list {{#allLayoutsExist}}-all-layouts-exist{{/allLayoutsExist}}">\n    <li class="previewer-variant-option desktop-option" data-option="desktop">\n        <div class="desktop-option-icon"></div>\n    </li>\n    {{#showTablet}}\n    <li class="previewer-variant-option tablet-option" data-option="tablet">\n        <div class="tablet-option-icon"></div>\n    </li>\n    {{/showTablet}}\n    {{#showMobile}}\n    <li class="previewer-variant-option mobile-option" data-option="mobile">\n        <div class="mobile-option-icon"></div>\n    </li>\n    {{/showMobile}}\n    <li class="reload-container">\n        <div\n            title="To replay animations press \'Option+R\' on Mac or \'Alt+R\' on Windows"\n            class="ceros-icon ceros-replay-icon reload-btn">\n        </div>\n    </li>\n\n</ul>\n'}),define("applications/html5-player/PreviewerSelectionView",["backbone","mustache","lodash","jquery","modules/page/utils/PlayerVariantService","modules/page/utils/PlayerVariantDetector","text!applications/html5-player/templates/previewer-selection.html"],function(e,t,n,i,r,o,a){"use strict";return e.View.extend({events:{"click .previewer-variant-option":"handleOptionClick","click .reload-btn":"reloadExperience"},initialize:function(){var e=r.isViewportWidthDetection();this.$el.show(),this.$el.html(t.render(a,{showTablet:!e||r.doesVariantExist("tablet"),showMobile:!e||r.doesVariantExist("mobile"),allLayoutsExist:!e||2===r.getNumberOfExistingVariants()})),o.on("change",n.bind(this.updateIcons,this)),r.on(r.EVENTS.CHANGE_PREVIEWER_FRAME_SIZE,n.bind(this.updateIcons,this)),r.on(r.EVENTS.RELOAD_TRIGGERED,n.bind(this.loadSpinner,this)),this.updateIcons()},updateIcons:function(){var e=r.getPreviewerFrameSize();this.$el.find(".previewer-variant-option").removeClass("-selected");var t="."+e+"-option";this.$el.find(t).addClass("-selected")},handleOptionClick:function(e){var t=i(e.currentTarget),n=t.data("option");n!==r.getPreviewerFrameSize()&&r.setPreviewerFrameSize(n)},showSpinner:function(){this.$(".reload-container div").removeClass("ceros-replay-icon").addClass("loader-spinner")},hideSpinner:function(){this.$(".reload-container div").removeClass("loader-spinner").addClass("ceros-replay-icon")},loadSpinner:function(){this.showSpinner(),setTimeout(n.bind(this.hideSpinner,this),750)},reloadExperience:function(){r.isDocVersionSet()&&(r.triggerReload(),this.loadSpinner())}})}),function(e,t){"use strict";"undefined"!=typeof exports?t(exports):"function"==typeof define&&define.amd?define("utils/Keycodes",["exports"],t):t(e)}(this,function(e){"use strict";return e.Keycodes={NIL:0,ESC:27,SHIFT:16,CTRL:17,LEFT_CMD:91,RIGHT_CMD:93,CMD_FIREFOX:224,ALT:18,RETURN:13,ENTER:13,BACKSPACE:8,DELETE:46,SPACE:32,TAB:9,HOME:36,END:35,RIGHT_ARROW:39,LEFT_ARROW:37,UP_ARROW:38,DOWN_ARROW:40,EQUALS_FF:61,EQUALS_WEBKIT:187,MINUS_FF:173,MINUS_WEBKIT:189,ZERO:48,ONE:49,SEMICOLON:186,SEMICOLON_FIREFOX:59,BRACKET_OPEN:219,BRACKET_CLOSE:221,SINGLE_QUOTE:222,A:65,C:67,D:68,E:69,G:71,H:72,I:73,J:74,K:75,L:76,P:80,R:82,V:86,X:88,Y:89,Z:90,COMMA:188,PERIOD:190},e.Keycodes}),define("utils/KeyboardUtils",["device","utils/Keycodes"],function(e,t){"use strict";var n={isMetaKeyPressed:function(t){return e.isMac()?t.metaKey:t.ctrlKey},isAltKeyPressed:function(e){return e.altKey||e.which===t.ALT&&"keydown"===e.type},isCtrlKeyPressed:function(e){return e.ctrlKey},isCtrlOnWindowsOrAltOnMacsPressed:function(t){return e.isWindows()?t.ctrlKey:this.isAltKeyPressed(t)},isSemicolonKeyPressed:function(n){var i=e.mozilla?t.SEMICOLON_FIREFOX:t.SEMICOLON;return n.which===i},isMacCtrlKeyPressed:function(t){return!!e.isMac()&&t.ctrlKey},isDeleteKeyPressed:function(e){return e.which===t.DELETE},isBackspaceKeyPressed:function(e){return e.which===t.BACKSPACE},isEscKeyPressed:function(e){return e.which===t.ESC},isEnterKeyPressed:function(e){return e.which===t.ENTER},isArrowKey:function(e){return e==t.RIGHT_ARROW||e==t.LEFT_ARROW||e==t.UP_ARROW||e==t.DOWN_ARROW},isShiftKeyPressed:function(e){return e.shiftKey||e.which===t.SHIFT},isAKeyPressed:function(e){return e.which===t.A},isEKeyPressed:function(e){return e.which===t.E},isGKeyPressed:function(e){return e.which===t.G},isRKeyPressed:function(e){return e.which===t.R},isOptionRPressed:function(e){return n.isAltKeyPressed(e)&&n.isRKeyPressed(e)},isCommandZPressed:function(e){return n.isMetaKeyPressed(e)&&e.which===t.Z},isUndoCombinationPressed:function(e){return n.isCommandZPressed(e)&&!e.shiftKey},isCommandYPressed:function(e){return n.isMetaKeyPressed(e)&&e.which===t.Y},isCommandShiftQuotePressed:function(e){return n.isMetaKeyPressed(e)&&n.isShiftKeyPressed(e)&&e.which===t.SINGLE_QUOTE},isAltLPressed:function(e){return n.isAltKeyPressed(e)&&e.which===t.L},isCommandShiftZPressed:function(e){return n.isCommandZPressed(e)&&e.shiftKey},isRedoCombinationPressed:function(e){return n.isCommandYPressed(e)||n.isCommandShiftZPressed(e)},isHKeyPressed:function(e){return e.which===t.H},isPKeyPressed:function(e){return e.which===t.P},isInputNavigation:function(e){return-1!==[t.DELETE,t.BACKSPACE,t.TAB,t.ESCAPE,t.ENTER,t.SHIFT,t.CTRL,t.LEFT_CMD].indexOf(e.which)||-1!==[t.A,t.C,t.R,t.X,t.Z].indexOf(e.which)&&this.isMetaKeyPressed(e)||-1!==[t.HOME,t.END,t.LEFT_ARROW,t.RIGHT_ARROW].indexOf(e.which)},isZoomCommand:function(e){return this.isMetaKeyPressed(e)&&(e.which===t.EQUALS_WEBKIT||e.which===t.EQUALS_FF||e.which===t.MINUS_WEBKIT||e.which===t.MINUS_FF||e.which===t.ONE||e.which===t.ZERO)},isInteger:function(e){return e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105},isLetter:function(e){return e.keyCode>=65&&e.keyCode<=90}};return n}),define("applications/html5-player/AdaptiveLayoutsPreviewerFrameView",["jquery","backbone","lodash","cookie","globals","text!applications/html5-player/templates/previewer-selection.html","modules/page/utils/PlayerVariantService","modules/page/utils/PlayerVariantDetector","utils/KeyboardUtils","device"],function(e,t,n,i,r,o,a,s,u,l){"use strict";return t.View.extend({initialize:function(){var t=this;this.$previewerSelectionHeaderEl=e(".previewer-selection-header"),this.frameName=a.getPreviewerFrameSize(),this.$el.addClass("-"+this.frameName),this.onlyAllowFullscreenMode=r.isMarkup,this.styleFrame(),e(window).on("resize",function(){t.styleFrame()});var n=localStorage.getItem(r.issue.slug+"-fullscreen-preview");(this.onlyAllowFullscreenMode||"true"===n)&&this.turnOnFullscreenMode(this),this.$el.addClass("-initialized"),e(window).on("keyup",function(n){u.isOptionRPressed(n)&&t.reloadExperience(),t.onlyAllowFullscreenMode||(e(document.activeElement).is("input")||!u.isHKeyPressed(n)||a.fullScreenMode?(u.isEscKeyPressed(n)||u.isHKeyPressed(n))&&a.fullScreenMode&&t.turnOffFullscreenMode(t):t.turnOnFullscreenMode(t))}),a.on(a.EVENTS.CHANGE_PREVIEWER_FRAME_SIZE,function(n){t.$el.removeClass("-"+t.frameName),t.frameName=n.variant,t.$el.addClass("-"+t.frameName),t.styleFrame(),s.detect(),e(window).trigger("resize")})},reloadExperience:function(){a.isDocVersionSet()&&a.triggerReload()},turnOnFullscreenMode:function(t){localStorage.setItem(r.issue.slug+"-fullscreen-preview","true"),a.setFullScreenMode(!0),t.$previewerSelectionHeaderEl.hide(),t.$el.addClass("-full-screen-mode"),t.$el.css({width:e(window).width(),height:e(window).height()}),e(window).trigger("resize")},turnOffFullscreenMode:function(t){localStorage.setItem(r.issue.slug+"-fullscreen-preview","false"),a.setFullScreenMode(!1),t.$previewerSelectionHeaderEl.show(),t.$el.removeClass("-full-screen-mode"),e(window).trigger("resize")},getThemeBackgroundColor:function(){return n.get(r,["themeObj","backgroundColor"],null)},styleFrame:function(){var t=e(window);if(a.fullScreenMode)return void this.$el.css({width:t.width(),height:t.height()});var n=a.getExperienceContainerDimensions(t);if(this.$el.css({width:n.width,height:n.height,backgroundColor:this.getThemeBackgroundColor()}),"desktop"!==this.frameName){var i=a.getTopBottomBorderWidth(e(window),this.frameName,n.height),r=a.getLeftRightBorderWidth(e(window),this.frameName,n.width),o=Math.round(i),s=Math.round(r);this.$el.css({"border-top-width":o,"border-bottom-width":o,"border-left-width":s,"border-right-width":s})}},showFadingHelpMessage:function(){if(!this.onlyAllowFullscreenMode){var t=i.get("shownPreviewerFadingHelpMessage");l.mobile()||t||(e(".fit-to-window-help-message").show().delay(3e3).fadeOut(400),i.set("shownPreviewerFadingHelpMessage","1"))}}})}),define("text!applications/html5-player/templates/infobar.html",[],function(){return'<div class="infobar">\n    <div class="container clearfix">\n        <span class="message">{{msg}}</span>\n        <a title="close" class="close"></a>\n    </div>\n</div>\n'}),define("applications/html5-player/InfoBarView",["jquery","backbone","mustache","text!applications/html5-player/templates/infobar.html"],function(e,t,n,i){"use strict";return t.View.extend({events:{"click .close":"handleClose"},initialize:function(){this.$el.html(n.render(i,{}))},showMessage:function(e){this.$el.find(".message").text(e),this.show()},show:function(){this.$el.find(".infobar").show()},hide:function(){this.$el.find(".infobar").hide()},handleClose:function(){this.hide()}})}),define("ceros",["require","lodash","jquery","backbone"],function(e,t,n,i){"use strict";var r={};return r.Module=function(e){t.extend(this,e),this.status=r.Module.STATUS.PENDING,e.delegate&&this.setDelegate(e.delegate)},t.extend(r.Module.prototype,i.Events,{setDelegate:function(e){if(!t.isObject(e))throw Error("invalid module delegate!");for(var n in e)!this.hasOwnProperty(n)&&e.hasOwnProperty(n)&&t.isFunction(e[n])&&(this[n]=t.bind(e[n],e))},getModule:function(e){return this.application.getModule(e)},setApplication:function(e){this.application=e},getApplication:function(){return this.application},getDependency:function(e){return this.application.getModule(e)},setStatus:function(e){this.status=e},getStatus:function(){return this.status},getDeferredLoadingTimeout:function(){return r.Application.DEFERRED_LOADING_TIMEOUT}}),r.Module.extend=i.View.extend,r.Module.STATUS={PENDING:1,LOADED:2,STARTED:4},r.Application=function(e){this.initCallbacks=new r.Callbacks,this.modules={};var i=this;this.loadedAllModules=(new n.Deferred).progress(function(e){i._loadModule(e),i._allLoaded()&&this.resolve()}),t.extend(this,e)},t.extend(r.Application.prototype,i.Events,{_allLoaded:function(){return t.every(t.values(this.modules),function(e){return e&&e.getStatus()===r.Module.STATUS.LOADED})},_loadModule:function(e){if(t.isUndefined(e)||t.isNull(e))throw Error("invalid module!");this.modules[e.id]=e,e.setApplication(this),e.trigger("load"),e.setStatus(r.Module.STATUS.LOADED),this.addInitializer(function(){e.trigger("start"),e.setStatus(r.Module.STATUS.STARTED)})},use:function(n){t.isString(n)?(this.modules[n]=null,e(["modules/"+n+"/module"],t.bind(function(e){if(!e)throw Error("could not load module: "+n);this.loadedAllModules.notify(e)},this))):this._loadModule(n)},getModule:function(e){return this.modules[e]},addInitializer:function(e){this.initCallbacks.add(e)},start:function(e){var i=t.bind(function(){this.trigger("initialize:before",e),this.initCallbacks.run(e,this),this.trigger("initialize:after",e),this.trigger("start",e)},this);this._allLoaded()?i():n.when(this.loadedAllModules).then(i)}}),r.Application.extend=i.View.extend,r.Application.DEFERRED_LOADING_TIMEOUT=5e3,r.Callbacks=function(){this.deferred=n.Deferred(),this.promise=this.deferred.promise()},t.extend(r.Callbacks.prototype,{add:function(e,t){this.promise.done(function(n,i){t&&(n=t),e.call(n,i)})},run:function(e,t){this.deferred.resolve(t,e)}}),r}),function(e,t){"use strict";"undefined"!=typeof exports?t(exports,require("lodash")):"function"==typeof define&&define.amd?define("color",["exports","lodash"],t):t(e,e._)}(this,function(e,t){"use strict";var n=function(e,n,i,r){var o=parseFloat(r);return(t.isUndefined(r)||t.isNaN(o))&&(o=1),null!==e&&(this.r=parseInt(e,10)),null!==n&&(this.g=parseInt(n,10)),null!==i&&(this.b=parseInt(i,10)),this.a=o,this};return n.prototype={toHex:function(){var e;return null===this.r||null===this.g||null===this.b?"transparent":(e=(this.b|this.g<<8|this.r<<16).toString(16),e="#"+"000000".substr(0,6-e.length)+e,e.toUpperCase())},isTransparent:function(){return!this.a},set:function(e){return t.each(e,t.bind(function(e,t){this[t]=e},this)),this},hsv:function(){var e={h:0,s:0,v:0},t=this.r/255,n=this.g/255,i=this.b/255,r=Math.min(t,Math.min(n,i)),o=Math.max(t,Math.max(n,i));if(r==o)return e.v=r,e;var a=t==r?n-i:i==r?t-n:i-t,s=t==r?3:i==r?1:5;return e.h=60*(s-a/(o-r)),e.s=(o-r)/o,e.v=o,e},rgb:function(){return{r:this.r,g:this.g,b:this.b}},rgba:function(){return{r:this.r,g:this.g,b:this.b,a:this.a}},cmyk:function(){var e={c:0,m:0,y:0,k:0},t=this.r/255,n=this.g/255,i=this.b/255;return e.k=Math.min(1-t,1-n,1-i),e.c=(1-t-e.k)/(1-e.k),e.m=(1-n-e.k)/(1-e.k),e.y=(1-i-e.k)/(1-e.k),isNaN(e.c)&&(e.c=0),isNaN(e.m)&&(e.m=0),isNaN(e.y)&&(e.y=0),e.c=Math.round(100*e.c),e.m=Math.round(100*e.m),e.y=Math.round(100*e.y),e.k=Math.round(100*e.k),e},contrastRatio:function(e){e=n.fromString(e);var t=this.relativeLuminance(),i=e.relativeLuminance();if(t<i){var r=t;t=i,i=r}return(t+.05)/(i+.05)},relativeLuminance:function(){var e=function(e){return e<.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)};return.2126*e(this.r/255)+.7152*e(this.g/255)+.0722*e(this.b/255)},clone:function(){return new n(this.r,this.g,this.b,this.a)},cloneWithAlpha:function(e){var t=this.clone();return t.a=e,t},toString:function(){return null!==this.r&&null!==this.g&&null!==this.b?null!==this.a&&1!==this.a?"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a+")":this.toHex():"transparent"},toValue:function(){return[this.r,this.g,this.b,this.a]}},n.fromHex=function(e){var t,i,r;return"#"===e[0]&&(e=e.substring(1,7)),3===e.length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),r=parseInt(e.substring(0,2),16),i=parseInt(e.substring(2,4),16),t=parseInt(e.substring(4,6),16),new n(r,i,t)},n.fromHSV=function(e,i,r){t.isObject(e)&&(i=e.s,r=e.v,e=e.h);var o,a,s,u,l,c,d,h;if(0===i)return c=d=h=r,new n(255*c,255*d,255*h);switch(e/=60,o=Math.floor(e),a=e-o,s=r*(1-i),u=r*(1-i*a),l=r*(1-i*(1-a)),o){case 0:c=r,d=l,h=s;break;case 1:c=u,d=r,h=s;break;case 2:c=s,d=r,h=l;break;case 3:c=s,d=u,h=r;break;case 4:c=l,d=s,h=r;break;default:c=r,d=s,h=u}return new n(255*c,255*d,255*h)},n.fromCMYK=function(e,i,r,o){t.isObject(e)&&(i=e.m,r=e.y,o=e.k,e=e.c);var a=n.Black();return e/=100,i/=100,r/=100,o/=100,a.r=1-Math.min(1,e*(1-o)+o),a.g=1-Math.min(1,i*(1-o)+o),a.b=1-Math.min(1,r*(1-o)+o),a.r=Math.round(255*a.r),a.g=Math.round(255*a.g),a.b=Math.round(255*a.b),a},n.fromString=function(e){var t,i,r,o,a,s,u;if(e instanceof n)return e;var l=e.match(this.regex);return l?(a=l[1],s=l[2],a?n.fromHex(a):s?(u=s.split(/\s*,\s*/),t=u[0],i=u[1],r=u[2],o=u[3],new n(t,i,r,o)):void 0):null},n.regex=/(?:#([0-9a-f]{3,6})|rgba?\(([^)]+)\))/i,n.buildStops=function(e){return t.map(e,function(e){return n.fromString(e.color)+" "+parseInt(100*e.stop,10)+"%"}).join(",")},n.White=function(e){return new n(255,255,255,e)},n.Black=function(e){return new n(0,0,0,e)},n.Transparent=function(){return new n},n.getMostContrasting=function(e,t,i){return e=n.fromString(e),t=n.fromString(t),i=n.fromString(i),e.contrastRatio(t)>e.contrastRatio(i)?t:i},e.Color=n,window.Color=n,n}),function(e,t,n,i){"use strict";function r(e,t,n){return setTimeout(l(e,n),t)}function o(e,t,n){return!!Array.isArray(e)&&(a(e,n[t],n),!0)}function a(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==i)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function s(t,n,i){var r="DEPRECATED METHOD: "+n+"\n"+i+" AT \n";return function(){var n=new Error("get-stack-trace"),i=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=e.console&&(e.console.warn||e.console.log);return o&&o.call(e.console,r,i),t.apply(this,arguments)}}function u(e,t,n){var i,r=t.prototype;i=e.prototype=Object.create(r),i.constructor=e,i._super=r,n&&ce(i,n)}function l(e,t){return function(){return e.apply(t,arguments)}}function c(e,t){return typeof e==fe?e.apply(t?t[0]||i:i,t):e}function d(e,t){return e===i?t:e}function h(e,t,n){a(m(t),function(t){e.addEventListener(t,n,!1)})}function f(e,t,n){a(m(t),function(t){e.removeEventListener(t,n,!1)})}function p(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function g(e,t){return e.indexOf(t)>-1}function m(e){return e.trim().split(/\s+/g)}function v(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function y(e){return Array.prototype.slice.call(e,0)}function b(e,t,n){for(var i=[],r=[],o=0;o<e.length;){var a=t?e[o][t]:e[o];v(r,a)<0&&i.push(e[o]),r[o]=a,o++}return n&&(i=t?i.sort(function(e,n){return e[t]>n[t]}):i.sort()),i}function w(e,t){for(var n,r,o=t[0].toUpperCase()+t.slice(1),a=0;a<de.length;){if(n=de[a],(r=n?n+o:t)in e)return r;a++}return i}function _(){return be++}function E(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}function S(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){c(e.options.enable,[e])&&n.handler(t)},this.init()}function T(e){var t=e.options.inputClass;return new(t||(Ee?V:Se?j:_e?H:F))(e,P)}function P(e,t,n){var i=n.pointers.length,r=n.changedPointers.length,o=t&Pe&&i-r==0,a=t&(Ie|xe)&&i-r==0;n.isFirst=!!o,n.isFinal=!!a,o&&(e.session={}),n.eventType=t,A(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function A(e,t){var n=e.session,i=t.pointers,r=i.length;n.firstInput||(n.firstInput=O(t)),r>1&&!n.firstMultiple?n.firstMultiple=O(t):1===r&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=t.center=C(i);t.timeStamp=me(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=M(s,u),t.distance=k(s,u),I(n,t),t.offsetDirection=L(t.deltaX,t.deltaY);var l=R(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=l.x,t.overallVelocityY=l.y,t.overallVelocity=ge(l.x)>ge(l.y)?l.x:l.y,t.scale=a?N(a.pointers,i):1,t.rotation=a?D(a.pointers,i):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,x(n,t);var c=e.element;p(t.srcEvent.target,c)&&(c=t.srcEvent.target),t.target=c}function I(e,t){var n=t.center,i=e.offsetDelta||{},r=e.prevDelta||{},o=e.prevInput||{};t.eventType!==Pe&&o.eventType!==Ie||(r=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=r.x+(n.x-i.x),t.deltaY=r.y+(n.y-i.y)}function x(e,t){var n,r,o,a,s=e.lastInterval||t,u=t.timeStamp-s.timeStamp;if(t.eventType!=xe&&(u>Te||s.velocity===i)){var l=t.deltaX-s.deltaX,c=t.deltaY-s.deltaY,d=R(u,l,c);r=d.x,o=d.y,n=ge(d.x)>ge(d.y)?d.x:d.y,a=L(l,c),e.lastInterval=t}else n=s.velocity,r=s.velocityX,o=s.velocityY,a=s.direction;t.velocity=n,t.velocityX=r,t.velocityY=o,t.direction=a}function O(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:pe(e.pointers[n].clientX),clientY:pe(e.pointers[n].clientY)},n++;return{timeStamp:me(),pointers:t,center:C(t),deltaX:e.deltaX,deltaY:e.deltaY}}function C(e){var t=e.length;if(1===t)return{x:pe(e[0].clientX),y:pe(e[0].clientY)};for(var n=0,i=0,r=0;r<t;)n+=e[r].clientX,i+=e[r].clientY,r++;return{x:pe(n/t),y:pe(i/t)}}function R(e,t,n){return{x:t/e||0,y:n/e||0}}function L(e,t){return e===t?Oe:ge(e)>=ge(t)?e<0?Ce:Re:t<0?Le:ke}function k(e,t,n){n||(n=Fe);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return Math.sqrt(i*i+r*r)}function M(e,t,n){n||(n=Fe);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return 180*Math.atan2(r,i)/Math.PI}function D(e,t){return M(t[1],t[0],Ve)+M(e[1],e[0],Ve)}function N(e,t){return k(t[0],t[1],Ve)/k(e[0],e[1],Ve)}function F(){this.evEl=Be,this.evWin=je,this.pressed=!1,S.apply(this,arguments)}function V(){this.evEl=We,this.evWin=qe,S.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function U(){this.evTarget=Ye,this.evWin=ze,this.started=!1,S.apply(this,arguments)}function B(e,t){var n=y(e.touches),i=y(e.changedTouches);return t&(Ie|xe)&&(n=b(n.concat(i),"identifier",!0)),[n,i]}function j(){this.evTarget=Xe,this.targetIds={},S.apply(this,arguments)}function G(e,t){var n=y(e.touches),i=this.targetIds;if(t&(Pe|Ae)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,a=y(e.changedTouches),s=[],u=this.target;if(o=n.filter(function(e){return p(e.target,u)}),t===Pe)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<a.length;)i[a[r].identifier]&&s.push(a[r]),t&(Ie|xe)&&delete i[a[r].identifier],r++;return s.length?[b(o.concat(s),"identifier",!0),s]:void 0}function H(){S.apply(this,arguments);var e=l(this.handler,this);this.touch=new j(this.manager,e),this.mouse=new F(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function W(e,t){e&Pe?(this.primaryTouch=t.changedPointers[0].identifier,q.call(this,t)):e&(Ie|xe)&&q.call(this,t)}function q(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var i=this.lastTouches,r=function(){var e=i.indexOf(n);e>-1&&i.splice(e,1)};setTimeout(r,Ze)}}function $(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(t-r.x),a=Math.abs(n-r.y);if(o<=Qe&&a<=Qe)return!0}return!1}function Y(e,t){this.manager=e,this.set(t)}function z(e){if(g(e,it))return it;var t=g(e,rt),n=g(e,ot);return t&&n?it:t||n?t?rt:ot:g(e,nt)?nt:tt}function K(e){this.options=ce({},this.defaults,e||{}),this.id=_(),this.manager=null,this.options.enable=d(this.options.enable,!0),this.state=st,this.simultaneous={},this.requireFail=[]}function X(e){return e&ht?"cancel":e&ct?"end":e&lt?"move":e&ut?"start":""}function Z(e){return e==ke?"down":e==Le?"up":e==Ce?"left":e==Re?"right":""}function Q(e,t){var n=t.manager;return n?n.get(e):e}function J(){K.apply(this,arguments)}function ee(){J.apply(this,arguments),this.pX=null,this.pY=null}function te(){J.apply(this,arguments)}function ne(){K.apply(this,arguments),this._timer=null,this._input=null}function ie(){J.apply(this,arguments)}function re(){J.apply(this,arguments)}function oe(){K.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ae(e,t){return t=t||{},t.recognizers=d(t.recognizers,ae.defaults.preset),new se(e,t)}function se(e,t){this.options=ce({},ae.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=T(this),this.touchAction=new Y(this,this.options.touchAction),ue(this,!0),a(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function ue(e,t){var n=e.element;if(n.style){var i;a(e.options.cssProps,function(r,o){i=w(n.style,o),t?(e.oldCssProps[i]=n.style[i],n.style[i]=r):n.style[i]=e.oldCssProps[i]||""}),t||(e.oldCssProps={})}}function le(e,n){var i=t.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=n,n.target.dispatchEvent(i)}var ce,de=["","webkit","Moz","MS","ms","o"],he=t.createElement("div"),fe="function",pe=Math.round,ge=Math.abs,me=Date.now;ce="function"!=typeof Object.assign?function(e){if(e===i||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==i&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])}return t}:Object.assign;var ve=s(function(e,t,n){for(var r=Object.keys(t),o=0;o<r.length;)(!n||n&&e[r[o]]===i)&&(e[r[o]]=t[r[o]]),o++;return e},"extend","Use `assign`."),ye=s(function(e,t){return ve(e,t,!0)},"merge","Use `assign`."),be=1,we=/mobile|tablet|ip(ad|hone|od)|android/i,_e="ontouchstart"in e,Ee=w(e,"PointerEvent")!==i,Se=_e&&we.test(navigator.userAgent),Te=25,Pe=1,Ae=2,Ie=4,xe=8,Oe=1,Ce=2,Re=4,Le=8,ke=16,Me=Ce|Re,De=Le|ke,Ne=Me|De,Fe=["x","y"],Ve=["clientX","clientY"];S.prototype={handler:function(){},init:function(){this.evEl&&h(this.element,this.evEl,this.domHandler),this.evTarget&&h(this.target,this.evTarget,this.domHandler),this.evWin&&h(E(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(E(this.element),this.evWin,this.domHandler)}};var Ue={mousedown:Pe,mousemove:Ae,mouseup:Ie},Be="mousedown",je="mousemove mouseup";u(F,S,{handler:function(e){var t=Ue[e.type];t&Pe&&0===e.button&&(this.pressed=!0),t&Ae&&1!==e.which&&(t=Ie),this.pressed&&(t&Ie&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var Ge={pointerdown:Pe,pointermove:Ae,pointerup:Ie,pointercancel:xe,pointerout:xe},He={2:"touch",3:"pen",4:"mouse",5:"kinect"},We="pointerdown",qe="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(We="MSPointerDown",qe="MSPointerMove MSPointerUp MSPointerCancel"),u(V,S,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),r=Ge[i],o=He[e.pointerType]||e.pointerType,a="touch"==o,s=v(t,e.pointerId,"pointerId");r&Pe&&(0===e.button||a)?s<0&&(t.push(e),s=t.length-1):r&(Ie|xe)&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(s,1))}});var $e={touchstart:Pe,touchmove:Ae,touchend:Ie,touchcancel:xe},Ye="touchstart",ze="touchstart touchmove touchend touchcancel";u(U,S,{handler:function(e){var t=$e[e.type];if(t===Pe&&(this.started=!0),this.started){var n=B.call(this,e,t);t&(Ie|xe)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}});var Ke={touchstart:Pe,touchmove:Ae,touchend:Ie,touchcancel:xe},Xe="touchstart touchmove touchend touchcancel";u(j,S,{handler:function(e){var t=Ke[e.type],n=G.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}});var Ze=2500,Qe=25;u(H,S,{handler:function(e,t,n){var i="touch"==n.pointerType,r="mouse"==n.pointerType;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)W.call(this,t,n);else if(r&&$.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Je=w(he.style,"touchAction"),et=Je!==i,tt="auto",nt="manipulation",it="none",rt="pan-x",ot="pan-y",at=function(){if(!et)return!1;var t={},n=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){t[i]=!n||e.CSS.supports("touch-action",i)}),t}();Y.prototype={set:function(e){"compute"==e&&(e=this.compute()),et&&this.manager.element.style&&at[e]&&(this.manager.element.style[Je]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return a(this.manager.recognizers,function(t){c(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),z(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var i=this.actions,r=g(i,it)&&!at[it],o=g(i,ot)&&!at[ot],a=g(i,rt)&&!at[rt];if(r){var s=1===e.pointers.length,u=e.distance<2,l=e.deltaTime<250;if(s&&u&&l)return}return a&&o?void 0:r||o&&n&Me||a&&n&De?this.preventSrc(t):void 0},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var st=1,ut=2,lt=4,ct=8,dt=ct,ht=16;K.prototype={defaults:{},set:function(e){return ce(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(o(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=Q(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return o(e,"dropRecognizeWith",this)?this:(e=Q(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(o(e,"requireFailure",this))return this;var t=this.requireFail;return e=Q(e,this),-1===v(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(o(e,"dropRequireFailure",this))return this;e=Q(e,this);var t=v(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){n.manager.emit(t,e)}var n=this,i=this.state;i<ct&&t(n.options.event+X(i)),t(n.options.event),e.additionalEvent&&t(e.additionalEvent),i>=ct&&t(n.options.event+X(i))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|st)))return!1;e++}return!0},recognize:function(e){var t=ce({},e);if(!c(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(dt|ht|32)&&(this.state=st),this.state=this.process(t),this.state&(ut|lt|ct|ht)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},u(J,K,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=t&(ut|lt),r=this.attrTest(e);return i&&(n&xe||!r)?t|ht:i||r?n&Ie?t|ct:t&ut?t|lt:ut:32}}),u(ee,J,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ne},getTouchAction:function(){var e=this.options.direction,t=[];return e&Me&&t.push(ot),e&De&&t.push(rt),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,r=e.direction,o=e.deltaX,a=e.deltaY;return r&t.direction||(t.direction&Me?(r=0===o?Oe:o<0?Ce:Re,n=o!=this.pX,i=Math.abs(e.deltaX)):(r=0===a?Oe:a<0?Le:ke,n=a!=this.pY,i=Math.abs(e.deltaY))),e.direction=r,n&&i>t.threshold&&r&t.direction},attrTest:function(e){return J.prototype.attrTest.call(this,e)&&(this.state&ut||!(this.state&ut)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Z(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),u(te,J,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[it]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&ut)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),u(ne,K,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[tt]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,o=e.deltaTime>t.time;if(this._input=e,!i||!n||e.eventType&(Ie|xe)&&!o)this.reset();else if(e.eventType&Pe)this.reset(),this._timer=r(function(){this.state=dt,this.tryEmit()},t.time,this);else if(e.eventType&Ie)return dt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===dt&&(e&&e.eventType&Ie?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=me(),this.manager.emit(this.options.event,this._input)))}}),u(ie,J,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[it]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&ut)}}),u(re,J,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Me|De,pointers:1},getTouchAction:function(){return ee.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(Me|De)?t=e.overallVelocity:n&Me?t=e.overallVelocityX:n&De&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&ge(t)>this.options.velocity&&e.eventType&Ie},emit:function(e){var t=Z(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),
u(oe,K,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[nt]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),e.eventType&Pe&&0===this.count)return this.failTimeout();if(i&&o&&n){if(e.eventType!=Ie)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||k(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,s&&a?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=r(function(){this.state=dt,this.tryEmit()},t.interval,this),ut):dt}return 32},failTimeout:function(){return this._timer=r(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==dt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ae.VERSION="2.0.8",ae.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[ie,{enable:!1}],[te,{enable:!1},["rotate"]],[re,{direction:Me}],[ee,{direction:Me},["swipe"]],[oe],[oe,{event:"doubletap",taps:2},["tap"]],[ne]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};se.prototype={set:function(e){return ce(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var n,i=this.recognizers,r=t.curRecognizer;(!r||r&&r.state&dt)&&(r=t.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&n.state&(ut|lt|ct)&&(r=t.curRecognizer=n),o++}},get:function(e){if(e instanceof K)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(o(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(o(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=v(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==i&&t!==i){var n=this.handlers;return a(m(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==i){var n=this.handlers;return a(m(e),function(e){t?n[e]&&n[e].splice(v(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&le(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](t),i++}},destroy:function(){this.element&&ue(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ce(ae,{INPUT_START:Pe,INPUT_MOVE:Ae,INPUT_END:Ie,INPUT_CANCEL:xe,STATE_POSSIBLE:st,STATE_BEGAN:ut,STATE_CHANGED:lt,STATE_ENDED:ct,STATE_RECOGNIZED:dt,STATE_CANCELLED:ht,STATE_FAILED:32,DIRECTION_NONE:Oe,DIRECTION_LEFT:Ce,DIRECTION_RIGHT:Re,DIRECTION_UP:Le,DIRECTION_DOWN:ke,DIRECTION_HORIZONTAL:Me,DIRECTION_VERTICAL:De,DIRECTION_ALL:Ne,Manager:se,Input:S,TouchAction:Y,TouchInput:j,MouseInput:F,PointerEventInput:V,TouchMouseInput:H,SingleTouchInput:U,Recognizer:K,AttrRecognizer:J,Tap:oe,Pan:ee,Swipe:re,Pinch:te,Rotate:ie,Press:ne,on:h,off:f,each:a,merge:ye,extend:ve,assign:ce,inherit:u,bindFn:l,prefixed:w}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=ae,"function"==typeof define&&define.amd?define("hammer",[],function(){return ae}):"undefined"!=typeof module&&module.exports?module.exports=ae:e.Hammer=ae}(window,document),define("shared/views/PlayerAbstractView",["log","lodash","jquery","backbone","color","device","hammer"],function(e,t,n,i,r,o,a){"use strict";return i.View.extend({broadcast:t.clone(i.Events),constructor:function(e){this.options=e||{},i.View.apply(this,arguments)},_broadcast:function(e){if(!t.isUndefined(e)){e.preventDefault(),e.stopPropagation();var i=n(e.currentTarget).attr("data-event-name"),r=n(e.currentTarget).attr("data-event-param");t.isString(i)&&this.broadcast.trigger(i,r)}},_triggerEvent:function(e){if(!t.isUndefined(e)){e.preventDefault();var i=n(e.currentTarget).attr("data-event-name"),r=n(e.currentTarget).attr("data-event-param");this.trigger(i,r)}},bindInteraction:function(e,i){var r;r="function"!=typeof i?n.noop:function(e){o.touch()&&(e=e.srcEvent),e.preventDefault(),i(e)},o.touch()&&t.each(e,function(e){e.swipeAction=new a(e),e.swipeAction.on("tap",r)}),o.desktop()&&e.off("click").on("click",r)},unbindInteraction:function(e){o.touch()&&t.each(e,function(e){e.swipeAction.destroy()}),o.desktop()&&e.off("click")},onClose:function(){},beforeClose:function(){},close:function(){this.beforeClose(),this.remove(),this.onClose(),this.trigger("close"),this.unbind()},setModel:function(e){this.model=e,this._bindModel()},setCollection:function(e){this.collection=e,this._bindCollection()},_bindModel:function(){this.model&&(this.model.bind("change",this._change,this),this.model.bind("sync",this._sync,this),this.model.bind("destroy",this._destroy,this),this.model.bind("invalid",this._invalid,this),this.render())},_bindCollection:function(){this.collection&&(this.collection.bind("add",this._add,this),this.collection.bind("remove",this._remove,this),this.collection.bind("reset",this._reset,this),this.render())},initialize:function(){this.options.module&&this._setModule(this.options.module),this._bindModel(),this._bindCollection()},insertAfter:function(e){this.$el.insertAfter(e)},insertBefore:function(e){this.$el.insertBefore(e)},appendTo:function(e){this.$el.appendTo(e)},after:function(e){this.$el.after(e)},before:function(e){this.$el.before(e)},show:function(){this.$el.show()},hide:function(){this.$el.hide()},_setModule:function(e){if(t.isUndefined(e)||null===e)throw Error("attempting to set an invalid module!");this.module=e},getModule:function(){return this.module},_change:function(){this.render()},_sync:function(){this.render()},_destroy:function(){this.render()},_invalid:function(){this.render()},_add:function(){this.render()},_remove:function(){this.render()},_reset:function(){this.render()},getEscapedId:function(){return this.id.replace("|","\\|")}})}),define("text!modules/splash-screen/templates/loading.html",[],function(){return'<div class="loading-container">\n    <div class="spinner"></div>\n    {{^whiteLabeling}}\n    <div class="branding-logo"></div>\n    {{/whiteLabeling}}\n    {{#showPreviewLabel}}\n    <div class="notice">REAL-TIME PREVIEW</div>\n    {{/showPreviewLabel}}\n</div>\n'}),define("modules/splash-screen/views/LoadingView",["jquery","lodash","backbone","mustache","shared/models/EmbeddedViewportModel","shared/views/PlayerAbstractView","device","color","text!modules/splash-screen/templates/loading.html"],function(e,t,n,i,r,o,a,s,u){"use strict";return o.extend({className:"splash-screen loading",lastAnimationId:null,initialize:function(){o.prototype.initialize.call(this),this.options=t.extend({autoContrastForegroundColor:"#FFFFFF",foregroundColor:"white",backgroundColor:"#161616",previewLabelBackgroundColor:"none",borderRadius:5,revolutionsPerSecond:1.2,fadeOutSpeed:"fast",whiteLabeling:!0,showPreviewLabel:!1},this.options),this.options.degreesPerTick=360/(60*this.options.revolutionsPerSecond)},render:function(){this.$el.empty(),this.$el.html(i.render(u,{whiteLabeling:this.options.whiteLabeling&&!this.options.showPreviewLabel,showPreviewLabel:this.options.showPreviewLabel})).show(),this.$spinner=this.$el.find(".spinner");var e=this.$el.find(".branding-logo"),t=this.$el.find(".notice");this.options.overlayed&&this.$spinner.addClass("overlayed"),this.$spinner.css({borderRadius:this.options.borderRadius,backgroundColor:this.options.backgroundColor}),this.renderSpinnerCanvas(),e.css({color:this.options.autoContrastForegroundColor}),t.css({backgroundColor:this.options.previewLabelBackgroundColor,color:this.options.foregroundColor}),this.scale(),r.getInstance().on("change",this.repositionForEmbed,this),this.repositionForEmbed()},start:function(){t.isNull(this.lastAnimationId)&&(this.lastAnimationId=requestAnimationFrame(this._draw))},stop:function(){t.isNull(this.lastAnimationId)||(cancelAnimationFrame(this.lastAnimationId),this.lastAnimationId=null)},scale:function(){this.$el.width()<100||this.$el.height()<100?this.$el.find("div.loading-container").addClass("small"):this.$el.find("div.loading-container").removeClass("small")},repositionForEmbed:function(){var t=r.getInstance();if(t.isActive()){var n=Math.max(0,t.getTop()),i=Math.min(e(window).height(),t.getBottom());this.$el.css({top:n+"px",height:i-n+"px"}),this.scale()}},renderSpinnerCanvas:function(){var t=Math.round(64/12),n=e('<canvas width="64" height="64"></canvas>');this.$spinner.append(n);var i=n[0].getContext("2d"),r=0,o=!1,a=this,u=32-t-1;this._draw=function(){var e,n,l=-.5*Math.PI;i.save(),i.fillStyle=a.options.backgroundColor,i.fillRect(0,0,64,64),i.lineWidth=t;var c=s.fromHex(a.options.autoContrastForegroundColor);c.a=.1,i.strokeStyle=c.toString(),i.beginPath(),i.arc(32,32,u,0,2*Math.PI,!0),i.stroke(),0===r&&o?(e=l,n=l+2*Math.PI):(e=o?l+Math.PI/180*r:l,n=o?l:l+Math.PI/180*r),i.strokeStyle=a.options.autoContrastForegroundColor,i.beginPath(),i.arc(32,32,u,e,n,!1),i.stroke(),i.restore(),r+=a.options.degreesPerTick,r>359&&(r=0,o=!o),a.lastAnimationId=requestAnimationFrame(a._draw)}},_remove:function(){this.$el.remove()},destroy:function(){this.stop(),this._remove(),r.getInstance().off("change",this.repositionForEmbed,this)}})}),define("text!modules/splash-screen/templates/previewer-unavailable.html",[],function(){return'<div class="warning-modal unavailable overlay">\n    \x3c!-- This is the overlay that will provide a transparent layer over the\n    experience and prevent any clicks. --\x3e\n </div>\n<div class="warning-modal unavailable modal">\n    <div>\n        <div class="branding-logo"></div>\n        <span class="warning-icon alert-icon"></span>\n        <span class="notice important">Your Ceros subscription expired</span>\n        <span class="notice">Get in touch with our helpful team who will rectify this in no time</span>\n        <button class="submit contact">Get in touch</button>\n    <div>\n</div>\n'}),define("text!modules/splash-screen/templates/player-unavailable.html",[],function(){return'<div class="warning-modal unavailable overlay">\n    \x3c!-- This is the overlay that will provide a transparent layer over the\n    experience and prevent any clicks. --\x3e\n </div>\n<div class="warning-modal modal">\n    <div>\n        <div class="branding-logo"></div>\n        <span class="warning-icon no-entry-icon"></span>\n        <span class="notice important">This experience has been removed by the publisher</span>\n    <div>\n</div>\n'}),define("modules/splash-screen/views/UnavailableView",["jquery","lodash","backbone","urlUtils","shared/views/PlayerAbstractView","globals","mustache","text!modules/splash-screen/templates/previewer-unavailable.html","text!modules/splash-screen/templates/player-unavailable.html"],function(e,t,n,i,r,o,a,s,u){"use strict";return r.extend({className:"splash-screen unavailable",events:{"click button.contact":"handleContactClick"},initialize:function(){r.prototype.initialize.call(this),this.render()},render:function(){var e=o.previewMode?s:u;this.$el.html(a.render(e))},handleContactClick:function(e){e.preventDefault();var t=i.appendQueryParams("http://www3.ceros.com/expiredaccount",{account:o.accountSlug});window.open(t)}})}),define("text!modules/splash-screen/templates/warning.html",[],function(){return'<div class="warning-modal embedded-previewer overlay">\n    \x3c!-- This is the overlay that will provide a transparent layer over the\n    experience and prevent any clicks. --\x3e\n</div>\n<div class="warning-modal embedded-previewer modal">\n    <div>\n        {{#showBranding}}<div class="branding-logo"></div>{{/showBranding}}\n        <span class="warning-icon alert-icon"></span>\n        <span class="notice important">{{importantText}}</span>\n        <span class="notice">{{descriptiveText}}</span>\n        <button class="submit dismiss">{{buttonText}}</button>\n    </div>\n</div>\n'}),define("modules/splash-screen/views/AbstractWarningView",["jquery","lodash","backbone","shared/views/PlayerAbstractView","mustache","text!modules/splash-screen/templates/warning.html"],function(e,t,n,i,r,o){"use strict";return i.extend({className:"warning",module:null,showBranding:!1,importantText:"",descriptiveText:"",buttonText:"Dismiss",initialize:function(){i.prototype.initialize.call(this),this.module=this.options.module},render:function(){this.$el.html(r.render(o,{showBranding:this.showBranding,importantText:this.importantText,descriptiveText:this.descriptiveText,buttonText:this.buttonText})),this.bindEvents()},bindEvents:function(){this.bindInteraction(this.$el.find("button.dismiss"),t.bind(function(e){e.preventDefault(),this.onDismissHandler()},this))},onDismissHandler:function(){}})}),define("modules/splash-screen/views/EmbeddedPreviewerWarningView",["jquery","lodash","backbone","modules/splash-screen/views/AbstractWarningView"],function(e,t,n,i){"use strict";return i.extend({className:"embedded-previewer-warning",showBranding:!0,importantText:"This is your preview - and not your published experience.",descriptiveText:"Please use the published experience URL to display this content on your website.",onDismissHandler:function(){this.module.trigger(this.module.publishedEvents.EMBED_WARNING_DISMISSED)}})}),define("modules/splash-screen/views/DeletedPageWarningView",["jquery","lodash","backbone","modules/splash-screen/views/AbstractWarningView"],function(e,t,n,i){"use strict";return i.extend({className:"deleted-page-warning",importantText:"This page is no longer available",descriptiveText:"Please try reloading",buttonText:"Reload",onDismissHandler:function(){window.location.reload()}})}),define("modules/splash-screen/module",["lodash","ceros","globals","modules/splash-screen/views/LoadingView","modules/splash-screen/views/UnavailableView","modules/splash-screen/views/EmbeddedPreviewerWarningView","modules/splash-screen/views/DeletedPageWarningView","color"],function(e,t,n,i,r,o,a,s){"use strict";var u=function(e){return s.getMostContrasting(e.backgroundColor,e.menuFgColor,e.menuBgColor).toHex()},l=new t.Module({id:"splashScreen",description:"Loading experience including spinner animation",version:"1.0",publishedEvents:{EMBED_WARNING_DISMISSED:"embed_warning_dismissed"},delegate:{loadingViews:[],showLoading:function(t,r){var o={theme:e.isUndefined(n.themeObj)?{}:n.themeObj},a=e.extend({startImmediately:!0,whiteLabeling:!0,showPreviewLabel:!1,overlayed:!0},o,r),s=u(a.theme),l=a.theme.backgroundColor;a.overlayed&&(s=a.theme.menuFgColor,l=a.theme.menuBgColor);var c=new i({autoContrastForegroundColor:s,foregroundColor:a.theme.menuFgColor,backgroundColor:l,previewLabelBackgroundColor:a.theme.menuBgColor,whiteLabeling:a.whiteLabeling,showPreviewLabel:a.showPreviewLabel,overlayed:a.overlayed});return this.loadingViews.push(c),t.prepend(c.$el),c.render(),a.startImmediately&&c.start(),{destroy:function(){c.destroy()},start:function(){c.start()},stop:function(){c.stop()}}},scale:function(){e.each(this.loadingViews,function(e,t){e.scale()})},showUnavailableScreen:function(e,t){var n=new r;e.append(n.$el)},showEmbeddedPreviewerWarning:function(e){var t=new o({module:l});t.render(),e.append(t.$el)},showDeletedPageWarning:function(e){var t=new a({module:l});t.render(),e.append(t.$el)},hideEmbeddedPreviewerWarning:function(e){e.find(".embedded-previewer-warning").hide()}}});return l}),define("text!modules/chrome/templates/menubar.html",[],function(){return'<nav id="chrome-menu">\n    <a href="#" class="title" title="Home"></a>\n    <div class="menu-buttons">\n        <div class="share button">\n            <button class="menu-button share-button" aria-controls="shareMenu"><span class="sr-only">Social Sharing Menu</span><span class="icon">&#xe000;</span></button>\n            <div class="arrow">\x3c!-- A dynamically rendered HTML5 canvas or VML element is inserted here --\x3e</div>\n        </div>\n        <div id="shareMenu" class="share-menu" style="display:none;" aria-expanded="false">\n            <ul>\n                <li><a href="#" data-share="facebook" title="Share on Facebook"><span class="sr-only">Share on Facebook</span><span class="icon ceros-facebook-icon"></span></a></li>\n                <li><a href="#" data-share="twitter" title="Share on Twitter"><span class="sr-only">Share on Twitter</span><span class="icon ceros-twitter-icon"></span></a></li>\n                <li><a href="#" data-share="linkedin" title="Share on LinkedIn"><span class="sr-only">Share on LinkedIn</span><span class="icon ceros-linkedin-icon"></span></a></li>\n                <li><a href="#" data-share="pinterest" title="Share on Pinterest"><span class="sr-only">Share on Pinterest</span><span class="icon ceros-pinterest-icon"></span></a></li>\n                <li><a href="#" data-share="email" title="Share via Email"><span class="sr-only">Share on Email</span><span class="icon ceros-email-icon"></span></a></li>\n            </ul>\n        </div>\n        <div class="cart button" aria-controls="cartModal">\n            <button class="menu-button" aria-controls="lightbox"><span class="sr-only">Open Cart</span><span class="icon">&#xe004;</span></button>\n        </div>\n    </div>\n</nav>\n'}),define("socialSharing",["jquery","lodash","urlUtils"],function(e,t,n){"use strict";return{getExperienceTitle:function(){return window.document.title},getOpenGraphTitle:function(){return window.cerosContext.docVersion.ogTitle},getOpenGraphDescription:function(){return window.cerosContext.docVersion.ogDescription},getTwitterTitle:function(){return window.cerosContext.docVersion.twitterTitle},urlForTwitter:function(e){var t=this.getTwitterTitle()||this.getExperienceTitle(),i={text:t,url:e};return n.appendQueryParams("http://twitter.com/share",i)},urlForLinkedIn:function(e){var t=this.getOpenGraphTitle()||this.getExperienceTitle(),i={url:e,mini:"true",title:t};return n.appendQueryParams("http://www.linkedin.com/shareArticle",i)},urlForPinterest:function(e,t){var i={url:e,media:t},r=this.getOpenGraphDescription()||this.getOpenGraphTitle()||this.getExperienceTitle();return r&&(i.description=r),n.appendQueryParams("http://pinterest.com/pin/create/button/",i)},urlForFacebook:function(e){var t={u:e};return n.appendQueryParams("http://www.facebook.com/sharer.php",t)},urlForEmail:function(e){var t={subject:this.getExperienceTitle(),body:"I thought you might like this. Here's a link to it on the web: "+e};return n.appendQueryParams("mailto:",t)},shareOnTwitter:function(e){window.open(this.urlForTwitter(e),"_blank","width=450,height=300")},shareOnLinkedIn:function(e){window.open(this.urlForLinkedIn(e),"_blank","width=520,height=570")},shareOnPinterest:function(e,t){window.open(this.urlForPinterest(e,t),"_blank","width=810,height=530")},shareOnFacebook:function(e){window.open(this.urlForFacebook(e),"_blank","width=450,height=300")},shareViaEmail:function(t){var n=document.createElement("a");n.href=this.urlForEmail(t),e("body").append(n),n.click(),e(n).remove()}}}),define("modules/chrome/views/ChromeView",["jquery","lodash","backbone","color","device","globals","shared/views/PlayerAbstractView","shared/utils/CerosResourceLoader","text!modules/chrome/templates/menubar.html","socialSharing","urlUtils","shared/utils/NavigationUtils","utils/Keycodes"],function(e,t,n,i,r,o,a,s,u,l,c,d,h){"use strict";return a.extend({id:"chrome",initialize:function(){a.prototype.initialize.call(this),this.autoHideTimer=null,this.render(),this.clickOverlay=e('<div class="click-overlay"></div>'),this.bindInteraction(this.clickOverlay,t.bind(this._hideShareMenu,this)),this.configureInteractions()},configureInteractions:function(){this.bindInteraction(this.title,t.bind(this._clickTitle,this)),this.bindInteraction(this.share,t.bind(this._activateShareMenu,this)),this.bindInteraction(this.shareMenu.find("a"),t.bind(this._sharePage,this)),this.bindInteraction(this.cart,t.bind(this._activateCart,this))},render:function(){this.$el.empty().html(u),e(window).on("resize",t.bind(this._onResize,this)),this.chromeMenu=this.$el.find("#chrome-menu"),this.title=this.chromeMenu.find(".title"),this.share=this.chromeMenu.find(".share"),this.$shareBtn=this.chromeMenu.find(".share-button"),this.shareMenu=this.chromeMenu.find(".share-menu"),this.shareMenuArrow=this.chromeMenu.find(".arrow"),this._renderShareMenuArrow(),this.cart=this.chromeMenu.find(".cart"),!1===this.options.showChromeMenu&&this.chromeMenu.hide(),this.setCustomTheming(),this.options.allowCommerceIntegration&&this.options.commerceSettings.shoppingCartUrl||this.cart.remove(),this.chromeMenu.addClass("icon-"+this.chromeMenu.find("div.button").length)},_renderShareMenuArrow:function(){var t=e('<canvas width="39" height="18"></canvas>');this.shareMenuArrow.empty().append(t);var n=t[0].getContext("2d");n.save(),n.clearRect(0,0,39,18),n.fillStyle=this.options.menuBackgroundColor,n.beginPath(),n.moveTo(19.5,0),n.lineTo(39,18),n.lineTo(0,18),n.lineTo(19.5,0),n.fill(),n.restore()},setCustomTheming:function(){this.chromeMenu.css("background-color",this.options.menuBackgroundColor),this.shareMenu.css("background-color",this.options.menuBackgroundColor),this.shareMenu.find("li").css("border-color",this.options.menuBorderColor);var t=this.options.menuForegroundColor;this.$el.find(".title,.label,.icon").css("color",t);var n=this.$el.find("a"),i=this.options.menuHoverOpacity;r.desktop()&&n.on("mouseenter",function(){e(this).css("opacity",i)}).on("mouseleave",function(){e(this).css("opacity","1.0")}),r.touch()&&n.on("touchstart",function(){e(this).css("opacity",i)}).on("touchend",function(){e(this).css("opacity","1.0")})},toggle:function(){this.chromeMenu.fadeToggle({duration:"fast",queue:!1,complete:t.bind(this.setAutoHideTimer,this)})},setAutoHideTimer:function(){this.cancelAutoHide(),this.chromeMenu.is(":visible")&&(this.autoHideTimer=setTimeout(t.bind(function(){"none"===this.shareMenu.css("display")&&this.hide(!0)},this),5e3))},cancelAutoHide:function(){clearTimeout(this.autoHideTimer)},show:function(e){this.cancelAutoHide(),e?this.$el.fadeIn("fast"):this.$el.show()},hide:function(e){this.cancelAutoHide(),e?this.chromeMenu.fadeOut("fast"):this.chromeMenu.hide()},getHeight:function(){return!1===this.options.showChromeMenu?0:r.mobile()?50:42},setTitle:function(e){this.chromeMenu.find(".title").text(e)},_onResize:function(){this._positionShareMenu()},_showShareMenu:function(){this._positionShareMenu(),this.shareMenuArrow.show(),this.shareMenu.attr("aria-expanded","true"),this.shareMenu.slideDown(150,t.bind(function(){this.$el.after(this.clickOverlay),this.clickOverlay.show()},this)),t.defer(t.bind(function(){this.bindInteraction(this.$el,t.bind(this._hideShareMenu,this))},this)),this.bindShareMenuFocusStateWatcher(),this.bindShareMenuEscWatcher()},bindShareMenuFocusStateWatcher:function(){this.focusCallback=function(){this.shareMenu[0].contains(document.activeElement)||(this.removeShareMenuWatchers(),this._hideShareMenu())}.bind(this),document.addEventListener("focus",this.focusCallback,!0)},bindShareMenuEscWatcher:function(){this.escCallback=function(e){"Escape"!==e.code&&e.keyCode!==h.ESC||(this.removeShareMenuWatchers(),this.$shareBtn.focus(),this._hideShareMenu())}.bind(this),document.addEventListener("keydown",this.escCallback,!0)},removeShareMenuWatchers:function(){document.removeEventListener("keydown",this.escCallback,!0),document.removeEventListener("focus",this.focusCallback,!0)},_hideShareMenu:function(){this.shareMenu.attr("aria-expanded","false"),this.shareMenu.slideUp(100,t.bind(function(){this.shareMenuArrow.hide(),this.clickOverlay.detach(),this.unbindInteraction(this.$el)},this)),r.mobile()&&this.setAutoHideTimer()},_positionShareMenu:function(){if(this.options.showChromeMenu){var t,n=e(window).width(),i=this.chromeMenu.height()+10;t=n<=480?this.share.position().left+this.share.width()/2-this.shareMenu.width()/2:this.share.position().left,this.shareMenu.css({top:i+"px",left:t+"px"})}},setMenuLinkHrefs:function(e){var t=c.removeEmbedParams(d.buildUriForPageNumber(e)),n=window.location.protocol+"//"+window.location.host+t,i=this.$el.find("[data-share='facebook']"),r=this.$el.find("[data-share='twitter']"),o=this.$el.find("[data-share='linkedin']"),a=this.$el.find("[data-share='pinterest']"),s=this.$el.find("[data-share='email']");this.title.attr("href",d.buildUriForPageNumber(1)),i.attr("href",l.urlForFacebook(n)),r.attr("href",l.urlForTwitter(n)),o.attr("href",l.urlForLinkedIn(n)),a.attr("href",l.urlForPinterest(n)),s.attr("href",l.urlForEmail(n))},_clickTitle:function(e){e.preventDefault(),this.getModule().trigger(this.getModule().publishedEvents.CHROME_TITLE_CLICK)},_activateCart:function(){this.getModule().trigger(this.getModule().publishedEvents.CHROME_SHOPPING_CART)},_activateShareMenu:function(e){"none"===this.shareMenu.css("display")?(this.getModule().trigger(this.getModule().publishedEvents.CHROME_SHARE),this._showShareMenu()):this._hideShareMenu()},_sharePage:function(t){t.preventDefault();var n="share-"+e(t.currentTarget).attr("data-share");this.getModule().trigger(this.getModule().publishedEvents.CHROME_SHARE_PAGE,{action:n}),this._hideShareMenu()}})}),define("modules/chrome/module",["jquery","lodash","ceros","globals","device","color","modules/chrome/views/ChromeView"],function(e,t,n,i,r,o,a){"use strict";var s=new n.Module({id:"chrome",description:"Provides a menu bar user interface for the web player",version:"2.0",chromeView:null,publishedEvents:{CHROME_SHARE:"chrome.share",CHROME_SHARE_PAGE:"chrome.share.page",CHROME_SHOPPING_CART:"chrome.shopping_cart",CHROME_TITLE_CLICK:"chrome.title.click"},delegate:{load:function(e){var n={theme:t.isUndefined(i.themeObj)?{}:i.themeObj};this.options=t.extend({},n,e);var r=this.options.theme.menuFgColor,u=this.options.theme.menuBgColor,l=o.fromHex(r);return l.a=.1,this.chromeView=new a({module:s,menuBackgroundColor:u,menuBorderColor:l,menuForegroundColor:r,menuHoverOpacity:this.options.theme.menuHoverOpacity,allowCommerceIntegration:i.allowCommerceIntegration,commerceSettings:i.commerceSettings,showChromeMenu:this.options.theme.menuEnabled}),this},shouldShow:function(){return!i.isEmbedded&&i.themeObj.menuEnabled},initiallyHidden:function(){return r.mobile()},getHeight:function(){return this.chromeView.getHeight()},el:function(){return this.chromeView.$el},show:function(e){this.chromeView&&this.chromeView.show(e)},hide:function(e){this.chromeView&&this.chromeView.hide(e)},toggle:function(){this.chromeView&&this.chromeView.toggle()},setTitle:function(e){this.chromeView.setTitle(e)},setMenuLinkHrefs:function(e){this.chromeView.setMenuLinkHrefs(e)}}});return s}),define("text!modules/branding/templates/branding.html",[],function(){return'\n    <a href="#" class="label"><span class="sr-only">Powered by Ceros</span></a>'}),define("modules/branding/views/BrandingView",["jquery","lodash","device","globals","shared/views/PlayerAbstractView","shared/utils/CerosResourceLoader","text!modules/branding/templates/branding.html"],function(e,t,n,i,r,o,a){"use strict";var s=i.publicAssetsBaseUrl+"PoweredByCeros.svg";return r.extend({id:"ceros-branding",initialize:function(){this.poweredByUrl=this.getBrandingLinkUrl(),r.prototype.initialize.call(this),this.render(),this.configureInteractions()},configureInteractions:function(){this.bindInteraction(this.$el,t.bind(this._clickCerosBranding,this))},render:function(){if(this.$el.empty().html(a),this.$el.find("a").attr("href",this.poweredByUrl),e(window).on("resize",t.bind(this._onResize,this)),this.setCustomTheming(),!this.options.whiteLabeling){var n={color:this.options.menuForegroundColor},i={alt:"Powered By Ceros",width:"100%",height:"100%"};o.addVectorImage(s).loadNow().done(t.bind(function(e){e.createImageElement(n,i).done(t.bind(function(e){this.$el.find("a").append(e)},this))},this))}},setCustomTheming:function(){this.$el.css("background-color",this.options.menuBackgroundColor);var t=this.options.menuHoverOpacity,i=this.$el.find("a");n.desktop()&&i.on("mouseenter",function(){e(this).css("opacity",t)}).on("mouseleave",function(){e(this).css("opacity","1.0")}),n.touch()&&i.on("touchstart",function(){e(this).css("opacity",t)}).on("touchend",function(){e(this).css("opacity","1.0")}),this._positionCerosBranding()},_positionCerosBranding:function(){n.isIphoneFullscreenMobileSafari(e(window).width(),e(window).height())?this.$el.css({right:"42px","border-radius":"3px 3px 0 0"}):this.$el.css({right:0,"border-radius":"3px 0 0 0"})},getBrandingLinkUrl:function(){return"http://www3.ceros.com/poweredbyceros?"+["utm_source=M-W-CerosPower","account="+encodeURIComponent(i.accountSlug),"experience="+encodeURIComponent(i.issueAliasSlug)].join("&")},_onResize:function(){this._positionCerosBranding()},_clickCerosBranding:function(e){e.preventDefault(),this.getModule().trigger(this.getModule().publishedEvents.BRANDING_CEROS_BRANDING_CLICK)}})}),define("modules/branding/module",["jquery","lodash","ceros","globals","device","color","modules/branding/views/BrandingView"],function(e,t,n,i,r,o,a){"use strict";var s=new n.Module({id:"branding",version:"1.0",brandingView:null,publishedEvents:{BRANDING_CEROS_BRANDING_CLICK:"branding.ceros_branding.click"},delegate:{load:function(e){var t=i.themeObj.menuFgColor,n=i.themeObj.menuBgColor;return this.brandingView=new a({module:s,menuBackgroundColor:n,menuForegroundColor:t,menuHoverOpacity:i.themeObj.menuHoverOpacity,whiteLabeling:i.whiteLabeling}),this},shouldShow:function(){return!i.whiteLabeling},el:function(){return this.brandingView.$el},show:function(){this.brandingView&&this.brandingView.show()},getBrandingUrl:function(){return this.brandingView.poweredByUrl}}});return s}),define("ImageUtils",["lodash","cerosMath","device","VectorImageUtils"],function(e,t,n,i){"use strict";return{CONSTANTS:{DEFAULT_VECTOR_IMAGE_MAX_DIM_SIZE:100},calculateWidthForDevicePixelRatio:function(e){return e*n.pixelRatio()},constrain:function(e,n,r){return i.isVectorBased(e)?t.scaleBoxToMaxDimension(n,r,this.CONSTANTS.DEFAULT_VECTOR_IMAGE_MAX_DIM_SIZE):{width:Math.round(n/2),height:Math.round(r/2)}},base64toBlob:function(t,n,i){n=e.isString(n)?n:"",i=e.isNumber(i)?i:512;for(var r=atob(t),o=[],a=0;a<r.length;a+=i){for(var s=r.slice(a,a+i),u=new Array(s.length),l=0;l<s.length;l++)u[l]=s.charCodeAt(l);var c=new Uint8Array(u);o.push(c)}return new Blob(o,{type:n})},createFileFromBase64:function(e,t,n){return new File([this.base64toBlob(e)],t,{type:n})},isBase64EncodedImage:function(e){return"data:image"===e.slice(0,10)}}}),define("shared/utils/DelegateUtils",["lodash"],function(e){"use strict";return{mergeDelegates:function(t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(e.isObject(i))for(var r in i)e.isFunction(i[r])?t[r]=e.bind(i[r],t):t[r]=i[r]}}}}),define("shared/utils/ScrollbarUtils",["lodash"],function(e){"use strict";var t=null;return{getScrollbarWidth:function(){if(!e.isNull(t))return t;var n=document.createElement("div");n.style.visibility="hidden",n.style.width="100px",document.body.appendChild(n);var i=n.offsetWidth;n.style.overflow="scroll";var r=document.createElement("div");r.style.width="100%",n.appendChild(r);var o=r.offsetWidth;return n.parentNode.removeChild(n),t=i-o}}}),define("utils/ScaleConstants",[],function(){"use strict";return{SCALE_EXPERIENCE_TYPE:{SCALE_TO_FOLD:"scale_to_fold",FULL_WIDTH:"full_width",NO_SCALING:"no_scaling"}}}),
define("shared/utils/ScaleContext",["log","jquery","lodash","backbone","globals","shared/utils/ScrollbarUtils","utils/ScaleConstants","device","modules/page/utils/PlayerVariantService","modules/page/utils/PlayerVariantDetector"],function(e,t,n,i,r,o,a,s,u,l){"use strict";var c=function(e){this.initialize(e)};return c.prototype={documentVersion:null,marginTopCallback:null,module:null,cachedScale:{},initialize:function(e){this.documentVersion=e.documentVersion,this.marginTopCallback=e.marginTopCallback,this.module=e.module},getCurrentWindowScaleContext:function(){var e=t(window),n=u.getExperienceContainerDimensions(e);return this._calculateScaleInternal(n.width,n.height)},isPreviewFullScreenMode:function(){return r.previewMode&&u.fullScreenMode},_calculateScaleInternal:function(e,i){var o=this.documentVersion.getExperienceWidth(),c=r.heightOverride||this.documentVersion.getExperienceHeight(),d=this.documentVersion.getScaleExperience(),h=t(window),f=u.getExperienceContainerDimensions(h),p=e+"x"+i+"-"+f.width+"x"+f.height+"-"+l.getVariant();if(!n.has(this.cachedScale,p)){var g={width:e,height:i,marginTop:this.marginTopCallback(),windowWidth:e,windowHeight:i,ratio:1,constrainedByHeight:!1,constrainedByWidth:!1,originalWindowWidth:f.width,originalWindowHeight:f.height},m=g.windowHeight+s.getSlackHeight(g.windowHeight)-g.marginTop;g.height=m;var v=this.documentVersion.getScaleExperienceType()===a.SCALE_EXPERIENCE_TYPE.FULL_WIDTH;this.calculateDoScaling(g,o,c,m,d,v),g.adjustedRatio=g.ratio*s.pixelRatio(),this.cachedScale[p]=g}return this.cachedScale[p]},calculateDoScaling:function(e,t,n,i,r,o){if(r){var a=n/t>i/e.windowWidth;if(o||!a)return e.constrainedByWidth=!0,e.width=e.windowWidth,void(e.ratio=e.width/t);e.constrainedByHeight=!0,e.ratio=e.height/n,e.width=t*e.ratio}},getPageScaleContext:function(e){var t=this.getCurrentWindowScaleContext();if(this.documentVersion.getScaleExperience()){var n=e.getPageHeight(this.documentVersion),i=this.documentVersion.getExperienceWidth(),r=Math.round(t.height/t.ratio),o=n<=r;t.constrainedByWidth&&!o&&(t=this.calculateNewScaleContextWhenConstrainedByWidthAndPageDoesNotFit(t,i,n))}return t},calculateNewScaleContextWhenConstrainedByWidthAndPageDoesNotFit:function(e,t,n){for(var i=o.getScrollbarWidth()*e.ratio,r=i;r>=0;r--){var a=(e.width-i+r)/t;if(!0===n<=Math.round(e.height/a)){i-=r;break}}var s=e.originalWindowWidth-i;return e=this._calculateScaleInternal(s,e.originalWindowHeight)},useZoom:function(e){var t=s.isIpad();return(!t||!s.isIosGreaterThanOrEqualTo(13))&&(t||this.doBlurryFontFix(e))},doBlurryFontFix:function(e){return(s.isBrowserChrome()&&s.desktop()||s.isDesktopSafari())&&e>=.8}},c}),define("modules/viewport/utils/PageLoadPolicy",["lodash"],function(e){"use strict";var t=function(e,t){this.lookBehind=1,this.lookAhead=1,this.isCircular=t,this.pageIndexes=e.sort(function(e,t){return e-t})};return t.prototype={getPageIndexesToLoad:function(t){var n=null,i=!1;e.each(this.pageIndexes,e.bind(function(e,r){return e===t?(n=r,i=!0,!1):e>t?(n=r,!1):void 0},this));var r;i?r=this.pageIndexes:(r=this.pageIndexes.slice(),null===n&&(n=r.length),r.splice(n,0,t));var o,a=[],s=n;for(o=0;o<this.lookBehind;o++){if(-1===--s){if(!this.isCircular)break;s=r.length-1}a.push(r[s])}var u=[];for(s=n,o=0;o<this.lookAhead;o++){if(++s===r.length){if(!this.isCircular)break;s=0}u.push(r[s])}return this.combinePageIndexArrays(r[n],a,u)},combinePageIndexArrays:function(t,n,i){for(var r=[t],o=0;o<i.length||o<n.length;)o<i.length&&r.push(i[o]),o<n.length&&r.push(n[o]),o++;return e.uniq(r)}},t}),define("modules/viewport/utils/GesturesBehavior",["log","jquery","lodash","globals","device","hammer"],function(e,t,n,i,r,o){"use strict";var a={startX:null,startY:null,lastDirection:null,xDistance:0,yDistance:0,gesturesEnabled:!0,swipeDirection:null,originalDirection:null};return{offsetTimeout:null,disableGestures:function(){a.gesturesEnabled=!1},enableGestures:function(){a.gesturesEnabled=!0},configureGestures:function(){var e={};r.isBrowserChrome()&&r.isAndroid()&&(e.inputClass=o.TouchInput),r.isMobileSafari()&&(e.touchAction="pan-x pan-y");var t=new o.Manager(this.$el[0],e);t.add(new o.Press({time:500})),r.isMobileSafari()&&(t.add(new o.Pinch),t.add(new o.Tap),t.get("pinch").set({enable:!0}),t.on("pinch pinchend pinchstart tap",function(e){"tap"===e.type&&2!==e.tapCount||e.preventDefault()})),t.on("press",n.bind(function(e){a.gesturesEnabled&&(e.preventDefault(),this.options.module.trigger(this.options.module.publishedEvents.LONGPRESS))},this)),t.on("hammer.input",n.bind(function(e){var t=e.eventType,r=e.deltaTime;if(a.gesturesEnabled){var s=this.getCurrentPage();if(this.isPageTransitioning())return void e.preventDefault();switch(t){case o.INPUT_START:this.pauseAnimationsOnMove=n.once(n.bind(function(){s.pauseAnimations()},this)),this.clearAutoTransitionDelay();break;case o.INPUT_MOVE:var u=e.deltaX,l=e.deltaY;if(a.xDistance=Math.abs(u),a.yDistance=Math.abs(l),!a.swipeDirection&&(a.xDistance>10||a.yDistance>10))a.xDistance>a.yDistance?a.swipeDirection=o.DIRECTION_HORIZONTAL:a.swipeDirection=o.DIRECTION_VERTICAL;else if(!a.swipeDirection)return;if(a.swipeDirection==o.DIRECTION_HORIZONTAL?a.lastDirection=u>0?o.DIRECTION_RIGHT:o.DIRECTION_LEFT:a.swipeDirection==o.DIRECTION_VERTICAL&&(a.lastDirection=l>0?o.DIRECTION_DOWN:o.DIRECTION_UP),n.isNull(a.originalDirection)||(a.originalDirection=a.lastDirection),a.originalDirection!=a.lastDirection&&(a.changedDirection=!0),a.swipeDirection==o.DIRECTION_HORIZONTAL){if(!i.themeObj.swipeEnabled)return;if(this.getPageCount()<=1&&this.documentVersion.getScaleExperience())return void e.preventDefault();var c=this.getNextPage(),d=this.getPreviousPage();if(!this.isValidHorizontalSwipe())return;if(n.isFunction(this.pauseAnimationsOnMove)&&this.pauseAnimationsOnMove(),i.isEmbedded&&(this._isSwipeRight()&&!d||this._isSwipeLeft()&&!c))return;c&&this._isSwipeLeft()&&(c.makeInTransition(),c.setBackgroundPositionAndScaleTransform(u+this.getPageViewportWidth(),!0)),d&&this._isSwipeRight()&&(d.makeInTransition(),d.setBackgroundPositionAndScaleTransform(u-this.getPageViewportWidth(),!0));var h=this._isSwipeOutOfPageBounds(),f=u;h&&(f=this._getRubberbandHorizontalDistance(),this._isSwipeLeft()&&(f*=-1)),this.getCurrentPage().setBackgroundPositionAndScaleTransform(f,!0),e.preventDefault()}break;case o.INPUT_END:case o.INPUT_CANCEL:if(a.swipeDirection==o.DIRECTION_HORIZONTAL){if(!this.isValidHorizontalSwipe())return;if(this.pauseAnimationsOnMove=null,!i.themeObj.swipeEnabled)return void this.setAutoTransitionDelay();var p=a.xDistance/r;if(!this._isSwipeOutOfPageBounds()&&t==o.INPUT_END&&(this._isDistancePageChangeSwipe(a.xDistance)||this._isVelocityPageChangeSwipe(p))){var g=this.calculateRemainingTransitionTime(a.xDistance,r);this._isSwipeLeft()?this._slideLeft(g):this._isSwipeRight()&&this._slideRight(g)}else this._abortSlide(r)}a.xDistance=0,a.yDistance=0,a.lastDirection=null,a.swipeDirection=null,a.originalDirection=null,a.changedDirection=!1;break;default:e.preventDefault()}}},this))},isValidHorizontalSwipe:function(){if(!this.documentVersion.getScaleExperience()){if(!this._isAtLeft()&&!this._isAtRight())return!1;if(this._isAtLeft()&&!this._isSwipeRight())return!1;if(this._isAtRight()&&!this._isSwipeLeft())return!1}return!0},_getPageTopWithOffset:function(){var e=this.getCurrentPage();return this._isAtTop()?this._getPageTop(e):this._isAtBottom()?this._getPageTop(e)+this.MOBILE_PAGE_SCROLL_HEIGHT_OFFSET:this._getPageTop(e)+this.MOBILE_PAGE_SCROLL_HEIGHT_OFFSET/2},_isAtTop:function(){return this.getCurrentPage().$el.scrollTop()<=0},_isAtBottom:function(){var e=this.getCurrentPage(),t=e.$el.height(),n=e.$pageScroll.height(),i=n-t;return e.$el.scrollTop()>=i},_isAtLeft:function(){return-1*this.getCurrentPage().$pageScroll.offset().left<=0},_isAtRight:function(){var e=this.getCurrentPage(),t=e.$el.width(),n=e.$pageScroll.width(),i=n-t;return-1*e.$pageScroll.offset().left>=i},_isSwipeOutOfPageBounds:function(){return this.isFirstPage()&&this._isSwipeRight()||this.isLastPage()&&this._isSwipeLeft()},_getRubberbandHorizontalDistance:function(){var e=this.getPageViewportWidth();return a.xDistance>=.5*e?.25*e:(e-a.xDistance)/e*a.xDistance},_isSwipeLeft:function(){return a.lastDirection==o.DIRECTION_LEFT},_isSwipeRight:function(){return a.lastDirection==o.DIRECTION_RIGHT},_isSwipeUp:function(){return a.lastDirection==o.DIRECTION_UP},_isSwipeDown:function(){return a.lastDirection==o.DIRECTION_DOWN},_abortSlide:function(e){var t=this.getCurrentPage();if(0!==t.getLeft()){this.isPageTransitionInProgress=!0;var i=this.calculateTransitionTime(a.xDistance,e);t.el().animate({"background-position-x":0},{duration:i,easing:"easeOutCubic",step:n.bind(function(e,n){t.setBackgroundPositionAndScaleTransform(e,!0),this.getNextPage()&&this.getNextPage().setBackgroundPositionAndScaleTransform(e+this.getPageViewportWidth(),!0),this.getPreviousPage()&&this.getPreviousPage().setBackgroundPositionAndScaleTransform(e-this.getPageViewportWidth(),!0)},this),complete:n.bind(function(){this.isPageTransitionInProgress=!1;var e=this.getNextPage();e&&e.makePending();var n=this.getPreviousPage();n&&n.makeViewed(),t.resumeAnimations(),this.setAutoTransitionDelay()},this)})}},_isDistancePageChangeSwipe:function(e){return e>=.2*this.getPageViewportWidth()},_isVelocityPageChangeSwipe:function(e){return e>.6},_slideRight:function(e){return this._slide("right",this.getPreviousPage(),e)},_slideLeft:function(e){return this._slide("left",this.getNextPage(),e)},_slide:function(e,t,n){"left"===e?this.nextPage(n):this.previousPage(n)},calculateTransitionTime:function(e,t){return this._calculateTransitionTimeInternal(e,t,!1)},calculateRemainingTransitionTime:function(e,t){return this._calculateTransitionTimeInternal(e,t,!0)},_calculateTransitionTimeInternal:function(e,t,n){var i=1e3,r=e/t,o=e/this.getPageViewportWidth();n&&(o=1-o),i*=o;var a=i/r;return a>i&&(a=i),a}}}),define("@frontend/player/interactions/InteractionInvocation",["lodash"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=66)}({1:function(t,n){t.exports=e},66:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=function(e,t){var n=i.assign({},e,t);delete n.pageView,i.assign(this,n)};t.InteractionInvocation=r}})}),define("@frontend/player/interactions/BaseInteraction",["lodash","@frontend/player/interactions/InteractionInvocation","shared/utils/ModuleEventManager"],function(e,t,n){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=44)}({1:function(t,n){t.exports=e},2:function(e,t){e.exports=require("@frontend/player/interactions/InteractionInvocation")},44:function(e,t,n){"use strict";var i=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(2),a=n(5),s=function(){function e(e,t){if(!t.module)throw new Error("All interactions must belong to a module");this.trigger=e.trigger,this.action=e.action,this.pageView=t,r.assign(this,e)}return e.prototype.hasGlobalScope=function(){return!0},e.prototype.triggerAction=function(e){if(!r.isFunction(this.getModuleAction))return!1;var t=this.getModuleAction();if(!t)return!1;var n=new o.InteractionInvocation(this,e);return this.hasGlobalScope()?a.trigger(t,n):this.pageView.module.trigger(t,n),!0},Object.defineProperty(e.prototype,"domTagOverride",{get:function(){if(this.isValid()&&"click"===this.trigger)return{tagName:"button",priority:1,attributes:{onmouseup:"blur()"}}},enumerable:!0,configurable:!0}),e.prototype.isValid=function(){var e=r.values(this);return!r.some(e,function(e){if(r.isNull(e))return!0;if(r.isArray(e)){if(0===e.length)return!0}else if(""===e)return!0;return!1})},e.prototype.toJSON=function(){return this.pageView,i(this,["pageView"])},e.prototype.shouldCreateHoverArea=function(){return!1},e.prototype.getHoverTargets=function(){return[]},e}();t.BaseInteraction=s},5:function(e,t){e.exports=require("shared/utils/ModuleEventManager")}})}),define("@frontend/player/interactions/links/BaseURLInteraction",["@frontend/player/interactions/BaseInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=70)}({3:function(e,t){e.exports=require("@frontend/player/interactions/BaseInteraction")},70:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"domTagOverride",{get:function(){if("click"===this.trigger&&this.isValid()){var e=this.constructUrl();return e?{tagName:"a",priority:2,attributes:o(o({},this.customAttributes()),{href:e})}:{tagName:"button",priority:1,attributes:this.customAttributes()}}},enumerable:!0,configurable:!0}),t.prototype.customAttributes=function(){return{}},t}(n(3).BaseInteraction);t.BaseURLInteraction=a}})}),define("@frontend/player/interactions/links/ScrollToInteraction",["lodash","@frontend/player/interactions/links/BaseURLInteraction","globals"],function(e,t,n){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=77)}({1:function(t,n){t.exports=e},77:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=n(8),s=n(9),u=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scrollTargetType=t.scrollTargetType||"",i.scrollTargetScranchor=t.scrollTargetScranchor,i}return r(t,e),t.prototype.constructUrl=function(){if(!s.isEmbedded)return"top"===this.scrollTargetType||"bottom"===this.scrollTargetType?"#page-"+(this.pageView.model.pageIndex+1)+"-"+this.scrollTargetType:"#"+(this.scrollTargetScranchor||"")},t.prototype.getModuleAction=function(){return this.pageView.module.publishedEvents.PAGE_ACTION_SCROLL_TO},t.prototype.isValid=function(){switch(this.scrollTargetType){case"top":case"bottom":return!0;case"scranchor":return!!this.scrollTargetScranchor&&!o.isEmpty(this.scrollTargetScranchor);default:return!1}},t}(a.BaseURLInteraction);t.ScrollToInteraction=u},8:function(e,t){e.exports=require("@frontend/player/interactions/links/BaseURLInteraction")},9:function(e,t){e.exports=require("globals")}})}),define("libs/utils/FeatureFlagsLookupService",["globals"],function(e){"use strict";return{hasFeature:function(t){return e.featureFlags&&!!e.featureFlags[t]}}}),define("libs/utils/FeatureFlags",[],function(){"use strict";return{PASSWORD_PROTECTED_EXPERIENCES:"Password Protected Experiences",GETTY_IMAGES:"Getty Image Integration",GETTY_VIDEOS:"Getty Video Integration",ACCESSIBILITY:"Accessibility"}}),define("@frontend/player/interactions/links/ScrollToObjectInteraction",["lodash","@frontend/player/interactions/links/ScrollToInteraction","libs/utils/FeatureFlagsLookupService","libs/utils/FeatureFlags"],function(e,t,n,i){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=79)}({1:function(t,n){t.exports=e},13:function(e,t){e.exports=require("@frontend/player/interactions/links/ScrollToInteraction")},79:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var s=n(13),u=n(1),l=n(80),c=n(81),d=function(e){function t(t,n){var i=t.layerTargets,r=a(t,["layerTargets"]),s=u.get(i,0);return e.call(this,o(o({},r),{scrollTargetType:"component",scrollTargetScranchor:s}),n)||this}return r(t,e),t.prototype.isValid=function(){if(!l.hasFeature(c.ACCESSIBILITY)||!this.scrollTargetScranchor)return!1;var e=this.pageView.model.findLayerById(this.scrollTargetScranchor);return Boolean(e&&!e.fixedPosition)},t.prototype.customAttributes=function(){if(this.isValid()){var e=this.pageView.model.findLayerById(this.scrollTargetScranchor);if("folder"===e.type){var t=this.pageView.model.constructor.findTopmostFolderContent(e);if(t)return{"aria-flowto":t.id}}}return{}},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.layerTargets=t.scrollTargetScranchor?[t.scrollTargetScranchor]:[],delete t.scrollTargetScranchor,delete t.scrollTargetType,t},t}(s.ScrollToInteraction);t.ScrollToObjectInteraction=d},80:function(e,t){e.exports=require("libs/utils/FeatureFlagsLookupService")},81:function(e,t){e.exports=require("libs/utils/FeatureFlags")}})}),define("@frontend/common/constants/AccessibilityConstants",[],function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=154)}({154:function(e,t,n){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.HTML_LANDMARK_TAGS=["main","nav","aside","article","section","header","footer"],t.DEFAULT_LANDMARK_TAG="main",t.properties={HTML_LANDMARK:"htmlLandmarkTag",ARIA_LABEL:"ariaLabel"},t.MODEL_DEFAULTS=((i={})[t.properties.ARIA_LABEL]=void 0,i),t.SECTION_DEFAULTS=((r={})[t.properties.HTML_LANDMARK]=void 0,r[t.properties.ARIA_LABEL]=void 0,r),t.MAIN_CONTENT_LINK_DEFAULT_TEXT="Skip to Main Content"}})}),define("@frontend/common/JsTsViewGlue",["lodash","backbone"],function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=160)}({0:function(t,n){t.exports=e},160:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(2);t.JsTsViewGlue=r.View.extend({constructor:function(e){this.options=e||{},this.subViews=[],r.View.call(this,e)},broadcast:i.clone(r.Events)})},2:function(e,n){e.exports=t}})}),define("@frontend/player/modules/page/views/main-content-link/MainContentLinkView",["lodash","jquery","@frontend/player/interactions/links/ScrollToObjectInteraction","@frontend/common/constants/AccessibilityConstants","@frontend/common/JsTsViewGlue"],function(e,t,n,i,r){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=112)}({1:function(t,n){t.exports=e},112:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),s=n(1),u=n(14),l=n(30),c=function(e){function t(n){return e.call(this,o(o({},t.DEFAULT_ATTRIBUTES),n))||this}return r(t,e),t.prototype.setPageView=function(e){return this.currentPageView=e,this},t.prototype.initialize=function(e){var n=s.get(e,"docVersion.attributes.mainContentLinkText"),i=s.get(e,"docVersion.attributes.theming.menuBgColor"),r=s.get(e,"docVersion.attributes.theming.menuFgColor");this.$el.html(n||l.MAIN_CONTENT_LINK_DEFAULT_TEXT),this.$el.css("background-color",i||t.DEFAULT_BACKGROUND_COLOR),this.$el.css("color",r||t.DEFAULT_FOREGROUND_COLOR),this.$el.on({click:this.onClick.bind(this)})},t.prototype.render=function(){return this.targetId=a(".page-viewport.top main:first").attr("id"),this.targetId?(this.$el.attr("href","#"+this.targetId),this.$el.attr("tabindex",2),this.$el.removeAttr("aria-hidden"),this.$el.css("visibility","")):(this.$el.removeAttr("href"),this.$el.removeAttr("tabindex"),this.$el.attr("aria-hidden","true"),this.$el.css("visibility","hidden")),e.prototype.render.call(this)},t.prototype.onClick=function(e){e.preventDefault(),this.targetId&&new u.ScrollToObjectInteraction({layerTargets:[this.targetId],trigger:"click",action:"scroll-to-object"},this.currentPageView).triggerAction(o(o({},e),{clickX:e.clientX,clickY:e.clientY,componentSlug:this.options.id,componentName:"Main Content Link",componentType:"main-content-link",pageSlug:this.currentPageView.model.get("slug"),pageName:this.currentPageView.model.get("name")}))},t.DEFAULT_BACKGROUND_COLOR="#000000",t.DEFAULT_FOREGROUND_COLOR="#FFFFFF",t.DEFAULT_ATTRIBUTES={className:"main-content-link",tagName:"a"},t}(n(113).JsTsViewGlue);t.MainContentLinkView=c},113:function(e,t){e.exports=require("@frontend/common/JsTsViewGlue")},14:function(e,t){e.exports=require("@frontend/player/interactions/links/ScrollToObjectInteraction")},30:function(e,t){e.exports=require("@frontend/common/constants/AccessibilityConstants")},4:function(e,t){e.exports=require("jquery")}})}),define("modules/viewport/views/ViewportView",["log","jquery","lodash","backbone","globals","ImageUtils","shared/utils/DelegateUtils","shared/utils/CerosResourceLoader","shared/utils/ScaleContext","shared/utils/ScrollbarUtils","device","shared/views/PlayerAbstractView","modules/viewport/utils/PageLoadPolicy","modules/viewport/utils/GesturesBehavior","modules/page/utils/PlayerVariantService","@frontend/player/modules/page/views/main-content-link/MainContentLinkView","libs/utils/FeatureFlagsLookupService","libs/utils/FeatureFlags"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f,p,g,m,v){"use strict";var y={NONE:0,LEFT:1,RIGHT:2};return d.extend({id:"viewport",documentVersion:null,module:null,pageJumpFrom:null,currentPage:null,currentPageSlug:null,pageViews:null,leftThresholdA:null,leftThresholdB:null,rightThresholdA:null,rightThresholdB:null,clickShield:null,isPageTransitionInProgress:!1,autoTransitionDelay:null,backgroundImage:null,scaleContext:null,scrollPositionsByPage:{},viewportContainer:null,backgroundContainerEl:null,backgroundImageEl:null,backgroundImageResource:null,backgroundImageInfo:null,mainContentLink:null,MOBILE_PAGE_SCROLL_HEIGHT_OFFSET:2,initialize:function(){this.documentVersion=this.options.documentVersion,this.scaleContext=this.options.scaleContext,this.module=this.options.module,this.mainContentLink=new g.MainContentLinkView({docVersion:this.documentVersion}),d.prototype.initialize.call(this),m.hasFeature(v.ACCESSIBILITY)&&this.$el.append(this.mainContentLink.$el),t(window).on("resize",n.bind(this.scale,this)),c.touch()&&(a.mergeDelegates(this,f),this.configureGestures()),this.clickShield=t('<div class="click-shield"></div>'),this.addClickShield(),this.reset(null),r.previewMode&&this.listenForRemoteChanges(),n.each(this.documentVersion.pages,n.bind(function(e){e.on("change:disabled",function(){this.module.trigger(this.module.publishedEvents.PAGE_ENABLED_CHANGE,{slug:this.currentPageSlug,isFirstPage:this.isFirstPage(),isLastPage:this.isLastPage(),isPageReady:this.getCurrentPage().isReady()})},this)},this)),this.backgroundImageInfo=n.get(r,"themeObj.backgroundImage",null)},listenForRemoteChanges:function(){this.documentVersion.on("change:carousel",n.bind(function(){this.getCurrentPage()&&this.currentPageSlug&&(this.module.trigger(this.module.publishedEvents.PAGE_UPDATE,{slug:this.currentPageSlug,isFirstPage:this.isFirstPage(),isLastPage:this.isLastPage(),isPageReady:this.getCurrentPage().isReady()}),this.setAutoTransitionDelay())},this)),this.documentVersion.on(this.documentVersion.MANIFEST_ADD_PAGE,n.bind(function(e,t){var i=this.module.createSinglePageView(e,t);this.pageViews.splice(t,0,i),i.prepare().done(n.bind(function(){i.attach(),this.$el[0].appendChild(i.el()[0]),this.scale(),i.makePending(),
this.currentPage=this.documentVersion.getPageNumberBySlug(this.currentPageSlug),this.module.trigger(this.module.publishedEvents.PAGE_UPDATE,{slug:this.currentPageSlug,isFirstPage:this.isFirstPage(),isLastPage:this.isLastPage(),isPageReady:this.getCurrentPage().isReady()})},this))},this)),this.documentVersion.on(this.documentVersion.MANIFEST_REMOVE_PAGE,n.bind(function(e){e+1===this.currentPage?this.module.trigger(this.module.publishedEvents.CURRENT_PAGE_DELETED):(this.pageViews.splice(e,1),this.currentPage=this.documentVersion.getPageNumberBySlug(this.currentPageSlug),this.module.trigger(this.module.publishedEvents.PAGE_UPDATE,{slug:this.currentPageSlug,isFirstPage:this.isFirstPage(),isLastPage:this.isLastPage(),isPageReady:this.getCurrentPage().isReady()}))},this)),this.documentVersion.on(this.documentVersion.MANIFEST_MOVE_PAGE,n.bind(function(e,t){var n=this.pageViews.splice(e,1)[0];this.pageViews.splice(t,0,n),this.currentPage=this.documentVersion.getPageNumberBySlug(this.currentPageSlug),this.module.trigger(this.module.publishedEvents.PAGE_UPDATE,{slug:this.currentPageSlug,isFirstPage:this.isFirstPage(),isLastPage:this.isLastPage(),isPageReady:this.getCurrentPage().isReady()})},this))},getNextPageIndex:function(){var e=!1;if(this.pageViews){e=this.currentPage+1;for(var t=this.pageViews[e-1];t&&t.isDisabled();)e++,t=this.pageViews[e-1];if(!t||t.isDisabled())if(this.documentVersion.isCarousel()){for(e=1;this.pageViews[e-1].isDisabled()&&e<this.currentPage;)e++;e>=this.currentPage&&(e=!1)}else e=!1}return e},getPreviousPageIndex:function(){var e=!1;if(this.pageViews){e=this.currentPage-1;for(var t=this.pageViews[e-1];t&&t.isDisabled();)e--,t=this.pageViews[e-1];if(!t||t.isDisabled())if(this.documentVersion.isCarousel()){for(e=this.pageViews.length;this.pageViews[e-1].isDisabled()&&e>this.currentPage;)e--;e<=this.currentPage&&(e=!1)}else e=!1}return e},isFirstPage:function(){return!1===this.getPreviousPageIndex()},isLastPage:function(){return!1===this.getNextPageIndex()},getCurrentPage:function(){return null!==this.pageViews&&this.pageViews[this.currentPage-1]},getNextPage:function(){var e=!1,t=this.getNextPageIndex();return t&&(e=this.pageViews[t-1]),e},getPreviousPage:function(){var e=!1,t=this.getPreviousPageIndex();return t&&(e=this.pageViews[t-1]),e},getPageCount:function(){return null===this.pageViews?0:this.pageViews.length},getPageViewportWidth:function(){return this.getCurrentPage().getScaleContext().originalWindowWidth},getExperienceWidth:function(){return this.documentVersion.getExperienceWidth()},getExperienceHeight:function(){return this.documentVersion.getExperienceHeight()},reset:function(e,t){if(this.$el.children().not("#ceros-branding").not(this.mainContentLink.$el).remove(),n.isNull(t)?this.currentPage=1:this.currentPage=t,null!==this.pageViews&&n.each(this.pageViews,function(e){e.close()}),this.pageViews=e,this.viewportContainer=document.createDocumentFragment(),null!==this.pageViews){this._updatePageCss();var i=[];n.each(this.pageViews,function(e){i.unshift(e.el()[0])}),n.each(i,n.bind(function(e){this.viewportContainer.appendChild(e)},this)),this.$el[0].appendChild(this.viewportContainer),this.scale()}},disablePage:function(e){this.pageViews[e-1].disable()},enablePage:function(e){this.pageViews[e-1].enable()},nextPage:function(e){if(null!==this.pageViews&&!this.isPageTransitioning()){var t=this.getNextPageIndex();if(t){var n=this.getCurrentPage(),i=this.getNextPage();this._preTransition(n,i),this.switchPage(t,y.RIGHT,e)}}},previousPage:function(e){if(null!==this.pageViews&&!this.isPageTransitioning()){var t=this.getPreviousPageIndex();if(t){var n=this.getCurrentPage(),i=this.getPreviousPage();this._preTransition(n,i),this.switchPage(t,y.LEFT,e)}}},doTransitionAnimation:function(e,i,r,o){if(r===y.NONE)return(new t.Deferred).resolve().promise();var a=new t.Deferred;this.isPageTransitionInProgress=!0,a.done(n.bind(function(){this.isPageTransitionInProgress=!1},this)),i.makeInTransition();var s=this.getPageViewportWidth()*(r===y.RIGHT?-1:1);return e.pauseAnimations(),e.el().animate({"background-position-x":s},{duration:o,easing:"easeOutCubic",step:n.bind(function(t){e.setBackgroundPositionAndScaleTransform(t,this.isPageTransitionInProgress),i.setBackgroundPositionAndScaleTransform(t-s,this.isPageTransitionInProgress)},this),complete:a.resolve}),a.promise()},_storePageScrollPosition:function(e){this.scrollPositionsByPage[e.getSlug()]=e.getScrollPosition()},_getStoredPageScrollPosition:function(e){return!n.isUndefined(e)&&n.has(this.scrollPositionsByPage,e.getSlug())?this.scrollPositionsByPage[e.getSlug()]:0},_preTransition:function(e,t){var n=e.getScaleContext();this._storePageScrollPosition(e),n.constrainedByHeight&&(this._hidePageScrollbar(e),this._hidePageScrollbar(t))},jumpToPage:function(e){if(null!==this.pageViews){var t=this.pageViews.length;e>=1&&e<=t&&(this.pageViews[e-1].isDisabled()||this.switchPage(e,y.NONE))}},isPageTransitioning:function(){return this.isPageTransitionInProgress},switchPage:function(e,t,i){if(!this.isPageTransitioning()){this.clearAutoTransitionDelay(),t==y.NONE||this.documentVersion.isAutoTransitioning()||this.getCurrentPage().pauseAnimations(),this.getCurrentPage().resetTimedTriggers();this.showPage(e,t,i).done(n.bind(function(){var e=this.getCurrentPage();this.activatePage(e),e.doCustomScaling()},this))}},showPage:function(e,i,o){i=!r.shouldReduceMotion&&i||y.NONE,o=o||500;var a=null;this.currentPage!==e&&(a=this.pageViews[this.currentPage-1]);var s=e-1;this.currentPage=e,this.currentPageSlug=this.pageViews[s].getSlug(),this.module.trigger(this.module.publishedEvents.PAGE_CHANGING,{slug:this.currentPageSlug,isFirstPage:this.isFirstPage(),isLastPage:this.isLastPage(),isPageReady:this.getCurrentPage().isReady()}),a&&a.reset();var u;if(this.documentVersion.shouldLazyLoad())u=[s];else{u=new h(this.documentVersion.getEnabledPageIndexes(),this.documentVersion.isCarousel()).getPageIndexesToLoad(s)}var l=new t.Deferred;this.attachPages(u,s).always(n.bind(function(){l.resolve()},this));var c=this.doTransitionAnimation(a,this.getCurrentPage(),i,o);return c.done(n.bind(function(){this._updatePageCss(),this._adjustPage()},this)),t.when(l,c)},_adjustPage:function(){var e=this.getCurrentPage();e.setScrollPosition(this._getStoredPageScrollPosition(e)),this._showPageScrollbar(e),this._focusPage(e)},_focusPage:function(e){r.isEmbedded||e&&e.focusScrollContainer()},activatePage:function(e){this.module.trigger(this.module.publishedEvents.PAGE_CHANGE,{slug:this.currentPageSlug,isFirstPage:this.isFirstPage(),isLastPage:this.isLastPage()}),e.activate(),m.hasFeature(v.ACCESSIBILITY)&&this.mainContentLink.setPageView(e).render(),this.setAutoTransitionDelay()},attachPages:function(i,r){var o=new t.Deferred;setTimeout(n.bind(function(){n.each(i,n.bind(function(e){this.pageViews[e].attach()},this)),"pending"===o.state()&&(e.devWarn("Page media took over 10 seconds"),o.reject())},this),1e4),this.module.trigger(this.module.publishedEvents.PAGE_BATCH_LOAD_START);var a=[];return n.each(i,n.bind(function(e){var t=this.pageViews[e],i=t.prepare();i.always(n.bind(t.attach,t)),(n.isUndefined(r)||e===r)&&a.push(i)},this)),t.when.apply(t,a).done(o.resolve),t.when.apply(t,a).fail(o.reject),o.promise()},_updatePageCss:function(){var e;n.each(this.pageViews,n.bind(function(t,n){e=n+1,e<this.currentPage&&!t.isViewed()?t.makeViewed():e!==this.currentPage||t.isTop()?e>this.currentPage&&!t.isPending()&&t.makePending():t.makeTop()},this))},scalePageComponents:function(){n.each(this.pageViews,function(e){e.scale()})},_showPageScrollbar:function(e){!c.isIos()&&this._doesPageFitInViewport(e)?e.$pageContainer.css("overflow-y","hidden"):e.$pageContainer.css("overflow-y","scroll")},_hidePageScrollbar:function(e){e.$pageContainer.css("overflow-y","hidden")},_doesPageFitInViewport:function(e){var t=e.getScaleContext(),n=e.model.getPageHeight(this.documentVersion),i=this.documentVersion.getExperienceWidth(),o=Math.round(t.windowHeight/t.ratio),a=Math.round(t.windowWidth/t.ratio),s=r.heightOverride||this.documentVersion.getExperienceHeight(),u=n<=s||n<=o,l=i<=a;return u&&l},scale:function(e){var i,r,o=this.scaleContext.getCurrentWindowScaleContext(),a=this.getExperienceWidth(),s=this.documentVersion.getScaleExperience();t("#main").css({height:o.originalWindowHeight+"px",width:o.originalWindowWidth+"px"}),this.$el.css({height:o.originalWindowHeight+"px",width:o.originalWindowWidth+"px","margin-top":o.marginTop+"px"}),null!==this.pageViews&&n.each(this.pageViews,n.bind(function(e){var t=e.model.getPageHeight(this.documentVersion),n=e.getScaleContext(),u=this._doesPageFitInViewport(e),c=u?0:l.getScrollbarWidth();if(r=this.getPageViewOffsetTop(e,n),i=this.getPageViewOffsetLeft(e,n,c),n.constrainedByWidth&&n.windowWidth<n.originalWindowWidth&&u){var d=n.originalWindowWidth-n.windowWidth,h=d/n.ratio;i+=h/2}var f=s?"hidden":"scroll";e.$pageContainer.css({width:"100%",height:"100%","overflow-y":"scroll","overflow-x":f,position:"relative"}),this._showPageScrollbar(e);var p=0;e.isPending()?p=o.originalWindowWidth:e.isViewed()&&(p=-1*o.originalWindowWidth),s?this.setPageViewScaleTransformCss(e,n):e.$el.css({height:"100%",width:"100%"}),e.setBackgroundPositionAndScaleTransform(p,this.isPageTransitionInProgress),s?e.$pageScroll.css({height:t+"px",width:a,left:i>=1?i:0,top:r>=1?r:0}):this.setPageScrollUnscaledCss(e,t,a,n),e.$pinnedContainer&&this.setPinnedContainerCss(t,n,i,r,c,a,e)},this));var u=this.getCurrentPage();!1!==u&&(this._focusPage(u),this.module.isFirstPageReadyToShow()&&u.onScrollAndWindowResize()),this.module.trigger(this.module.publishedEvents.SCALE,o)},setPageScrollUnscaledCss:function(e,t,n,i){e.$pageScroll.css({height:t+"px",width:n});var r="";t<=i.height?(r+="translateY(-50%) ",e.$pageScroll.css({top:"50%"})):e.$pageScroll.css({top:""}),n<=i.windowWidth?(r+="translateX(-50%)",e.$pageScroll.css({left:"50%"})):e.$pageScroll.css({left:""}),e.$pageScroll.css({transform:r})},setPinnedContainerCss:function(e,t,i,r,o,a,s){var u={height:e+"px",width:t.width/t.ratio,left:i>=1?i:0,top:r>=1?r:0};o?n.extend(u,{"max-width":a,width:t.originalWindowWidth/t.ratio-o}):n.extend(u,{width:a}),s.$pinnedContainer.css(u)},setPageViewScaleTransformCss:function(e,t){var n,i;this.scaleContext.useZoom(t.ratio)?(n="zoom",i=t.ratio):(n="transform",i="scale("+t.ratio+","+t.ratio+")"),e.storeScaleTransform(n,i);var r={height:t.height/t.ratio+"px",width:t.originalWindowWidth/t.ratio+"px"};r[n]=i,e.$el.css(r)},addClickShield:function(){this.$el.before(this.clickShield),this.clickShield.show()},removeClickShield:function(){this.clickShield.detach()},setAutoTransitionDelay:function(){this.clearAutoTransitionDelay(),this.documentVersion.isAutoTransitioning()&&(this.autoTransitionDelay=n.delay(n.bind(function(){this.clearAutoTransitionDelay(),this.nextPage()},this),1e3*this.documentVersion.getAutoTransitionDelay()))},clearAutoTransitionDelay:function(){clearTimeout(this.autoTransitionDelay),this.autoTransitionDelay=null},preloadMedia:function(){this.getBackgroundImagePromise()},getBackgroundImagePromise:function(){return this.backgroundImageResource?this.backgroundImageResource.getPromise():n.isNull(this.backgroundImageInfo)?t.Deferred().reject().promise():(this.loadBackgroundImage(),this.backgroundImageResource.getPromise())},loadBackgroundImage:function(){this.backgroundImageResource&&this.backgroundImageResource.cancel();var e=this.calculateBackgroundImageDimensions();this.bgImageWidth=e.width,this.bgImageHeight=e.height;var t=o.calculateWidthForDevicePixelRatio(this.bgImageWidth);return this.backgroundImageResource=s.addRasterImage(this.backgroundImageInfo.id,t),this.backgroundImageResource.loadNow(),this.backgroundImageResource},showBackground:function(e){e&&(this.backgroundContainerEl=t("#backgroundContainer"),this.backgroundImageEl=t("<img>",{width:20,height:20}),this.backgroundContainerEl.empty().append(this.backgroundImageEl),this.backgroundImageEl.on("load",n.bind(this.scaleBackground,this)).attr("src",e.getSrc()),t(window).on("resize",n.throttle(n.bind(this.resizeBackgroundImage,this),200)),this.backgroundContainerEl.fadeIn())},resizeBackgroundImage:function(){this.loadBackgroundImage().getPromise().then(n.bind(function(e){t(this.backgroundImageEl).attr("src")===e.getSrc()?this.scaleBackground():t(this.backgroundImageEl).attr("src",e.getSrc())},this))},scaleBackground:function(){var e=this.getWindowWidth(),t=this.getWindowHeight();this.backgroundContainerEl.width(e).height(t),this.backgroundImageEl.width(this.bgImageWidth).height(this.bgImageHeight).css({left:"-"+(this.bgImageWidth>e?this.bgImageWidth/2-e/2:0)+"px"})},getWindowWidth:function(){var e=t(window);return p.getExperienceContainerWidth(e)},getWindowHeight:function(){var e=t(window),n=p.getExperienceContainerHeight(e);return n+=c.getSlackHeight(n)},getPageViewOffsetTop:function(e,t){return this.documentVersion.getScaleExperience()&&t.constrainedByHeight?0:Math.max(0,(t.height/t.ratio-e.model.getPageHeight(this.documentVersion))/2)},getPageViewOffsetLeft:function(e,t,n){var i,r=this.documentVersion.getScaleExperience();if(n)i=n;else{i=this._doesPageFitInViewport(e)?0:l.getScrollbarWidth()}return r&&t.constrainedByWidth?0:Math.max(0,(t.windowWidth/t.ratio-this.getExperienceWidth()-i)/2)},calculateBackgroundImageDimensions:function(){var e=this.backgroundImageInfo.original.width,t=this.backgroundImageInfo.original.height,n=this.getWindowWidth()/e,i=this.getWindowHeight()/t,r=n>i?n:i;return{width:Math.round(r*e),height:Math.round(r*t)}}})}),define("modules/page/views/AbstractPageChildView",["jquery","lodash","backbone","shared/views/PlayerAbstractView"],function(e,t,n,i){"use strict";return i.extend({initiallyVisible:!0,mediaHasBeenLoaded:!0,childViews:null,initialize:function(){i.prototype.initialize.call(this),this.parentViews=[],this.visible=this.options.visible,this.initiallyVisible=this.options.visible,this.mediaHasBeenLoaded=this.options.visible},close:function(){},preloadMedia:function(){},preloadMediaNow:function(){},attachMedia:function(){},scaleComponent:function(){},doCustomScaling:function(){},getRatioForCustomScaling:function(){return 1},onAttach:function(){},pauseAnimations:function(){},resumeAnimations:function(){},reset:function(){},getExtents:function(){},getId:function(){return this.id},isInitiallyVisible:function(){return this.initiallyVisible},runAllChildViewExitAnimaions:function(){},areAllParentsVisible:function(){},childrenUseBlendingModes:function(){return!1},hasActiveBlendingMode:function(){return!1}})}),define("ExtentsUtils",["backbone","lodash"],function(e,t){"use strict";return{getExtentsFromDimensions:function(e,t,n,i,r,o){var a=this.getExtentsPointsFromDimensions(e,t,n,i,r,o);return{x1:Math.round(Math.min(a[0].x,a[1].x,a[2].x,a[3].x)),y1:Math.round(Math.min(a[0].y,a[1].y,a[2].y,a[3].y)),x2:Math.round(Math.max(a[0].x,a[1].x,a[2].x,a[3].x)),y2:Math.round(Math.max(a[0].y,a[1].y,a[2].y,a[3].y))}},getExtentsPointsFromDimensions:function(e,t,n,i,r,o){if(e-=o,t-=o,n+=2*o,i+=2*o,0!==r){var a=e+n/2,s=t+i/2;return[Math.rotateCoord(e,t,a,s,r),Math.rotateCoord(e+n,t,a,s,r),Math.rotateCoord(e+n,t+i,a,s,r),Math.rotateCoord(e,t+i,a,s,r)]}return[new window.CerosMath.Point(e,t),new window.CerosMath.Point(e+n,t),new window.CerosMath.Point(e+n,t+i),new window.CerosMath.Point(e,t+i)]},getExtentsFromObjectExtentsInsideSmartGroup:function(e,t){var n=t.transformPointFromIsolationModeToRotatedPageCoordinateSpace(new window.CerosMath.Point(e.x1,e.y1)),i=t.transformPointFromIsolationModeToRotatedPageCoordinateSpace(new window.CerosMath.Point(e.x2,e.y2));return{x1:n.x,y1:n.y,xMidpoint:0,yMidpoint:0,x2:i.x,y2:i.y}},getBoundingExtentsFromObjectExtentsInsideSmartgroup:function(e,t){var n=t.transformPointFromIsolationModeToRotatedPageCoordinateSpace(new window.CerosMath.Point(e.x1,e.y1)),i=t.transformPointFromIsolationModeToRotatedPageCoordinateSpace(new window.CerosMath.Point(e.x2,e.y2)),r=Math.min(n.x,i.x),o=Math.max(n.x,i.x),a=Math.min(n.y,i.y),s=Math.max(n.y,i.y);return{x1:r,y1:a,xMidpoint:o-(o-r)/2,yMidpoint:s-(s-a)/2,x2:o,y2:s}},createExtentsFromCoordinates:function(e,t,n,i){return{x1:e,y1:t,xMidpoint:e+(n-e)/2,yMidpoint:t+(i-t)/2,x2:n,y2:i}},createExtentsFromSelectedComponentCollection:function(e){var t=e.getLeftmostX(!0),n=e.getTopmostY(!0),i=e.getRightmostX(!0),r=e.getBottommostY(!0);return this.createExtentsFromCoordinates(t,n,i,r)},getSmallestContainingRectangle:function(){var n,i,r,o,a;return t.each(arguments,function(s){a=s instanceof e.Model&&t.isFunction(s.getExtents)?s.getExtents():s,void 0===n?(n=a.x1,i=a.y1,r=a.x2,o=a.y2):(n=Math.min(n,a.x1),i=Math.min(i,a.y1),r=Math.max(r,a.x2),o=Math.max(o,a.y2))}),0===arguments.length&&(n=0,i=0,r=0,o=0),{x1:n,y1:i,x2:r,y2:o}},getSmallestContainingRectangleInPageCoords:function(){var e,n,i,r,o;return t.each(arguments,function(t){o=t.getExtentsInPageCoords(),void 0===e?(e=o.x1,n=o.y1,i=o.x2,r=o.y2):(e=Math.min(e,o.x1),n=Math.min(n,o.y1),i=Math.max(i,o.x2),r=Math.max(r,o.y2))}),0===arguments.length&&(e=0,n=0,i=0,r=0),{x1:e,y1:n,x2:i,y2:r}},createHoverArea:function(e,t,n){var i,r,o,a,s=[],u=n?1:0;return i=e.y1<t.y1?e:t,s.push({x:i.x1,y:i.y1}),s.push({x:i.x2+u,y:i.y1}),a=e.x2>t.x2?e:t,a!==i&&s.push({x:a.x2+u,y:a.y1}),s.push({x:a.x2+u,y:a.y2+u}),r=e.y2>t.y2?e:t,r!==a&&s.push({x:r.x2+u,y:r.y2+u}),s.push({x:r.x1,y:r.y2+u}),o=e.x1<t.x1?e:t,o!==r&&s.push({x:o.x1,y:o.y2+u}),o!==i&&s.push({x:o.x1,y:o.y1}),s}}}),define("modules/page/views/FolderView",["jquery","lodash","backbone","modules/page/views/AbstractPageChildView","ExtentsUtils"],function(e,t,n,i,r){"use strict";return i.extend({initialize:function(){i.prototype.initialize.call(this),this.childViews={}},hide:function(){t.each(this.childViews,function(e){e.hide()})},addContainerId:function(e){t.each(this.childViews,function(t){t.addContainerId(e)})},addParentView:function(e){this.parentViews.push(e),t.each(this.childViews,function(t){t.addParentView(e)})},areAllParentsVisible:function(){return t.every(this.parentViews,function(e){return e.visible})},isHovered:function(){return t.some(this.childViews,function(e){e.isHovered()})},addPointerEvents:function(){t.each(this.childViews,function(e){e.addPointerEvents()})},removePointerEventsIfNoInteractions:function(){t.each(this.childViews,function(e){e.removePointerEventsIfNoInteractions()})},runAllChildViewExitAnimations:function(n){this.runningExitAnimations=!0,n=n||[],t.each(this.childViews,function(e){e.runAllChildViewExitAnimations(n)});var i=this;return e.when.apply(e,n).done(function(){i.runningExitAnimations=!1}),n},reset:function(){this.runningExitAnimations=!1},getExtents:function(){var e;return this.childViews?t.each(this.childViews,function(t){var n=t.getExtents();e=e?r.getSmallestContainingRectangle(e,n):n}.bind(this)):e={},e},getFirstAvailableZIndex:function(){var e=0;return this.childViews&&this.childViews.length>0&&(e="folder"===this.childViews[0].options.type?this.childViews[0].getFirstAvailableZIndex():this.childViews[0].$el.css("zIndex")||0),e},isFixedPosition:function(){return!1}})}),define("sequenceBuilder",["log","jquery","lodash"],function(e,t,n){"use strict";var i="undefined"!=typeof WebKitAnimationEvent?"-webkit-":"undefined"!=typeof AnimationEvent?"":null,r=function(){this.ruleBuffer=[],this.keyframeInc=0,this.keyframeMap={},this.sequenceInc=0,this.sequenceMap={},this.pauseClassCache=[]};n.extend(r.prototype,{reset:function(){this.ruleBuffer=[],this.keyframeInc=0,this.keyframeMap={},this.sequenceInc=0,this.sequenceMap={},this.pauseClassCache=[]},_generateKeyframe:function(e,t,r,o){var a=e+"|"+JSON.stringify(t);if(0!==o&&(a+="|"+r+"|"+o),this.keyframeMap.hasOwnProperty(a))return this.keyframeMap[a];var s="@"+i+"keyframes keyframe"+this.keyframeInc+"{",u=n.sortBy(n.keys(t),function(e){return parseInt(e,10)});if(0===o)n.each(u,function(n){s+=n+"{"+e+":"+t[n]+"}"});else{var l=n.round(o/(o+r)*100,5),c=100-l;s+="0%{"+e+":"+t["0%"]+"}"+l+"%{"+e+":"+t["0%"]+"}",n.each(u,function(n){"0%"!=n&&(s+=Math.round(l+c*(parseInt(n,10)/100))+"%{"+e+":"+t[n]+"}")})}return s+="}",this.ruleBuffer.push(s),this.keyframeMap[a]="keyframe"+this.keyframeInc++,this.keyframeMap[a]},_generatePauseClass:function(e){var t="sequencePause"+e;if(!n.includes(this.pauseClassCache,t)){this.pauseClassCache.push(t);var r=[];n(e).times(function(){r.push("paused")}),this.ruleBuffer.push("."+t+"{"+i+"animation-play-state:"+r.join(",")+" !important;}")}return t},_generateRunClass:function(e,t,r,o){var a="sequenceRun"+this.sequenceInc++;return this.ruleBuffer.push("."+a+"{"+i+"animation-name:"+e.join(",")+";"+i+"animation-duration:"+t.join(",")+";"+i+"animation-timing-function:"+r.join(",")+";"+i+"animation-fill-mode:"+n.map(e,function(){return"both"}).join(",")+";"+i+"animation-play-state:"+n.map(e,function(){return"running"}).join(",")+";"+i+"animation-iteration-count:"+o.join(",")+";}"),a},generate:function(e){var t=n.map(e,function(e){return e.getKey()}).join("&");if(!this.sequenceMap.hasOwnProperty(t)){var r=[],o=[],a=[],s=[],u=this;n.each(e,function(e){var t="transform"==e.property?i+"transform":e.property;r.push(u._generateKeyframe(t,e.frames,e.duration,e.delay)),o.push(e.duration+e.delay+"ms"),a.push(e.easing),s.push(e.iterations)}),this.sequenceMap[t]={runClass:this._generateRunClass(r,o,a,s),pauseClass:this._generatePauseClass(e.length)}}return this.sequenceMap[t]},flush:function(){this.ruleBuffer.length>0&&(t("head").append(t("<style></style>").html(this.ruleBuffer.join("\n"))),this.ruleBuffer=[])}});var o=null;return function(){return null===o&&(o=new r),o}()}),define("shared/utils/AnimationTweenDelegate",["log","jquery","lodash"],function(e,t,n){"use strict";var i={Tween:function(e,t,n,i,r,o){if(this.property=e,this.frames=t,this.duration=n,this.delay=i||0,this.iterations=r,this.easing=o,!this.frames.hasOwnProperty("0%"))throw Error("Tween must define 0% keyframe!");if(!this.frames.hasOwnProperty("100%"))throw Error("Tween must define 100% keyframe!");this._normalize()}};return i.Tween.prototype={_normalize:function(){n.isUndefined(this.iterations)?this.iterations=1:n.isNumber(this.iterations)?(this.iterations=parseInt(this.iterations,10),this.iterations<0&&(this.iterations=0)):this.iterations="infinite"},getKey:function(){for(var e=n.values(this),t=0;t<e.length;t++)"object"==typeof e[t]&&(e[t]=JSON.stringify(e[t]));return e.join("|")}},i}),define("shared/utils/CssUtils",["lodash"],function(e){"use strict";return{concatTransform:function(t,n){return(e.isUndefined(t)||"none"===t)&&(t=""),n=t+" "+n,n.trim()},removeMatrixTransformAndAddNewScaleTransform:function(e,t){return e=e.replace(/matrix\(.*\)/g,""),e=e.replace(/scale\(.*\)/g,""),e=e.replace(/none/g,""),e+=" scale("+t+")",e.trim()}}}),define("shared/utils/WebkitUtils",["shared/utils/CssUtils","device"],function(e,t){"use strict";return{hardwareAccelerateTransform:function(t){return e.concatTransform(t,"translate3d(0,0,0)")},requiresHardwareAccelerateTransform:function(e,n){return t.isDesktopSafari()||t.isIos()&&(e||n)}}}),define("libs/utils/animations/AnimationEffectUtils",["lodash"],function(e){"use strict";var t=["noDirection","center","left","right","up","down","topRight","topLeft","bottomRight","bottomLeft","backwards","forwards","verticalCenter","horizontalCenter","clockwise","counterClockwise","diagonal1","diagonal2"],n={},i={"Entry Effects":{FADE_IN:{label:"Fade In",directions:{noDirection:"fadeIn",left:"fadeLeft",right:"fadeRight",up:"fadeUp",down:"fadeDown"}},SPIN_FADE_IN:{label:"Spin and Fade In",directions:{counterClockwise:"spinLeftFade",clockwise:"spinRightFade"}},SLIDE_IN:{label:"Slide In",directions:{center:"enlargeFadeIn",left:"slideLeft",right:"slideRight",up:"slideUp",down:"slideDown",topRight:"slideTopRight",topLeft:"slideTopLeft",bottomRight:"slideBottomRight",bottomLeft:"slideBottomLeft"}},BOUNCE_IN:{label:"Bounce In",directions:{left:"bounceRight",right:"bounceLeft",up:"bounceUp",down:"bounceDown"}},LIGHTSPEED_IN:{label:"Light Speed In",directions:{left:"lightSpeedLeftIn",right:"lightSpeedRightIn"}},ROLL_IN:{label:"Roll In",directions:{left:"rollLeftIn",right:"rollRightIn"}},FLIP_IN:{label:"Rock In",directions:{verticalCenter:"flipInX",horizontalCenter:"flipInY"}},SHIFT_IN:{label:"Shift In",directions:{left:"shiftLeft",right:"shiftRight",up:"shiftUp",down:"shiftDown"}},SWING:{label:"Swing",directions:{left:"swingLeft",right:"swingRight",up:"swingTop",down:"swingBottom",bottomRight:"swingTopLeft",bottomLeft:"swingTopRight",topRight:"swingBottomLeft",topLeft:"swingBottomRight"}},SCALE_UP:{label:"Scale Up",directions:{left:"scaleUpLeft",right:"scaleUpRight",center:"enlarge",up:"scaleUpTop",down:"scaleUpBottom"}},EXPAND:{label:"Expand",directions:{left:"scaleUpHorizontalLeft",right:"scaleUpHorizontalRight",down:"scaleUpVerticalTop",up:"scaleUpVerticalBottom",horizontalCenter:"scaleUpHorizontalCenter",verticalCenter:"scaleUpVerticalCenter"}}},"Attention Seekers":{SPIN:{label:"Spin",directions:{clockwise:"spinRight",counterClockwise:"spinLeft"}},FLASH:{label:"Flash",directions:{noDirection:"flash"}},PULSE:{label:"Pulse",directions:{noDirection:"pulse"}},BOB:{label:"Bob",directions:{noDirection:"bob"}},TADA:{label:"Tada",directions:{noDirection:"tada"}},FLIP:{label:"Flip",directions:{horizontalCenter:"flip",verticalCenter:"flipHorizontal",diagonal2:"flipDiagonalRight",diagonal1:"flipDiagonalLeft"}},ROTATE_90:{label:"Rotate 90°",directions:{clockwise:"rotateCW90",counterClockwise:"rotateCCW90"}},SHAKE:{label:"Shake",directions:{noDirection:"shake"}},JELLO:{label:"Jello",directions:{noDirection:"jelloHorizontal"}},WOBBLE:{label:"Wobble",directions:{down:"wobbleTop",up:"wobbleBottom",right:"wobbleLeft",left:"wobbleRight"}},VIBRATE:{label:"Vibrate",directions:{noDirection:"vibrate"}},KEN_BURNS:{label:"Ken Burns",directions:{up:"kenBurnsTop",down:"kenBurnsBottom",left:"kenBurnsLeft",right:"kenBurnsRight"}}},"Exit Effects":{FADE_OUT:{label:"Fade Out",directions:{noDirection:"fadeOut",left:"fadeLeftOut",right:"fadeRightOut",up:"fadeUpOut",down:"fadeDownOut"}},SPIN_FADE_OUT:{label:"Spin and Fade Out",directions:{counterClockwise:"spinLeftFadeOut",clockwise:"spinRightFadeOut"}},SLIDE_OUT:{label:"Slide Out",directions:{right:"slideLeftOut",left:"slideRightOut",up:"slideUpOut",down:"slideDownOut",noDirection:"shrinkFadeOut",topRight:"slideTopRightOut",topLeft:"slideTopLeftOut",bottomRight:"slideBottomRightOut",bottomLeft:"slideBottomLeftOut"}},BOUNCE_OUT:{label:"Bounce Out",directions:{left:"bounceLeftOut",right:"bounceRightOut",up:"bounceUpOut",down:"bounceDownOut"}},LIGHTSPEED_OUT:{label:"Light Speed Out",directions:{left:"lightSpeedLeftOut",right:"lightSpeedRightOut"}},ROLL_OUT:{label:"Roll Out",directions:{left:"rollLeftOut",right:"rollRightOut"}},FLIP_OUT:{label:"Rock Out",directions:{verticalCenter:"flipOutX",horizontalCenter:"flipOutY"}},SHIFT_OUT:{label:"Shift Out",directions:{left:"shiftLeftOut",right:"shiftRightOut",up:"shiftUpOut",down:"shiftDownOut"}},SCALE_DOWN:{label:"Scale Down",directions:{left:"scaleDownLeft",right:"scaleDownRight",center:"shrink",down:"scaleDownTop",up:"scaleDownBottom"}},SHRINK:{label:"Shrink",directions:{down:"scaleDownVerticalTop",up:"scaleDownVerticalBottom",left:"scaleDownHorizontalLeft",right:"scaleDownHorizontalRight",verticalCenter:"scaleDownVerticalCenter",horizontalCenter:"scaleDownHorizontalCenter"}}}},r={},o={},a={};return e.each(i,function(n,i){a[i]={},e.each(n,function(n,s){r[s]=n,a[i][s]=n.label,e.each(t,function(e){n.directions.hasOwnProperty(e)&&(o[n.directions[e]]={title:s,direction:e})})})}),{DIRECTIONS:t,EFFECT_MAP:r,DROPDOWN_OPTIONS:a,getTypeFromTitleAndDirection:function(e,t){return t||(t="noDirection"),r[e].directions[t]},getTitleAndDirectionFromType:function(e){return o[e]},getDirectionsForTitle:function(t){return e.keys(r[t].directions)},isEntryAnimation:function(t){if(n.hasOwnProperty(t))return n[t];for(var r=!1,o=i["Entry Effects"],a=Object.keys(o),s=0;s<a.length;++s){var u=e.values(o[a[s]].directions);if(e.includes(u,t)){r=!0;break}}return n[t]=r,r}}}),define("animation",["log","jquery","lodash","backbone","device","sequenceBuilder","shared/utils/DelegateUtils","shared/utils/AnimationTweenDelegate","shared/utils/WebkitUtils","cssHooksTransform","libs/utils/animations/AnimationEffectUtils"],function(e,t,n,i,r,o,a,s,u,l,c){"use strict";var d="undefined"!=typeof WebKitAnimationEvent?"webkitAnimationEnd":"undefined"!=typeof AnimationEvent?"animationend":null,h="undefined"!=typeof WebKitAnimationEvent?"webkitAnimationStart":"undefined"!=typeof AnimationEvent?"animationstart":null,f=function(e){var n=t.extend({$el:null,name:"unknown"},e||{});this.$el=n.$el,this.name=n.name,this.compiled=!1,this.tweens=[],this.eventState={},this.runClass=null,this.pauseClass=null,this.initialState={},this.finalState={},this.loop=!1,this.requiresHardwareAcceleration=n.requiresHardwareAcceleration};return f.EASING={EASE:"ease",EASE_IN:"ease-in",EASE_OUT:"ease-out",EASE_IN_OUT:"ease-in-out",LINEAR:"linear"},f.RUNNING_STATE="running",f.COMPLETE_STATE="complete",f.START_EVENT="start",f.PAUSE_EVENT="pause",f.RESUME_EVENT="resume",f.END_EVENT="end",a.mergeDelegates(f,s),n.extend(f.prototype,i.Events,{add:function(t){return this.compiled?(e.warn("Animation already compiled!"),this):(this.tweens.push(t),this)},compile:function(){if(this.compiled)return this;if(n.isEmpty(this.tweens))return this;var e=o.generate(this.tweens);return this.runClass=e.runClass,this.pauseClass=e.pauseClass,this._buildRestingStates(),this.compiled=!0,this},precompile:function(e){if(n.isUndefined(e)||(this.$el=e),!n.isNull(this.$el)){var t={};n.each(["opacity","left","top","transform"],n.bind(function(e){t[e]=this.$el.css(e)},this)),t["transform-origin"]=this.$el.get(0).style.transformOrigin,this.initialState=t}},_buildRestingStates:function(){n.each(this.tweens,n.bind(function(e){this.initialState[e.property]=e.frames["0%"],this.finalState[e.property]=e.frames["100%"]},this)),n.has(this.finalState,"transform")&&this.requiresHardwareAcceleration&&(this.finalState.transform=u.hardwareAccelerateTransform(this.finalState.transform))},resetToInitialState:function(){n.isNull(this.$el)||this.$el.css(this.initialState)},setToFinalState:function(){n.isNull(this.$el)||this.$el.css(this.finalState)},isRunning:function(){return!n.isNull(this.$el)&&this.$el.hasClass(this.runClass)},isPaused:function(){return!n.isNull(this.$el)&&this.$el.hasClass(this.pauseClass)},play:function(e){if(this.compile(),n.isUndefined(e)||(this.$el=e),!n.isNull(this.$el))return o.flush(),this.eventState={},this.$el.bind(d,n.bind(function(e){e.originalEvent.target===this.$el[0]&&(this.eventState[e.originalEvent.animationName]=!1),n.every(n.values(this.eventState),function(e){return!e})&&this.finish()},this)),this.$el.bind(h,n.bind(function(e){e.originalEvent.target===this.$el[0]&&(this.eventState[e.originalEvent.animationName]=!0)},this)),this.$el[0].offsetWidth,"none"===this.$el.css("display")&&this.$el.show(),this.$el.addClass(this.runClass),this.trigger(f.START_EVENT),this},pause:function(){this.compiled&&!n.isNull(this.$el)&&this.isRunning()&&!this.isPaused()&&(this.$el.addClass(this.pauseClass),this.trigger(f.PAUSE_EVENT))},resume:function(){this.compiled&&!n.isNull(this.$el)&&this.isPaused()&&(this.$el.removeClass(this.pauseClass),this.trigger(f.RESUME_EVENT))},finish:function(){this.$el.css(this.finalState),"0"===this.$el.css("opacity")&&this.$el.hide(),this.cleanup(),this.trigger(f.END_EVENT)},cleanup:function(){this.compiled&&!n.isNull(this.$el)&&this.$el.off(d).off(h).removeClass(this.runClass).removeClass(this.pauseClass)},isInProgress:function(){return this.$el.hasClass(this.runClass)},isEntryAnimation:function(){return c.isEntryAnimation(this.name)},setLoop:function(e){this.loop=e},isLooping:function(){return this.loop}}),f}),define("animationTypes",["lodash","log","animation","device"],function(e,t,n,i){"use strict";var r={0:[0,0],15:[-30,6],30:[15,-6],45:[-15,3.6],60:[9,-2.4],75:[-6,1.2],100:[0,0]},o={0:[1,1],30:[1.25,.75],40:[.75,1.25],50:[1.15,.85],65:[.95,1.15],
75:[1.05,.95],100:[1,1]},a={0:0,10:2,20:-4,30:4,40:-4,50:4,60:-4,70:4,80:-2,90:2,100:0},s={0:[0,0,0],20:[-3,-.1,-.1],30:[3,.1,.1],40:[-3,.1,.1],50:[3,.1,.1],60:[-3,.1,.1],70:[3,.1,.1],80:[-3,.1,.1],90:[3,.1,.1],100:[0,0,0]},u={0:[0,0],5:[-2,2],10:[-2,-2],15:[2,2],20:[2,-2],25:[-2,2],30:[-2,-2],35:[2,2],40:[2,-2],45:[-2,2],50:[-2,-2],55:[2,2],60:[2,-2],65:[-2,2],70:[-2,-2],75:[2,2],80:[2,-2],85:[-2,2],90:[-2,-2],95:[2,2],100:[0,0]};return{compileNewSequence:function(i,r,o){var a=null;if(e.isString(r.type)&&!e.isEmpty(r.type)&&e.isNumber(r.duration)&&r.duration>0){var s={$el:i,name:r.type,requiresHardwareAcceleration:o.get("requiresHardwareAcceleration")};a=new n(s),a.precompile(),!e.isUndefined(r.delay)&&e.isNumber(r.delay)||(r.delay=0),!0===r.loop&&a.setLoop(!0),e.isFunction(this[r.type])?this[r.type](a,r,o):t.warn("Animation type not supported: "+JSON.stringify(r)),a.compile()}return a},getIterations:function(e){var t=e.iterations?e.iterations:1;return!0===e.loop&&(t="infinite"),t},getDuration:function(e){return 1e3*e.duration},getDelay:function(e){return 1e3*e.delay},getEasing:function(e){return e.easing},buildTween:function(e,t,i){return new n.Tween(t,i,this.getDuration(e),this.getDelay(e),this.getIterations(e),this.getEasing(e))},fadeIn:function(e,t,n){e.add(this.buildTween(t,"opacity",{"0%":0,"100%":n.get("opacity")}))},fadeOut:function(e,t,n){e.add(this.buildTween(t,"opacity",{"0%":n.get("opacity"),"100%":0}))},spinSequence:function(e,t,n,i,r){var o=n.getScale(),a=n.getTransformOriginString(.5,.5);e.add(this.buildTween(t,"transform",{"0%":"rotate("+i+"deg) scale("+o.x+","+o.y+")","100%":"rotate("+r+"deg) scale("+o.x+","+o.y+")"})),e.add(this.buildTween(t,"transform-origin",{"0%":a,"100%":a}))},spinRight:function(e,t,n){var i=n.get("rotation");this.spinSequence(e,t,n,i-360,i)},spinLeft:function(e,t,n){var i=n.get("rotation");this.spinSequence(e,t,n,i+360,i)},rotateCW90:function(e,t,n){var i=n.get("rotation");this.spinSequence(e,t,n,i-90,i)},rotateCCW90:function(e,t,n){var i=n.get("rotation");this.spinSequence(e,t,n,i+90,i)},slideInXSequence:function(e,t,n,r){var o=n.get("rotation"),a=n.getScale(),s=n.get("x");i.mobile()?e.add(this.buildTween(t,"left",{"0%":r.x+"px","100%":s+"px"})):e.add(this.buildTween(t,"transform",{"0%":"translateX("+(r.x-s)+"px) rotate("+o+"deg) scale("+a.x+","+a.y+")","100%":"translateX(0px) rotate("+o+"deg) scale("+a.x+","+a.y+")"}))},slideInYSequence:function(e,t,n,r){var o=n.get("rotation"),a=n.getScale(),s=n.get("y");i.mobile()?e.add(this.buildTween(t,"top",{"0%":r.y+"px","100%":s+"px"})):e.add(this.buildTween(t,"transform",{"0%":"translateY("+(r.y-s)+"px) rotate("+o+"deg) scale("+a.x+","+a.y+")","100%":"translateY(0px) rotate("+o+"deg) scale("+a.x+","+a.y+")"}))},slideInXYSequence:function(e,t,n,r,o){var a=n.get("rotation"),s=n.getScale(),u=n.get("x"),l=n.get("y");i.mobile()?(e.add(this.buildTween(t,"left",{"0%":r.x+"px","100%":u+"px"})),e.add(this.buildTween(t,"top",{"0%":o.y+"px","100%":l+"px"}))):e.add(this.buildTween(t,"transform",{"0%":"translateX("+(r.x-u)+"px) translateY("+(o.y-l)+"px) rotate("+a+"deg) scale("+s.x+","+s.y+")","100%":"translateX(0px) translateY(0px) rotate("+a+"deg) scale("+s.x+","+s.y+")"}))},slideLeft:function(e,t,n){this.slideLeftIn(e,t,n)},slideLeftIn:function(e,t,n){var i=n.getOffPageRight();this.slideInXSequence(e,t,n,i)},slideRight:function(e,t,n){this.slideRightIn(e,t,n)},slideRightIn:function(e,t,n){var i=n.getOffPageLeft();this.slideInXSequence(e,t,n,i)},slideDown:function(e,t,n){this.slideDownIn(e,t,n)},slideDownIn:function(e,t,n){var i=n.getOffPageTop();this.slideInYSequence(e,t,n,i)},slideUp:function(e,t,n){this.slideUpIn(e,t,n)},slideUpIn:function(e,t,n){var i=n.getOffPageBottom();this.slideInYSequence(e,t,n,i)},slideTopRight:function(e,t,n){var i=n.getOffPageBottom(),r=n.getOffPageLeft();this.slideInXYSequence(e,t,n,r,i)},slideTopLeft:function(e,t,n){var i=n.getOffPageRight(),r=n.getOffPageBottom();this.slideInXYSequence(e,t,n,i,r)},slideBottomRight:function(e,t,n){var i=n.getOffPageTop(),r=n.getOffPageLeft();this.slideInXYSequence(e,t,n,r,i)},slideBottomLeft:function(e,t,n){var i=n.getOffPageTop(),r=n.getOffPageRight();this.slideInXYSequence(e,t,n,r,i)},slideOutSequence:function(e,t,n,i){var r=n.get("x"),o=n.get("y");e.add(this.buildTween(t,"left",{"0%":r+"px","100%":i.x+"px"})),e.add(this.buildTween(t,"top",{"0%":o+"px","100%":i.y+"px"}))},slideOutXYSequence:function(e,t,n,r,o){var a=n.get("rotation"),s=n.getScale(),u=n.get("x"),l=n.get("y");i.mobile()?(e.add(this.buildTween(t,"left",{"0%":u+"px","100%":r.x+"px"})),e.add(this.buildTween(t,"top",{"0%":l+"px","100%":o.y+"px"}))):e.add(this.buildTween(t,"transform",{"0%":"translateX(0px) translateY(0px) rotate("+a+"deg) scale("+s.x+","+s.y+")","100%":"translateX("+(r.x-u)+"px) translateY("+(o.y-l)+"px) rotate("+a+"deg) scale("+s.x+","+s.y+")"}))},slideLeftOut:function(e,t,n){var i=n.getOffPageRight();this.slideOutSequence(e,t,n,i)},slideRightOut:function(e,t,n){var i=n.getOffPageLeft();this.slideOutSequence(e,t,n,i)},slideDownOut:function(e,t,n){var i=n.getOffPageBottom();this.slideOutSequence(e,t,n,i)},slideUpOut:function(e,t,n){var i=n.getOffPageTop();this.slideOutSequence(e,t,n,i)},slideTopRightOut:function(e,t,n){var i=n.getOffPageTop(),r=n.getOffPageRight();this.slideOutXYSequence(e,t,n,r,i)},slideTopLeftOut:function(e,t,n){var i=n.getOffPageTop(),r=n.getOffPageLeft();this.slideOutXYSequence(e,t,n,r,i)},slideBottomRightOut:function(e,t,n){var i=n.getOffPageRight(),r=n.getOffPageBottom();this.slideOutXYSequence(e,t,n,i,r)},slideBottomLeftOut:function(e,t,n){var i=n.getOffPageLeft(),r=n.getOffPageBottom();this.slideOutXYSequence(e,t,n,i,r)},shake:function(t,n,i){var r=i.get("rotation"),o=i.getTransformOriginString(.5,.5,!0),s=i.getScale(),u={};e.each(a,function(e,t){u[t+"%"]="rotate("+(r+e)+"deg) scale("+s.x+", "+s.y+")"}),t.add(this.buildTween(n,"transform",u)),t.add(this.buildTween(n,"transform-origin",{"0%":o,"100%":o}))},shiftInSequence:function(e,t,n,i){var r=n.get("rotation"),o=n.getScale();i.x*=o.x,i.y*=o.y,e.add(this.buildTween(t,"transform",{"0%":"translate("+i.x+"px,"+i.y+"px) rotate("+r+"deg) scale("+o.x+","+o.y+")","100%":"translate(0,0) rotate("+r+"deg) scale("+o.x+","+o.y+")"}))},shiftLeft:function(e,t,n){var i=n.get("allWidth"),r=n.getRelativeRotatedPoint(i,0);this.shiftInSequence(e,t,n,r)},shiftRight:function(e,t,n){var i=n.get("allWidth"),r=n.getRelativeRotatedPoint(-1*i,0);this.shiftInSequence(e,t,n,r)},shiftDown:function(e,t,n){var i=n.get("allHeight"),r=n.getRelativeRotatedPoint(0,-1*i);this.shiftInSequence(e,t,n,r)},shiftUp:function(e,t,n){var i=n.get("allHeight"),r=n.getRelativeRotatedPoint(0,i);this.shiftInSequence(e,t,n,r)},shiftOutSequence:function(e,t,n,i){var r=n.get("rotation"),o=n.getScale();i.x*=o.x,i.y*=o.y,e.add(this.buildTween(t,"transform",{"0%":"translate(0,0) rotate("+r+"deg) scale("+o.x+","+o.y+")","100%":"translate("+i.x+"px,"+i.y+"px) rotate("+r+"deg) scale("+o.x+","+o.y+")"}))},shiftLeftOut:function(e,t,n){var i=n.get("allWidth"),r=n.getRelativeRotatedPoint(-1*i,0);this.shiftOutSequence(e,t,n,r)},shiftRightOut:function(e,t,n){var i=n.get("allWidth"),r=n.getRelativeRotatedPoint(i,0);this.shiftOutSequence(e,t,n,r)},shiftDownOut:function(e,t,n){var i=n.get("allHeight"),r=n.getRelativeRotatedPoint(0,i);this.shiftOutSequence(e,t,n,r)},shiftUpOut:function(e,t,n){var i=n.get("allHeight"),r=n.getRelativeRotatedPoint(0,-1*i);this.shiftOutSequence(e,t,n,r)},flash:function(e,t,n){var i=n.get("opacity");e.add(this.buildTween(t,"opacity",{"0%":i,"50%":0,"100%":i}))},pulse:function(e,t,n){var i=n.get("rotation"),r=n.getScale();e.add(this.buildTween(t,"transform",{"0%":"rotate("+i+"deg) scale("+r.x+","+r.y+")","50%":"rotate("+i+"deg) scale("+(r.x+.1)+","+(r.y+.1)+")","100%":"rotate("+i+"deg) scale("+r.x+","+r.y+")"}))},bob:function(e,t,n){var i=n.get("rotation"),r=n.getScale(),o=n.getRelativeRotatedPoint(0,-30),a=n.getRelativeRotatedPoint(0,-15);e.add(this.buildTween(t,"transform",{"0%":"translate(0,0) rotate("+i+"deg) scale("+r.x+","+r.y+")","40%":"translate("+o.x+"px,"+o.y+"px) rotate("+i+"deg) scale("+r.x+","+r.y+")","50%":"translate(0,0) rotate("+i+"deg) scale("+r.x+","+r.y+")","60%":"translate("+a.x+"px,"+a.y+"px) rotate("+i+"deg) scale("+r.x+","+r.y+")","80%":"translate(0,0) rotate("+i+"deg) scale("+r.x+","+r.y+")","100%":"translate(0,0) rotate("+i+"deg) scale("+r.x+","+r.y+")"}))},tada:function(t,n,i){var r=i.get("rotation"),o=i.getScale(),a={};e.each(s,function(e,t){a[t+"%"]="rotate("+(r+e[0])+"deg) scale("+(o.x+e[1])+", "+(o.y+e[2])+")"}),t.add(this.buildTween(n,"transform",a));var u=i.getTransformOriginString(.5,.5);t.add(this.buildTween(n,"transform-origin",{"0%":u,"100%":u}))},flipSequence:function(e,t,n,i,r){var o=n.getOffsetRotation(),a=Math.rotateCoord(i,r,0,0,o),s=n.get("rotation"),u=n.getScale();e.add(this.buildTween(t,"transform",{"0%":"rotate3d("+a.x+","+a.y+", 0, 180deg) rotateZ("+s+"deg) scale("+u.x+", "+u.y+")","100%":"rotate3d("+a.x+","+a.y+", 0, 0deg) rotateZ("+s+"deg) scale("+u.x+", "+u.y+")"}));var l=n.getTransformOriginString(.5,.5);e.add(this.buildTween(t,"transform-origin",{"0%":l,"100%":l}))},flip:function(e,t,n){this.flipSequence(e,t,n,0,1)},flipHorizontal:function(e,t,n){this.flipSequence(e,t,n,1,0)},flipDiagonalRight:function(e,t,n){this.flipSequence(e,t,n,1,1)},flipDiagonalLeft:function(e,t,n){this.flipSequence(e,t,n,-1,1)},flipInX:function(e,t,n){var i=n.get("rotation"),r=n.getOffsetRotation(),o=n.getScale(),a=n.get("opacity"),s=Math.rotateCoord(1,0,0,0,r);e.add(this.buildTween(t,"transform",{"0%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,90deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")","40%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,-10deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")","70%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,10deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")","100%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,0deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":0,"100%":a}))},flipInY:function(e,t,n){var i=n.get("rotation"),r=n.getOffsetRotation(),o=n.getScale(),a=n.get("opacity"),s=Math.rotateCoord(0,1,0,0,r);e.add(this.buildTween(t,"transform",{"0%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,-90deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")","40%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,-10deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")","70%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,10deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")","100%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,0deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":0,"100%":a}))},flipOutX:function(e,t,n){var i=n.get("rotation"),r=n.getOffsetRotation(),o=n.getScale(),a=n.get("opacity"),s=Math.rotateCoord(1,0,0,0,r);e.add(this.buildTween(t,"transform",{"0%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,0deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")","100%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,90deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":a,"100%":0}))},flipOutY:function(e,t,n){var i=n.get("rotation"),r=n.getOffsetRotation(),o=n.getScale(),a=n.get("opacity"),s=Math.rotateCoord(0,1,0,0,r);e.add(this.buildTween(t,"transform",{"0%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,0deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")","100%":"perspective(400px) rotate3d("+s.x+","+s.y+",0,-90deg) rotateZ("+i+"deg) scale("+o.x+","+o.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":a,"100%":0}))},fadeInSequence:function(e,t,n,i){var r=n.get("rotation"),o=n.getScale(),a=n.get("opacity");e.add(this.buildTween(t,"transform",{"0%":"translate("+i.x+"px,"+i.y+"px) rotate("+r+"deg) scale("+o.x+","+o.y+")","100%":"translate(0,0) rotate("+r+"deg) scale("+o.x+","+o.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":0,"100%":a}))},fadeUp:function(e,t,n){this.fadeUpIn(e,t,n)},fadeUpIn:function(e,t,n){var i=n.getRelativeRotatedPoint(0,25);this.fadeInSequence(e,t,n,i)},fadeDown:function(e,t,n){this.fadeDownIn(e,t,n)},fadeDownIn:function(e,t,n){var i=n.getRelativeRotatedPoint(0,-25);this.fadeInSequence(e,t,n,i)},fadeRight:function(e,t,n){this.fadeRightIn(e,t,n)},fadeRightIn:function(e,t,n){var i=n.getRelativeRotatedPoint(-25,0);this.fadeInSequence(e,t,n,i)},fadeLeft:function(e,t,n){this.fadeLeftIn(e,t,n)},fadeLeftIn:function(e,t,n){var i=n.getRelativeRotatedPoint(25,0);this.fadeInSequence(e,t,n,i)},fadeOutSequence:function(e,t,n,i){var r=n.get("rotation"),o=n.getScale(),a=n.get("opacity");e.add(this.buildTween(t,"transform",{"0%":"translate(0,0) rotate("+r+"deg) scale("+o.x+","+o.y+")","100%":"translate("+i.x+"px,"+i.y+"px) rotate("+r+"deg) scale("+o.x+","+o.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":a,"100%":0}))},fadeUpOut:function(e,t,n){var i=n.getRelativeRotatedPoint(0,-25);this.fadeOutSequence(e,t,n,i)},fadeDownOut:function(e,t,n){var i=n.getRelativeRotatedPoint(0,25);this.fadeOutSequence(e,t,n,i)},fadeRightOut:function(e,t,n){var i=n.getRelativeRotatedPoint(25,0);this.fadeOutSequence(e,t,n,i)},fadeLeftOut:function(e,t,n){var i=n.getRelativeRotatedPoint(-25,0);this.fadeOutSequence(e,t,n,i)},bounceInSequence:function(e,t,n,i,r,o){var a=n.get("x"),s=n.get("y"),u=n.get("opacity");e.add(this.buildTween(t,"left",{"0%":i.x+"px","60%":a+r.x+"px","80%":a+o.x+"px","100%":a+"px"})),e.add(this.buildTween(t,"top",{"0%":i.y+"px","60%":s+r.y+"px","80%":s+o.y+"px","100%":s+"px"})),e.add(this.buildTween(t,"opacity",{"0%":0,"60%":u,"100%":u}))},bounceUp:function(e,t,n){this.bounceUpIn(e,t,n)},bounceUpIn:function(e,t,n){var i=n.getOffPageBottom(),r=n.getRelativeRotatedPoint(0,-30),o=n.getRelativeRotatedPoint(0,10);this.bounceInSequence(e,t,n,i,r,o)},bounceDown:function(e,t,n){this.bounceDownIn(e,t,n)},bounceDownIn:function(e,t,n){var i=n.getOffPageTop(),r=n.getRelativeRotatedPoint(0,30),o=n.getRelativeRotatedPoint(0,-10);this.bounceInSequence(e,t,n,i,r,o)},bounceLeft:function(e,t,n){this.bounceLeftIn(e,t,n)},bounceLeftIn:function(e,t,n){var i=n.getOffPageLeft(),r=n.getRelativeRotatedPoint(30,0),o=n.getRelativeRotatedPoint(-10,0);this.bounceInSequence(e,t,n,i,r,o)},bounceRight:function(e,t,n){this.bounceRightIn(e,t,n)},bounceRightIn:function(e,t,n){var i=n.getOffPageRight(),r=n.getRelativeRotatedPoint(-30,0),o=n.getRelativeRotatedPoint(10,0);this.bounceInSequence(e,t,n,i,r,o)},bounceOutSequence:function(e,t,n,i,r,o){var a=n.get("x"),s=n.get("y"),u=n.get("opacity");e.add(this.buildTween(t,"left",{"0%":a+"px","20%":a+r.x+"px","40%":a+o.x+"px","100%":i.x+"px"})),e.add(this.buildTween(t,"top",{"0%":s+"px","20%":s+r.y+"px","40%":s+o.y+"px","100%":i.y+"px"})),e.add(this.buildTween(t,"opacity",{"0%":u,"60%":u,"100%":0}))},bounceUpOut:function(e,t,n){var i=n.getOffPageTop(),r=n.getRelativeRotatedPoint(0,-10),o=n.getRelativeRotatedPoint(0,30);this.bounceOutSequence(e,t,n,i,r,o)},bounceDownOut:function(e,t,n){var i=n.getOffPageBottom(),r=n.getRelativeRotatedPoint(0,10),o=n.getRelativeRotatedPoint(0,-30);this.bounceOutSequence(e,t,n,i,r,o)},bounceLeftOut:function(e,t,n){var i=n.getOffPageLeft(),r=n.getRelativeRotatedPoint(-10,0),o=n.getRelativeRotatedPoint(30,0);this.bounceOutSequence(e,t,n,i,r,o)},bounceRightOut:function(e,t,n){var i=n.getOffPageRight(),r=n.getRelativeRotatedPoint(10,0),o=n.getRelativeRotatedPoint(-30,0);this.bounceOutSequence(e,t,n,i,r,o)},spinFadeInSequence:function(e,t,n,i){var r=n.get("rotation"),o=n.getScale(),a=n.get("opacity");e.add(this.buildTween(t,"transform",{"0%":"rotate("+(r+i)+"deg) scale("+o.x+","+o.y+")","100%":"rotate("+r+"deg) scale("+o.x+","+o.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":0,"100%":a}));var s=n.getTransformOriginString(.5,.5);e.add(this.buildTween(t,"transform-origin",{"0%":s,"100%":s}))},spinRightFade:function(e,t,n){this.spinRightFadeIn(e,t,n)},spinRightFadeIn:function(e,t,n){this.spinFadeInSequence(e,t,n,-90)},spinLeftFade:function(e,t,n){this.spinLeftFadeIn(e,t,n)},spinLeftFadeIn:function(e,t,n){this.spinFadeInSequence(e,t,n,90)},spinFadeOutSequence:function(e,t,n,i){var r=n.get("rotation"),o=n.getScale(),a=n.get("opacity");e.add(this.buildTween(t,"transform",{"0%":"rotate("+r+"deg) scale("+o.x+","+o.y+")","100%":"rotate("+(r+i)+"deg) scale("+o.x+","+o.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":a,"100%":0}));var s=n.getTransformOriginString(.5,.5);e.add(this.buildTween(t,"transform-origin",{"0%":s,"100%":s}))},spinRightFadeOut:function(e,t,n){this.spinFadeOutSequence(e,t,n,90)},spinLeftFadeOut:function(e,t,n){this.spinFadeOutSequence(e,t,n,-90)},lightSpeedInSequence:function(e,t,n,i,r,o){var a=n.get("rotation"),s=n.getScale(),u=n.get("opacity"),l="right"===o?1:-1;e.add(this.buildTween(t,"transform",{"0%":"translate("+i.x+"px,"+i.y+"px) skewX("+30*l+"deg) rotate("+a+"deg) scale("+s.x+","+s.y+")","60%":"translate("+r.x+"px,"+r.y+"px) skewX("+-30*l+"deg) rotate("+a+"deg) scale("+s.x+","+s.y+")","80%":"translate(0,0) skewX("+15*l+"deg) rotate("+a+"deg) scale("+s.x+","+s.y+")","100%":"translate(0,0) skewX(0deg) rotate("+a+"deg) scale("+s.x+","+s.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":0,"60%":u,"100%":u}))},lightSpeedRight:function(e,t,n){this.lightSpeedRightIn(e,t,n)},lightSpeedRightIn:function(e,t,n){var i=n.getScale(),r=n.get("width")*i.x,o=n.get("pageWidth"),a=n.getRelativeRotatedPoint(-1*o,0),s=n.getRelativeRotatedPoint(Math.round(.6*r),0);this.lightSpeedInSequence(e,t,n,a,s,"right")},lightSpeedLeft:function(e,t,n){this.lightSpeedLeftIn(e,t,n)},lightSpeedLeftIn:function(e,t,n){var i=n.getScale(),r=n.get("width")*i.x,o=n.get("pageWidth"),a=n.getRelativeRotatedPoint(o,0),s=n.getRelativeRotatedPoint(-1*Math.round(.6*r),0);this.lightSpeedInSequence(e,t,n,a,s,"left")},lightSpeedOutSequence:function(e,t,n,i,r){var o=n.get("rotation"),a=n.getScale(),s=n.get("opacity"),u="right"===r?-1:1,l=30*u;e.add(this.buildTween(t,"transform",{"0%":"translate(0,0) skewX(0deg) rotate("+o+"deg) scale("+a.x+","+a.y+")","60%":"translate("+i.x+"px,"+i.y+"px) skewX("+l+"deg) rotate("+o+"deg) scale("+a.x+","+a.y+")","100%":"translate("+i.x+"px,"+i.y+"px) skewX(0deg) rotate("+o+"deg) scale("+a.x+","+a.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":s,"60%":0,"100%":0}))},lightSpeedRightOut:function(e,t,n){var i=n.get("pageWidth"),r=n.getRelativeRotatedPoint(i,0);this.lightSpeedOutSequence(e,t,n,r,"right")},lightSpeedLeftOut:function(e,t,n){var i=n.get("pageWidth"),r=n.getRelativeRotatedPoint(-1*i,0);this.lightSpeedOutSequence(e,t,n,r,"left")},rollInSequence:function(e,t,n,i,r){var o=n.get("rotation"),a=n.getScale(),s=n.get("opacity");i.x*=a.x,i.y*=a.y,e.add(this.buildTween(t,"transform",{"0%":"translate("+i.x+"px,"+i.y+"px) rotate("+(o+r)+"deg) scale("+a.x+","+a.y+")","100%":"translate(0,0) rotate("+o+"deg) scale("+a.x+","+a.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":0,"100%":s}));var u=n.getTransformOriginString(.5,.5);e.add(this.buildTween(t,"transform-origin",{"0%":u,"100%":u}))},rollLeft:function(e,t,n){this.rollLeftIn(e,t,n)},rollRightIn:function(e,t,n){var i=n.get("allWidth"),r=n.getRelativeRotatedPoint(-1*i,0);this.rollInSequence(e,t,n,r,-120)},rollRight:function(e,t,n){this.rollRightIn(e,t,n)},rollLeftIn:function(e,t,n){var i=n.get("allWidth"),r=n.getRelativeRotatedPoint(i,0);this.rollInSequence(e,t,n,r,120)},rollOutSequence:function(e,t,n,i,r){var o=n.get("rotation"),a=n.getScale(),s=n.get("opacity");i.x*=a.x,i.y*=a.y,e.add(this.buildTween(t,"transform",{"0%":"translate(0,0) rotate("+o+"deg) scale("+a.x+","+a.y+")","100%":"translate("+i.x+"px,"+i.y+"px) rotate("+(o+r)+"deg) scale("+a.x+","+a.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":s,"100%":0}));var u=n.getTransformOriginString(.5,.5);e.add(this.buildTween(t,"transform-origin",{"0%":u,"100%":u}))},rollLeftOut:function(e,t,n){var i=n.get("allWidth"),r=n.getRelativeRotatedPoint(-1*i,0);this.rollOutSequence(e,t,n,r,-120)},rollRightOut:function(e,t,n){var i=n.get("allWidth"),r=n.getRelativeRotatedPoint(i,0);this.rollOutSequence(e,t,n,r,120)},enlargeFadeIn:function(e,t,n){var i=n.get("rotation"),r=n.getScale(),o=n.get("opacity");e.add(this.buildTween(t,"transform",{"0%":"rotate("+i+"deg) scale(0)","100%":"rotate("+i+"deg) scale("+r.x+","+r.y+")"})),e.add(this.buildTween(t,"opacity",{"0%":0,"100%":o}))},shrinkFadeOut:function(e,t,n){var i=n.get("rotation"),r=n.getScale(),o=n.get("opacity");e.add(this.buildTween(t,"transform",{"0%":"rotate("+i+"deg) scale("+r.x+","+r.y+")","100%":"rotate("+i+"deg) scale(0)"})),e.add(this.buildTween(t,"opacity",{"0%":o,"100%":0}))},scale:function(e,t,n,i,r,o){var a=n.get("rotation"),s=n.getScale(),u="rotate("+a+"deg) scale(0, 0)",l="rotate("+a+"deg) scale("+s.x+","+s.y+")";if(o){u="rotate("+a+"deg) scale("+("x"===o?0:s.x)+","+("y"===o?0:s.y)+")"}var c={"0%":u,"100%":l};if("down"===i&&(c={"0%":l,"100%":u}),e.add(this.buildTween(t,"transform",c)),r){var d=r;0===a&&1===s.x&&1===s.y||(d=n.getTransformOriginString(.5,.5,!0)),e.add(this.buildTween(t,"transform-origin",{"0%":r,"100%":d}))}},enlarge:function(e,t,n){this.scale(e,t,n,"up",n.getTransformOriginString(.5,.5,!0))},scaleUpRight:function(e,t,n){this.scale(e,t,n,"up",n.getTransformOriginString(0,.5))},scaleUpLeft:function(e,t,n){this.scale(e,t,n,"up",n.getTransformOriginString(1,.5))},scaleUpBottom:function(e,t,n){this.scale(e,t,n,"up",n.getTransformOriginString(.5,0))},scaleUpTop:function(e,t,n){this.scale(e,t,n,"up",n.getTransformOriginString(.5,1))},scaleUpVerticalTop:function(e,t,n){this.scale(e,t,n,"up",n.getTransformOriginString(1,0),"y")},scaleUpVerticalBottom:function(e,t,n){this.scale(e,t,n,"up",n.getTransformOriginString(0,1),"y")},scaleUpVerticalCenter:function(e,t,n){this.scale(e,t,n,"up",n.getTransformOriginString(.5,.5),"y")},scaleUpHorizontalLeft:function(e,t,n){this.scale(e,t,n,"up",n.getTransformOriginString(1,1),"x")},scaleUpHorizontalRight:function(e,t,n){this.scale(e,t,n,"up",n.getTransformOriginString(0,0),"x")},scaleUpHorizontalCenter:function(e,t,n){this.scale(e,t,n,"up",n.getTransformOriginString(.5,.5),"x")},shrink:function(e,t,n){this.scale(e,t,n,"down",n.getTransformOriginString(.5,.5,!0))},scaleDownLeft:function(e,t,n){this.scale(e,t,n,"down",n.getTransformOriginString(0,.5))},scaleDownRight:function(e,t,n){this.scale(e,t,n,"down",n.getTransformOriginString(1,.5))},scaleDownTop:function(e,t,n){this.scale(e,t,n,"down",n.getTransformOriginString(.5,1))},scaleDownBottom:function(e,t,n){this.scale(e,t,n,"down",n.getTransformOriginString(.5,0))},scaleDownVerticalTop:function(e,t,n){this.scale(e,t,n,"down",n.getTransformOriginString(0,1),"y")},scaleDownVerticalBottom:function(e,t,n){this.scale(e,t,n,"down",n.getTransformOriginString(1,0),"y")},scaleDownVerticalCenter:function(e,t,n){this.scale(e,t,n,"down",n.getTransformOriginString(.5,.5),"y")},scaleDownHorizontalLeft:function(e,t,n){this.scale(e,t,n,"down",n.getTransformOriginString(0,0),"x")},scaleDownHorizontalRight:function(e,t,n){this.scale(e,t,n,"down",n.getTransformOriginString(1,1),"x")},scaleDownHorizontalCenter:function(e,t,n){this.scale(e,t,n,"down",n.getTransformOriginString(.5,.5),"x")},swing:function(e,t,n,i,r){var o=n.get("rotation"),a=n.getScale();e.add(this.buildTween(t,"transform",{"0%":i+" rotate("+o+"deg) scale("+a.x+", "+a.y+")","100%":"rotateX(0) rotateY(0) rotate("+o+"deg) scale("+a.x+", "+a.y+")"})),e.add(this.buildTween(t,"transform-origin",{"0%":r,"100%":n.getTransformOriginString(.5,.5,!0)})),e.add(this.buildTween(t,"transform-box",{"0%":"fill-box","100%":"fill-box"}))},swingTopLeft:function(e,t,n){this.swing(e,t,n,"rotateX(180deg) rotateY(-180deg)",n.getTransformOriginString(0,0))},swingTopRight:function(e,t,n){this.swing(e,t,n,"rotateX(-180deg) rotateY(-180deg)",n.getTransformOriginString(1,0))},swingBottomLeft:function(e,t,n){this.swing(e,t,n,"rotateX(180deg) rotateY(180deg)",n.getTransformOriginString(0,1))},swingBottomRight:function(e,t,n){this.swing(e,t,n,"rotateX(-180deg) rotateY(180deg)",n.getTransformOriginString(1,1))},swingLeft:function(e,t,n){this.swing(e,t,n,"rotateY(180deg)",n.getTransformOriginString(1,.5))},swingRight:function(e,t,n){this.swing(e,t,n,"rotateY(-180deg)",n.getTransformOriginString(0,.5))},swingTop:function(e,t,n){this.swing(e,t,n,"rotateX(180deg)",n.getTransformOriginString(.5,1))},swingBottom:function(e,t,n){this.swing(e,t,n,"rotateX(-180deg)",n.getTransformOriginString(.5,0))},jelloHorizontal:function(t,n,i){var r=i.get("rotation"),a=i.getScale(),s={};e.each(o,function(e,t){s[t+"%"]="scale("+e[0]*a.x+", "+e[1]*a.y+") rotate("+r+"deg)"}),t.add(this.buildTween(n,"transform",s))},wobble:function(t,n,i,o,a){var s=i.get("rotation"),u=i.getTransformOriginString(.5,.5,!0),l=i.getScale(),c="translate"+o,d=a?1:-1,h={};e.each(r,function(e,t){var n=s+e[1]*d;h[t+"%"]=c+"("+e[0]+"px) rotate("+n+"deg) scale("+l.x+", "+l.y+")"}),t.add(this.buildTween(n,"transform",h)),t.add(this.buildTween(n,"transform-origin",{"0%":u,"100%":u}))},wobbleTop:function(e,t,n){this.wobble(e,t,n,"X",!0)},wobbleBottom:function(e,t,n){this.wobble(e,t,n,"X",!1)},wobbleLeft:function(e,t,n){this.wobble(e,t,n,"Y",!0)},wobbleRight:function(e,t,n){this.wobble(e,t,n,"Y",!1)},vibrate:function(t,n,i){var r=i.get("rotation"),o=i.getScale(),a={};e.each(u,function(e,t){a[t+"%"]="translate("+e[0]+"px, "+e[1]+"px) rotate("+r+"deg) scale("+o.x+", "+o.y+")"}),t.add(this.buildTween(n,"transform",a))},kenBurns:function(e,t,n,i,r,o){var a=n.get("rotation"),s=n.getScale();e.add(this.buildTween(t,"transform",{"0%":"scale("+s.x+", "+s.y+") translate(0, 0) rotate("+a+"deg)","100%":"scale("+1.25*s.x+", "+1.25*s.y+") translate("+i+") rotate("+a+"deg)"})),e.add(this.buildTween(t,"transform-origin",{"0%":r,"100%":o}))},kenBurnsTop:function(e,t,n){this.kenBurns(e,t,n,"0, -15px",n.getTransformOriginString(.5,.16),n.getTransformOriginString(.5,0))},kenBurnsBottom:function(e,t,n){this.kenBurns(e,t,n,"0, 15px",n.getTransformOriginString(.5,.84),n.getTransformOriginString(.5,1))},kenBurnsLeft:function(e,t,n){this.kenBurns(e,t,n,"-20px, 0",n.getTransformOriginString(.16,.5),n.getTransformOriginString(0,.5))},kenBurnsRight:function(e,t,n){this.kenBurns(e,t,n,"20px, 0",n.getTransformOriginString(.84,.5),n.getTransformOriginString(1,.5))}}}),define("shared/models/AnimatedObjectModel",["jquery","lodash","backbone"],function(e,t,n){"use strict";return n.Model.extend({getCenter:function(){return{x:this.get("x")+this.get("width")/2,y:this.get("y")+this.get("height")/2}},getScale:function(){return{x:t.isUndefined(this.get("scaleWidth"))?1:this.get("scaleWidth"),y:t.isUndefined(this.get("scaleHeight"))?1:this.get("scaleHeight")}},getOffsetX:function(){if(!this.get("parentSmartgroup"))return 0;var e=this.get("parentSmartgroup").options.scaleWidth;if(1===e)return this.get("parentSmartgroup").options.x;var t=this.get("parentSmartgroup").options.width/2,n=this.get("parentSmartgroup").options.width*e/2,i=t-n;return this.get("parentSmartgroup").options.x+i},getOffsetY:function(){if(!this.get("parentSmartgroup"))return 0;var e=this.get("parentSmartgroup").options.scaleHeight;if(1===e)return this.get("parentSmartgroup").options.y;var t=this.get("parentSmartgroup").options.height/2,n=this.get("parentSmartgroup").options.height*e/2,i=t-n;return this.get("parentSmartgroup").options.y+i},getOffsetRotation:function(){return this.get("parentSmartgroup")?Math.toRad(this.get("parentSmartgroup").options.rotation):0},getRelativeRotatedPoint:function(e,t){var n=this.getOffsetRotation();if(n){var i=this.get("allWidth")/2,r=this.get("allHeight")/2;e+=i,t+=r;var o=Math.rotateCoord(e,t,i,r,n);e=o.x-i,t=o.y-r}return{x:e,y:t}},getRotatedPoint:function(e,t){var n=this.getOffsetRotation();if(n){var i=this.get("allWidth")/2,r=this.get("allHeight")/2,o=this.getCenter();e+=i,t+=r;var a=Math.rotateCoord(e,t,o.x,o.y,n);e=a.x-i,t=a.y-r}return{x:e,y:t}},getRotatedCenter:function(){var e=this.getOffsetRotation(),t=this.get("parentSmartgroup"),n=this.getCenter();if(t&&e>0){var i=t.options.width/2,r=t.options.height/2;return Math.rotateCoord(n.x,n.y,i,r,-1*e)}return{x:n.x,y:n.y}},getOffPageY:function(e){var t=this.get("x"),n=this.get("parentSmartgroup"),i=this.getOffsetRotation();if(n&&i>0){var r=this.getCenter();return e-=this.getRotatedCenter().y-r.y,this.getRotatedPoint(t,e)}return{x:t,y:e}},getOffPageTop:function(){var e=-1*(1+this.getOffsetY());return this.get("parentSmartgroup")&&1!==this.get("parentSmartgroup").options.scaleHeight&&(e/=this.get("parentSmartgroup").options.scaleHeight),e-=this.get("allHeight"),this.getOffPageY(e)},getOffPageBottom:function(){var e=this.get("pageHeight")+1-this.getOffsetY();return this.get("parentSmartgroup")&&1!==this.get("parentSmartgroup").options.scaleHeight&&(e/=this.get("parentSmartgroup").options.scaleHeight),e+=this.get("allHeight")-this.get("height"),this.getOffPageY(e)},getOffPageX:function(e){var t=this.get("y"),n=this.get("parentSmartgroup"),i=this.getOffsetRotation();if(n&&i>0){var r=this.getCenter();return e-=this.getRotatedCenter().x-r.x,this.getRotatedPoint(e,t)}return{x:e,y:t}},getOffPageLeft:function(){var e=-1*(1+this.getOffsetX());return this.get("parentSmartgroup")&&1!==this.get("parentSmartgroup").options.scaleWidth&&(e/=this.get("parentSmartgroup").options.scaleWidth),e-=this.get("allWidth"),this.getOffPageX(e)},getOffPageRight:function(){var e=this.get("pageWidth")+1-this.getOffsetX();return this.get("parentSmartgroup")&&1!==this.get("parentSmartgroup").options.scaleWidth&&(e/=this.get("parentSmartgroup").options.scaleWidth),e+=this.get("allWidth")-this.get("width"),this.getOffPageX(e)},getTransformOriginString:function(e,t,n){var i=this.get("width")*e,r=this.get("height")*t;if(!n){var o=this.getScale();i*=o.x,r*=o.y}return i+"px "+r+"px"}})}),define("modules/page/utils/VisibleBoundaries",["lodash"],function(e){"use strict";function t(t,n,i,r){this.topY=t,this.bottomY=n,e.isNil(i)||e.isNil(r)||(this.hasXBoundaries=!0,this.leftX=i,this.rightX=r)}return t.prototype.getEntryAnimationVisibleBoundaries=function(e,n){var i=this.topY,r=this.bottomY,o=this.leftX,a=this.rightX;return i>0&&(i+=50),r<e&&(r-=50),this.hasXBoundaries&&(o>0&&(o+=50),a<n&&(a-=50)),new t(i,r,o,a)},t}),define("InteractionUtils",["lodash"],function(e){"use strict";return{isInteractionTargetingLayers:function(t){return e.includes(["show-and-stay-visible","hide-and-stay-hidden","show-layers","show-layers-on-hover","hide-layers","toggle-layers"],t.action)},isHoverInteractionShowingLayers:function(t){return"hover"===t.trigger&&e.includes(["show-and-stay-visible","show-layers-on-hover"],t.action)},isShowLayersOnHoverInteraction:function(e){return"show-layers-on-hover"===e.action},isShowLayersInteraction:function(t){return e.includes(["show-layers","show-layers-on-hover"],t.action)},isHideLayersInteraction:function(e){return"hide-layers"===e.action},isTemporaryHoverInteractionShowingOrHidingLayers:function(t){return"hover"===t.trigger&&e.includes(["show-layers-on-hover","hide-layers"],t.action)},shouldCreateHoverArea:function(e){return"show-layers-on-hover"===e.action&&e.createHoverArea}}}),define("rect",["jquery","lodash","cerosMath"],function(e,t,n){"use strict";var i=function(e,t,i,r,o){if(this.topLeft=new n.Point(e,t),this.topRight=new n.Point(i,t),this.bottomRight=new n.Point(i,r),this.bottomLeft=new n.Point(e,r),o){var a=(e+i)/2,s=(t+r)/2;this.topLeft.rotate(a,s,o),this.topRight.rotate(a,s,o),this.bottomRight.rotate(a,s,o),this.bottomLeft.rotate(a,s,o)}};return t.extend(i.prototype,{getEndpoints:function(){return[this.topLeft,this.topRight,this.bottomRight,this.bottomLeft]}}),i}),
define("modules/page/views/components/AbstractComponentView",["log","jquery","lodash","device","backbone","color","globals","modules/page/views/AbstractPageChildView","animation","animationTypes","shared/models/AnimatedObjectModel","shared/utils/CerosResourceLoader","shared/utils/CssUtils","shared/utils/WebkitUtils","shared/utils/ModuleEventManager","modules/page/utils/VisibleBoundaries","ExtentsUtils","InteractionUtils","rect","cerosMath","modules/page/utils/PlayerVariantDetector","modules/page/utils/PlayerVariantService","@frontend/common/libs/BlendingModes","libs/utils/FeatureFlagsLookupService","libs/utils/FeatureFlags"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f,p,g,m,v,y,b,w,_,E,S,T){"use strict";var E=E.BlendingModes;return s.extend({COMMERCE_ACTIONS:["product","shopping-cart"],LIGHTBOX_ACTION:"lightbox",className:"component",timedTriggersCreatedAtLeastOnce:!1,initialize:function(){s.prototype.initialize.call(this),this.hasAccessibilityFeature=S.hasFeature(T.ACCESSIBILITY),this.$el.addClass("page-object"),this.$el.addClass(this.type),this.$el.css({position:"absolute"}),this.options.rotation||(this.options.rotation=0),this.timedTriggerTimeouts=[],this._activatedEntryAnimations=!1,this.runningExitAnimations=!1,this.wasInsideVisibleBoundaries=!1,this.timedTriggersActivated=!1,this.exitAnimationPromise=null,this.validInteractions={},this.options.unfixedX=this.options.x,this.options.unfixedY=this.options.y,this.options.absoluteX=this.options.x,this.options.absoluteY=this.options.y,this.$window=t(window),this.options.animationsRepeatAll=!!this.options.animationsRepeatAll&&!a.shouldReduceMotion,this.defaultTagName=this.tagName},tagOverride:function(){var e=void 0;if(this.hasAccessibilityFeature&&this.options.htmlLandmarkTag&&(e={tagName:this.options.htmlLandmarkTag}),Array.isArray(this.options.interactions)){e=this.options.interactions.reduce(function(e,t){var n=t.domTagOverride;return n?e?n.priority>e.priority?n:e:n:e},void 0)||e}return e},getSpecifiedAttributes:function(e){return n.transform(e,function(e,t){t.specified&&(e[t.name]=t.value)},{})},applyAccessibilityFeatures:function(){this.applyTagOverride(),this.hasAccessibilityFeature&&(this.options.ariaLabel?this.getAriaElement().attr("aria-label",this.options.ariaLabel):this.getAriaElement().removeAttr("aria-label"))},getAriaElement:function(){return this.$el},applyTagOverride:function(){var e=this.tagOverride();if(e&&e.tagName){this.tagName=n.get(e,"tagName",this.tagName);var i=this.attributes||{};if(this.attributes=n.assign({},this.attributes,n.get(e,"attributes")),this.$el.is(this.tagName)&&n.isEqual(i,this.attributes))return;var r=n.assign(this.getSpecifiedAttributes(this.$el[0].attributes),this.attributes),o=t("<"+this.tagName+">",r).append(this.$el.contents());this.$el.replaceWith(o),this.setElement(o)}else if(!this.$el.is(this.defaultTagName)){var r=n.assign(this.getSpecifiedAttributes(this.$el[0].attributes),this.attributes),o=t("<"+this.defaultTagName+">",r).append(this.$el.contents());this.$el.replaceWith(o),this.setElement(o)}},getOpacity:function(){return this.options.opacity},addParentView:function(e){this.parentViews.push(e),e.options.rotation&&(delete this.options.allWidth,delete this.options.allHeight,this._configureAllWidthAllHeight(),this._applyAnimations()),this.configureAbsoluteCoordinates()},hasParents:function(){return this.parentViews.length>0},configureAbsoluteCoordinates:function(){var e=new b.Point(this.options.x+this.options.width/2,this.options.y+this.options.height/2),t=this.parentViews;n.each(t,function(t){if(t.options.rotation){var n=t.options.width/2,i=t.options.height/2;e.rotate(n,i,-Math.toRad(t.options.rotation))}e.x+=t.options.x||0,e.y+=t.options.y||0}),this.options.absoluteX=e.x-this.options.allWidth/2,this.options.absoluteY=e.y-this.options.allHeight/2},areAllParentsVisible:function(){var e=n.every(this.parentViews,function(e){return e.visible});return this.options.parentSmartgroup?e&&this.options.parentSmartgroup.visible:e},areAllParentsInitiallyVisible:function(){var e=n.every(this.parentViews,function(e){return e.initiallyVisible});return this.options.parentSmartgroup?e&&this.options.parentSmartgroup.initiallyVisible:e},areAnyParentsNotVisible:function(){var e=n.some(this.parentViews,function(e){return!e.visible});return this.options.parentSmartgroup?e||!this.options.parentSmartgroup.visible:e},idBelongsToParent:function(e){return n.some(this.parentViews,function(t){return t.id===e})},addContainerId:function(e){var t=this.$el.attr("data-container-id")?this.$el.attr("data-container-id")+",":"";this.$el.attr("data-container-id",t+e)},onClose:function(){},_configureAllWidthAllHeight:function(){if(n.isUndefined(this.options.allWidth)&&n.isUndefined(this.options.allHeight)){var e=this.options.rotation?this.options.rotation:0;this.options.parentSmartgroup&&this.options.parentSmartgroup.options.rotation&&(e+=this.options.parentSmartgroup.options.rotation,e%=360),this.hasParents()&&(e+=n.reduce(this.parentViews,function(e,t){return e+(t.options.rotation||0)},0));var t,i;if(e>180&&(e=360-e),e>90&&(e=180-e),0!==(e=Math.toRad(e))){t=Math.cos(e),i=Math.sin(e);var r=m.getExtentsFromDimensions(this.options.x,this.options.y,this.options.width,this.options.height,e,this.options.border.width?this.options.border.width:0);this.options.allWidth=r.x2-r.x1,this.options.allHeight=r.y2-r.y1}else this.options.allWidth=this.options.width,this.options.allHeight=this.options.height;this._configureAllWidthAllHeightForShadow(),this._configureAllWidthAllHeightForBorder(e,i,t)}},_configureAllWidthAllHeightForShadow:function(){n.isEmpty(this.options.shadow)||""===this.options.shadow||(this.options.allWidth+=n.isNumber(this.options.shadow.x)?Math.abs(this.options.shadow.x):0,this.options.allHeight+=n.isNumber(this.options.shadow.y)?Math.abs(this.options.shadow.y):0,this.options.allWidth+=n.isNumber(this.options.shadow.blur)?Math.abs(this.options.shadow.blur):0,this.options.allHeight+=n.isNumber(this.options.shadow.blur)?Math.abs(this.options.shadow.blur):0,this.options.shadow.blur>Math.abs(this.options.shadow.x)&&(this.options.allWidth+=this.options.shadow.blur-Math.abs(this.options.shadow.x)),this.options.shadow.blur>Math.abs(this.options.shadow.y)&&(this.options.allHeight+=this.options.shadow.blur-Math.abs(this.options.shadow.y)))},_configureAllWidthAllHeightForBorder:function(e,t,i){!n.isEmpty(this.options.border)&&""!==this.options.border&&n.isNumber(this.options.border.width)&&(0!==e?(this.options.allWidth+=2*(this.options.border.width*i+this.options.border.width*t),this.options.allHeight+=2*(this.options.border.width*i+this.options.border.width*t)):(this.options.allWidth+=2*this.options.border.width,this.options.allHeight+=2*this.options.border.width))},enablePointerEventsForIPadSafariDesktop:function(){if(this.options.fixedPosition){var e=i.isDesktopSafari()||i.isMobileSafari();i.isIpadPretendingToBeDesktop()&&i.isIosGreaterThanOrEqualTo(13)&&e&&this.hasClickInteraction()&&this.$el.css("pointer-events","all")}},render:function(){if(this.applyAccessibilityFeatures(),this.$el.css("transform",""),this.updateFixedPosition(),this.enablePointerEventsForIPadSafariDesktop(),this._configureAllWidthAllHeight(),this.configureAbsoluteCoordinates(),this._applyPosition(this.options.x,this.options.y,this.options.border),this._applyRotation(this.options.rotation,this.options.width,this.options.height),this._applyDimensions(this.options.width,this.options.height),this._applyOpacity(this.getOpacity()),this._applyVisibility(this.options.visible),this._configureInteractions(),f.requiresHardwareAccelerateTransform(this.options.fixedPosition,"text"===this.type)&&this.$el.css("transform",f.hardwareAccelerateTransform(this.$el.css("transform"))),"image"===this.type&&i.isDesktopSafari()&&this.hasActiveBlendingMode()){var e=this.$el.find("img");e.css("transform",f.hardwareAccelerateTransform(e.css("transform")))}return this.doCustomScaling(),this._applyAnimations(),this._applyBorder(this.options.border),this._applyBackground(this.options.background),this._applyShadow(this.options.shadow,this.options.rotation,this.options.border,this.options.background),this},scaleComponent:function(){this.updateFixedPosition()},updateFixedPosition:function(){if(this.options.fixedPosition&&!i.desktop()){var e=this.options.pageView.$pageScroll,t=parseFloat(e.css("left")),n=parseFloat(e.css("top"));this.options.x=this.options.unfixedX+t,this.options.y=this.options.unfixedY+n,this._applyPosition(this.options.x,this.options.y,this.options.border)}},onAttach:function(){},attachMedia:function(){return(new t.Deferred).resolve().promise()},applyChanges:function(e){a.allowAdaptiveLayouts&&(e=n.extend(e,e.overrides[w.getVariant()])),this.options=n.extend(this.options,e),this.render(),this.attachMedia(),this.rerunActivationAndEntryAnimations()},getApplyPositionTarget:function(){return this.$el},_applyPosition:function(e,t,i){var r=this.getApplyPositionTarget();!n.isEmpty(i)&&n.isNumber(i.width)&&(e-=i.width,t-=i.width),r.css("left",e+"px"),r.css("top",t+"px")},getApplyDimensionsTarget:function(){return this.$el},_applyDimensions:function(e,t){var n=this.getApplyDimensionsTarget();n.css("width",e+"px"),n.css("height",t+"px"),n.css("transform-origin","center")},setDimensionsAsAttributes:function(e,t,n){e.attr("width",t),e.attr("height",n)},getApplyOpacityTarget:function(){return this.$el},_applyOpacity:function(e){this.options.parentSmartgroup&&this.options.parentSmartgroup.getOpacity()<1&&(e*=this.options.parentSmartgroup.getOpacity());var t=this.getApplyOpacityTarget();e<1?t.css("opacity",e):t.css("opacity","initial"),0===e&&t.css({"background-color":"white"})},getApplyVisibilityTarget:function(){return this.$el},_applyVisibility:function(e){this.getApplyVisibilityTarget().css("display",e?"block":"none")},_applyRotation:function(e,t,n){if(e&&0!==e){var i="rotate("+e+"deg)";this.$el.css("transform",h.concatTransform(this.$el.css("transform"),i))}},getApplyBorderTarget:function(){return this.$el},_applyBorder:function(e){var t=this.getApplyBorderTarget();if(n.isEmpty(e))t.css("border","none");else if(e.width?(t.css("borderWidth",e.width+"px"),e.color&&""!==e.color&&t.css("borderColor",e.color),e.style&&""!==e.style&&e.style.match(/(solid|dashed|dotted)/)?t.css("borderStyle",e.style):t.css("borderStyle","solid")):t.css("borderWidth","0"),e.radius){var i=(e.radius+"").split(",");if(1==i.length)t.css("borderRadius",parseInt(i[0],10)+"px",10);else{var r=parseInt(i[0],10),o=parseInt(i[1],10),a=parseInt(i[2],10),s=parseInt(i[3],10);t.css("borderRadius",r+"px "+o+"px "+a+"px "+s+"px")}}else t.css("borderRadius","")},entryAnimationsActivated:function(){return this._activatedEntryAnimations},isEntryAnimationConfiguredToReplayOnScroll:function(){return this.options.animationsReplayOnScroll},setWasInsideVisibleBoundaries:function(e){this.wasInsideVisibleBoundaries=e},getWasInsideVisibleBoundaries:function(){return this.wasInsideVisibleBoundaries},isAnyPartOfComponentWithinBoundaries:function(e,t){t=t||this.getComponentBoundaries();var n=t.componentTop<e.bottomY&&t.componentBottom>=e.topY;return e.hasXBoundaries&&(n=n&&t.componentLeft<e.rightX&&t.componentRight>=e.leftX),n},isAnyPartOfComponentWithinEntryAnimationBoundaries:function(e,t){return this.isAnyPartOfComponentWithinBoundaries(e.getEntryAnimationVisibleBoundaries(this.options.pageHeight,this.options.pageWidth),t)},isOutsideOfPage:function(){var e=new g(0,this.options.pageHeight,0,this.options.pageWidth);return!1===this.isAnyPartOfComponentWithinBoundaries(e)},getComponentBoundaries:function(){var e=this.options.absoluteX,t=this.options.absoluteY,n=this.options.allHeight,i=this.options.allWidth,r=this.options.parentSmartgroup,o=this.isFixedPosition();if(r){e*=r.options.scaleWidth,e+=r.options.originalX,t*=r.options.scaleHeight,t+=r.options.originalY;var a=Math.toRad(r.options.rotation);if(a){var s=r.options.x+r.options.width/2,u=r.options.y+r.options.height/2,l=Math.rotateCoord(e,t,s,u,-a);e=l.x,t=l.y}n*=r.options.scaleHeight}var c=t+n,d=e+i;if(o){var h=this.getTopAndBottomFixedPosition(t,c);t=h.top,c=h.bottom}return{componentTop:t,componentLeft:e,componentBottom:c,componentRight:d}},getTopAndBottomFixedPosition:function(e,t){var n=this.options.pageView.$pinnedContainer,i=this.options.pageView.scaleContext,r=this.options.pageView.getScaleContext(),o=n?n.offset():{left:0,top:0},a=this.options.pageView.$pageScroll.offset(),s=a.top-o.top;return i.useZoom(r.ratio)||(s/=r.ratio),{top:Math.floor(e-s),bottom:Math.floor(t-s)}},isFixedPosition:function(){if(this.options.fixedPosition||this.options.parentSmartgroup&&this.options.parentSmartgroup.options.fixedPosition)return!0;if(!n.isEmpty(this.parentViews))for(var e=0;e<this.parentViews.length;++e){var t=this.parentViews[e];if(void 0!==t.isFixedPosition&&t.isFixedPosition())return!0}return!1},_hasInteraction:function(e){var t=this.options.interactions;return!(!n.isArray(t)||0===t.length)&&this.getValidInteractionsByTrigger(e).length>0},hasClickInteraction:function(){return this._hasInteraction(this.getModule().INTERACTION_TRIGGERS.CLICK)},hasHoverInteraction:function(){return i.desktop()&&this._hasInteraction(this.getModule().INTERACTION_TRIGGERS.HOVER)},getResettableHoverInteractions:function(){if(this.hasHoverInteraction()){var e=this.getValidInteractionsByTrigger(this.getModule().INTERACTION_TRIGGERS.HOVER);return n.filter(e,function(e){return e.resetWhenScrolledOffscreen})}return null},hasResettableHoverInteractions:function(){var e=this.getResettableHoverInteractions();return e&&e.length>0},getValidInteractionsByTrigger:function(e){if(!this.validInteractions[e]||a.previewMode){var t=this.options.interactions,i=this;t=n.filter(t,function(t){return!!i._isValidInteraction(t)&&(n.isUndefined(e)||t.trigger===e)}),t.sort(function(e,t){var n=-1!==["page-goto","page-next","page-prev"].indexOf(e.action),i=-1!==["page-goto","page-next","page-prev"].indexOf(t.action),r="page-enable-disable"==e.action,o="page-enable-disable"==t.action;return r&&i?-1:o&&n?1:0}),this.validInteractions[e]=t}return this.validInteractions[e]},_isValidInteraction:function(e){return!(-1!==n.indexOf(this.COMMERCE_ACTIONS,e.action)&&!this.options.allowCommerceIntegration)&&e.isValid()},unbindInteractions:function(){this.$el.off("click"),this.$el.off("mouseover"),this.$el.off("mouseout")},assignCursor:function(){this.hasClickInteraction()||this.options.showHoverCursor?this.$el.css("cursor","pointer"):this.$el.css("cursor","inherit")},styleForTouchDevices:function(){i.touch()&&i.trident&&this.$el.css("touch-action","manipulation")},bindClickInteraction:function(){this.hasClickInteraction()?this.$el.on("click",n.bind(this._handleClickInteraction,this)):this.$el.on("click",n.bind(this.handleClickWithoutInteraction,this))},bindMouseoverInteraction:function(){this.hasHoverInteraction()&&this.$el.on("mouseover",n.bind(this._handleMouseOverInteraction,this))},_configureInteractions:function(){this.unbindInteractions(),this.assignCursor(),this.styleForTouchDevices(),this.bindClickInteraction(),this.bindMouseoverInteraction()},createTimedTriggers:function(){var e=this.getModule(),t=this;if(this.canCreateTimedTriggers()){var i=n.groupBy(t.getValidInteractionsByTrigger(e.INTERACTION_TRIGGERS.VIEW),function(e){return e.delay});n.forOwn(i,function(i,r){var o=n.filter(i,function(e){return!t.timedTriggersCreatedAtLeastOnce||e.repeat});if(o.length>0){var a=setTimeout(function(){function i(n){t.simulateClick(!0,n),p.trigger(e.publishedEvents.TIMED_INTERACTION,t.addComponentAndClickDataToEvent(n)),("cycle-next"===n.action||"cycle-previous"===n.action)&&t.timedTriggerTimeouts.push(setTimeout(function(){i(n)},1e3*r))}n.each(o,function(e){i(e)})},1e3*r);t.timedTriggerTimeouts.push(a)}}),this.timedTriggersCreatedAtLeastOnce=!0,this.timedTriggersActivated=!0}},canCreateTimedTriggers:function(){if(this.timedTriggersActivated)return!1;if(!this.visible)return!1;var e=this.getModule();return!!this._hasInteraction(e.INTERACTION_TRIGGERS.VIEW)&&this.areAllParentsVisible()},simulateClick:function(e,n){var i={clientX:-1,clientY:-1,preventDefault:t.noop};this._handleClickInteraction(i,e,n)},_handleClickInteraction:function(e,t,i){var r=this.getModule(),o=!1;e.preventDefault();var a=[];if(t){if(!i)return;a=[i]}else a=this.getValidInteractionsByTrigger(r.INTERACTION_TRIGGERS.CLICK);n.each(a,n.bind(function(t){this._triggerClickAction(e,t)&&(o=!0)},this));var s=this.addComponentAndClickDataToEvent({},e);p.trigger(r.publishedEvents.PAGE_COMPONENT_CLICKED,s),o&&(e.handledByComponent=!0,t||r.trigger(r.publishedEvents.PAGE_COMPONENT_INTERACTION,s))},handleClickWithoutInteraction:function(e){var t=this.getModule(),n=this.addComponentAndClickDataToEvent({},e);p.trigger(t.publishedEvents.PAGE_COMPONENT_CLICKED,n)},_triggerClickAction:function(e,t){var n=this.addComponentAndClickDataToEvent({},e);return t.triggerAction(n)},addComponentAndClickDataToEvent:function(e,n){return t.extend(e,{clickX:n?n.clientX:-1,clickY:n?n.clientY:-1,componentSlug:this.id,componentName:this.options.title,componentType:this.options.type,pageSlug:this.options.pageView.model.get("slug"),pageName:this.options.pageView.model.get("name")})},_handleMouseOverInteraction:function(e){var t=this.getValidInteractionsByTrigger(this.getModule().INTERACTION_TRIGGERS.HOVER),i=this;if(t.length>0){if(this.options.pageView.isMouseOverAnActiveHoverAreaWithHigherZIndex(this,e))return;this.options.pageView.deactivateNonParentHovers(this),n.each(t,function(e){i._triggerMouseOverAction(e)});var r={componentSlug:this.id,componentName:this.options.title,componentType:this.options.type,pageSlug:this.options.pageView.model.get("slug"),pageName:this.options.pageView.model.get("name")},o=this.getModule();o.trigger(o.publishedEvents.PAGE_COMPONENT_HOVER_INTERACTION,r)}},_triggerMouseOverAction:function(e){var t=e.layerTargets,i=v.isHoverInteractionShowingLayers(e);t=n.filter(t,n.bind(function(e){var t=this.options.pageView.findChildView(e);t.removePointerEventsIfNoInteractions();var n=this.options.pageView.isChildVisible(t);return i?!n:n},this)),i?this.options.pageView.invokeShowAction(t):this.options.pageView.invokeHideAction(t),v.isTemporaryHoverInteractionShowingOrHidingLayers(e)&&this.options.pageView.addActiveHoverAndBindMouseEvents(this,e)},triggerMouseOutAction:function(e){var t=this;n.each(e.layerTargets,function(e){t.options.pageView.findChildView(e).addPointerEvents()}),v.isShowLayersOnHoverInteraction(e)?this.options.pageView.invokeHideAction(e.layerTargets):v.isHideLayersInteraction(e)&&this.options.pageView.invokeShowAction(e.layerTargets)},getApplyAnimationsTarget:function(){return this.$el},getAnimatedObjectModelData:function(){return{x:this.options.x,y:this.options.y,allWidth:this.options.allWidth,allHeight:this.options.allHeight,width:this.options.width,height:this.options.height,rotation:this.options.rotation,opacity:this.getOpacity(),scaleWidth:this.options.scaleWidth,scaleHeight:this.options.scaleHeight,pageWidth:this.options.pageWidth,pageHeight:this.options.pageHeight,parentSmartgroup:this.options.parentSmartgroup,requiresHardwareAcceleration:f.requiresHardwareAccelerateTransform(this.options.fixedPosition,"text"===this.type)}},_applyAnimations:function(){var e=this.getAnimatedObjectModelData();this.animatedObjectModel=new c(e);var t=this.getApplyAnimationsTarget();this.cleanupAnimations(),this.entryAnimations=this.buildAnimationPhases(t,this.options.animations,this.options.animationsRepeatAll,this.animatedObjectModel),this.exitAnimations=this.buildAnimationPhases(t,this.options.exitAnimations,!1,this.animatedObjectModel),this.resetToInitialState()},buildAnimationPhases:function(e,t,i,r){var o=[];if(t&&t.length>0)for(var a=function(e){e.play()},s=0;s<t.length;s++){i&&(t[s].loop=!1);var c=l.compileNewSequence(e,t[s],r);if(n.isNull(c))break;if(o.push(c),o[o.length-2]&&o[o.length-2].on(u.END_EVENT,n.bind(function(){var e=this;n.defer(a,e)},c)),!0===t[s].loop)break}return o},reset:function(){this.resetAnimations()},resetAnimations:function(){this.cleanupAnimations(),this.resetToInitialState(),this.runningExitAnimations=!1,this._activatedEntryAnimations=!1},resetTimers:function(){n.each(this.timedTriggerTimeouts,function(e){window.clearTimeout(e)}),this.timedTriggerTimeouts=[],this.timedTriggersActivated=!1},whenLeavingVisibleBoundaries:function(){var e=this.entryAnimationsActivated()&&this.isEntryAnimationConfiguredToReplayOnScroll(),t=this.getModule(),i=!n.isEmpty(this.getValidInteractionsByTrigger(t.INTERACTION_TRIGGERS.VIEW)),r=i&&this.initiallyVisible&&this.areAllParentsInitiallyVisible();this.isOutsideOfPage()||(e&&(this.resetAnimations(),this.exitAnimationPromise&&(this.exitAnimationPromise.resolve(),this.exitAnimationPromise=null),this.visible&&"none"===this.$el.css("display")&&this.$el.show()),r&&this.resetTimers())},onActivationStart:function(){},onActivationEnd:function(){},onExitStart:function(){},onExitEnd:function(){},activateAndRunEntryAnimations:function(){if(this.onActivationStart(),this.hasEntryAnimation()&&!this.entryAnimationsActivated()){this._activatedEntryAnimations=!0;var e=this;this.runEntryAnimations().done(function(){e.onActivationEnd()})}else this.onActivationEnd()},rerunActivationAndEntryAnimations:function(){if(this.onActivationStart(),this.hasEntryAnimation()){this._activatedEntryAnimations=!0;var e=this;this.runEntryAnimations().done(function(){e.onActivationEnd()})}else this.onActivationEnd()},runEntryAnimations:function(){var e=this.getModule();if(!this.runningExitAnimations){n.each(this.entryAnimations,function(e){e.cleanup()}),this.entryAnimations[0].resetToInitialState();var i=this,r=new t.Deferred,o=function(){n.last(i.entryAnimations).off(u.END_EVENT,o),i.options.animationsRepeatAll?n.defer(n.bind(i.runEntryAnimations,i)):(r.resolve(),p.trigger(e.publishedEvents.PAGE_COMPONENT_ANIMATION_END,i.id))};return n.last(this.entryAnimations).on(u.END_EVENT,o),this.entryAnimations[0].play(),this.entryAnimations.length>0&&p.trigger(e.publishedEvents.PAGE_COMPONENT_ANIMATION_START,this.id),r.promise()}return(new t.Deferred).resolve().promise()},runAllChildViewExitAnimations:function(e){if(e=e||[],!this.runningExitAnimations&&this.visible&&this.areAllParentsVisible()){var t=this;this.runningExitAnimations=!0,this.onExitStart();var i=this.runExitAnimations().then(function(){t.runningExitAnimations=!1,t.onExitEnd()});e.push(i),this.childViews&&n.each(this.childViews,function(t){t.runAllChildViewExitAnimations(e)})}return e},runExitAnimations:function(){var e=this.getModule();this.entryAnimations&&n.each(this.entryAnimations,function(e){e.cleanup()});var i=new t.Deferred;if(this.exitAnimationPromise=i,n.isEmpty(this.exitAnimations)||"none"===this.$el.css("display"))p.trigger(e.publishedEvents.PAGE_COMPONENT_ANIMATION_END,this.id),i.resolve();else{var r=this,o=function(){p.trigger(e.publishedEvents.PAGE_COMPONENT_ANIMATION_END,r.id),i.resolve(),n.last(r.exitAnimations).off(u.END_EVENT,o)};n.last(this.exitAnimations).on(u.END_EVENT,o),n.each(this.exitAnimations,function(e){e.cleanup()}),this.exitAnimations[0].resetToInitialState(),this.exitAnimations[0].play(),this.exitAnimations.length>0&&p.trigger(e.publishedEvents.PAGE_COMPONENT_ANIMATION_START,this.id)}return i.promise()},cleanupAnimations:function(){this.entryAnimations&&n.each(this.entryAnimations,function(e){e.cleanup()}),this.exitAnimations&&n.each(this.exitAnimations,function(e){e.cleanup()})},hasEntryAnimation:function(){return this.entryAnimations&&n.size(this.entryAnimations)>0},doTriggerOnScroll:function(){return this.hasEntryAnimation()||this._hasInteraction(this.getModule().INTERACTION_TRIGGERS.VIEW)||"html"===this.type},resetToInitialState:function(){if(n.isEmpty(this.entryAnimations)){if(!n.isEmpty(this.exitAnimations)){var e=n.first(this.exitAnimations),t=!(e.isEntryAnimation()||this.options.visible&&0===e.initialState.opacity);if(!t)return void e.setToFinalState();e.resetToInitialState()}}else n.first(this.entryAnimations).resetToInitialState()},pauseAnimations:function(){this.entryAnimations&&n.each(this.entryAnimations,function(e){e.pause()}),this.exitAnimations&&n.each(this.exitAnimations,function(e){e.pause()})},resumeAnimations:function(){this.entryAnimations&&n.each(this.entryAnimations,function(e){e.resume()}),this.exitAnimations&&n.each(this.exitAnimations,function(e){e.resume()})},hasShadow:function(e){return!n.isEmpty(e)&&(e.x>0||e.x<0||e.y>0||e.y<0||e.blur>0)},getApplyShadowTarget:function(){return this.$el},_applyShadow:function(e,t){var i=this.getApplyShadowTarget();if(this.hasShadow(e)){var r={x:n.isNumber(e.x)?e.x:0,y:n.isNumber(e.y)?e.y:0};t&&0!==t&&this._rotateShadowCoordinates(r,t);var o="";o+=Math.round(r.x)+"px",o+=" "+Math.round(r.y)+"px",o+=e.blur?" "+e.blur+"px":" 0",o+=e.spread?" "+e.spread+"px":" 0",o+=" "+e.color,i.css("boxShadow",o)}else i.css("boxShadow","none")},_rotateShadowCoordinates:function(e,t){t=Math.toRad(t);var n=e.x*Math.cos(t)+e.y*Math.sin(t),i=-1*e.x*Math.sin(t)+e.y*Math.cos(t);e.x=n,e.y=i},_flipShadowCoordinates:function(e,t,n){t&&(e.x*=-1),n&&(e.y*=-1)},getApplyBackgroundTarget:function(){return this.$el},_applyBackground:function(e){var t=this.getApplyBackgroundTarget();if(!e)return t.css("backgroundColor","transparent"),void t.css("backgroundImage","none");e.color?t.css("backgroundColor",e.color):t.css("backgroundColor","transparent"),e.gradient?t.css("backgroundImage","linear-gradient("+parseInt(e.gradient.angle,10)+"deg,"+o.buildStops(e.gradient.stops)+")"):t.css("backgroundImage","none")},getExtentsDimensionData:function(){return{x:this.options.x,y:this.options.y,width:this.options.width,height:this.options.height,rotation:-Math.toRad(this.options.rotation),borderWidth:this.options.border.width?this.options.border.width:0}},getExtents:function(){var e=this.getExtentsDimensionData(),t=m.getExtentsPointsFromDimensions(e.x,e.y,e.width,e.height,e.rotation,e.borderWidth),n=this.transformPointToPageCoordinateSpace(t[0]),i=this.transformPointToPageCoordinateSpace(t[1]),r=this.transformPointToPageCoordinateSpace(t[2]),o=this.transformPointToPageCoordinateSpace(t[3]);return{x1:Math.round(Math.min(n.x,i.x,r.x,o.x)),y1:Math.round(Math.min(n.y,i.y,r.y,o.y)),x2:Math.round(Math.max(n.x,i.x,r.x,o.x)),y2:Math.round(Math.max(n.y,i.y,r.y,o.y))}},transformPointToPageCoordinateSpace:function(e){var t=new b.Point(e.x,e.y),i=this.parentViews;if(n.each(i,function(e){if(e.options.rotation){var n=e.options.width/2,i=e.options.height/2;t.rotate(n,i,-Math.toRad(e.options.rotation))}t.x+=e.options.x||0,t.y+=e.options.y||0}),this.options.parentSmartgroup){var r=this.options.parentSmartgroup.options.x,o=this.options.parentSmartgroup.options.y,a=this.options.parentSmartgroup.options.width/2,s=this.options.parentSmartgroup.options.height/2,u=-Math.toRad(this.options.parentSmartgroup.options.rotation);0!==u&&t.rotate(a,s,u),t.x+=r,t.y+=o}return t},isHovered:function(){return this.$el.is(":hover")},removePointerEventsIfNoInteractions:function(){this.options.interactions.length||this.parentsHaveInteractions()||this.$el.css("pointer-events","none")},addPointerEvents:function(){this.$el.css("pointer-events","auto")},isFlipped:function(){return!n.isNil(this.options.flipHorizontal)||!n.isNil(this.options.flipVertical)},childrenUseBlendingModes:function(){if(!this.childViews)return!1;var e=this;return this.childViews.some(function(t){var i=n.bind(e.childrenUseBlendingModes,t);return t.hasActiveBlendingMode()||i()})},hasActiveBlendingMode:function(){return this.options.blendingMode&&!E.isDefaultBlendingMode(this.options.blendingMode)},parentsHaveInteractions:function(){var e=this.options.parentSmartGroup||this.parentViews;if(e&&(!Array.isArray(e)||e.length)){var t=[];if(this.options.parentSmartGroup)t=this.options.parentSmartGroup.interactions;else for(var i=0;i<this.parentViews.length;++i)this.parentViews[i].validInteractions&&(t.push(this.parentViews[i].validInteractions.click),t.push(this.parentViews[i].validInteractions.hover),t.push(this.parentViews[i].validInteractions.view));return!!n.filter(n.flatten(t)).length}}})}),define("text!modules/page/templates/media-loading.html",[],function(){return'<div class="media-loading__media-type-icon {{#isImage}}-image{{/isImage}}{{^isImage}}-video{{/isImage}}"></div>\n<div class="media-loading__spinner"><div class="loader-spinner"></div></div>\n'}),define("modules/page/views/components/MediaComponentLoadingView",["log","jquery","lodash","backbone","mustache","device","shared/views/PlayerAbstractView","text!modules/page/templates/media-loading.html"],function(e,t,n,i,r,o,a,s){"use strict";return a.extend({className:"media-loading",initialize:function(e){this.isImage=e.isImage,this.parentHeight=e.height,this.render()},render:function(){this.$el.html(r.render(s,{isImage:this.isImage})),this.setIconSize(),this.setSpinnerSize()},setIconSize:function(){var e=Math.floor(.2*this.parentHeight);this.$el.find(".media-loading__media-type-icon").css("font-size",e+"px")},setSpinnerSize:function(){var e=Math.floor(.08*this.parentHeight);this.$el.find(".media-loading__spinner").css({height:e+"px",width:e+"px"})}})}),define("modules/page/models/video/AbstractVideo",[],function(){"use strict";return{on:function(e,t){throw new Error("on() must be defined by child class")},getPosition:function(){throw new Error("getPosition() must be defined by child class")},getLength:function(){throw new Error("getLength() must be defined by child class")},isPlaying:function(){throw new Error("isPlaying() must be defined by child class")},getCurrentSource:function(){throw new Error("getCurrentSource() must be defined by child class")}}}),define("modules/page/models/video/HTMLVideo",["lodash","modules/page/models/video/AbstractVideo"],function(e,t){"use strict";var n=function(e){this.$videoElement=e};return e.extend(n.prototype,t,{on:function(e,t){this.$videoElement.on(e,t)},getPosition:function(){return this.$videoElement[0].currentTime},getLength:function(){return this.$videoElement[0].duration},isPlaying:function(){return!1===this.$videoElement[0].ended&&!1===this.$videoElement[0].paused&&this.$videoElement[0].currentTime>0},getCurrentSource:function(){return this.$videoElement[0].currentSrc}}),n}),define("modules/page/utils/VideoTracker",["jquery","log","lodash","backbone"],function(e,t,n,i){"use strict";var r=function(e,t){this.video=e,this.loadedMetaData=!1,this.playedVideoBeforeMetaDataLoaded=!1,this.sentInitialPlayEvent=!1,this.progressPercents=[],this.isPlaying=!1,this.isTransitioningToPaused=!1,this.videoLength=t||!1,this.enabled=!0,this.currentPosition=0,this.lastPosition=0,this.progressStartPosition=0,this.isWindowVisible="hidden"!==document.visibilityState,this.addEventListeners()};return r.prototype=n.extend({},i.Events,{EVENTS:{PLAY:"play",PROGRESS_TIME:"progress_time",PROGRESS_PERCENT:"progress_percent"},enableTracking:function(){this.enabled||(this.enabled=!0,this.isWindowVisible&&this.restartProgressTracking())},disableTracking:function(){this.enabled&&(this.isWindowVisible&&this.triggerProgressEvent(this.lastPosition),this.enabled=!1)},addEventListeners:function(){document.addEventListener("visibilitychange",n.bind(function(){"hidden"===document.visibilityState?(this.isWindowVisible=!1,this.enabled&&this.triggerProgressEvent(this.lastPosition)):"visible"===document.visibilityState&&(this.isWindowVisible=!0,this.enabled&&this.restartProgressTracking())},this));var e=this;n.each("loadedmetadata,timeupdate".split(","),function(t){e.video.on(t,function(){switch(e.currentPosition=e.video.getPosition(),e.videoLength&&(e.currentPosition=Math.min(e.currentPosition,e.videoLength)),e.isTransitioningToPaused=e.isPlaying&&!e.video.isPlaying(),e.isPlaying=e.video.isPlaying(),t){case"loadedmetadata":e.handleLoadedMetadataEvent();break;case"timeupdate":e.handleTimeUpdateEvent();break;default:throw new Error("Missing handler function for video event: "+t)}e.lastPosition=e.currentPosition})})},handleLoadedMetadataEvent:function(){this.loadedMetaData=!0,
this.videoLength||!this.video.getLength()||this.video.getLength()===1/0||isNaN(this.video.getLength())||(this.videoLength=this.video.getLength()),this.playedVideoBeforeMetaDataLoaded&&(this.triggerPlayEvent(),this.sentInitialPlayEvent=!0)},sendInitialPlayEvent:function(){this.sentInitialPlayEvent||this.playedVideoBeforeMetaDataLoaded||(this.loadedMetaData?(this.triggerPlayEvent(),this.sentInitialPlayEvent=!0):this.playedVideoBeforeMetaDataLoaded=!0)},triggerPlayEvent:function(){this.triggerEvent(this.EVENTS.PLAY,{videoPosition:this.sanitizeVideoPosition(this.currentPosition)})},handleTimeUpdateEvent:function(){this.isPlaying&&this.sendInitialPlayEvent(),this.enabled&&this.isWindowVisible&&(this.currentPosition<this.lastPosition||Math.abs(this.currentPosition-this.lastPosition)>1?this.triggerProgressEvent(this.lastPosition):(this.isTransitioningToPaused||this.currentPosition-this.progressStartPosition>=10)&&this.triggerProgressEvent(),(this.isPlaying||this.isTransitioningToPaused)&&this.trackProgressPercent())},trackProgressPercent:function(){var e=this.videoLength?Math.floor(this.videoLength):this.videoLength;if(e&&100!==this.progressPercents.length){var t=Math.round(this.currentPosition/e*100);t=Math.max(1,Math.min(100,t));var n=1;e<100&&(n=Math.ceil(100/e));for(var i=0;i<n&&(this.addProgressPercentViewed(t),!(--t<=0));i++);}},addProgressPercentViewed:function(e){if(!n.includes(this.progressPercents,e)){this.progressPercents.push(e);var t=this.progressPercents.length;this.triggerEvent(this.EVENTS.PROGRESS_PERCENT,{progressPercent:t})}},triggerProgressEvent:function(e){e=e||this.currentPosition;var t=e-this.progressStartPosition;t>.1&&this.triggerEvent(this.EVENTS.PROGRESS_TIME,{videoPosition:this.sanitizeVideoPosition(this.progressStartPosition),videoPlayTime:this.round(t)}),this.restartProgressTracking()},triggerEvent:function(e,t){this.videoLength&&(t.videoLength=this.round(this.videoLength)),this.trigger(e,t)},restartProgressTracking:function(){this.progressStartPosition=this.currentPosition},round:function(e){return Math.round(100*e)/100},sanitizeVideoPosition:function(e){var t=this.round(e);return t<0&&(t=0),t}}),r}),define("modules/page/views/components/video/AbstractVideoComponentView",["lodash","jquery","log","globals","device","color","modules/page/views/components/AbstractComponentView","modules/page/views/components/MediaComponentLoadingView","modules/page/models/video/HTMLVideo","modules/page/utils/VideoTracker","shared/utils/CerosResourceLoader","urlUtils"],function(e,t,n,i,r,o,a,s,u,l,c,d){"use strict";var h=i.mediaDomainMap?e.invert(i.mediaDomainMap):null,f=[10,20,30,40,50,60,70,80,90,100];return a.extend({type:"video",tagName:"div",className:null,EVENTS:{VIDEO_READY:"video_ready"},isVideoReady:!1,playedOnce:!1,videoSlug:null,$vid:null,videoHandle:null,videoTracker:null,tapToPlay:!0,muted:!1,isAutoPaused:!1,isManuallyPaused:!1,isPinned:void 0,isRewound:!1,initialize:function(){a.prototype.initialize.apply(this),this.areMediaPropertiesSet()&&(this.videoSlug=this.options.video&&this.options.video.substr(this.options.video.lastIndexOf("/")+1),this.isVideoReady=!1,this.posterLoader=this.options.posterLoader,e.isUndefined(this.options.tapToPlay)||(this.tapToPlay=this.options.tapToPlay),e.isUndefined(this.options.muted)||(this.muted=this.options.muted),this._initializeDom(),i.previewMode&&(this.mediaLoadingScreen=new s({height:this.options.height,isImage:!1}),this.$el.append(this.mediaLoadingScreen.$el)),this.posterLoader&&(this.posterLoader.onImageLoaded(this.attachMedia,this),i.previewMode&&this.posterLoader.onImageLoaded(this.hideMediaLoadingScreen,this)))},hideMediaLoadingScreen:function(){this.mediaLoadingScreen.close()},onActivationStart:function(){this.videoTracker&&this.videoTracker.enableTracking()},areMediaPropertiesSet:function(){return this.options.video&&this.options.poster},attachMedia:function(){var n=new t.Deferred;if(this.areMediaPropertiesSet()){var i=this.getPosterFrameResource();i?i.loadNow().done(e.bind(function(e){this.$poster.attr("src",e.getSrc()),n.resolve()},this)):n.resolve()}else n.resolve();return n},getPosterFrameResource:function(){var e=null;return this.posterLoader&&((e=this.posterLoader.getCurrentResource())||n.warn("Poster image should have been added to resource loader during preload")),e},_hidePoster:function(){this.$poster&&this.$poster.hide()},_showPoster:function(){this.$poster&&this.$poster.show()},_isPosterShowing:function(){return this.$poster&&"none"!==this.$poster.css("display")},doTriggerOnScroll:function(){return!0},_getPosterFrameSrc:function(){return this.posterLoader?this.posterLoader.getCurrentUrl():""},_initializeDom:function(){this.$poster=t("<img>",{width:this.options.width,height:this.options.height,position:"absolute",top:0,left:0}),this.$el.append(this.$poster)},getAriaElement:function(){return this.$poster},onActivationEnd:function(){this.canAutoplay()&&!this.isManuallyPaused?this.play():this._isPosterShowing()&&this._loadVideo()},onExitStart:function(){this._hideVideoAndShowPoster(),this.autoPause(),this._rewindEndedAutoplayingVideo()},_getVideoFormats:function(){throw new Error("Device-specific implementation")},getResolvedVideoUrlForFormat:function(t){var i,r=this.options.videoMedia;if(!e.isUndefined(r)&&!e.isNull(r)){var o=r.encodings;if(!o[t])return null;i=o[t],i=d.makeUrlAbsolute(i),i=d.replaceProtocolIfHttpsRequest(i),h&&(i=this.switchAmazonDomainInUrl(i))}return e.isUndefined(i)&&(n.warn("Resolved video not found!",i),i=this.options.video+"/redirect/"+t),i},switchAmazonDomainInUrl:function(t){var n=t.match(/https?:\/\/(([a-z0-9-]*)\.[^\/]*)/i);if(n){var i=n[1],r=n[2];e.has(h,r)&&(t=t.replace(i,h[r]))}return t},_setVideoSources:function(){var n=this._getVideoFormats();e.each(n,e.bind(function(e){var n=this.getResolvedVideoUrlForFormat(e.format);if(n){var i="video/"+e.type;"hls-playlist"!==e.format&&"dash-playlist"!==e.format||(i="application/"+e.type),this.$vid.append(t("<source>",{src:n,type:i}))}},this))},_isLoopForever:function(){return!0===this.options.videoAutoPlay&&!0===this.options.videoLoop},_isShowControls:function(){return!1===this.options.videoAutoPlay||e.isUndefined(this.options.videoHideControls)||!1===this.options.videoHideControls},_hideVideo:function(){this.$vid&&this.$vid.hide()},_showVideo:function(){this.$vid&&this.$vid.show()},_hideVideoAndShowPoster:function(){this.videoHandle&&!this.videoHandle.currentTime&&(this._showPoster(),this.isVideoReady&&this._hideVideo())},_hidePosterAndShowVideo:function(){this.isVideoReady&&this._showVideo(),this._hidePoster()},_isPlaying:function(){return this.videoHandle&&!1===this.videoHandle.ended&&!1===this.videoHandle.paused&&this.videoHandle.currentTime>0},_isEnded:function(){return this.isVideoReady&&this.videoHandle.ended},_setCurrentTime:function(e){this.isVideoReady&&(this.videoHandle.currentTime=e)},reset:function(){a.prototype.reset.apply(this),this.pauseAnyVideoAndRewindAutoPlayingVideo(),this.isRewound&&this.options.videoAutoPlay&&(this.isManuallyPaused=!1)},whenLeavingVisibleBoundaries:function(){e.isUndefined(this.isPinned)&&(this.isPinned=this.options.fixedPosition||!(!this.options.parentSmartGroup||!this.options.parentSmartGroup.fixedPosition),!this.isPinned&&this.parentViews&&e.each(this.parentViews,e.bind(function(e){if(e.options.fixedPosition)return this.isPinned=!0,!1},this))),this.isPinned||(a.prototype.whenLeavingVisibleBoundaries.apply(this),this.disableVideoTrackingAndAutoPlayingVideo())},disableVideoTrackingAndAutoPlayingVideo:function(){this.disableVideoTracking(),this.options.videoAutoPlay&&this.pauseAnyVideoAndRewindAutoPlayingVideo()},disableVideoTracking:function(){this.videoTracker&&this.videoTracker.disableTracking()},pauseAnyVideoAndRewindAutoPlayingVideo:function(){this.autoPause(),this._rewindEndedAutoplayingVideo()},_rewindEndedAutoplayingVideo:function(){this.options.videoAutoPlay&&this._isEnded()&&(this._setCurrentTime(0),this.isRewound=!0)},loadAndShowVideo:function(){this.isVideoReady?this._hidePosterAndShowVideo():this._loadVideo()},play:function(){this.loadAndShowVideo(),this.videoTracker&&this.videoTracker.enableTracking(),this.isVideoReady?this.videoHandle.play():this.on(this.EVENTS.VIDEO_READY,e.bind(function(){this.videoHandle.play()},this)),this.isRewound=!1},autoPause:function(){this.isVideoReady&&!this.isPaused()&&(this.videoTracker&&this.videoTracker.disableTracking(),this.isAutoPaused=!0,this.videoHandle.pause())},getElementWidth:function(){return this.options.width},getElementHeight:function(){return this.options.height},buildVideoElement:function(){var e={id:this.id,width:this.getElementWidth(),height:this.getElementHeight(),poster:this._getPosterFrameSrc(),preload:"auto","webkit-playsinline":!0,playsinline:!0,type:"application/x-mpegURL"};this.muted&&(e.muted=!0),this._isLoopForever()&&(e.loop=!0),this.$vid=t("<video>",e),this.$vid.prop("controls",this._isShowControls()),this.$vid.prop("controlsList","nodownload"),this.$vid.css("display","none"),this.videoHandle=this.$vid[0],this.videoHandle.muted=this.muted,this.videoHandle.autoplay=this.canAutoplay(),r.isDesktopSafari()||r.isMobileSafari()?this.$vid.css("object-fit","cover"):this.$vid.css("object-fit","fill"),this.$poster.after(this.$vid)},_loadVideo:function(){if(!this.$vid){this.buildVideoElement();var t=new u(this.$vid),n=e.get(this.options,"videoMedia.duration");this.videoTracker=new l(t,n),this._configureVideoEvents(t),this.configurePlatformSpecificEvents(),this.doPlatformSpecificSetup(),this.bindVideoElementPauseAndPlayForManualPauseDetection()}},manuallyPause:function(){this.isVideoReady&&!this.isPaused()&&(this.videoTracker&&this.videoTracker.disableTracking(),this.isAutoPaused=!1,this.videoHandle.pause())},isPaused:function(){return this.$vid[0].paused},_configureVideoEvents:function(t){t.on("play",e.bind(function(){this.playedOnce=!0,n.debug("Currently playing from src "+t.getCurrentSource())},this)),this.videoTracker.on(this.videoTracker.EVENTS.PLAY,e.bind(function(e){this.triggerEvent(this.getModule().publishedEvents.PAGE_VIDEO_PLAY,e)},this)),this.options.videoLoop||(this.videoTracker.on(this.videoTracker.EVENTS.PROGRESS_TIME,e.bind(function(e){this.triggerEvent(this.getModule().publishedEvents.PAGE_VIDEO_PROGRESS_TIME,e)},this)),this.videoTracker.on(this.videoTracker.EVENTS.PROGRESS_PERCENT,e.bind(function(t){e.includes(f,t.progressPercent)&&this.triggerEvent(this.getModule().publishedEvents.PAGE_VIDEO_PROGRESS_PERCENT,t)},this)))},bindVideoElementPauseAndPlayForManualPauseDetection:function(){this.$vid.bind("pause",e.bind(function(e){this.onVideoPause()},this)),this.$vid.bind("play",e.bind(function(e){this.onVideoPlay()},this))},onVideoPause:function(){this.isManuallyPaused=!this.isAutoPaused},onVideoPlay:function(){this.isManuallyPaused=!1,this.isAutoPaused=!1},triggerEvent:function(t,n){var i=e.extend({componentSlug:this.options.id,videoSlug:this.videoSlug,pageSlug:this.options.pageView.model.get("slug")},n);this.getModule().trigger(t,i)},canAutoplay:function(){return!!this.options.videoAutoPlay&&(!this.tapToPlay||this.playedOnce)},_applyRotation:function(e,t,n){},_applyBackground:function(e){},_applyBorder:function(e){},_configureAction:function(){}})}),define("modules/page/views/AbstractTransformableGroupView",["device","modules/page/views/components/AbstractComponentView"],function(e,t){"use strict";return t.extend({render:function(){t.prototype.render.apply(this,arguments),this.$el.off("focus.resize").on("focus.resize",this.applyFocusDimensions.bind(this)),this.$el.off("blur.resize").on("blur.resize",this._applyDimensions.bind(this))},applyFocusDimensions:function(){this.$el.css({height:this.options.height,width:this.options.width})},_applyDimensions:function(t,n){this.$el.css({height:e.webkit?"1px":"",width:e.webkit?"1px":""});var i=this.options.width/2+"px "+this.options.height/2+"px";this.$el.css("transform-origin",i),this.$el.css("-moz-transform-origin",i),this.$el.css("-webkit-transform-origin",i),this.$el.css("-ms-transform-origin",i)},tagOverride:function(){var n=t.prototype.tagOverride.call(this);return e.msie&&n&&"button"===n.tagName.toLowerCase()?{tagName:this.defaultTagName,attributes:{tabindex:0,onkeyup:"if (['Enter', ' ', 'Spacebar'].indexOf(event.key) >= 0) this.click()",role:"button"}}:n}})}),define("modules/page/views/SmartgroupView",["jquery","lodash","globals","backbone","modules/page/views/AbstractTransformableGroupView","device","shared/utils/CssUtils","ExtentsUtils"],function(e,t,n,i,r,o,a,s){"use strict";return r.extend({sizeAdjusted:!1,initialize:function(){r.prototype.initialize.call(this),this.$el.addClass("smart-group"),this.childViews={},this.setSizeFromExtents()},setSizeFromExtents:function(){function e(n){if("folder"===n.type)t.each(n.items,function(t){e(t)});else{var r=n,o=s.getExtentsFromDimensions(r.x,r.y,r.width,r.height,Math.toRad(r.rotation),r.border.width?r.border.width:0);i.push(o)}}n.previewMode&&(this.options=t.clone(this.options)),this.options.scaleWidth=this.options.width/100,this.options.scaleHeight=this.options.height/100;var i=[];t.each(this.options.layers,function(t){e(t)});var r=s.getSmallestContainingRectangle.apply(s,i);this.options.width=r.x2-r.x1,this.options.height=r.y2-r.y1;var o=this.options.width/2,a=this.options.height/2,u=this.options.width/2*this.options.scaleWidth,l=this.options.height/2*this.options.scaleHeight;this.options.originalX=this.options.x,this.options.originalY=this.options.y,this.options.x=this.options.x-(o-u),this.options.y=this.options.y-(a-l),this.options.fixedPosition&&(this.options.unfixedX=this.options.x,this.options.unfixedY=this.options.y),this.sizeAdjusted=!0},_applyDimensions:function(e,t){r.prototype._applyDimensions.call(this,e,t);var n="scale("+this.options.scaleWidth+","+this.options.scaleHeight+")";this.$el.css("transform",a.concatTransform(this.$el.css("transform"),n))},render:function(){this.sizeAdjusted||this.setSizeFromExtents(),r.prototype.render.call(this)},applyChanges:function(e){this.sizeAdjusted=!1,r.prototype.applyChanges.call(this,e)},getAnimatedObjectModelData:function(){return this.sizeAdjusted||this.setSizeFromExtents(),r.prototype.getAnimatedObjectModelData.call(this)},removePointerEventsIfNoInteractions:function(){t.each(this.childViews,function(e){e.removePointerEventsIfNoInteractions()})}})}),define("modules/page/views/components/CanvasBackgroundComponentView",["jquery","lodash","backbone","modules/page/views/components/AbstractComponentView"],function(e,t,n,i){"use strict";return i.extend({type:"canvas-background",initialize:function(e){e.height=e.pageView.getPageHeight(),e.width=e.pageView.documentVersion.getExperienceWidth(),i.prototype.initialize.apply(this,arguments)},applyChanges:function(e){e.height=this.options.pageView.getPageHeight(),e.width=this.options.pageView.documentVersion.getExperienceWidth(),i.prototype.applyChanges.apply(this,arguments)}})}),define("modules/page/views/components/SquareShapeComponentView",["jquery","lodash","backbone","modules/page/views/components/AbstractComponentView"],function(e,t,n,i){"use strict";return i.extend({type:"shape",render:function(){return i.prototype.render.call(this),!t.isEmpty(this.options.background)||!t.isEmpty(this.options.border)&&0!==this.options.border.width||t.isEmpty(this.options.action)||this.$el.css({"background-color":"white",opacity:0}),this},hasShadow:function(e){return!t.isEmpty(this.options.background)&&i.prototype.hasShadow.call(this,e)}})}),define("modules/page/views/components/AbstractCanvasComponentView",["lodash","jquery","modules/page/views/components/AbstractComponentView"],function(e,t,n){"use strict";return n.extend({tagName:"canvas",canvasElement:function(){return this.$el.is("canvas")?this.$el:this.$el.find("canvas")},getApplyDimensionsTarget:function(){return this.$el.add(this.$el.find("canvas"))},applyTagOverride:function(){var n=this.tagOverride(),i=this.canvasElement();if(n){var r=this.getSpecifiedAttributes(this.$el[0].attributes),o=t("<"+n.tagName+"></"+n.tagName+">");o.attr(e.assign({},r,n.attributes));var a=this.getSpecifiedAttributes(o[0].attributes);if(this.$el.is(n.tagName)&&e.isEqual(r,a))return;this.unbindInteractions(),this.$el.replaceWith(o),i.css("left",0),i.css("top",0),this.setElement(o.append(i))}else this.$el.is("canvas")||(this.unbindInteractions(),i.attr("style",this.$el.attr("style")),this.$el.replaceWith(i),this.setElement(i))}})}),define("modules/page/utils/SVGUtil",["log","lodash"],function(e,t){"use strict";return function(){var n=function(e){e=e.replace(/(\s+)/g,";").split(";");var n="M";return t.each(e,function(e,t){e.length>0&&(n+=(0===t?"":"L")+e)}),n+="z"},i=function(e){var n=e.replace(/([MmZzLlHhVvCcSsQqTtAa])\s/g,"$1").replace(/\s-/g,"-").replace(/\s/g,",").match(/([MmZzLlHhVvCcSsQqTtAa](-?\d+[\.\s]?\d*,?)*)/g),i=[];return t.each(n,function(e,r){var o=e.substr(1).replace(/-/g,",-").replace(/(^,)/,"").split(",");t.each(o,function(e,t){o[t]=parseFloat(e)}),i.push({op:n[r].substr(0,1),coords:o})}),i},r=function(n,r){"string"==typeof r&&(r=i(r)),n.beginPath();var o,a,s,u,l,c,d=0,h=0,f=null,p=null;t.each(r,function(t,i){var r=t.coords;switch(t.op){case"m":d+=r[0],h+=r[1],n.moveTo(d,h);break;case"M":f=d=r[0],p=h=r[1],n.moveTo(d,h);break;case"c":o=d+r[0],a=h+r[1],s=d+r[2],u=h+r[3],d+=r[4],h+=r[5],l=2*d-s,c=2*h-u,n.bezierCurveTo(o,a,s,u,d,h);break;case"C":o=r[0],a=r[1],s=r[2],u=r[3],d=r[4],h=r[5],l=2*d-s,c=2*h-u,n.bezierCurveTo(o,a,s,u,d,h);break;case"s":s=d+r[0],u=h+r[1],d+=r[2],h+=r[3],n.bezierCurveTo(l,c,s,u,d,h),l=2*d-s,c=2*h-u;break;case"q":o=d+r[0],a=h+r[1],d+=r[2],h+=r[3],l=2*d-o,c=2*h-a,n.quadraticCurveTo(o,a,d,h);break;case"t":d+=r[0],h+=r[1],n.quadraticCurveTo(l,c,d,h),l=2*d-l,c=2*h-c;break;case"l":d+=r[0],h+=r[1],n.lineTo(d,h);break;case"L":d=r[0],h=r[1],n.lineTo(d,h);break;case"h":d+=r[0],n.lineTo(d,h);break;case"H":d=r[0],n.lineTo(d,h);break;case"v":h+=r[0],n.lineTo(d,h);break;case"V":h=r[0],n.lineTo(d,h);break;case"z":case"Z":n.lineTo(f,p);break;default:e.warn("UNKNOWN SVG OP: "+t.op)}})},o=function(e,t,n,i){t&&null!==t&&(r(e,t),i&&e.stroke(),n&&e.fill())};return{pointsToPath:n,parse:i,render:o,stroke:function(e,t){o(e,t,!1,!0)},fill:function(e,t){o(e,t,!0,!1)},trace:r}}()}),define("text!modules/page/templates/shapes.svg",[],function(){return'<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\x3e\n<svg version="1.2" baseProfile="tiny" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"\n\t y="0px" width="1000px" height="1000px" viewBox="0 0 1000 1000" xml:space="preserve">\n<g id="single-arrow" display="none">\n\t<path display="inline" fill-rule="evenodd" fill="none" stroke="#000000" stroke-miterlimit="10" d="M0,346.2l696.6,0V0L1000,500\n\t\tl-303.4,500V653.9L0,653.9V346.2z"/>\n</g>\n<g id="double-arrow" display="none">\n\t<path display="inline" fill-rule="evenodd" fill="none" stroke="#000000" stroke-miterlimit="10" d="M232.8,653.9V1000L0,500\n\t\tL232.8,0v346.1l534.5,0V0L1000,500l-232.8,500V653.9L232.8,653.9z"/>\n</g>\n<g id="rounded-square" display="none">\n\t<path display="inline" fill-rule="evenodd" fill="none" stroke="#000000" stroke-miterlimit="10" d="M1000,883.3\n\t\tc0,64.2-52.5,116.7-116.7,116.7H116.7C52.5,1000,0,947.5,0,883.3V116.7C0,52.5,52.5,0,116.7,0h766.7C947.5,0,1000,52.5,1000,116.7\n\t\tV883.3z"/>\n</g>\n<g id="triangle" display="none">\n\t<path display="inline" fill-rule="evenodd" fill="none" stroke="#000000" stroke-miterlimit="10" d="M500,0L0,1000h1000L500,0"/>\n</g>\n<g id="right-triangle" display="none">\n\t<polygon display="inline" fill-rule="evenodd" fill="none" stroke="#000000" stroke-miterlimit="10" points="0.1,1000.5\n\t\t1000.5,1000.5 1000.5,0.1 \t"/>\n</g>\n<g id="single-arrow-fat" display="none">\n\t<path display="inline" fill-rule="evenodd" fill="none" stroke="#000000" stroke-miterlimit="10" d="M454.5,0L1000,500l-545.5,500\n\t\tV700H0V300h454.5V0z"/>\n</g>\n<g id="double-arrow-fat" display="none">\n\t<path display="inline" fill-rule="evenodd" fill="none" stroke="#000000" stroke-miterlimit="10" d="M517,680.3L517,680.3l-252,0\n\t\tV1000L0,500L265,0v319.6h218v0h252V0l265,500l-265,500V680.3H517z"/>\n</g>\n<g id="round-bubble" display="none">\n\t<path display="inline" fill-rule="evenodd" fill="none" stroke="#000000" stroke-miterlimit="10" d="M650.3,786.5\n\t\tC516.5,972.5,288.8,1000,288.8,1000c75.1-73.8,98.5-146,100.4-204.9C166.4,754.5,0,594.2,0,402.5C0,180.2,223.9,0,500,0\n\t\ts500,180.2,500,402.5C1000,582.6,853,735.1,650.3,786.5z"/>\n</g>\n<g id="square-bubble" display="none">\n\t<path display="inline" fill-rule="evenodd" fill="none" stroke="#000000" stroke-miterlimit="10" d="M796.5,800H648.4l-302.2,200\n\t\tl54.9-200H203.5C91.1,800,0,705.2,0,588.3V211.7C0,94.8,91.1,0,203.5,0h592.9C908.9,0,1000,94.8,1000,211.7v376.7\n\t\tC1000,705.2,908.9,800,796.5,800z"/>\n</g>\n<g id="star" display="none">\n\t<path display="inline" fill-rule="evenodd" fill="none" stroke="#000000" stroke-miterlimit="10" d="M500,0l154.5,329.2L1000,382\n\t\tL750,638.2l59,361.8L500,829.2L191,1000l59-361.8L0,382l345.5-52.8L500,0z"/>\n</g>\n<g id="star2" display="none">\n\t<path display="inline" fill-rule="evenodd" fill="none" stroke="#000000" stroke-miterlimit="10" d="M500.3,0l-98.1,410.7L0,382.3\n\t\tl339.8,225.2L191,999.6l308.1-270.4L808.7,1000L659,607.7l341-225.5l-402.3,28.2L500.3,0z"/>\n</g>\n<g id="pentagon" display="none">\n\t<path display="inline" fill="none" stroke="#000000" stroke-miterlimit="10" d="M1000,382l-191,618H191L0,382L500,0L1000,382z"/>\n</g>\n<g id="circle" display="none">\n\t<circle display="inline" fill="none" stroke="#000000" stroke-miterlimit="10" cx="500" cy="500" r="500"/>\n</g>\n<g id="square" display="none">\n\t<rect x="0" y="0" display="inline" fill="none" stroke="#000000" stroke-miterlimit="10" width="1000" height="1000"/>\n</g>\n</svg>\n'}),define("modules/page/utils/ShapeLibrary",["jquery","lodash","modules/page/utils/SVGUtil","libs/image/ImageResource","text!modules/page/templates/shapes.svg"],function(e,t,n,i,r){"use strict";var o=function(){this.shapes=e(r),this.scale={x:parseInt(this.shapes.filter(":first").attr("width"),10),y:parseInt(this.shapes.filter(":first").attr("height"),10)},this.paths={},this.shapes.find("g").each(t.bind(function(t,i){i=e(i);var r=i.attr("id"),o=i.children(),a=this.getScale().x,s=this.getScale().y;this.paths[r]=null;var u;o.length>0&&(o.is("path")?(u=n.parse(o.attr("d")),this.paths[r]=function(e){n.trace(e,u)}):o.is("polygon")?(u=n.pointsToPath(o.attr("points")),this.paths[r]=function(e){n.trace(e,u)}):o.is("circle")?this.paths[r]=function(e){var t=a>s?s/2:a/2;e.translate(a/2,s/2),e.scale(a>s?a/s:1,s>a?s/a:1),e.arc(0,0,t,0,Math.toRad(360),!0)}:o.is("rect")&&(this.paths[r]=function(e){e.rect(0,0,a,s)}))},this))};return t.extend(o.prototype,{getScale:function(){return this.scale},getPathFunc:function(e){return this.paths[e]},getAllShapes:function(){return t.keys(this.paths)},hasShape:function(e){return t.has(this.paths,e)},getImageResource:function(n,r,o,a,s){var u=e('<canvas width="'+r+'" height="'+o+'"></canvas>'),l=u[0].getContext("2d");l.save(),l.clearRect(0,0,r,o),t.isUndefined(a)||(l.fillStyle=a),t.isUndefined(s)||(l.strokeStyle=s);var c=this.getPathFunc(n);null!==c&&(l.scale(r/this.getScale().x,o/this.getScale().y),l.beginPath(),c(l),t.isUndefined(a)||l.fill(),t.isUndefined(s)||l.stroke()),l.restore();var d=new i(u[0].toDataURL());return u.remove(),d}}),new o}),define("modules/page/views/components/ShapeComponentView",["log","jquery","lodash","backbone","modules/page/views/components/AbstractCanvasComponentView","modules/page/utils/ShapeLibrary","device","cerosMath"],function(e,t,n,i,r,o,a,s){"use strict";return r.extend({type:"shape",render:function(){var e=this.canvasElement();if(!n.isFunction(e[0].getContext))return this;this.scale=o.getScale(),this.startX=0,this.startY=0;var t={width:this.options.width,height:this.options.height};if("square"===this.options.shape)throw Error("This component view cannot be used for square!");this.addShadowPadding(t),this.addBorderPadding(t),this.options.allWidth=t.width,this.options.allHeight=t.height,r.prototype.render.call(this);var i=this.options.shadow,s=this.options.border,u=this.options.background,l=t.width,c=t.height;!n.isEmpty(u)||!n.isEmpty(s)&&0!==s.width||n.isEmpty(this.options.action)||e.css({"background-color":"white",opacity:0}),this._applyDimensions(l,c),e[0].width=l*(a.retina()?2:1),e[0].height=c*(a.retina()?2:1);var d=this.getContextAndApplyBorderShadowStyles();return this.renderBackground(d,s,u,i),this},addShadowPadding:function(e){var t=this.options.shadow;if(!n.isEmpty(t)&&!n.isEmpty(this.options.background)&&""!==t){var i=this.options.rotation;if(i&&0!==i){var r=n.isNumber(t.x)?t.x:0,o=n.isNumber(t.y)?t.y:0;i=Math.toRad(i),t.x=r*Math.cos(i)+o*Math.sin(i),t.y=-1*r*Math.sin(i)+o*Math.cos(i)}t.blur=n.isNumber(t.blur)?Math.abs(t.blur):0,t.x=n.isNumber(t.x)?t.x:0,t.y=n.isNumber(t.y)?t.y:0,a.retina()&&!t.retinaReady&&(t.blur*=2,t.x*=2,t.y*=2,t.retinaReady=!0),t.x<0&&(this.options.x-=Math.abs(t.x)+t.blur,this.startX+=Math.abs(t.x)+t.blur),t.y<0&&(this.options.y-=Math.abs(t.y)+t.blur,this.startY+=Math.abs(t.y)+t.blur),e.width+=Math.abs(t.x)+t.blur,e.height+=Math.abs(t.y)+t.blur,t.blur>Math.abs(t.x)&&this._applyShadowXOffset(e,t),t.blur>Math.abs(t.y)&&this._applyShadowYOffset(e,t),this.options.shadow=t}},_applyShadowXOffset:function(e,t){var n=t.blur-Math.abs(t.x),i=this.options.isXAdjusted?0:n;e.width+=n,this.startX+=n,this.options.x-=i,this.options.isXAdjusted=!0},_applyShadowYOffset:function(e,t){var n=t.blur-Math.abs(t.y),i=this.options.isYAdjusted?0:n;e.height+=n,this.startY+=n,this.options.y-=i,this.options.isYAdjusted=!0},addBorderPadding:function(e){var t=this.options.border;!n.isEmpty(t)&&""!==t&&n.isNumber(t.width)&&(e.width+=2*t.width*this._sizeFactorForPointyShapes()+this._offsetForPointyShapes(t),e.height+=2*t.width*this._sizeFactorForPointyShapes()+this._offsetForPointyShapes(t),this.options.x-=t.width+this._offsetForPointyShapes(t),this.options.y-=t.width+this._offsetForPointyShapes(t),this.startX+=t.width+this._offsetForPointyShapes(t),this.startY+=t.width+this._offsetForPointyShapes(t))},getContextAndApplyBorderShadowStyles:function(){var e=this.canvasElement().get(0).getContext("2d");a.retina()&&e.scale(2,2),e.translate(this.startX,this.startY);var t=this.options.border;n.isEmpty(t)||""===t||(e.lineWidth=1==t.width?1.0001:t.width,e.strokeStyle=t.color);var i=this.options.shadow;return n.isEmpty(i)||n.isEmpty(this.options.background)||""===i||(e.shadowOffsetX=i.x,e.shadowOffsetY=i.y,e.shadowColor=i.color,e.shadowBlur=i.blur),e},_applyShadow:function(){},_applyBorder:function(){},_applyBackground:function(){},_sizeFactorForPointyShapes:function(){return"star2"==this.options.shape||"double-arrow"==this.options.shape?2:1},_offsetForPointyShapes:function(e){return"star2"==this.options.shape||"double-arrow"==this.options.shape||"single-arrow"==this.options.shape?e.width:0},renderBackground:function(t,i,r,a){t.save(),(n.isUndefined(this.options.pathData)||n.isNull(this.options.pathData)||""===this.options.pathData)&&(this.path=o.getPathFunc(this.options.shape)),"square"==this.options.shape||(null!==this.path?(t.save(),t.scale(this.options.width/this.scale.x,this.options.height/this.scale.y),t.beginPath(),this.path(t),t.closePath(),t.restore()):e.error("Unsupported shape")),t.save(),r&&r.gradient?this._renderGradient(t,r.gradient):r&&r.color&&(t.fillStyle=r.color,t.fill()),t.restore(),i&&i.width>0&&t.stroke(),t.restore()},_applyPosition:function(e,t,n){var i=this.getApplyPositionTarget();"square"==this.options.shape?r.prototype._applyPosition.call(this,e,t,n):(i.css("left",e+"px"),i.css("top",t+"px"))},_renderGradient:function(e,t){var i=s.calcRotatedLineIntersect(t.angle,this.options.width,this.options.height),r=i.startPt,o=i.endPt,a=e.createLinearGradient(Math.round(r.getX()),Math.round(r.getY()),Math.round(o.getX()),Math.round(o.getY()));n.each(t.stops,n.bind(function(e){a.addColorStop(e.stop,e.color)},this)),e.fillStyle=a,e.fill()}})}),define("modules/page/views/components/HtmlComponentView",["jquery","lodash","backbone","globals","modules/page/views/components/AbstractComponentView"],function(e,t,n,i,r){"use strict";return r.extend({type:"html",onActivationStart:function(){if(this.previousCustomHtml!==this.options.customHtml)if(this.previousCustomHtml=this.options.customHtml,-1!==this.options.customHtml.indexOf("http:")&&"https:"===location.protocol)if(i.previewMode){this.$el.html("<p style='background-color:white'>Can't load an insecure resource on a secure page. Please publish your experience or change the embed code to use https.</p>")}else this.$el.empty();else if(this._hasHubspotCall()){var n=window.hbspt.forms.create;window.hbspt.forms.create=t.bind(function(t){t&&!t.target&&(t.target="#"+e.escapeSelector(this.el.id)),n(t)},this),this._parseHtml(),window.hbspt.forms.create=n}else this._parseHtml()},_parseHtml:function(){this.$el.empty().html(e.parseHTML(this.options.customHtml,document,!0))},_hasHubspotCall:function(){return-1!==this.options.customHtml.indexOf("hbspt.forms.create")},_applyBorder:function(){},_applyBackground:function(){},_applyShadow:function(){},_applyOpacity:function(){}})}),define("modules/page/views/components/ChartblocksChartComponentView",["jquery","lodash","backbone","globals","modules/page/views/components/AbstractComponentView"],function(e,t,n,i,r){"use strict";return r.extend({type:"chartblocks-chart",renderHash:null,render:function(){r.prototype.render.call(this);var t=this.generateRenderHash();if(t!==this.renderHash){this.oldX=this.options.x,this.oldY=this.options.y;var n=e("<iframe />");n.attr({width:this.options.width,height:this.options.height,src:this.getEmbedUrl(),frameBorder:"0"}),this.$el.empty(),this.$el.append(n),this.renderHash=t}},getEmbedUrl:function(){return"//embed.chartblocks.com/1.0/?c="+this.options.chartId+"&t="+this.options.requestToken},generateRenderHash:function(){return[this.options.width,this.options.height,this.options.chartId,this.options.requestToken].join(":")}})}),define("hubspotFormUtils",["lodash","jquery"],function(e,t){"use strict";return{renderForm:function(n){n.onFormReady=n.onFormReady||e.noop,n.onFormSubmit=n.onFormSubmit||e.noop;var i=null;n.onTimeout&&(i=setTimeout(n.onTimeout,1e4)),this.removeStyleTagForDomId(n.domId),window.hbspt.forms.create({portalId:n.portalId,formId:n.formId,css:n.css,target:"#"+n.domId,onFormReady:function(e,r){i&&clearTimeout(i);var o=t("head style").last();-1!==o.text().indexOf(n.css)&&o.attr("data-hubspot-form",n.domId),n.onFormReady(e,r)},onFormSubmit:n.onFormSubmit})},removeStyleTagForDomId:function(e){t("style[data-hubspot-form="+e+"]").remove()}}}),define("modules/page/views/components/AbstractFormComponentView",["lodash","jquery","device","shared/utils/NavigationUtils","modules/page/views/components/AbstractComponentView"],function(e,t,n,i,r){"use strict";return r.extend({type:"form-component",onAttach:function(){this.renderForm()},applyChanges:function(e){r.prototype.applyChanges.call(this,e),this.renderForm()},getContainerDivId:function(){return"form-component-"+this.options.id.replace("|","_")},getContainerClassName:function(){return"form-component-"+(this.options.originalObjectId||this.options.id)},renderForm:function(){throw new Error("renderForm not implemented.")},handleSubmit:function(e){throw new Error("handleSubmit not implemented.")},triggerSubmitInteractions:function(t,n){var i=this.getModule(),r=this.getValidInteractionsByTrigger(i.INTERACTION_TRIGGERS.SUBMIT);i.trigger(i.publishedEvents.PAGE_COMPONENT_FORM_SUBMITTED,this.addComponentAndClickDataToEvent({formOrigin:t,formOriginAccountId:n,formOriginFormId:this.options.formId,formOriginFormName:this.options.formName,interactionTriggered:!e.isEmpty(r)})),e.isEmpty(r)||e.each(r,e.bind(function(t){
"url"===t.action||"page-goto"===t.action||"page-next"===t.action||"page-prev"===t.action||"scroll-to"===t.action?e.defer(e.bind(function(){this._triggerClickAction(null,t)},this)):this._triggerClickAction(null,t)},this))},_applyBorder:function(){},_applyBackground:function(){},_applyShadow:function(){},_applyOpacity:function(){}})}),define("modules/page/views/components/HubspotFormComponentView",["lodash","jquery","device","hubspotFormUtils","shared/utils/NavigationUtils","modules/page/views/components/AbstractFormComponentView"],function(e,t,n,i,r,o){"use strict";return o.extend({type:"hubspot-form",getContainerDivId:function(){return"hubspot-"+this.options.id.replace("|","_")},getContainerClassName:function(){return"hubspot-"+(this.options.originalObjectId||this.options.id)},renderForm:function(){this.$el.empty();var n=t('<div id="'+this.getContainerDivId()+'"></div>');n.addClass(this.getContainerClassName()),this.$el.append(n),i.renderForm({portalId:this.options.hubId,formId:this.options.formId,css:this.options.css,domId:this.getContainerDivId(),onFormSubmit:e.bind(this.handleSubmit,this)})},handleSubmit:function(e){this.doIframeHack(e),this.triggerSubmitInteractions("hubspot",this.options.hubId)},scaleComponent:function(){var e=this.options.pageView.getScaleContext().ratio,t=this.$("#"+this.getContainerDivId());this.options.pageView.scaleContext.useZoom(e)?t.css({zoom:1/e,transform:"scale("+e+")","transform-origin":"0 0",width:100/e+"%","-moz-transform-origin":"0 0","-webkit-transform-origin":"0 0","-ms-transform-origin":"0 0"}):t.css({zoom:"initial",transform:"initial","transform-origin":"initial",width:"initial","-moz-transform-origin":"initial","-webkit-transform-origin":"initial","-ms-transform-origin":"initial"}),o.prototype.scaleComponent.call(this)},doIframeHack:function(i){if(n.isIos()||n.edge||n.isDesktopSafari()||n.msie){var o=!1,a=null,s=t(i).find("input[name=hs_context]").val();if(!e.isEmpty(s))try{var u=JSON.parse(s),l=r.getLocationWithoutParamsAndLayoutOrPageNumber();u.redirectUrl&&0===u.redirectUrl.indexOf(l)&&(a=u.redirectUrl),o=e.isEmpty(u.redirectUrl)||Boolean(a)}catch(e){}if(o){t("#hubspot-submit").remove();var c=t("<iframe></iframe>");c.attr("id","hubspot-submit"),c.attr("name","hubspot-submit"),c.css({position:"absolute",left:"99999px"}),t(document.body).append(c),t(i).attr("target","hubspot-submit"),a&&this.doThankYouMessageHack(i,a)}}},doThankYouMessageHack:function(n,r){var o=window.location.href,a=r+"&submissionGuid=1";window.history.replaceState({},"",a),e.defer(e.bind(function(){t(n).remove(),i.renderForm({portalId:this.options.hubId,formId:this.options.formId,css:this.options.css,domId:this.getContainerDivId(),onFormReady:function(){window.history.replaceState({},"",o)}})},this))}})}),function(e){function t(e,t){return function(n){return s(e.call(this,n),t)}}function n(){}function i(e){o(this,e)}function r(e){var t=e.years||e.year||e.y||0,n=e.months||e.month||e.M||0,i=e.weeks||e.week||e.w||0,r=e.days||e.day||e.d||0,o=e.hours||e.hour||e.h||0,a=e.minutes||e.minute||e.m||0,s=e.seconds||e.second||e.s||0,u=e.milliseconds||e.millisecond||e.ms||0;this._input=e,this._milliseconds=u+1e3*s+6e4*a+36e5*o,this._days=r+7*i,this._months=n+12*t,this._data={},this._bubble()}function o(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function a(e){return e<0?Math.ceil(e):Math.floor(e)}function s(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function u(e,t,n,i){var r,o,a=t._milliseconds,s=t._days,u=t._months;a&&e._d.setTime(+e._d+a*n),(s||u)&&(r=e.minute(),o=e.hour()),s&&e.date(e.date()+s*n),u&&e.month(e.month()+u*n),a&&!i&&R.updateOffset(e),(s||u)&&(e.minute(r),e.hour(o))}function l(e){return"[object Array]"===Object.prototype.toString.call(e)}function c(e,t){var n,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),o=0;for(n=0;n<i;n++)~~e[n]!=~~t[n]&&o++;return o+r}function d(e){return e?ee[e]||e.toLowerCase().replace(/(.)s$/,"$1"):e}function h(e,t){return t.abbr=e,M[e]||(M[e]=new n),M[e].set(t),M[e]}function f(e){if(!e)return R.fn._lang;if(!M[e]&&D)try{require("./lang/"+e)}catch(e){return R.fn._lang}return M[e]}function p(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function g(e){var t,n,i=e.match(V);for(t=0,n=i.length;t<n;t++)re[i[t]]?i[t]=re[i[t]]:i[t]=p(i[t]);return function(r){var o="";for(t=0;t<n;t++)o+=i[t]instanceof Function?i[t].call(r,e):i[t];return o}}function m(e,t){function n(t){return e.lang().longDateFormat(t)||t}for(var i=5;i--&&U.test(t);)t=t.replace(U,n);return te[t]||(te[t]=g(t)),te[t](e)}function v(e,t){switch(e){case"DDDD":return G;case"YYYY":return H;case"YYYYY":return W;case"S":case"SS":case"SSS":case"DDD":return j;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return q;case"a":case"A":return f(t._l)._meridiemParse;case"X":return z;case"Z":case"ZZ":return $;case"T":return Y;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return B;default:return new RegExp(e.replace("\\",""))}}function y(e){var t=($.exec(e)||[])[0],n=(t+"").match(Z)||["-",0,0],i=60*n[1]+~~n[2];return"+"===n[0]?-i:i}function b(e,t,n){var i,r=n._a;switch(e){case"M":case"MM":r[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":i=f(n._l).monthsParse(t),null!=i?r[1]=i:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(r[2]=~~t);break;case"YY":r[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":r[0]=~~t;break;case"a":case"A":n._isPm=f(n._l).isPM(t);break;case"H":case"HH":case"h":case"hh":r[3]=~~t;break;case"m":case"mm":r[4]=~~t;break;case"s":case"ss":r[5]=~~t;break;case"S":case"SS":case"SSS":r[6]=~~(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=y(t)}null==t&&(n._isValid=!1)}function w(e){var t,n,i=[];if(!e._d){for(t=0;t<7;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];i[3]+=~~((e._tzm||0)/60),i[4]+=~~((e._tzm||0)%60),n=new Date(0),e._useUTC?(n.setUTCFullYear(i[0],i[1],i[2]),n.setUTCHours(i[3],i[4],i[5],i[6])):(n.setFullYear(i[0],i[1],i[2]),n.setHours(i[3],i[4],i[5],i[6])),e._d=n}}function _(e){var t,n,i=e._f.match(V),r=e._i;for(e._a=[],t=0;t<i.length;t++)n=(v(i[t],e).exec(r)||[])[0],n&&(r=r.slice(r.indexOf(n)+n.length)),re[i[t]]&&b(i[t],n,e);r&&(e._il=r),e._isPm&&e._a[3]<12&&(e._a[3]+=12),!1===e._isPm&&12===e._a[3]&&(e._a[3]=0),w(e)}function E(e){var t,n,r,a,s,u=99;for(a=0;a<e._f.length;a++)t=o({},e),t._f=e._f[a],_(t),n=new i(t),s=c(t._a,n.toArray()),n._il&&(s+=n._il.length),s<u&&(u=s,r=n);o(e,r)}function S(e){var t,n=e._i,i=K.exec(n);if(i){for(e._f="YYYY-MM-DD"+(i[2]||" "),t=0;t<4;t++)if(X[t][1].exec(n)){e._f+=X[t][0];break}$.exec(n)&&(e._f+=" Z"),_(e)}else e._d=new Date(n)}function T(t){var n=t._i,i=N.exec(n);n===e?t._d=new Date:i?t._d=new Date(+i[1]):"string"==typeof n?S(t):l(n)?(t._a=n.slice(0),w(t)):t._d=n instanceof Date?new Date(+n):new Date(n)}function P(e,t,n,i,r){return r.relativeTime(t||1,!!n,e,i)}function A(e,t,n){var i=k(Math.abs(e)/1e3),r=k(i/60),o=k(r/60),a=k(o/24),s=k(a/365),u=i<45&&["s",i]||1===r&&["m"]||r<45&&["mm",r]||1===o&&["h"]||o<22&&["hh",o]||1===a&&["d"]||a<=25&&["dd",a]||a<=45&&["M"]||a<345&&["MM",k(a/30)]||1===s&&["y"]||["yy",s];return u[2]=t,u[3]=e>0,u[4]=n,P.apply({},u)}function I(e,t,n){var i,r=n-t,o=n-e.day();return o>r&&(o-=7),o<r-7&&(o+=7),i=R(e).add("d",o),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function x(e){var t=e._i,n=e._f;return null===t||""===t?null:("string"==typeof t&&(e._i=t=f().preparse(t)),R.isMoment(t)?(e=o({},t),e._d=new Date(+t._d)):n?l(n)?E(e):_(e):T(e),new i(e))}function O(e,t){R.fn[e]=R.fn[e+"s"]=function(e){var n=this._isUTC?"UTC":"";return null!=e?(this._d["set"+n+t](e),R.updateOffset(this),this):this._d["get"+n+t]()}}function C(e,t){R.duration.fn["as"+e]=function(){return+this/t}}for(var R,L,k=Math.round,M={},D="undefined"!=typeof module&&module.exports,N=/^\/?Date\((\-?\d+)/i,F=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,V=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,U=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,B=/\d\d?/,j=/\d{1,3}/,G=/\d{3}/,H=/\d{1,4}/,W=/[+\-]?\d{1,6}/,q=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,$=/Z|[\+\-]\d\d:?\d\d/i,Y=/T/i,z=/[\+\-]?\d+(\.\d{1,3})?/,K=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,X=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Z=/([\+\-]|\d\d)/gi,Q="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),J={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},ee={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},te={},ne="DDD w W M D d".split(" "),ie="M D H h m s w W".split(" "),re={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return s(this.year()%100,2)},YYYY:function(){return s(this.year(),4)},YYYYY:function(){return s(this.year(),5)},gg:function(){return s(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return s(this.weekYear(),5)},GG:function(){return s(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return s(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return s(~~(this.milliseconds()/10),2)},SSS:function(){return s(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+s(~~(e/60),2)+":"+s(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+s(~~(10*e/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};ne.length;)L=ne.pop(),re[L+"o"]=function(e,t){return function(n){return this.lang().ordinal(e.call(this,n),t)}}(re[L],L);for(;ie.length;)L=ie.pop(),re[L+L]=t(re[L],2);for(re.DDDD=t(re.DDD,3),n.prototype={set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,i;for(this._monthsParse||(this._monthsParse=[]),t=0;t<12;t++)if(this._monthsParse[t]||(n=R([2e3,t]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(i.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,i;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;t<7;t++)if(this._weekdaysParse[t]||(n=R([2e3,1]).day(t),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase()[0]},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,i){var r=this._relativeTime[n];return"function"==typeof r?r(e,t,n,i):r.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return I(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}},R=function(e,t,n){return x({_i:e,_f:t,_l:n,_isUTC:!1})},R.utc=function(e,t,n){return x({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},R.unix=function(e){return R(1e3*e)},R.duration=function(e,t){var n,i,o=R.isDuration(e),a="number"==typeof e,s=o?e._input:a?{}:e,u=F.exec(e);return a?t?s[t]=e:s.milliseconds=e:u&&(n="-"===u[1]?-1:1,s={y:0,d:~~u[2]*n,h:~~u[3]*n,m:~~u[4]*n,s:~~u[5]*n,ms:~~u[6]*n}),i=new r(s),o&&e.hasOwnProperty("_lang")&&(i._lang=e._lang),i},R.version="2.1.0",R.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",R.updateOffset=function(){},R.lang=function(e,t){if(!e)return R.fn._lang._abbr;t?h(e,t):M[e]||f(e),R.duration.fn._lang=R.fn._lang=f(e)},R.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),f(e)},R.isMoment=function(e){return e instanceof i},R.isDuration=function(e){return e instanceof r},R.fn=i.prototype={clone:function(){return R(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return m(R(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return null==this._isValid&&(this._a?this._isValid=!c(this._a,(this._isUTC?R.utc(this._a):R(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=m(this,e||R.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return n="string"==typeof e?R.duration(+t,e):R.duration(e,t),u(this,n,1),this},subtract:function(e,t){var n;return n="string"==typeof e?R.duration(+t,e):R.duration(e,t),u(this,n,-1),this},diff:function(e,t,n){var i,r,o=this._isUTC?R(e).zone(this._offset||0):R(e).local(),s=6e4*(this.zone()-o.zone());return t=d(t),"year"===t||"month"===t?(i=432e5*(this.daysInMonth()+o.daysInMonth()),r=12*(this.year()-o.year())+(this.month()-o.month()),r+=(this-R(this).startOf("month")-(o-R(o).startOf("month")))/i,r-=6e4*(this.zone()-R(this).startOf("month").zone()-(o.zone()-R(o).startOf("month").zone()))/i,"year"===t&&(r/=12)):(i=this-o,r="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-s)/864e5:"week"===t?(i-s)/6048e5:i),n?r:a(r)},from:function(e,t){return R.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(R(),e)},calendar:function(){var e=this.diff(R().startOf("day"),"days",!0),t=e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){var e=this.year();return e%4==0&&e%100!=0||e%400==0},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?"string"==typeof e&&"number"!=typeof(e=this.lang().weekdaysParse(e))?this:this.add({d:e-t}):t},month:function(e){var t,n=this._isUTC?"UTC":"";return null!=e?"string"==typeof e&&"number"!=typeof(e=this.lang().monthsParse(e))?this:(t=this.date(),this.date(1),this._d["set"+n+"Month"](e),this.date(Math.min(t,this.daysInMonth())),R.updateOffset(this),this):this._d["get"+n+"Month"]()},startOf:function(e){switch(e=d(e)){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),this},endOf:function(e){return this.startOf(e).add(e,1).subtract("ms",1)},isAfter:function(e,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)>+R(e).startOf(t)},isBefore:function(e,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)<+R(e).startOf(t)},isSame:function(e,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)==+R(e).startOf(t)},min:function(e){return e=R.apply(null,arguments),e<this?this:e},max:function(e){return e=R.apply(null,arguments),e>this?this:e},zone:function(e){var t=this._offset||0;return null==e?this._isUTC?t:this._d.getTimezoneOffset():("string"==typeof e&&(e=y(e)),Math.abs(e)<16&&(e*=60),this._offset=e,this._isUTC=!0,t!==e&&u(this,R.duration(t-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return R.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var t=k((R(this).startOf("day")-R(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},weekYear:function(e){var t=I(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=I(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=I(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this._d.getDay()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},lang:function(t){return t===e?this._lang:(this._lang=f(t),this)}},L=0;L<Q.length;L++)O(Q[L].toLowerCase().replace(/s$/,""),Q[L]);O("year","FullYear"),R.fn.days=R.fn.day,R.fn.months=R.fn.month,R.fn.weeks=R.fn.week,R.fn.isoWeeks=R.fn.isoWeek,R.fn.toJSON=R.fn.toISOString,R.duration.fn=r.prototype={_bubble:function(){var e,t,n,i,r=this._milliseconds,o=this._days,s=this._months,u=this._data;u.milliseconds=r%1e3,e=a(r/1e3),u.seconds=e%60,t=a(e/60),u.minutes=t%60,n=a(t/60),u.hours=n%24,o+=a(n/24),u.days=o%30,s+=a(o/30),u.months=s%12,i=a(s/12),u.years=i},weeks:function(){return a(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*~~(this._months/12)},humanize:function(e){var t=+this,n=A(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},add:function(e,t){var n=R.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=R.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=d(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=d(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:R.fn.lang};for(L in J)J.hasOwnProperty(L)&&(C(L,J[L]),function(e){R.duration.fn[e]=function(){return this._data[e]}}(L.toLowerCase()));C("Weeks",6048e5),R.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},R.lang("en",{ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),D&&(module.exports=R),"undefined"==typeof ender&&(this.moment=R),"function"==typeof define&&define.amd&&define("moment",[],function(){return R})}.call(this),define("utils/TimerUtils",["jquery","moment"],function(e,t){"use strict";return{waitFor:function(n,i,r){var o=new e.Deferred,a=t(),s=function(){n()?o.resolve():t()-a>r?o.reject():setTimeout(s,i)};return s(),o.promise()}}}),define("marketoFormUtils",["lodash","jquery","mustache","utils/TimerUtils"],function(e,t,n,i){"use strict";return{renderForm:function(t){var i=this;t.onFormReady=t.onFormReady||e.noop,t.onFormSubmit=t.onFormSubmit||e.noop;var r=null;t.onTimeout&&(r=setTimeout(t.onTimeout,1e4)),window.MktoForms2.loadForm(t.marketoInstanceUrl,t.munchkinId,t.formId,function(e){e?(e.render(t.renderingElement),r&&clearTimeout(r),e.getFormElem().find(".cf_widgetLoader").length>0?i.waitForSocialSignonRender(e).done(function(){e.onSuccess(t.onFormSubmit),t.onFormReady(e)}).fail(function(){t.onTimeout&&t.onTimeout()}):(e.onSuccess(t.onFormSubmit),t.onFormReady(e))):(r&&clearTimeout(r),t.onError&&t.onError(n.render("Your form, {{formName}}, has been deleted from your Marketo account. Please make a new form in Marketo or choose an existing form for this experience.",{formName:t.formName})))})},waitForSocialSignonRender:function(n){var r=new t.Deferred,o=e.bind(function(){return t.trim(n.getFormElem().find(".cf_widget_socialsignon").html())},this);return i.waitFor(o,125,1e4).done(function(){r.resolve()}).fail(function(){r.reject()}),r.promise()}}}),define("modules/page/views/components/MarketoFormComponentView",["lodash","jquery","device","marketoFormUtils","shared/utils/NavigationUtils","modules/page/views/components/AbstractFormComponentView"],function(e,t,n,i,r,o){"use strict";return o.extend({type:"marketo-form",getContainerDivId:function(){return"marketo-"+this.options.id.replace("|","_")},getContainerClassName:function(){return"marketo-"+(this.options.originalObjectId||this.options.id)},renderForm:function(){this.$el.empty();var n=t('<form id="'+this.getContainerDivId()+'"></form>');n.addClass(this.getContainerClassName()),this.$el.append(n),i.renderForm({munchkinId:this.options.munchkinId,formId:this.options.formId,marketoInstanceUrl:this.options.marketoInstanceUrl,domId:this.getContainerDivId(),renderingElement:n,onFormSubmit:e.bind(this.handleSubmit,this),onFormReady:e.bind(this.handleReady,this),onTimeout:function(){window.Rollbar&&window.Rollbar.error("Marketo form failed to load. (Timeout error.)",{munchkinId:this.options.munchkinId,formId:this.options.formId,marketoInstanceUrl:this.options.marketoInstanceUrl})}})},handleReady:function(e){},handleSubmit:function(t,n){return this.triggerSubmitInteractions("marketo",this.options.munchkinId),e.defer(e.bind(this.renderForm,this)),!1}})}),define("modules/page/views/components/HotspotComponentView",["jquery","lodash","backbone","modules/page/views/components/AbstractComponentView"],function(e,t,n,i){"use strict";return i.extend({type:"hotspot",render:function(){return i.prototype.render.call(this),this.$el.css({"background-color":"transparent"}),this},_applyBorder:function(){},_applyBackground:function(){},_applyShadow:function(){},_applyOpacity:function(){}})}),define("@frontend/player/custom-path/common/CustomPathSVGUtil",["lodash"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=38)}({1:function(t,n){t.exports=e},38:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=function(){function e(){}return e.generateCurveCoords=function(e,t){void 0===t&&(t=!0);for(var n=e,i=this.moveToStartingPoint(n[0]),r=1;r<n.length;r++)i+=this.generateCurveSection(n[r-1],n[r]);return t&&(i+=this.generateCurveSection(n[n.length-1],n[0]),i+=this.closePath()),i},e.moveToStartingPoint=function(e){return"M "+e.x+" "+e.y+" "},e.generateCurveSection=function(e,t){return"C "+(i.isUndefined(e.cx2)?e.x:e.cx2)+" "+(i.isUndefined(e.cy2)?e.y:e.cy2)+", "+(i.isUndefined(t.cx1)?t.x:t.cx1)+" "+(i.isUndefined(t.cy1)?t.y:t.cy1)+", "+t.x+" "+t.y+" "},e.closePath=function(){return" Z"},e}();t.CustomPathSVGUtil=r}})}),define("@frontend/player/custom-path/common/AbstractCustomPathComponentView",["lodash","modules/page/views/components/AbstractComponentView","mustache","cerosMath","@frontend/player/custom-path/common/CustomPathSVGUtil"],function(e,t,n,i,r){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=32)}({1:function(t,n){t.exports=e},32:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(33),a=n(34),s=n(35),u=n(36),l=n(1),c=n(37),d=function(e){function t(t){return l.defaults(t,{className:"custom-path-container"}),e.call(this,t)||this}return r(t,e),t.prototype.bindMouseoverInteraction=function(){var e=this;this.hasHoverInteraction()&&this.$("path").on("mouseover",function(t){return e._handleMouseOverInteraction(t)})},t.prototype.assignCursor=function(){this.hasClickInteraction()||this.options.showHoverCursor?this.$("path").css("cursor","pointer"):this.$("path").css("cursor","inherit")},t.prototype._applyBorder=function(){},t.prototype._applyBackground=function(){},t.prototype._applyShadow=function(){},t.prototype._applyOpacity=function(){},t.prototype.isHovered=function(){return this.$("path").is(":hover")},t.prototype.render=function(){var t=c.CustomPathSVGUtil.generateCurveCoords(this.options.path,this.options.isClosedPath),n=this.options.shadow,i=this.options.border.width||0,r=this.options.width,o=this.options.height,l=this.options.background,d=this.gradientExists(l),h=this.id+"-"+this.type+"-svg",f=h+"-gradient",p=this.options.rotation||0,g=u.maintainOffsetWhenRotated(p,{x:n.x||0,y:n.y||0}),m=g.x||0,v=g.y||0,y=(n.blur||0)/2,b=2*y,w=100*Math.abs(m/r)*-1-20-b,_=100*Math.abs(v/o)*-1-20-b,E=2*Math.abs(w)+100,S=2*Math.abs(_)+100;return this.$el.empty().html(a.render(s,{path:t,svgName:h,gradientName:f,fill:d?"url(#"+f+")":this.options.background.color||"transparent",stroke:this.options.border.color||"",strokeWidth:i,shadowX:m,shadowY:v,shadowBlur:y,shadowColor:n.color||"",shadowFilterExists:this.shadowFilterExists(n),filterX:w,filterY:_,filterWidth:E,filterHeight:S,width:r,height:o,gradientExists:d,gradientStop0:this.getStop(l,0),gradientStop1:this.getStop(l,1),gradientXYRotation:this.getGradientXYFromAngle(l.gradient&&l.gradient.angle?l.gradient.angle:0)})),this.$el.css({opacity:this.getOpacity()}),e.prototype.render.call(this,this),this},t.prototype.getGradientXYFromAngle=function(e){var t=e*(Math.PI/180);return{x1:Math.round(50+50*Math.sin(t+Math.PI)),x2:Math.round(50+50*Math.sin(t)),y1:Math.round(50+50*Math.cos(t)),y2:Math.round(50+50*Math.cos(t+Math.PI))}},t.prototype.getStop=function(e,t){if(e&&e.gradient&&e.gradient.stops)return e.gradient.stops.find(function(e){return e.stop===t})},t.prototype.gradientExists=function(e){return!!e&&!!e.gradient},t.prototype.shadowFilterExists=function(e){return e&&void 0!==e.x&&void 0!==e.y&&void 0!==e.color&&void 0!==e.blur},t.prototype._applyPosition=function(e,t){var n=this.getApplyPositionTarget();n.css("left",e+"px"),n.css("top",t+"px")},t}(o);t.AbstractCustomPathComponentView=d},33:function(e,t){e.exports=require("modules/page/views/components/AbstractComponentView")},34:function(e,t){e.exports=n},35:function(e,t){e.exports='<svg\n  id="custom-path-component-id"\n  name="{{svgName}}"\n  overflow="visible"\n  width="{{width}}"\n  height="{{height}}"\n>\n  {{#shadowFilterExists}}\n  <filter\n    id="{{svgName}}-custom-path-shadow-filter"\n    x="{{filterX}}%"\n    y="{{filterY}}%"\n    width="{{filterWidth}}%"\n    height="{{filterHeight}}%"\n  >\n    <feGaussianBlur in="SourceAlpha" stdDeviation="{{shadowBlur}}" />\n    <feOffset dx="{{shadowX}}" dy="{{shadowY}}" result="offsetblur" />\n    <feFlood flood-color="{{shadowColor}}" />\n    <feComposite in2="offsetblur" operator="in" />\n    <feMerge>\n      <feMergeNode />\n      <feMergeNode in="SourceGraphic" />\n    </feMerge>\n  </filter>\n  {{/shadowFilterExists}} {{#gradientExists}}\n  <linearGradient\n    id="{{gradientName}}"\n    x1="{{gradientXYRotation.x1}}%"\n    y1="{{gradientXYRotation.y1}}%"\n    x2="{{gradientXYRotation.x2}}%"\n    y2="{{gradientXYRotation.y2}}%"\n  >\n    <stop offset="0%" style="stop-color:{{gradientStop0.color}};stop-opacity:1" />\n    <stop offset="100%" style="stop-color:{{gradientStop1.color}};stop-opacity:1" />\n  </linearGradient>\n  {{/gradientExists}}\n  <path\n    d="{{path}}"\n    fill="{{fill}}"\n    stroke="{{stroke}}"\n    stroke-width="{{strokeWidth}}"\n    filter="{{#shadowFilterExists}}url(#{{svgName}}-custom-path-shadow-filter){{/shadowFilterExists}}"\n    stroke-linecap="butt"\n    stroke-linejoin="miter"\n    pointer-events="auto"\n  ></path>\n</svg>\n'},36:function(e,t){e.exports=require("cerosMath")},37:function(e,t){e.exports=require("@frontend/player/custom-path/common/CustomPathSVGUtil")}})}),define("@frontend/player/hotspot-path/HotspotPathComponentView",["@frontend/player/custom-path/common/AbstractCustomPathComponentView"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),
Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=42)}({16:function(e,t){e.exports=require("@frontend/player/custom-path/common/AbstractCustomPathComponentView")},42:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="hotspot-path",t}return r(t,e),t.prototype.render=function(){return e.prototype.render.call(this),this.$el.css({"background-color":"transparent"}),this},t}(n(16).AbstractCustomPathComponentView);t.HotspotPathComponentView=o}})}),define("modules/page/views/components/ImageComponentView",["log","jquery","lodash","backbone","device","globals","modules/page/views/components/AbstractComponentView","modules/page/views/components/MediaComponentLoadingView","shared/utils/CerosResourceLoader","shared/utils/CssUtils","shared/utils/WebkitUtils","@frontend/common/libs/ImageEffects","libs/utils/FeatureFlagsLookupService","libs/utils/FeatureFlags"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f){"use strict";var d=d.ImageEffects;return a.extend({type:"image",image:null,srcOverride:null,dimensionsOverride:!1,initialize:function(){this.$imgEl=null,this.imageReadyPromises={},a.prototype.initialize.call(this),this.imageLoader=this.options.imageLoader,o.previewMode&&(this.mediaLoadingScreen=new s({height:this.options.height,isImage:!0}),this.$el.append(this.mediaLoadingScreen.$el))},render:function(){return n.isNull(this.$imgEl)&&(this.$imgEl=t("<img/>"),this.$imgEl.css("display","block"),this.hasShadow(this.options.shadow)?r.isIos()&&this.options.shadow.blur&&this.$imgEl.css("transform",l.concatTransform(this.$imgEl.css("transform"),"translateZ(0)")):(r.isDesktopSafari()&&this.$imgEl.css("transform",c.hardwareAccelerateTransform(this.$el.css("transform"))),r.isIos()&&this.options.fixedPosition&&this.$imgEl.css("transform",c.hardwareAccelerateTransform(this.$el.css("transform")))),this.$el.append(this.$imgEl)),this.dimensionsOverride||this.setDimensionsAsAttributes(this.$imgEl,this.options.width,this.options.height),this.isFlipped()&&this._applyImageFlip(),a.prototype.render.call(this),this.imageLoader&&(this.imageLoader.onLowResImageLoaded(this.attachMedia,this),this.imageLoader.onImageLoaded(this.attachMedia,this),o.previewMode&&(this.imageLoader.onLowResImageLoaded(this.hideMediaLoadingScreen,this),this.imageLoader.onImageLoaded(this.hideMediaLoadingScreen,this))),n.isNil(this.options.effects)||this._applyImageEffects(this.options),n.isNil(this.options.blendingMode)||this.$imgEl.parent().css("mix-blend-mode",this.options.blendingMode),this},hideMediaLoadingScreen:function(){this.mediaLoadingScreen.close()},_applyImageFlip:function(){var e=this.options.flipHorizontal?"-1":"1",t=this.options.flipVertical?"-1":"1";this.$imgEl.css("transform","scaleX("+e+") scaleY("+t+")")},_applyImageEffects:function(e){var t=e.effects,i=this.getApplyShadowTarget(),o=this.options.shadow,a=this.options.rotation,s="";if(n.isNil(t)||(s=this.computeEffect(t)),this.hasShadow(o)&&!r.isIE11()){var u={x:n.isNumber(o.x)?o.x:0,y:n.isNumber(o.y)?o.y:0};a&&0!==a&&this._rotateShadowCoordinates(u,a),this.isFlipped()&&this._flipShadowCoordinates(u,this.options.flipHorizontal,this.options.flipVertical);var l="drop-shadow(";l+=Math.round(u.x)+"px",l+=" "+Math.round(u.y)+"px";var c=r.webkit?4:2;l+=o.blur?" "+Math.round(o.blur/c)+"px":" 0",l+=" "+o.color,l+=")",i.css("-webkit-filter",s+" "+l),i.css("filter",s+" "+l);var d="progid:DXImageTransform.Microsoft.Dropshadow(OffX=";d+=Math.round(u.x)+", OffY=",d+=Math.round(u.y)+", Color='",d+=o.color+"')",i.css("filter",d)}else i.css("filter",s),i.css("-webkit-filter",s)},_applyShadow:function(e,t){this.hasShadow(e)&&!r.isIE11()||a.prototype._applyShadow.call(this)},computeEffect:function(e){var t=e[d.BRIGHTNESS.NAME],i=e[d.CONTRAST.NAME],r=e[d.HUE.NAME],o=e[d.SATURATION.NAME],a=e[d.SEPIA.NAME],s=e[d.INVERT.NAME],u="",l="",c="";n.isNil(t)||t===d.defaultValueOf(d.BRIGHTNESS.NAME)||(t+=100,u=this.createImageEffectCssString(d.BRIGHTNESS,t)),n.isNil(i)||i===d.defaultValueOf(d.CONTRAST.NAME)||(i+=100,l=this.createImageEffectCssString(d.CONTRAST,i)),n.isNil(o)||o===d.defaultValueOf(d.SATURATION.NAME)||(o+=100,0===o&&(o=1),c=this.createImageEffectCssString(d.SATURATION,o));var h={};return h[d.BRIGHTNESS.NAME]=u,h[d.CONTRAST.NAME]=l,h[d.SATURATION.NAME]=c,h[d.HUE.NAME]=this.createEffectStringIfPresent(r,d.HUE),h[d.SEPIA.NAME]=this.createEffectStringIfPresent(a,d.SEPIA),h[d.INVERT.NAME]=this.createEffectStringIfPresent(s,d.INVERT),d.computeBrowserImageFilter(h)},createImageEffectCssString:function(e,t){return e.NAME+"("+t+e.UNIT+")"},createEffectStringIfPresent:function(e,t){return n.isNil(e)||e===d.defaultValueOf(t.NAME)?"":this.createImageEffectCssString(t,e)},getApplyBorderTarget:function(){return this.$imgEl},getApplyShadowTarget:function(){return this.$imgEl},attachMedia:function(){if(this.srcOverride)return this.attachImageSrc(this.srcOverride);if(!this.imageLoader)return this.attachImageSrc("");var i=this.imageLoader.getCurrentResource();return i?i.loadNow().then(n.bind(function(e){return this.attachImageSrc(e.getSrc())},this)):(e.warn("Image should have been added to resource loader during preload"),t.Deferred().resolve(null).promise())},attachImageSrc:function(e){var i=this.imageReadyPromises[e];return i?(this.$imgEl.attr("src",e),i.promise()):(i=this.imageReadyPromises[e]=t.Deferred(),this.$imgEl.on("load",n.bind(function(){this.addAltText(this.$imgEl),i.resolve()},this)),this.$imgEl.on("error",n.bind(function(){this.addAltText(this.$imgEl)},this)),this.$imgEl.attr("src",e),i.promise())},_applyBackground:function(e){},addAltText:function(e){var t=this.options.altText;t||(t=h.hasFeature(f.ACCESSIBILITY)?"":void 0),e.attr("alt",t)}})}),define("modules/page/views/components/VectorImageComponentView",["log","jquery","lodash","modules/page/views/components/ImageComponentView","VectorImageUtils"],function(e,t,n,i,r){"use strict";return i.extend({initialize:function(){i.prototype.initialize.call(this),this.loadImage=n.once(this.loadImage,this),this.vectorImageReady=new t.Deferred},attachMedia:function(){if(this.imageLoader){var t=this.imageLoader.getCurrentResource();n.isNull(t)?e.warn("Image should have been added to resource loader during preload"):t.loadNow().done(n.bind(function(e){this.loadImage(e,this.vectorImageReady,this.options.background)},this)).fail(n.bind(function(){this.vectorImageReady.reject()},this))}return this.vectorImageReady.promise()},loadImage:function(e,t,i){i.backgroundHasBeenSet=this.options.backgroundHasBeenSet,e.createObjectURL(i).done(n.bind(function(e){this.$imgEl.on("load",n.bind(function(){this.addAltText(this.$imgEl),t.resolve()},this)),this.$imgEl.on("error",n.bind(function(e){this.addAltText(this.$imgEl),t.reject(e)},this)),this.$imgEl.attr("src",e)},this)).fail(t.reject)}})}),define("modules/page/views/components/LineComponentView",["jquery","lodash","backbone","modules/page/views/components/AbstractCanvasComponentView"],function(e,t,n,i){"use strict";return i.extend({type:"line",render:function(){var e=this.canvasElement();if(!t.isFunction(e[0].getContext))return this;var n=this.options.shadow;this.options.x1=this.options.x,this.options.y1=this.options.y,this.options.x=this.options.x1<this.options.x2?this.options.x1:this.options.x2,this.options.y=this.options.y1<this.options.y2?this.options.y1:this.options.y2,this.options.width=Math.abs(this.options.x2-this.options.x1),this.options.height=Math.abs(this.options.y2-this.options.y1);var r=this.options.x1-this.options.x,o=this.options.y1-this.options.y,a=this.options.x2-this.options.x,s=this.options.y2-this.options.y;this.options.width<this.options.lineWidth&&(this.options.width+=this.options.lineWidth),this.options.height<this.options.lineWidth&&(this.options.height+=this.options.lineWidth);var u=Math.ceil(this.options.lineWidth/2);n&&this.hasShadow(n)&&(u+=n.blur?n.blur:0,n.x=t.isNumber(n.x)?n.x:0,n.y=t.isNumber(n.y)?n.y:0,n.x<0&&(this.options.x-=Math.abs(n.x),r+=Math.abs(n.x),a+=Math.abs(n.x)),this.options.width+=Math.abs(n.x),n.y<0&&(this.options.y-=Math.abs(n.y),o+=Math.abs(n.y),s+=Math.abs(n.y)),this.options.height+=Math.abs(n.y)),this.options.width+=2*u,this.options.height+=2*u,this.options.x-=u,this.options.y-=u,r+=u,o+=u,a+=u,s+=u,i.prototype.render.call(this),this.setDimensionsAsAttributes(e,this.options.width,this.options.height);var l=e.get(0).getContext("2d");return l.lineWidth=this.options.lineWidth,l.strokeStyle=this.options.color,n&&this.hasShadow(n)&&(l.shadowOffsetX=n.x,l.shadowOffsetY=n.y,l.shadowColor=n.color,l.shadowBlur=n.blur),l.beginPath(),1===this.options.lineWidth&&l.translate(.5,.5),l.moveTo(r,o),l.lineTo(a,s),l.closePath(),l.stroke(),this},_applyBackground:function(){},_applyRotation:function(){},_applyShadow:function(){}})}),define("SyncedPropertiesMap",[],function(){"use strict";var e={"text-component":["title","textContent"]};return{get:function(t){return e[t]||[]}}}),define("modules/page/utils/PlayerVariantUtil",["lodash","log","modules/page/utils/PlayerVariantDetector","SyncedPropertiesMap"],function(e,t,n,i){"use strict";return{reconcileComponentForCurrentVariant:function(e){var t=n.getVariant();return this.reconcileComponentForVariant(t,e)},reconcileComponentForVariant:function(n,r){if("desktop"===n)return r;var o=e.isObject(r.overrides)&&e.isObject(r.overrides[n]),a=!o&&e.isObject(r.parentSmartGroup),s="desktop"!==n&&!a;if(o){var u=r.synced?e.omit(r.overrides[n],i.get(r.type)):r.overrides[n];e.extend(r,u)}else s&&t.warn("PlayerVariantUtil::reconcileComponentForVariant provided with component missing overrides definition",{variantName:n,componentType:r.type,componentId:r.id});return r}}}),define("modules/page/utils/TextSpanUtil",["log","lodash","jquery"],function(e,t,n){"use strict";var i=function(e,t,i){var r=[],o=0;if(i&&i.length>0){for(var a=0;a<i.length;a++){var s=i[a];s.index>o&&r.push({underline:t.underline,letterSpacing:t.letterSpacing,index:o,length:s.index-o}),o=s.index+s.length,r.push(n.extend(!0,{underline:t.underline,letterSpacing:t.letterSpacing},s))}return o<e.length&&r.push({underline:t.underline,letterSpacing:t.letterSpacing,index:o,length:e.length-o}),r}return[{underline:t.underline,letterSpacing:t.letterSpacing,index:0,length:e.length}]},r=function(e,t){for(var n=0;n<t.length;n++)if(e>=t[n].index&&e<t[n].index+t[n].length)return n;return-1};return{padTextSpans:i,findTextSpanForCharIndex:function(e,t){var n=r(e,t);return-1!=n?t[n]:void 0},findTextSpansForLine:function(e,i,o){var a=[],s=r(e,o),u=r(e+i-1,o);if(-1!==s&&-1!==u){a=n.extend(!0,[],o.slice(s,u+1));var l=t.first(a),c=t.last(a);e>l.index&&(l.length-=e-l.index,l.index=e),e+i<c.index+c.length&&(c.length=e+i-c.index)}return a}}}),function(e,t){"use strict";"undefined"!=typeof exports?t(exports,require("../underscore/underscore")._):"function"==typeof define&&define.amd?define("libs/typesetter/GlyphMetrics",["exports","lodash"],t):t(e,e._)}(this,function(e,t){"use strict";return e.GlyphMetrics={EMPTY_METRICS:"[]",encode:function(e){if(t.isEmpty(e.glyphMetrics))return this.EMPTY_METRICS;var n="",i=null;return t.each(e.glyphMetrics,function(e){var t=parseFloat(e.x.toFixed(2)),r=parseFloat(e.y.toFixed(2));n+=t+",",r!=i&&(n+=r),n+=",",i=r}),","==n.charAt(n.length-1)&&(n=n.substr(0,n.length-1)),"["+n+"]"},decode:function(e,n){var i,r,o,a=JSON.parse(e.replace(/,,/g,",null,").replace(/,]/,",null]")),s=[],u=null,l=a.length/2;for(i=0;i<l;i++){var c=a[2*i],d=a[2*i+1];o={x:c,y:null===d?u:d,ch:n[i]},t.isNumber(d)&&(o.sol=!0),(t.isNumber(a[2*(i+1)+1])||i===l-1)&&(o.eol=!0),s.push(o),null!==d&&(u=d)}var h,f=[];for(i=0;i<s.length;i++)o=s[i],o.sol&&(h=[]),h.push(o),o.eol&&f.push(h);for(i=0;i<f.length;i++){for(r=f[i].length-1;r>0&&(" "===f[i][r].ch||"\n"===f[i][r].ch);)delete f[i][r].eol,r--;f[i][r].eol=!0}return{totalCharacters:s.length,totalLines:f.length,lines:f}}},e.GlyphMetrics}),define("libs/font/FontUtil",["lodash","jquery","libs/font/FontConstants"],function(e,t,n){"use strict";return{loadMetrics:function(e){return t.ajax({url:"/rest/v1/font/font-metrics",dataType:"json",data:{variantGuids:e}})},buildGoogleVariantDisplayName:function(e,t){var n={100:"Thin",200:"Extra-Light",300:"Light",400:"Normal",500:"Medium",600:"Semi-Bold",700:"Bold",800:"Extra-Bold",900:"Ultra-Bold"}[e];return"normal"!==t&&(n+=" "+t),n},parseGoogleVariantName:function(e){var t,n;if("regular"===(e=e.toLowerCase()))t=400,n="normal";else if("italic"===e)t=400,n="italic";else if("oblique"===e)t=400,n="oblique";else{var i=/(\d+)(italic|regular|oblique)?/i,r=e.match(i);if(!r||3!==r.length)throw"Could not parse google variant: "+e;t=parseInt(r[1],10),n=r[2]&&"regular"!==r[2]?r[2]:"normal"}return{fontWeight:t,fontStyle:n,variantName:this.buildGoogleVariantDisplayName(t,n)}},buildGoogleVariantName:function(e,t){var n=null;return 400===e?n="italic"===t?"italic":"oblique"===t?"oblique":"regular":(n=""+e,"italic"===t?n+="Italic":"oblique"===t&&(n+="Oblique")),n},getFontAPI:function(t){return e.startsWith(t,n.GOOGLE_API_ID)?n.GOOGLE_API_ID:e.startsWith(t,n.UPLOADED_API_ID)?n.UPLOADED_API_ID:e.startsWith(t,n.BUILTIN_API_ID)?n.BUILTIN_API_ID:void 0}}}),define("modules/page/models/media-loaders/ComponentFontLoader",["lodash","backbone","log","shared/utils/CerosResourceLoader","modules/page/utils/TextUtil","libs/font/FontVariant","libs/font/FontFamily","libs/font/FontUtil"],function(e,t,n,i,r,o,a,s){"use strict";var u=function(t){if(this.variants=[],t.defaultSpan){var n=this.getVariant(t.defaultSpan);this.variants.push(n)}e.each(t.textSpans,e.bind(function(n){var i=e.extend({},t.defaultSpan,n),r=this.getVariant(i);this.variants.push(r)},this)),this.variants=e.uniq(this.variants),this.resources=null};return e.extend(u.prototype,t.Events,{getVariant:function(e){return r.resolveFont(e.variantGuid)},getAllVariants:function(){return this.variants},load:function(){null===this.resources&&(this.resources={},e.each(this.variants,e.bind(function(t){if(t.isBuiltIn())this.trigger("variant-loaded",t);else if(t.isUploaded()){var n=i.addCustomWebFont(t.getCssFamilyName(),t.cssUrl,void 0);n.getPromise().done(e.bind(function(){this.trigger("variant-loaded",t)},this)),n.getPromise().fail(e.bind(function(){this.trigger("variant-failed",t)},this)),this.resources[t.guid]=n}else{var r=t.getFontFamily().getFamilyName()+":"+s.buildGoogleVariantName(t.getFontWeight(),t.getFontStyle()),o=i.addGoogleWebFont(r);o.getPromise().done(e.bind(function(){this.trigger("variant-loaded",t)},this)),o.getPromise().fail(e.bind(function(){this.trigger("variant-failed",t)},this)),this.resources[t.guid]=o}},this)))},loadNow:function(){this.load(),e.each(this.resources,function(e){e.loadNow()})},onVariantLoaded:function(t,n){e.each(this.getAllLoadedVariants(),function(e){t.call(n,e)}),this.on("variant-loaded",t,n)},onLoadFail:function(e,t){this.hasFailedVariant()&&e.call(t),this.on("variant-failed",e,t)},getAllLoadedVariants:function(){return null===this.resources?(n.warn("Variants were never loaded"),[]):e.filter(this.variants,e.bind(function(t){return!!t.isBuiltIn()||e.has(this.resources,t.guid)&&"resolved"===this.resources[t.guid].getPromise().state()},this))},hasFailedVariant:function(){return null===this.resources?(n.warn("Variants were never loaded"),!1):e.some(this.variants,e.bind(function(t){return!t.isBuiltIn()&&(e.has(this.resources,t.guid)&&"rejected"===this.resources[t.guid].getPromise().state())},this))}}),u}),define("libs/utils/LetterSpacingUtils",[],function(){"use strict";var e={MIN_LETTER_SPACING_VALUE:-9999,MAX_LETTER_SPACING_VALUE:99999,unitsToEms:function(e){return e/1e3},unitsToCss:function(t){return e.unitsToEms(t)+"em"},unitsToPixels:function(t,n){return e.unitsToEms(t)*n}};return e}),define("modules/page/constants/TextModeConstants",[],function(){"use strict";return{PARAGRAPH:"paragraph",LINE:"line",DEFAULT:""}}),define("modules/page/views/components/TextComponentView",["log","jquery","lodash","backbone","device","globals","modules/page/views/components/AbstractComponentView","modules/page/utils/PlayerVariantUtil","modules/page/utils/TextUtil","modules/page/utils/TextSpanUtil","libs/typesetter/GlyphMetrics","shared/utils/CerosResourceLoader","libs/font/FontVariant","libs/font/FontFamily","libs/font/FontUtil","modules/page/models/media-loaders/ComponentFontLoader","libs/utils/LetterSpacingUtils","modules/page/constants/TextModeConstants"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f,p,g,m,v){"use strict";var y={},b={},w=function(e,t){return e.getCssFamilyName()+":"+t},_=function(e,i){var r=w(e,i);if(n.has(b,r))return b[r].promise();var o=new t.Deferred;return b[r]=o,u.measureFontBaselineOffset(e,i,i).then(o.resolve,o.reject),o.then(function(e){y[r]=e})};return a.extend({type:"text",textSpans:null,textContent:null,textUpdatedViaSdk:!1,initialize:function(){a.prototype.initialize.call(this),this.fontLoader=this.options.fontLoader,this.defaultVariant=this._getVariant(this.options.defaultSpan),this.forceMode=this.options.forceMode||v.DEFAULT,this.isRerendering=!1,this.tooSmallToRender=!1},render:function(){return this.options.width<=1||this.options.height<=1?void(this.tooSmallToRender=!0):(this.tooSmallToRender=!1,a.prototype.render.call(this),r.webkit&&this.$el.css("-webkit-filter","blur(0px)"),this._applyDimensions(this.options.width,this.options.height),this.setDefaultTextStyle(),this.prepareTextContentAndSpans(),this.allFontsReady=new t.Deferred,this.variantsMeasured=0,this.fontLoader.onVariantLoaded(this.measureBaselineOffsetAndRenderText,this),this.fontLoader.onLoadFail(this.allFontsReady.reject,this.allFontsReady),this)},prepareTextContentAndSpans:function(){this.textContent=this._applyTextTransform(this.options.textContent),this.textSpans=l.padTextSpans(this.textContent,this.options.defaultSpan,this.options.textSpans)},setTextFromSDK:function(e){e=e||"",this.textUpdatedViaSdk=!0,this.options.textContent=e;var t,n;this.textSpans&&this.textSpans.length>0&&(this.textSpans[0].fontColor&&(t=this.textSpans[0].fontColor),this.textSpans[0].variantGuid&&(n=this.textSpans[0].variantGuid)),this.options.textSpans=[],this.prepareTextContentAndSpans(),this.textSpans&&this.textSpans.length>0&&(t&&(this.textSpans[0].fontColor=t),n&&(this.textSpans[0].variantGuid=n)),"resolved"===this.allFontsReady.state()&&this._layoutContent(),this.$el.css("columns","unset")},measureBaselineOffsetAndRenderText:function(e){_(e,this.options.defaultSpan.fontSize).then(n.bind(function(){++this.variantsMeasured===this.fontLoader.getAllVariants().length&&this.allFontsReady.resolve()},this))},_getPadding:function(){return{left:n.isNumber(this.options.paddingLeft)?this.options.paddingLeft:0,right:n.isNumber(this.options.paddingRight)?this.options.paddingRight:0,top:n.isNumber(this.options.paddingTop)?this.options.paddingTop:0,bottom:n.isNumber(this.options.paddingBottom)?this.options.paddingBottom:0}},_getColumnWidth:function(){var e=this._getPadding();return(this.options.width-e.left-e.right-(this.options.columns-1)*this.options.columnGap)/this.options.columns},_getVariant:function(e){return u.resolveFont(e.variantGuid)},_getDefaultBaselineOffset:function(){var e=0,t=this._getVariant(this.options.defaultSpan),i=w(t,this.options.defaultSpan.fontSize);return t&&n.has(y,i)&&(e=y[i]),e},_layoutContent:function(){var t=this._getDefaultBaselineOffset();this.defaultVariant=this._getVariant(this.options.defaultSpan);var i=this.options.glyphMetrics===c.EMPTY_METRICS&&""!==this.textContent;if(!n.isString(this.options.glyphMetrics)||i)return o.previewMode||this.textUpdatedViaSdk||e.warn("no glyph metrics! using paragraph layout..."),void this._layoutParagraphs(null,t);this.$el.css("lineHeight",this.options.defaultSpan.fontSize+"px"),!0===this.options.showOverflow?this.$el.css("overflow","visible"):this.$el.css("overflow","hidden"),this.$el.empty();var r=c.decode(this.options.glyphMetrics,this.textContent);(this.hasAccessibilityFeature||this.textUpdatedViaSdk&&!this._useParagraphLayout(r))&&(t-=(this.options.leading-this.options.defaultSpan.fontSize)/2),this.textUpdatedViaSdk||this._useParagraphLayout(r)||this.isForcedParagraphMode()?this._layoutParagraphs(r,t):this._useCharacterLayout(r)?this._layoutGlyphs(r,t):this._layoutLines(r,t)},_useParagraphLayout:function(e){return e.totalLines>=250},isForcedLineMode:function(){return this.forceMode===v.LINE},isForcedParagraphMode:function(){return this.forceMode===v.PARAGRAPH},isHiddenFromScreenReaders:function(){return this.options.hiddenFromScreenReaders&&this.hasAccessibilityFeature},_useCharacterLayout:function(e){return this.forceMode===v.DEFAULT&&e.totalCharacters<=250},_applyTextTransform:function(e){switch(this.options.textTransform){case"uppercase":return e.toUpperCase();case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}return e},_applyStyle:function(e,t){var i={},r=n.extend({},this.options.defaultSpan,t),o=this._getVariant(r);if(t.fontColor&&(i.color=t.fontColor),o.getFontWeight()!==this.defaultVariant.getFontWeight()&&(i["font-weight"]=o.getFontWeight()),o.getFontStyle()!==this.defaultVariant.getFontStyle()&&(i["font-style"]=o.getFontStyle()),o.getCssFamilyName()!==this.defaultVariant.getCssFamilyName()&&(i["font-family"]=o.getCssFamilyName()),t.underline&&(i["text-decoration"]="underline"),t.letterSpacing&&(i["letter-spacing"]=m.unitsToCss(t.letterSpacing)),n.isEmpty(i)&&this.hasAccessibilityFeature&&!this.textUpdatedViaSdk)return e.content;i=n.extend(i,n.pick(e,["position","top","left"]));var a="<span";return n.isEmpty(i)||(a+=' style="',n.each(i,function(e,t){a+=t+":"+e+";"}),a+='"'),a+=">"+e.content+"</span>"},_getNumSpaces:function(e){return n.reduce(e,function(e,t){return e+(" "===t.ch||"\n"===t.ch?1:0)},0)},_layoutGlyphsChars:function(e,t,i,r){for(var o=[],a=0;a<e.length;a++){var s=t+a,u=e[a];if("\n"!==u.ch&&!n.isUndefined(u.ch)){var c=l.findTextSpanForCharIndex(s,this.textSpans),d=" "===u.ch?"&nbsp;":u.ch,h=s===c.index+c.length-1,f=a<e.length-1&&n.isUndefined(e[a+1].ch);!c.underline||h||u.eol||f||(d+="&nbsp"),o.push(this._applyStyle({content:d,top:u.y+i+r.top+"px",left:u.x+r.left+"px"},c))}}return o},_layoutGlyphs:function(e,t){for(var i=this._getPadding(),r=0,o=[],a=0;a<e.lines.length;a++){var s=e.lines[a],u=r;if(r+=s.length,0!==s.length&&(1!==s.length||!n.isUndefined(s[0].ch))){this._getNumSpaces(s)!=s.length&&(o=o.concat(this._layoutGlyphsChars(s,u,t,i)))}}this.$el.append(o.join(""))},_applyTextSpans:function(e,t){return n.map(e,n.bind(function(e){var n=this.textContent.substr(e.index,e.length);n=this._escapeHtmlSpecialCharacters(n);var i={content:n,position:"relative"};return t&&(i.left=t),this._applyStyle(i,e)},this)).join("")},_escapeHtmlSpecialCharacters:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\s/g,"&nbsp;")},_kernLongLines:function(){var e=String.fromCharCode(160),i=this._getColumnWidth();this.$("span.text-line").each(n.bind(function(r,o){o=t(o);var a=o.width();if(a>i){var s=a-i,u=t(o).find("span"),c=n.reduce(u,function(e,n){return e+t(n).text()},""),d=c.trim().split(e),h=s/(d.length-1),f=-1*Math.ceil(s),p=parseInt(t(o).attr("index"),10);o.empty();for(var g,m=c.lastIndexOf(e);m>0;){g=c.lastIndexOf(e,m-1);var v=l.findTextSpansForLine(p+g+1,m-g,this.textSpans),y=g<0?"0px":f+"px",b=this._applyTextSpans(v,y);o.prepend(b),f+=h,m=g}}},this))},_layoutLines:function(e,t){var i=this._getPadding();this.chIndex=0;for(var r=['<div style="width:110%;position:relative">'],o=0;o<e.lines.length;o++){var a=e.lines[o];if(0!==a.length){for(var s="",u=!1,c=this.chIndex,d=0,h=0;h<a.length;h++)n.isUndefined(a[h].ch)||(s+=a[h].ch,u="\n"===a[h].ch,d++);if(s.trim().length>0){var f=l.findTextSpansForLine(c,d,this.textSpans),p=this._applyTextSpans(f),g=a[0].y+t+i.top+"px",m=a[0].x+i.left+"px";r.push('<span class="text-line" index="'+c+'" style="top:'+g+";left:"+m+'">'+p+"</span>")}u&&r.push("<br/>"),this.chIndex+=d}}r.push("</div>"),this.$el.append(r.join("")),this._onReflow(this.$("span:first"),n.bind(function(){this._kernLongLines()},this))},_layoutParagraphs:function(e,i){var r=this.hasAccessibilityFeature&&!this.textUpdatedViaSdk;this.options.textTransform&&this.$el.css("textTransform",this.options.textTransform),this.$el.empty();var o={position:"relative",content:""},a=this.$el;if(r){var s=this.options.htmlTag||"p";a=t("<"+s+' style="position:relative;top:'+i+'px;"/>'),this.$el.append(a),this.$el.css("whiteSpace","pre-wrap")}else o.top=i+"px";if(n.each(this.textSpans,n.bind(function(e){var t=this.textContent.substr(e.index,e.length);if(r)o.content=n.escape(t),a.append(this._applyStyle(o,e));else{for(var i=t.split("\n"),s=[],u=0;u<i.length;u++)o.content=n.escape(i[u]),s.push(this._applyStyle(o,e));a.append(s.join("<br />"))}},this)),this.options.justify&&this.options.justify.match(/(left|right|center|justify)/)&&this.$el.css("textAlign",this.options.justify),this.options.columns){var u=r?this.$el.find("> *"):this.$el;u.css("columnCount",this.options.columns),u.css("columnWidth","auto"),r||u.css("columnFill","auto"),this.options.columnGap?u.css("columnGap",this.options.columnGap+"px"):u.css("columnGap","0px")}this.$el.css("lineHeight",this.options.leading+"px"),this.$el.css("padding",0),n.each(["Top","Right","Bottom","Left"],n.bind(function(e){this.options["padding"+e]&&(this.$el.css("padding"+e,parseInt(this.options["padding"+e],10)+"px"),"Top"!=e&&"Bottom"!=e||(this.options.height-=parseInt(this.options["padding"+e],10)),"Left"!=e&&"Right"!=e||(this.options.width-=parseInt(this.options["padding"+e],10)))},this)),this._applyDimensions(this.options.width,this.options.height)},_onReflow:function(e,t){if(!n.isEmpty(e)){var i=function(){e.width()>0?t():setTimeout(i,1)};setTimeout(i,1)}},applyChanges:function(e){var t=n.cloneDeep(e);s.reconcileComponentForCurrentVariant(t),this.fontLoader=new g(t),this.fontLoader.load(),a.prototype.applyChanges.call(this,e)},applyAccessibilityFeatures:function(){a.prototype.applyAccessibilityFeatures.call(this),this.setScreenReaderVisibilityStatus()},attachMedia:function(){return this.tooSmallToRender?t.Deferred().resolve():(this.fontLoader.loadNow(),this.allFontsReady.always(n.bind(this._applyDefaultFont,this)),this.allFontsReady.always(n.bind(this._layoutContent,this)),this.allFontsReady.promise())},_applyDefaultFont:function(){var e=this._getVariant(this.options.defaultSpan).getCssFamilyName(),t=u.formatFamilyNameForCSS(e);this.$el.css("fontFamily",t)},setDefaultTextStyle:function(){var e=this.options.defaultSpan,t=this._getVariant(e);this.$el.css("fontSize",e.fontSize+"px"),this.$el.css("textTransform","none"),this.$el.css("color",e.fontColor),this.$el.css("fontWeight",t.getFontWeight()),this.$el.css("fontStyle",t.getFontStyle())},setScreenReaderVisibilityStatus:function(){if(!this.isHiddenFromScreenReaders())return void this.$el.removeAttr("aria-hidden");this.$el.attr("aria-hidden","true")},scaleComponent:function(){this.rerenderByTogglingVisibility()},rerenderByTogglingVisibility:n.debounce(function(){if(!this.isRerendering){this.isRerendering=!0;var e=this.$el.css("display");this.$el.css("display","none"),n.delay(n.bind(function(){this.$el.css("display",e),this.isRerendering=!1},this),1)}},100)})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("hlsjs",[],t):"object"==typeof exports?exports.Hls=t():e.Hls=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=27)}([function(e,t,n){"use strict";function i(){}function r(e,t){return t="["+e+"] > "+t}function o(e){var t=self.console[e];return t?function(){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];i[0]&&(i[0]=r(e,i[0])),t.apply(self.console,i)}:i}function a(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.forEach(function(t){l[t]=e[t]?e[t].bind(e):o(t)})}n.d(t,"a",function(){return c}),n.d(t,"b",function(){return d});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u={trace:i,debug:i,log:i,warn:i,info:i,error:i},l=u,c=function(e){if(!0===e||"object"===(void 0===e?"undefined":s(e))){a(e,"debug","log","info","warn","error");try{l.log()}catch(e){l=u}}else l=u},d=l},function(e,t,n){"use strict";var i={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"};t.a=i},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r});var i={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},r={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",
KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(0),o=n(2),a=n(1),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=new Set(["hlsEventGeneric","hlsHandlerDestroying","hlsHandlerDestroyed"]),l=function(){function e(t){i(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}return e.prototype.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},e.prototype.onHandlerDestroying=function(){},e.prototype.onHandlerDestroyed=function(){},e.prototype.isEventHandler=function(){return"object"===s(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent},e.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if(u.has(e))throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)},e.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},e.prototype.onEvent=function(e,t){this.onEventGeneric(e,t)},e.prototype.onEventGeneric=function(e,t){var n=function(e,t){var n="on"+e.replace("hls","");if("function"!=typeof this[n])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+n+")");return this[n].bind(this,t)};try{n.call(this,e,t).call()}catch(t){r.b.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(a.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();t.a=l},function(e,t,n){!function(t){var n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/;?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,a={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=a.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=a.normalizePath(r.path),a.buildURLFromParts(r)}var o=a.parseURL(t);if(!o)throw new Error("Error trying to parse relative URL.");if(o.scheme)return n.alwaysNormalize?(o.path=a.normalizePath(o.path),a.buildURLFromParts(o)):t;var s=a.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var u=i.exec(s.path);s.netLoc=u[1],s.path=u[2]}s.netLoc&&!s.path&&(s.path="/");var l={scheme:s.scheme,netLoc:o.netLoc,path:null,params:o.params,query:o.query,fragment:o.fragment};if(!o.netLoc&&(l.netLoc=s.netLoc,"/"!==o.path[0]))if(o.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+o.path;l.path=a.normalizePath(d)}else l.path=s.path,o.params||(l.params=s.params,o.query||(l.query=s.query));return null===l.path&&(l.path=n.alwaysNormalize?a.normalizePath(o.path):o.path),a.buildURLFromParts(l)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(r,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=a}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"b",function(){return o});var r=function(){function e(){i(this,e)}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,n){for(var i=n,r=0;e.isHeader(t,n);)r+=10,r+=e._readSize(t,n+6),e.isFooter(t,n+10)&&(r+=10),n+=r;if(r>0)return t.subarray(i,i+r)},e._readSize=function(e,t){var n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3]},e.getTimeStamp=function(t){for(var n=e.getID3Frames(t),i=0;i<n.length;i++){var r=n[i];if(e.isTimeStampFrame(r))return e._readTimeStamp(r)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var n=String.fromCharCode(t[0],t[1],t[2],t[3]),i=e._readSize(t,4);return{type:n,size:i,data:t.subarray(10,10+i)}},e.getID3Frames=function(t){for(var n=0,i=[];e.isHeader(t,n);){var r=e._readSize(t,n+6);n+=10;for(var o=n+r;n+8<o;){var a=e._getFrameData(t.subarray(n)),s=e._decodeFrame(a);s&&i.push(s),n+=a.size+10}e.isFooter(t,n)&&(n+=10)}return i},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),n=1&t[3],i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var n=e._utf8ArrayToStr(t.data,!0),i=new Uint8Array(t.data.subarray(n.length+1));return{key:t.type,info:n,data:i.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var n=1,i=e._utf8ArrayToStr(t.data.subarray(n));n+=i.length+1;var r=e._utf8ArrayToStr(t.data.subarray(n));return{key:t.type,info:i,data:r}}var o=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:o}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var n=1,i=e._utf8ArrayToStr(t.data.subarray(n));n+=i.length+1;var r=e._utf8ArrayToStr(t.data.subarray(n));return{key:t.type,info:i,data:r}}var o=e._utf8ArrayToStr(t.data);return{key:t.type,data:o}},e._utf8ArrayToStr=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.length,i=void 0,r=void 0,o=void 0,a="",s=0;s<n;){if(0===(i=e[s++])&&t)return a;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:r=e[s++],a+=String.fromCharCode((31&i)<<6|63&r);break;case 14:r=e[s++],o=e[s++],a+=String.fromCharCode((15&i)<<12|(63&r)<<6|(63&o)<<0)}}return a},e}(),o=r._utf8ArrayToStr;t.a=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(4),o=n.n(r),a=n(16),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(){function e(){var t;i(this,e),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[],this._elementaryStreams=(t={},t[e.ElementaryStreamTypes.AUDIO]=!1,t[e.ElementaryStreamTypes.VIDEO]=!1,t)}return e.prototype.addElementaryStream=function(e){this._elementaryStreams[e]=!0},e.prototype.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},e.prototype.createInitializationVector=function(e){for(var t=new Uint8Array(16),n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t},e.prototype.fragmentDecryptdataFromLevelkey=function(e,t){var n=e;return e&&e.method&&e.uri&&!e.iv&&(n=new a.a,n.method=e.method,n.baseuri=e.baseuri,n.reluri=e.reluri,n.iv=this.createInitializationVector(t)),n},s(e,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=o.a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var e=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var n=this.lastByteRangeEndOffset;e[0]=n||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0],this._byteRange=e}return e}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}],[{key:"ElementaryStreamTypes",get:function(){return{AUDIO:"audio",VIDEO:"video"}}}]),e}();t.a=u},function(e,t,n){"use strict";var i={search:function(e,t){for(var n=0,i=e.length-1,r=null,o=null;n<=i;){r=(n+i)/2|0,o=e[r];var a=t(o);if(a>0)n=r+1;else{if(!(a<0))return o;i=r-1}}return null}};t.a=i},function(e,t,n){"use strict";var i={isBuffered:function(e,t){try{if(e)for(var n=e.buffered,i=0;i<n.length;i++)if(t>=n.start(i)&&t<=n.end(i))return!0}catch(e){}return!1},bufferInfo:function(e,t,n){try{if(e){var i=e.buffered,r=[],o=void 0;for(o=0;o<i.length;o++)r.push({start:i.start(o),end:i.end(o)});return this.bufferedInfo(r,t,n)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},bufferedInfo:function(e,t,n){var i=[],r=void 0,o=void 0,a=void 0,s=void 0,u=void 0;for(e.sort(function(e,t){return e.start-t.start||t.end-e.end}),u=0;u<e.length;u++){var l=i.length;if(l){var c=i[l-1].end;e[u].start-c<n?e[u].end>c&&(i[l-1].end=e[u].end):i.push(e[u])}else i.push(e[u])}for(u=0,r=0,o=a=t;u<i.length;u++){var d=i[u].start,h=i[u].end;if(t+n>=d&&t<h)o=d,a=h,r=a-t;else if(t+n<d){s=d;break}}return{len:r,start:o,end:a,nextStart:s}}};t.a=i},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(33),o=n(34),a=n(35),s=n(2),u=n(0),l=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.removePKCS7Padding,a=void 0===o||o;if(i(this,e),this.logEnabled=!0,this.observer=t,this.config=n,this.removePKCS7Padding=a,a)try{var s=crypto||self.crypto;this.subtle=s.subtle||s.webkitSubtle}catch(e){}this.disableWebCrypto=!this.subtle}return e.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},e.prototype.decrypt=function(e,t,n,i){var s=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(u.b.log("JS AES decrypt"),this.logEnabled=!1);var l=this.decryptor;l||(this.decryptor=l=new a.a),l.expandKey(t),i(l.decrypt(e,0,n,this.removePKCS7Padding))}else{this.logEnabled&&(u.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var c=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new o.a(c,t)),this.fastAesKey.expandKey().then(function(o){new r.a(c,n).decrypt(e,o).catch(function(r){s.onWebCryptoError(r,e,t,n,i)}).then(function(e){i(e)})}).catch(function(r){s.onWebCryptoError(r,e,t,n,i)})}},e.prototype.onWebCryptoError=function(e,t,n,i,r){this.config.enableSoftwareAES?(u.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,n,i,r)):(u.b.error("decrypting error : "+e.message),this.observer.trigger(Event.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},e.prototype.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.a=l},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function r(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!r(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,r,s,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(n=this._events[e],a(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),l=n.slice(),r=l.length,u=0;u<r;u++)l[u].apply(this,s);return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,r,a,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){"use strict";function i(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}t.a=i},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l});var a=n(3),s=n(1),u={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},l=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,s.a.BUFFER_APPENDED,s.a.FRAG_BUFFERED,s.a.FRAG_LOADED));return o.bufferPadding=.2,o.fragments=Object.create(null),o.timeRanges=Object.create(null),o.config=n.config,o}return o(t,e),t.prototype.destroy=function(){this.fragments=null,this.timeRanges=null,this.config=null,a.a.prototype.destroy.call(this),e.prototype.destroy.call(this)},t.prototype.getBufferedFrag=function(e,t){var n=this.fragments,i=Object.keys(n).filter(function(i){var r=n[i];if(r.body.type!==t)return!1;if(!r.buffered)return!1;var o=r.body;return o.startPTS<=e&&e<=o.endPTS});if(0===i.length)return null;var r=i.pop();return n[r].body},t.prototype.detectEvictedFragments=function(e,t){var n=this,i=void 0,r=void 0;Object.keys(this.fragments).forEach(function(o){var a=n.fragments[o];if(!0===a.buffered){var s=a.range[e];if(s){i=s.time;for(var u=0;u<i.length;u++)if(r=i[u],!1===n.isTimeBuffered(r.startPTS,r.endPTS,t)){n.removeFragment(a.body);break}}}})},t.prototype.detectPartialFragments=function(e){var t=this,n=this.getFragmentKey(e),i=this.fragments[n];i&&(i.buffered=!0,Object.keys(this.timeRanges).forEach(function(n){if(!0===e.hasElementaryStream(n)){var r=t.timeRanges[n];i.range[n]=t.getBufferedTimes(e.startPTS,e.endPTS,r)}}))},t.prototype.getBufferedTimes=function(e,t,n){for(var i=[],r=void 0,o=void 0,a=!1,s=0;s<n.length;s++){if(r=n.start(s)-this.bufferPadding,o=n.end(s)+this.bufferPadding,e>=r&&t<=o){i.push({startPTS:Math.max(e,n.start(s)),endPTS:Math.min(t,n.end(s))});break}if(e<o&&t>r)i.push({startPTS:Math.max(e,n.start(s)),endPTS:Math.min(t,n.end(s))}),a=!0;else if(t<=r)break}return{time:i,partial:a}},t.prototype.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.sn},t.prototype.getPartialFragment=function(e){var t=this,n=void 0,i=void 0,r=void 0,o=null,a=0;return Object.keys(this.fragments).forEach(function(s){var u=t.fragments[s];t.isPartial(u)&&(i=u.body.startPTS-t.bufferPadding,r=u.body.endPTS+t.bufferPadding,e>=i&&e<=r&&(n=Math.min(e-i,r-e),a<=n&&(o=u.body,a=n)))}),o},t.prototype.getState=function(e){var t=this.getFragmentKey(e),n=this.fragments[t],i=u.NOT_LOADED;return void 0!==n&&(i=n.buffered?!0===this.isPartial(n)?u.PARTIAL:u.OK:u.APPENDING),i},t.prototype.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},t.prototype.isTimeBuffered=function(e,t,n){for(var i=void 0,r=void 0,o=0;o<n.length;o++){if(i=n.start(o)-this.bufferPadding,r=n.end(o)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1},t.prototype.onFragLoaded=function(e){var t=e.frag;if(!isNaN(t.sn)){var n=this.getFragmentKey(t),i={body:t,range:Object.create(null),buffered:!1};this.fragments[n]=i}},t.prototype.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(e){var n=t.timeRanges[e];t.detectEvictedFragments(e,n)})},t.prototype.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},t.prototype.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},t.prototype.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},t.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},t}(a.a)},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(3),s=function(e){function t(n){i(this,t);for(var o=arguments.length,a=Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];var u=r(this,e.call.apply(e,[this,n].concat(a)));return u._tickInterval=null,u._tickCallCount=0,u}return o(t,e),t.prototype.destroy=function(){this.clearInterval(),e.prototype.destroy.call(this)},t.prototype.hasInterval=function(){return null!==this._tickInterval},t.prototype.setInterval=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return!this._tickInterval&&(this._tickInterval=setInterval(this.tick.bind(this,!1),e),!0)}),t.prototype.clearInterval=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),this._tickInterval=null,!0)}),t.prototype.tick=function(){1==++this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&setTimeout(this.tick.bind(this),0),this._tickCallCount=0)},t.prototype.doTick=function(){throw new Error("TaskLoop is abstract and `doLoop` must be implemented")},t}(a.a);t.a=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=n(3),u=n(2),l=n(0),c=n(15),d=n(28),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},p={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},g=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,a.a.MANIFEST_LOADING,a.a.LEVEL_LOADING,a.a.AUDIO_TRACK_LOADING,a.a.SUBTITLE_TRACK_LOADING));return o.loaders={},o}return o(t,e),t.canHaveQualityLevels=function(e){return e!==f.AUDIO_TRACK&&e!==f.SUBTITLE_TRACK},t.mapContextToLevelType=function(e){switch(e.type){case f.AUDIO_TRACK:return p.AUDIO;case f.SUBTITLE_TRACK:return p.SUBTITLE;default:return p.MAIN}},t.getResponseUrl=function(e,t){var n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n},t.prototype.createInternalLoader=function(e){var t=this.hls.config,n=t.pLoader,i=t.loader,r=n||i,o=new r(t);return e.loader=o,this.loaders[e.type]=o,o},t.prototype.getInternalLoader=function(e){return this.loaders[e.type]},t.prototype.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},t.prototype.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},t.prototype.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},t.prototype.onManifestLoading=function(e){this.load(e.url,{type:f.MANIFEST})},t.prototype.onLevelLoading=function(e){this.load(e.url,{type:f.LEVEL,level:e.level,id:e.id})},t.prototype.onAudioTrackLoading=function(e){this.load(e.url,{type:f.AUDIO_TRACK,id:e.id})},t.prototype.onSubtitleTrackLoading=function(e){this.load(e.url,{type:f.SUBTITLE_TRACK,id:e.id})},t.prototype.load=function(e,t){var n=this.hls.config,i=this.getInternalLoader(t);if(i){var r=i.context;if(r&&r.url===e)return l.b.trace("playlist request ongoing"),!1;l.b.warn("aborting previous loader for type: "+t.type),i.abort()}var o=void 0,a=void 0,s=void 0,u=void 0;switch(t.type){case f.MANIFEST:o=n.manifestLoadingMaxRetry,a=n.manifestLoadingTimeOut,s=n.manifestLoadingRetryDelay,u=n.manifestLoadingMaxRetryTimeout;break;case f.LEVEL:o=0,a=n.levelLoadingTimeOut;break;default:o=n.levelLoadingMaxRetry,a=n.levelLoadingTimeOut,s=n.levelLoadingRetryDelay,u=n.levelLoadingMaxRetryTimeout,l.b.log("Playlist loader for "+t.type+" "+(t.level||t.id))}i=this.createInternalLoader(t),t.url=e,t.responseType=t.responseType||"";var c=void 0,d=void 0;return c={timeout:a,maxRetry:o,retryDelay:s,maxRetryDelay:u},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},i.load(t,c,d),!0},t.prototype.loadsuccess=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(n.isSidxRequest)return this._handleSidxRequest(e,n),void this._handlePlaylistLoaded(e,t,n,i);this.resetInternalLoader(n.type);var r=e.data;if(t.tload=performance.now(),0!==r.indexOf("#EXTM3U"))return void this._handleManifestParsingError(e,n,"no EXTM3U delimiter",i);r.indexOf("#EXTINF:")>0||r.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,n,i):this._handleMasterPlaylist(e,t,n,i)},t.prototype.loaderror=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._handleNetworkError(t,n)},t.prototype.loadtimeout=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._handleNetworkError(t,n,!0)},t.prototype._handleMasterPlaylist=function(e,n,i,r){var o=this.hls,s=e.data,u=t.getResponseUrl(e,i),c=d.a.parseMasterPlaylist(s,u);if(!c.length)return void this._handleManifestParsingError(e,i,"no level found in manifest",r);var h=c.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),f=d.a.parseMasterPlaylistMedia(s,u,"AUDIO",h),p=d.a.parseMasterPlaylistMedia(s,u,"SUBTITLES");if(f.length){var g=!1;f.forEach(function(e){e.url||(g=!0)}),!1===g&&c[0].audioCodec&&!c[0].attrs.AUDIO&&(l.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),f.unshift({type:"main",name:"main"}))}o.trigger(a.a.MANIFEST_LOADED,{levels:c,audioTracks:f,subtitles:p,url:u,stats:n,networkDetails:r})},t.prototype._handleTrackOrLevelPlaylist=function(e,n,i,r){var o=this.hls,s=i.id,u=i.level,l=i.type,c=t.getResponseUrl(e,i),h=isNaN(u)?isNaN(s)?0:s:u,p=t.mapContextToLevelType(i),g=d.a.parseLevelPlaylist(e.data,c,h,p);if(g.tload=n.tload,l===f.MANIFEST){var m={url:c,details:g};o.trigger(a.a.MANIFEST_LOADED,{levels:[m],audioTracks:[],url:c,stats:n,networkDetails:r})}if(n.tparsed=performance.now(),g.needSidxRanges){var v=g.initSegment.url;return void this.load(v,{isSidxRequest:!0,type:l,level:u,levelDetails:g,id:s,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}i.levelDetails=g,this._handlePlaylistLoaded(e,n,i,r)},t.prototype._handleSidxRequest=function(e,t){var n=c.a.parseSegmentIndex(new Uint8Array(e.data));n.references.forEach(function(e,n){var i=e.info,r=t.levelDetails.fragments[n];0===r.byteRange.length&&(r.rawByteRange=String(1+i.end-i.start)+"@"+String(i.start))}),t.levelDetails.initSegment.rawByteRange=String(n.moovEndOffset)+"@0"},t.prototype._handleManifestParsingError=function(e,t,n,i){this.hls.trigger(a.a.ERROR,{type:u.b.NETWORK_ERROR,details:u.a.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:n,networkDetails:i})},t.prototype._handleNetworkError=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=void 0,r=void 0,o=this.getInternalLoader(e);switch(e.type){case f.MANIFEST:i=n?u.a.MANIFEST_LOAD_TIMEOUT:u.a.MANIFEST_LOAD_ERROR,r=!0;break;case f.LEVEL:i=n?u.a.LEVEL_LOAD_TIMEOUT:u.a.LEVEL_LOAD_ERROR,r=!1;break;case f.AUDIO_TRACK:i=n?u.a.AUDIO_TRACK_LOAD_TIMEOUT:u.a.AUDIO_TRACK_LOAD_ERROR,r=!1;break;default:r=!1}o&&(o.abort(),this.resetInternalLoader(e.type)),this.hls.trigger(a.a.ERROR,{type:u.b.NETWORK_ERROR,details:i,fatal:r,url:o.url,loader:o,context:e,networkDetails:t})},t.prototype._handlePlaylistLoaded=function(e,n,i,r){var o=i.type,s=i.level,u=i.id,l=i.levelDetails;if(!l.targetduration)return void this._handleManifestParsingError(e,i,"invalid target duration",r);if(t.canHaveQualityLevels(i.type))this.hls.trigger(a.a.LEVEL_LOADED,{details:l,level:s||0,id:u||0,stats:n,networkDetails:r});else switch(o){case f.AUDIO_TRACK:this.hls.trigger(a.a.AUDIO_TRACK_LOADED,{details:l,id:u,stats:n,networkDetails:r});break;case f.SUBTITLE_TRACK:this.hls.trigger(a.a.SUBTITLE_TRACK_LOADED,{details:l,id:u,stats:n,networkDetails:r})}},h(t,null,[{key:"ContextType",get:function(){return f}},{key:"LevelType",get:function(){return p}}]),t}(s.a);t.a=g},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(0),o=n(1),a=Math.pow(2,32)-1,s=function(){function e(t,n){i(this,e),this.observer=t,this.remuxer=n}return e.prototype.resetTimeStamp=function(e){this.initPTS=e},e.prototype.resetInitSegment=function(t,n,i,r){if(t&&t.byteLength){var a=this.initData=e.parseInitSegment(t);null==n&&(n="mp4a.40.5"),null==i&&(i="avc1.42e01e");var s={};a.audio&&a.video?s.audiovideo={container:"video/mp4",codec:n+","+i,initSegment:r?t:null}:(a.audio&&(s.audio={container:"audio/mp4",codec:n,initSegment:r?t:null}),a.video&&(s.video={container:"video/mp4",codec:i,initSegment:r?t:null})),this.observer.trigger(o.a.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else n&&(this.audioCodec=n),i&&(this.videoCodec=i)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var n=e[t]<<8|e[t+1];return n<0?65536+n:n},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var n=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return n<0?4294967296+n:n},e.writeUint32=function(e,t,n){e.data&&(t+=e.start,e=e.data),e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n},e.findBox=function(t,n){var i=[],r=void 0,o=void 0,a=void 0,s=void 0,u=void 0,l=void 0,c=void 0;if(t.data?(l=t.start,s=t.end,t=t.data):(l=0,s=t.byteLength),!n.length)return null;for(r=l;r<s;)o=e.readUint32(t,r),a=e.bin2str(t.subarray(r+4,r+8)),c=o>1?r+o:s,a===n[0]&&(1===n.length?i.push({data:t,start:r+8,end:c}):(u=e.findBox({data:t,start:r+8,end:c},n.slice(1)),u.length&&(i=i.concat(u)))),r=c;return i},e.parseSegmentIndex=function(t){var n=e.findBox(t,["moov"])[0],i=n?n.end:null,r=0,o=e.findBox(t,["sidx"]),a=void 0;if(!o||!o[0])return null;a=[],o=o[0];var s=o.data[0];r=0===s?8:16;var u=e.readUint32(o,r);r+=4,r+=0===s?8:16,r+=2;var l=o.end+0,c=e.readUint16(o,r);r+=2;for(var d=0;d<c;d++){var h=r,f=e.readUint32(o,h);h+=4;var p=2147483647&f;if(1==(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var g=e.readUint32(o,h);h+=4,a.push({referenceSize:p,subsegmentDuration:g,info:{duration:g/u,start:l,end:l+p-1}}),l+=p,h+=4,r=h}return{earliestPresentationTime:0,timescale:u,version:s,referencesCount:c,references:a,moovEndOffset:i}},e.parseInitSegment=function(t){var n=[];return e.findBox(t,["moov","trak"]).forEach(function(t){var i=e.findBox(t,["tkhd"])[0];if(i){var o=i.data[i.start],a=0===o?12:20,s=e.readUint32(i,a),u=e.findBox(t,["mdia","mdhd"])[0];if(u){
o=u.data[u.start],a=0===o?12:20;var l=e.readUint32(u,a),c=e.findBox(t,["mdia","hdlr"])[0];if(c){var d=e.bin2str(c.data.subarray(c.start+8,c.start+12)),h={soun:"audio",vide:"video"}[d];if(h){var f=e.findBox(t,["mdia","minf","stbl","stsd"]);if(f.length){f=f[0];var p=e.bin2str(f.data.subarray(f.start+12,f.start+16));r.b.log("MP4Demuxer:"+h+":"+p+" found")}n[s]={timescale:l,type:h},n[h]={timescale:l,id:s}}}}}}),n},e.getStartDTS=function(t,n){var i=void 0,r=void 0,o=void 0;return i=e.findBox(n,["moof","traf"]),r=[].concat.apply([],i.map(function(n){return e.findBox(n,["tfhd"]).map(function(i){var r=void 0,o=void 0;return r=e.readUint32(i,4),o=t[r].timescale||9e4,e.findBox(n,["tfdt"]).map(function(t){var n=void 0,i=void 0;return n=t.data[t.start],i=e.readUint32(t,4),1===n&&(i*=Math.pow(2,32),i+=e.readUint32(t,8)),i})[0]/o})})),o=Math.min.apply(null,r),isFinite(o)?o:0},e.offsetStartDTS=function(t,n,i){e.findBox(n,["moof","traf"]).map(function(n){return e.findBox(n,["tfhd"]).map(function(r){var o=e.readUint32(r,4),s=t[o].timescale||9e4;e.findBox(n,["tfdt"]).map(function(t){var n=t.data[t.start],r=e.readUint32(t,4);if(0===n)e.writeUint32(t,4,r-i*s);else{r*=Math.pow(2,32),r+=e.readUint32(t,8),r-=i*s,r=Math.max(r,0);var o=Math.floor(r/(a+1)),u=Math.floor(r%(a+1));e.writeUint32(t,4,o),e.writeUint32(t,8,u)}})})})},e.prototype.append=function(t,n,i,r){var a=this.initData;a||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),a=this.initData);var s=void 0,u=this.initPTS;if(void 0===u){var l=e.getStartDTS(a,t);this.initPTS=u=l-n,this.observer.trigger(o.a.INIT_PTS_FOUND,{initPTS:u})}e.offsetStartDTS(a,t,u),s=e.getStartDTS(a,t),this.remuxer.remux(a.audio,a.video,null,null,s,i,r,t)},e.prototype.destroy=function(){},e}();t.a=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(4),o=n.n(r),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(){i(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return a(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=o.a.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),e}();t.a=s},function(e,t,n){"use strict";function i(e,t){var n=o[t];return!!n&&!0===n[e.slice(0,4)]}function r(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r});var o={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(1),o=n(19),a=n(0),s=n(2),u=n(10),l=n.n(u),c=n(45),d=n.n(c),h=n(11),f=Object(h.a)(),p=function(){function e(t,n){i(this,e),this.hls=t,this.id=n;var u=this.observer=new l.a,c=t.config;u.trigger=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];u.emit.apply(u,[e,e].concat(n))},u.off=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];u.removeListener.apply(u,[e].concat(n))};var h=function(e,n){n=n||{},n.frag=this.frag,n.id=this.id,t.trigger(e,n)}.bind(this);u.on(r.a.FRAG_DECRYPTED,h),u.on(r.a.FRAG_PARSING_INIT_SEGMENT,h),u.on(r.a.FRAG_PARSING_DATA,h),u.on(r.a.FRAG_PARSED,h),u.on(r.a.ERROR,h),u.on(r.a.FRAG_PARSING_METADATA,h),u.on(r.a.FRAG_PARSING_USERDATA,h),u.on(r.a.INIT_PTS_FOUND,h);var p={mp4:f.isTypeSupported("video/mp4"),mpeg:f.isTypeSupported("audio/mpeg"),mp3:f.isTypeSupported('audio/mp4; codecs="mp3"')},g=navigator.vendor;if(c.enableWorker&&"undefined"!=typeof Worker){a.b.log("demuxing in webworker");var m=void 0;try{m=this.w=d()(46),this.onwmsg=this.onWorkerMessage.bind(this),m.addEventListener("message",this.onwmsg),m.onerror=function(e){t.trigger(r.a.ERROR,{type:s.b.OTHER_ERROR,details:s.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},m.postMessage({cmd:"init",typeSupported:p,vendor:g,id:n,config:JSON.stringify(c)})}catch(e){a.b.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),m&&URL.revokeObjectURL(m.objectURL),this.demuxer=new o.a(u,p,c,g),this.w=void 0}}else this.demuxer=new o.a(u,p,c,g)}return e.prototype.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var n=this.observer;n&&(n.removeAllListeners(),this.observer=null)},e.prototype.push=function(e,t,n,i,r,o,s,u){var l=this.w,c=isNaN(r.startDTS)?r.start:r.startDTS,d=r.decryptdata,h=this.frag,f=!(h&&r.cc===h.cc),p=!(h&&r.level===h.level),g=h&&r.sn===h.sn+1,m=!p&&g;if(f&&a.b.log(this.id+":discontinuity detected"),p&&a.b.log(this.id+":switch detected"),this.frag=r,l)l.postMessage({cmd:"demux",data:e,decryptdata:d,initSegment:t,audioCodec:n,videoCodec:i,timeOffset:c,discontinuity:f,trackSwitch:p,contiguous:m,duration:o,accurateTimeOffset:s,defaultInitPTS:u},e instanceof ArrayBuffer?[e]:[]);else{var v=this.demuxer;v&&v.push(e,d,t,n,i,c,f,p,m,o,s,u)}},e.prototype.onWorkerMessage=function(e){var t=e.data,n=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case r.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}},e}();t.a=p},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(1),o=n(2),a=n(9),s=n(36),u=n(15),l=n(37),c=n(40),d=n(41),h=n(44),f=function(){function e(t,n,r,o){i(this,e),this.observer=t,this.typeSupported=n,this.config=r,this.vendor=o}return e.prototype.destroy=function(){var e=this.demuxer;e&&e.destroy()},e.prototype.push=function(e,t,n,i,o,s,u,l,c,d,h,f){if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var p=this.decrypter;null==p&&(p=this.decrypter=new a.a(this.observer,this.config));var g=this,m=void 0;try{m=performance.now()}catch(e){m=Date.now()}p.decrypt(e,t.key.buffer,t.iv.buffer,function(e){var a=void 0;try{a=performance.now()}catch(e){a=Date.now()}g.observer.trigger(r.a.FRAG_DECRYPTED,{stats:{tstart:m,tdecrypt:a}}),g.pushDecrypted(new Uint8Array(e),t,new Uint8Array(n),i,o,s,u,l,c,d,h,f)})}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(n),i,o,s,u,l,c,d,h,f)},e.prototype.pushDecrypted=function(e,t,n,i,a,f,p,g,m,v,y,b){var w=this.demuxer;if(!w||(p||g)&&!this.probe(e)){for(var _=this.observer,E=this.typeSupported,S=this.config,T=[{demux:l.a,remux:d.a},{demux:u.a,remux:h.a},{demux:s.a,remux:d.a},{demux:c.a,remux:d.a}],P=0,A=T.length;P<A;P++){var I=T[P],x=I.demux.probe;if(x(e)){var O=this.remuxer=new I.remux(_,S,E,this.vendor);w=new I.demux(_,O,S,E),this.probe=x;break}}if(!w)return void _.trigger(r.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=w}var C=this.remuxer;(p||g)&&(w.resetInitSegment(n,i,a,v),C.resetInitSegment()),p&&(w.resetTimeStamp(b),C.resetTimeStamp(b)),"function"==typeof w.setDecryptData&&w.setDecryptData(t),w.append(e,f,m,y)},e}();t.a=f},function(e,t,n){"use strict";function i(e,t,n,i){var r=void 0,o=void 0,a=void 0,s=void 0,u=void 0,l=navigator.userAgent.toLowerCase(),c=i,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return r=1+((192&t[n+2])>>>6),(o=(60&t[n+2])>>>2)>d.length-1?void e.trigger(Event.ERROR,{type:p.b.MEDIA_ERROR,details:p.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+o}):(s=(1&t[n+2])<<2,s|=(192&t[n+3])>>>6,f.b.log("manifest codec:"+i+",ADTS data:type:"+r+",sampleingIndex:"+o+"["+d[o]+"Hz],channelConfig:"+s),/firefox/i.test(l)?o>=6?(r=5,u=new Array(4),a=o-3):(r=2,u=new Array(2),a=o):-1!==l.indexOf("android")?(r=2,u=new Array(2),a=o):(r=5,u=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&o>=6?a=o-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(o>=6&&1===s||/vivaldi/i.test(l))||!i&&1===s)&&(r=2,u=new Array(2)),a=o)),u[0]=r<<3,u[0]|=(14&o)>>1,u[1]|=(1&o)<<7,u[1]|=s<<3,5===r&&(u[1]|=(14&a)>>1,u[2]=(1&a)<<7,u[2]|=8,u[3]=0),{config:u,samplerate:d[o],channelCount:s,codec:"mp4a.40."+r,manifestCodec:c})}function r(e,t){return 255===e[t]&&240==(246&e[t+1])}function o(e,t){return 1&e[t+1]?7:9}function a(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function s(e,t){return!!(t+1<e.length&&r(e,t))}function u(e,t){if(t+1<e.length&&r(e,t)){var n=o(e,t),i=n;t+5<e.length&&(i=a(e,t));var s=t+i;if(s===e.length||s+1<e.length&&r(e,s))return!0}return!1}function l(e,t,n,r,o){if(!e.samplerate){var a=i(t,n,r,o);e.config=a.config,e.samplerate=a.samplerate,e.channelCount=a.channelCount,e.codec=a.codec,e.manifestCodec=a.manifestCodec,f.b.log("parsed codec:"+e.codec+",rate:"+a.samplerate+",nb channel:"+a.channelCount)}}function c(e){return 9216e4/e}function d(e,t,n,i,r){var s=void 0,u=void 0,l=void 0,c=e.length;if(s=o(e,t),u=a(e,t),(u-=s)>0&&t+s+u<=c)return l=n+i*r,{headerLength:s,frameLength:u,stamp:l}}function h(e,t,n,i,r){var o=c(e.samplerate),a=d(t,n,i,r,o);if(a){var s=a.stamp,u=a.headerLength,l=a.frameLength,h={unit:t.subarray(n+u,n+u+l),pts:s,dts:s};return e.samples.push(h),e.len+=l,{sample:h,length:l+u}}}t.d=s,t.e=u,t.c=l,t.b=c,t.a=h;var f=n(0),p=n(2)},function(e,t,n){"use strict";var i={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,n,i,r){if(!(n+24>t.length)){var o=this.parseHeader(t,n);if(o&&n+o.frameLength<=t.length){var a=9e4*o.samplesPerFrame/o.sampleRate,s=i+r*a,u={unit:t.subarray(n,n+o.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=o.channelCount,e.samplerate=o.sampleRate,e.samples.push(u),e.len+=o.frameLength,{sample:u,length:o.frameLength}}}},parseHeader:function(e,t){var n=e[t+1]>>3&3,r=e[t+1]>>1&3,o=e[t+2]>>4&15,a=e[t+2]>>2&3,s=e[t+2]>>1&1;if(1!==n&&0!==o&&15!==o&&3!==a){var u=3===n?3-r:3===r?3:4,l=1e3*i.BitratesMap[14*u+o-1],c=3===n?0:2===n?1:2,d=i.SamplingRateMap[3*c+a],h=e[t+3]>>6==3?1:2,f=i.SamplesCoefficients[n][r],p=i.BytesInSlot[r],g=8*f*p;return{sampleRate:d,channelCount:h,frameLength:parseInt(f*l/d+s,10)*p,samplesPerFrame:g}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var n=this.parseHeader(e,t),i=4;n&&n.frameLength&&(i=n.frameLength);var r=t+i;if(r===e.length||r+1<e.length&&this.isHeaderPattern(e,r))return!0}return!1}};t.a=i},function(e,t,n){"use strict";function i(e,t,n){var i=e[t],r=e[n],o=r.startPTS;isNaN(o)?r.start=n>t?i.start+i.duration:Math.max(i.start-r.duration,0):n>t?(i.duration=o-i.start,i.duration<0&&a.b.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(r.duration=i.start-o,r.duration<0&&a.b.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!"))}function r(e,t,n,r,o,a){var s=n;if(!isNaN(t.startPTS)){var u=Math.abs(t.startPTS-n);isNaN(t.deltaPTS)?t.deltaPTS=u:t.deltaPTS=Math.max(u,t.deltaPTS),s=Math.max(n,t.startPTS),n=Math.min(n,t.startPTS),r=Math.max(r,t.endPTS),o=Math.min(o,t.startDTS),a=Math.max(a,t.endDTS)}var l=n-t.start;t.start=t.startPTS=n,t.maxStartPTS=s,t.endPTS=r,t.startDTS=o,t.endDTS=a,t.duration=r-n;var c=t.sn;if(!e||c<e.startSN||c>e.endSN)return 0;var d=void 0,h=void 0,f=void 0;for(d=c-e.startSN,h=e.fragments,h[d]=t,f=d;f>0;f--)i(h,f,f-1);for(f=d;f<h.length-1;f++)i(h,f,f+1);return e.PTSKnown=!0,l}function o(e,t){var n=Math.max(e.startSN,t.startSN)-t.startSN,i=Math.min(e.endSN,t.endSN)-t.startSN,o=t.startSN-e.startSN,s=e.fragments,u=t.fragments,l=0,c=void 0;if(t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment),i<n)return void(t.PTSKnown=!1);for(var d=n;d<=i;d++){var h=s[o+d],f=u[d];f&&h&&(l=h.cc-f.cc,isNaN(h.startPTS)||(f.start=f.startPTS=h.startPTS,f.endPTS=h.endPTS,f.duration=h.duration,f.backtracked=h.backtracked,f.dropped=h.dropped,c=f))}if(l)for(a.b.log("discontinuity sliding from playlist, take drift into account"),d=0;d<u.length;d++)u[d].cc+=l;if(c)r(t,c,c.startPTS,c.endPTS,c.startDTS,c.endDTS);else if(o>=0&&o<s.length){var p=s[o].start;for(d=0;d<u.length;d++)u[d].start+=p}t.PTSKnown=e.PTSKnown}t.b=r,t.a=o;var a=n(0)},function(e,t,n){"use strict";var i={toString:function(e){for(var t="",n=e.length,i=0;i<n;i++)t+="["+e.start(i).toFixed(3)+","+e.end(i).toFixed(3)+"]";return t}};t.a=i},function(e,t,n){"use strict";function i(e,t){for(var n=null,i=0;i<e.length;i+=1){var r=e[i];if(r&&r.cc===t){n=r;break}}return n}function r(e,t){return l.a.search(e,function(e){return e.cc<t?1:e.cc>t?-1:0})}function o(e,t,n){var i=!1;return t&&t.details&&n&&(n.endCC>n.startCC||e&&e.cc<n.startCC)&&(i=!0),i}function a(e,t){var n=e.fragments,r=t.fragments;if(!r.length||!n.length)return void c.b.log("No fragments to align");var o=i(n,r[0].cc);return!o||o&&!o.startPTS?void c.b.log("No frag in previous level to align on"):o}function s(e,t){t.fragments.forEach(function(t){if(t){var n=t.start+e;t.start=t.startPTS=n,t.endPTS=n+t.duration}}),t.PTSKnown=!0}function u(e,t,n){if(o(e,t,n)){var i=a(t.details,n);i&&(c.b.log("Adjusting PTS using last level due to CC increase within current level"),s(i.start,n))}if(!1===n.PTSKnown&&t&&t.details&&t.details.fragments&&t.details.fragments.length){var r=t.details.programDateTime,u=n.programDateTime,l=(u-r)/1e3+t.details.fragments[0].start;isNaN(l)||(c.b.log("adjusting PTS using programDateTime delta, sliding:"+l.toFixed(3)),s(l,n))}}t.b=r,t.a=u;var l=n(7),c=n(0)},function(e,t,n){"use strict";function i(e,t){var n=null;try{n=new window.Event("addtrack")}catch(e){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function r(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}t.b=i,t.a=r},function(e,t,n){"use strict";function i(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new c,this.regionList=[]}function r(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+(0|i)/1e3}var n=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function o(){this.values=Object.create(null)}function a(e,t,n,i){var r=i?e.split(i):[e];for(var o in r)if("string"==typeof r[o]){var a=r[o].split(n);if(2===a.length){var s=a[0],u=a[1];t(s,u)}}}function s(e,t,n){function i(){var t=r(e);if(null===t)throw new Error("Malformed timestamp: "+u);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function s(){e=e.replace(/^\s+/,"")}var u=e;if(s(),t.startTime=i(),s(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+u);e=e.substr(3),s(),t.endTime=i(),s(),function(e,t){var i=new o;a(e,function(e,t){switch(e){case"region":for(var r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var o=t.split(","),a=o[0];i.integer(e,a),i.percent(e,a)&&i.set("snapToLines",!1),i.alt(e,a,["auto"]),2===o.length&&i.alt("lineAlign",o[1],["start",h,"end"]);break;case"position":o=t.split(","),i.percent(e,o[0]),2===o.length&&i.alt("positionAlign",o[1],["start",h,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",h,"end","left","right"])}},/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");var r=i.get("line","auto");"auto"===r&&-1===d.line&&(r=-1),t.line=r,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",h);var s=i.get("position","auto");"auto"===s&&50===d.position&&(s="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=s}(e,t)}function u(e){return e.replace(/<br(?: \/)?>/gi,"\n")}n.d(t,"b",function(){return u});var l=n(61),c=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};o.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var d=new l.a(0,0,0),h="middle"===d.align?"middle":"center";i.prototype={parse:function(e){function t(){var e=n.buffer,t=0;for(e=u(e);t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var i=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,n.buffer=e.substr(t),i}var n=this;e&&(n.buffer+=n.decoder.decode(e,{stream:!0}));try{var i=void 0;if("INITIAL"===n.state){if(!/\r\n|\n/.test(n.buffer))return this;i=t();var r=i.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!r||!r[0])throw new Error("Malformed WebVTT signature.");n.state="HEADER"}for(var o=!1;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(o?o=!1:i=t(),n.state){case"HEADER":/:/.test(i)?function(e){a(e,function(e,t){switch(e){case"Region":console.log("parse region",t)}},/:/)}(i):i||(n.state="ID");continue;case"NOTE":i||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){n.state="NOTE";break}if(!i)continue;if(n.cue=new l.a(0,0,""),n.state="CUE",-1===i.indexOf("--\x3e")){n.cue.id=i;continue}case"CUE":try{s(i,n.cue,n.regionList)}catch(e){n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var c=-1!==i.indexOf("--\x3e");if(!i||c&&(o=!0)){n.oncue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}n.cue.text&&(n.cue.text+="\n"),n.cue.text+=i;continue;case"BADCUE":i||(n.state="ID");continue}}}catch(e){"CUETEXT"===n.state&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state="INITIAL"===n.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return e.onflush&&e.onflush(),this}},t.a=i},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n.n(r),a=n(2),s=n(14),u=n(30),l=n(31),c=n(32),d=n(47),h=n(48),f=n(49),p=n(0),g=n(50),m=n(12),v=n(1),y=n(10),b=n.n(y),w=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();n(70);var _=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var r=e.DefaultConfig;if((n.liveSyncDurationCount||n.liveMaxLatencyDurationCount)&&(n.liveSyncDuration||n.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var o in r)o in n||(n[o]=r[o]);if(void 0!==n.liveMaxLatencyDurationCount&&n.liveMaxLatencyDurationCount<=n.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==n.liveMaxLatencyDuration&&(n.liveMaxLatencyDuration<=n.liveSyncDuration||void 0===n.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(p.a)(n.debug),this.config=n,this._autoLevelCapping=-1;var a=this.observer=new b.a;a.trigger=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];a.emit.apply(a,[e,e].concat(n))},a.off=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];a.removeListener.apply(a,[e].concat(n))},this.on=a.on.bind(a),this.off=a.off.bind(a),this.trigger=a.trigger.bind(a);var f=this.abrController=new n.abrController(this),g=new n.bufferController(this),v=new n.capLevelController(this),y=new n.fpsController(this),w=new s.a(this),_=new u.a(this),E=new l.a(this),S=new h.a(this),T=this.levelController=new d.a(this),P=new m.b(this),A=this.streamController=new c.a(this,P),I=[T,A],x=n.audioStreamController;x&&I.push(new x(this,P)),this.networkControllers=I;var O=[w,_,E,f,g,v,y,S,P];if(x=n.audioTrackController){var C=new x(this);this.audioTrackController=C,O.push(C)}if(x=n.subtitleTrackController){var R=new x(this);this.subtitleTrackController=R,O.push(R)}if(x=n.emeController){var L=new x(this);this.emeController=L,O.push(L)}[n.subtitleStreamController,n.timelineController].forEach(function(e){e&&O.push(new e(t))}),this.coreComponents=O}return e.isSupported=function(){return Object(f.a)()},w(e,null,[{key:"version",get:function(){return"0.9.1"}},{key:"Events",get:function(){return v.a}},{key:"ErrorTypes",get:function(){return a.b}},{key:"ErrorDetails",get:function(){return a.a}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:g.a},set:function(t){e.defaultConfig=t}}]),e.prototype.destroy=function(){p.b.log("destroy"),this.trigger(v.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1},e.prototype.attachMedia=function(e){p.b.log("attachMedia"),this.media=e,this.trigger(v.a.MEDIA_ATTACHING,{media:e})},e.prototype.detachMedia=function(){p.b.log("detachMedia"),this.trigger(v.a.MEDIA_DETACHING),this.media=null},e.prototype.loadSource=function(e){e=o.a.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),p.b.log("loadSource:"+e),this.url=e,this.trigger(v.a.MANIFEST_LOADING,{url:e})},e.prototype.startLoad=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;p.b.log("startLoad("+e+")"),this.networkControllers.forEach(function(t){t.startLoad(e)})},e.prototype.stopLoad=function(){p.b.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},e.prototype.swapAudioCodec=function(){p.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},e.prototype.recoverMediaError=function(){p.b.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)},w(e,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){p.b.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){p.b.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){p.b.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){p.b.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){p.b.log("set startLevel:"+e);var t=this;-1!==e&&(e=Math.max(e,t.minAutoLevel)),t.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){p.b.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this,t=e.levels,n=e.config.minAutoBitrate,i=t?t.length:0,r=0;r<i;r++)if((t[r].realBitrate?Math.max(t[r].realBitrate,t[r].bitrate):t[r].bitrate)>n)return r;return 0}},{key:"maxAutoLevel",get:function(){var e=this,t=e.levels,n=e.autoLevelCapping;return-1===n&&t&&t.length?t.length-1:n}},{key:"nextAutoLevel",get:function(){var e=this;return Math.min(Math.max(e.abrController.nextAutoLevel,e.minAutoLevel),e.maxAutoLevel)},set:function(e){var t=this;t.abrController.nextAutoLevel=Math.max(t.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),e}();t.default=_},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(4),o=n.n(r),a=n(6),s=n(16),u=n(29),l=n(0),c=n(17),d=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,h=/#EXT-X-MEDIA:(.*)/g,f=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),p=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,g=function(){function e(){i(this,e)}return e.findGroup=function(e,t){if(!e)return null;for(var n=null,i=0;i<e.length;i++){var r=e[i];r.id===t&&(n=r)}return n},e.convertAVC1ToAVCOTI=function(e){var t=void 0,n=e.split(".");return n.length>2?(t=n.shift()+".",t+=parseInt(n.shift()).toString(16),t+=("000"+parseInt(n.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return o.a.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,n){var i=[],r=void 0;for(d.lastIndex=0;null!=(r=d.exec(t));){var o={},a=o.attrs=new u.a(r[1]);o.url=e.resolve(r[2],n);var s=a.decimalResolution("RESOLUTION");s&&(o.width=s.width,o.height=s.height),o.bitrate=a.decimalInteger("AVERAGE-BANDWIDTH")||a.decimalInteger("BANDWIDTH"),o.name=a.NAME,function(e,t){["video","audio"].forEach(function(n){var i=e.filter(function(e){return Object(c.b)(e,n)});if(i.length){var r=i.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)});t[n+"Codec"]=r.length>0?r[0]:i[0],e=e.filter(function(e){return-1===i.indexOf(e)})}}),t.unknownCodecs=e}([].concat((a.CODECS||"").split(/[ ,]+/)),o),o.videoCodec&&-1!==o.videoCodec.indexOf("avc1")&&(o.videoCodec=e.convertAVC1ToAVCOTI(o.videoCodec)),i.push(o)}return i},e.parseMasterPlaylistMedia=function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=void 0,a=[],s=0;for(h.lastIndex=0;null!==(o=h.exec(t));){var l={},c=new u.a(o[1]);if(c.TYPE===i){if(l.groupId=c["GROUP-ID"],l.name=c.NAME,l.type=i,l.default="YES"===c.DEFAULT,l.autoselect="YES"===c.AUTOSELECT,l.forced="YES"===c.FORCED,c.URI&&(l.url=e.resolve(c.URI,n)),l.lang=c.LANGUAGE,l.name||(l.name=l.lang),r.length){var d=e.findGroup(r,l.groupId);l.audioCodec=d?d.codec:r[0].codec}l.id=s++,a.push(l)}}return a},e.parseLevelPlaylist=function(e,t,n,i){var r=0,o=0,c={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},d=new s.a,h=0,g=null,m=new a.a,v=void 0,y=void 0;for(f.lastIndex=0;null!==(v=f.exec(e));){var b=v[1];if(b){m.duration=parseFloat(b);var w=(" "+v[2]).slice(1);m.title=w||null,m.tagList.push(w?["INF",b,w]:["INF",b])}else if(v[3]){if(!isNaN(m.duration)){var _=r++;m.type=i,m.start=o,m.levelkey=d,m.sn=_,m.level=n,m.cc=h,m.baseurl=t,m.relurl=(" "+v[3]).slice(1),c.programDateTime&&(g?m.rawProgramDateTime?m.pdt=Date.parse(m.rawProgramDateTime):m.pdt=g.pdt+1e3*g.duration:m.pdt=Date.parse(c.programDateTime),m.endPdt=m.pdt+1e3*m.duration),c.fragments.push(m),g=m,o+=m.duration,m=new a.a}}else if(v[4]){if(m.rawByteRange=(" "+v[4]).slice(1),g){var E=g.byteRangeEndOffset;E&&(m.lastByteRangeEndOffset=E)}}else if(v[5])m.rawProgramDateTime=(" "+v[5]).slice(1),m.tagList.push(["PROGRAM-DATE-TIME",m.rawProgramDateTime]),void 0===c.programDateTime&&(c.programDateTime=new Date(new Date(Date.parse(v[5]))-1e3*o));else{for(v=v[0].match(p),y=1;y<v.length&&void 0===v[y];y++);var S=(" "+v[y+1]).slice(1),T=(" "+v[y+2]).slice(1);switch(v[y]){case"#":m.tagList.push(T?[S,T]:[S]);break;case"PLAYLIST-TYPE":c.type=S.toUpperCase();break;case"MEDIA-SEQUENCE":r=c.startSN=parseInt(S);break;case"TARGETDURATION":c.targetduration=parseFloat(S);break;case"VERSION":c.version=parseInt(S);break;case"EXTM3U":break;case"ENDLIST":c.live=!1;break;case"DIS":h++,m.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":h=parseInt(S);break;case"KEY":var P=S,A=new u.a(P),I=A.enumeratedString("METHOD"),x=A.URI,O=A.hexadecimalInteger("IV");I&&(d=new s.a,x&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(I)>=0&&(d.method=I,d.baseuri=t,d.reluri=x,d.key=null,d.iv=O));break;case"START":var C=S,R=new u.a(C),L=R.decimalFloatingPoint("TIME-OFFSET");isNaN(L)||(c.startTimeOffset=L);break;case"MAP":var k=new u.a(S);m.relurl=k.URI,m.rawByteRange=k.BYTERANGE,m.baseurl=t,m.level=n,m.type=i,m.sn="initSegment",c.initSegment=m,m=new a.a;break;default:l.b.warn("line parsed but not handled: "+v)}}}return m=g,m&&!m.relurl&&(c.fragments.pop(),o-=m.duration),c.totalduration=o,c.averagetargetduration=o/c.fragments.length,c.endSN=r-1,c.startCC=c.fragments[0]?c.fragments[0].cc:0,c.endCC=h,!c.initSegment&&c.fragments.length&&c.fragments.every(function(e){return e.relurl.endsWith(".mp4")})&&(l.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),m=new a.a,m.relurl=c.fragments[0].relurl,m.baseurl=t,m.level=n,m.type=i,m.sn="initSegment",c.initSegment=m,c.needSidxRanges=!0),c},e}();t.a=g},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=/^(\d+)x(\d+)$/,o=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,a=function(){function e(t){i(this,e),"string"==typeof t&&(t=e.parseAttrList(t));for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}return e.prototype.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},e.prototype.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t
;for(var n=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)n[i]=parseInt(t.slice(2*i,2*i+2),16);return n}return null},e.prototype.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},e.prototype.decimalFloatingPoint=function(e){return parseFloat(this[e])},e.prototype.enumeratedString=function(e){return this[e]},e.prototype.decimalResolution=function(e){var t=r.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t=void 0,n={};for(o.lastIndex=0;null!==(t=o.exec(e));){var i=t[2];0===i.indexOf('"')&&i.lastIndexOf('"')===i.length-1&&(i=i.slice(1,-1)),n[t[1]]=i}return n},e}();t.a=a},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=n(3),u=n(2),l=n(0),c=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,a.a.FRAG_LOADING));return o.loaders={},o}return o(t,e),t.prototype.destroy=function(){var t=this.loaders;for(var n in t){var i=t[n];i&&i.destroy()}this.loaders={},e.prototype.destroy.call(this)},t.prototype.onFragLoading=function(e){var t=e.frag,n=t.type,i=this.loaders,r=this.hls.config,o=r.fLoader,a=r.loader;t.loaded=0;var s=i[n];s&&(l.b.warn("abort previous fragment loader for type: "+n),s.abort()),s=i[n]=t.loader=r.fLoader?new o(r):new a(r);var u=void 0,c=void 0,d=void 0;u={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var h=t.byteRangeStartOffset,f=t.byteRangeEndOffset;isNaN(h)||isNaN(f)||(u.rangeStart=h,u.rangeEnd=f),c={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:r.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},s.load(u,c,d)},t.prototype.loadsuccess=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=e.data,o=n.frag;o.loader=void 0,this.loaders[o.type]=void 0,this.hls.trigger(a.a.FRAG_LOADED,{payload:r,frag:o,stats:t,networkDetails:i})},t.prototype.loaderror=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.a.ERROR,{type:u.b.NETWORK_ERROR,details:u.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:n})},t.prototype.loadtimeout=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.a.ERROR,{type:u.b.NETWORK_ERROR,details:u.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:n})},t.prototype.loadprogress=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=t.frag;r.loaded=e.loaded,this.hls.trigger(a.a.FRAG_LOAD_PROGRESS,{frag:r,stats:e,networkDetails:i})},t}(s.a);t.a=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=n(3),u=n(2),l=n(0),c=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,a.a.KEY_LOADING));return o.loaders={},o.decryptkey=null,o.decrypturl=null,o}return o(t,e),t.prototype.destroy=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},s.a.prototype.destroy.call(this)},t.prototype.onKeyLoading=function(e){var t=e.frag,n=t.type,i=this.loaders[n],r=t.decryptdata,o=r.uri;if(o!==this.decrypturl||null===this.decryptkey){var s=this.hls.config;i&&(l.b.warn("abort previous key loader for type:"+n),i.abort()),t.loader=this.loaders[n]=new s.loader(s),this.decrypturl=o,this.decryptkey=null;var u=void 0,c=void 0,d=void 0;u={url:o,frag:t,responseType:"arraybuffer"},c={timeout:s.fragLoadingTimeOut,maxRetry:s.fragLoadingMaxRetry,retryDelay:s.fragLoadingRetryDelay,maxRetryDelay:s.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(u,c,d)}else this.decryptkey&&(r.key=this.decryptkey,this.hls.trigger(a.a.KEY_LOADED,{frag:t}))},t.prototype.loadsuccess=function(e,t,n){var i=n.frag;this.decryptkey=i.decryptdata.key=new Uint8Array(e.data),i.loader=void 0,this.loaders[i.type]=void 0,this.hls.trigger(a.a.KEY_LOADED,{frag:i})},t.prototype.loaderror=function(e,t){var n=t.frag,i=n.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.a.ERROR,{type:u.b.NETWORK_ERROR,details:u.a.KEY_LOAD_ERROR,fatal:!1,frag:n,response:e})},t.prototype.loadtimeout=function(e,t){var n=t.frag,i=n.loader;i&&i.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.a.ERROR,{type:u.b.NETWORK_ERROR,details:u.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:n})},t}(s.a);t.a=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(7),s=n(8),u=n(18),l=n(1),c=n(12),d=n(6),h=n(14),f=n(22),p=n(23),g=n(2),m=n(0),v=n(24),y=n(13),b=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),w={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},_=function(e){function t(n,o){i(this,t);var a=r(this,e.call(this,n,l.a.MEDIA_ATTACHED,l.a.MEDIA_DETACHING,l.a.MANIFEST_LOADING,l.a.MANIFEST_PARSED,l.a.LEVEL_LOADED,l.a.KEY_LOADED,l.a.FRAG_LOADED,l.a.FRAG_LOAD_EMERGENCY_ABORTED,l.a.FRAG_PARSING_INIT_SEGMENT,l.a.FRAG_PARSING_DATA,l.a.FRAG_PARSED,l.a.ERROR,l.a.AUDIO_TRACK_SWITCHING,l.a.AUDIO_TRACK_SWITCHED,l.a.BUFFER_CREATED,l.a.BUFFER_APPENDED,l.a.BUFFER_FLUSHED));return a.fragmentTracker=o,a.config=n.config,a.audioCodecSwap=!1,a._state=w.STOPPED,a}return o(t,e),t.prototype.onHandlerDestroying=function(){this.stopLoad()},t.prototype.onHandlerDestroyed=function(){this.state=w.STOPPED,this.fragmentTracker=null},t.prototype.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,n=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var i=n.startLevel;-1===i&&(i=0,this.bitrateTest=!0),this.level=n.nextLoadLevel=i,this.loadedmetadata=!1}t>0&&-1===e&&(m.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=w.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=w.STOPPED},t.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.clearInterval(),this.state=w.STOPPED,this.forceStartLoad=!1},t.prototype.doTick=function(){switch(this.state){case w.BUFFER_FLUSHING:this.fragLoadError=0;break;case w.IDLE:this._doTickIdle();break;case w.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=w.IDLE);break;case w.FRAG_LOADING_WAITING_RETRY:var t=performance.now(),n=this.retryDate;(!n||t>=n||this.media&&this.media.seeking)&&(m.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=w.IDLE);break;case w.ERROR:case w.STOPPED:case w.FRAG_LOADING:case w.PARSING:case w.PARSED:case w.ENDED:}this._checkBuffer(),this._checkFragmentChanged()},t.prototype._doTickIdle=function(){var e=this.hls,t=e.config,n=this.media;if(void 0!==this.levelLastLoaded&&(n||!this.startFragRequested&&t.startFragPrefetch)){var i=void 0;i=this.loadedmetadata?n.currentTime:this.nextLoadPosition;var r=e.nextLoadLevel,o=this.levels[r];if(o){var a=o.bitrate,u=void 0;u=a?Math.max(8*t.maxBufferSize/a,t.maxBufferLength):t.maxBufferLength,u=Math.min(u,t.maxMaxBufferLength);var c=s.a.bufferInfo(this.mediaBuffer?this.mediaBuffer:n,i,t.maxBufferHole),d=c.len;if(!(d>=u)){m.b.trace("buffer length of "+d.toFixed(3)+" is below max of "+u.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=r;var h=o.details;if(void 0===h||!0===h.live&&this.levelLastLoaded!==r)return void(this.state=w.WAITING_LEVEL);var f=this.fragPrevious;if(!h.live&&f&&!f.backtracked&&f.sn===h.endSN&&!c.nextStart&&Math.min(n.duration,f.start+f.duration)-Math.max(c.end,f.start)<=Math.max(.2,f.duration)){var p={};return this.altAudio&&(p.type="video"),this.hls.trigger(l.a.BUFFER_EOS,p),void(this.state=w.ENDED)}this._fetchPayloadOrEos(i,c,h)}}}},t.prototype._fetchPayloadOrEos=function(e,t,n){var i=this.fragPrevious,r=this.level,o=n.fragments,a=o.length;if(0!==a){var s=o[0].start,u=o[a-1].start+o[a-1].duration,l=t.end,c=void 0;if(n.initSegment&&!n.initSegment.data)c=n.initSegment;else if(n.live){var d=this.config.initialLiveManifestSize;if(a<d)return void m.b.warn("Can not start playback of a level, reason: not enough fragments "+a+" < "+d);if(null===(c=this._ensureFragmentAtLivePoint(n,l,s,u,i,o,a)))return}else l<s&&(c=o[0]);c||(c=this._findFragment(s,i,a,o,l,u,n)),c&&this._loadFragmentOrKey(c,r,n,e,l)}},t.prototype._ensureFragmentAtLivePoint=function(e,t,n,i,r,o,s){var u=this.hls.config,l=this.media,c=void 0,d=void 0!==u.liveMaxLatencyDuration?u.liveMaxLatencyDuration:u.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(n-u.maxFragLookUpTolerance,i-d)){var h=this.liveSyncPosition=this.computeLivePosition(n,e);m.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),t=h,l&&l.readyState&&l.duration>h&&(l.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&t>i&&l&&l.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(r)if(e.programDateTime)c=this._findFragmentByPDT(o,r.endPdt+1);else{var f=r.sn+1;if(f>=e.startSN&&f<=e.endSN){var p=o[f-e.startSN];r.cc===p.cc&&(c=p,m.b.log("live playlist, switching playlist, load frag with next SN: "+c.sn))}c||(c=a.a.search(o,function(e){return r.cc-e.cc}))&&m.b.log("live playlist, switching playlist, load frag with same CC: "+c.sn)}c||(c=o[Math.min(s-1,Math.round(s/2))],m.b.log("live playlist, switching playlist, unknown, load middle frag : "+c.sn))}return c},t.prototype._findFragmentByPDT=function(e,t){if(!e||void 0===t)return null;if(t<e[0].pdt)return null;if(t>=e[e.length-1].endPdt)return null;for(var n=0;n<e.length;++n){var i=e[n];if(t<i.endPdt)return i}return null},t.prototype._findFragmentBySN=function(e,t,n,i){var r=this.hls.config,o=void 0,s=r.maxFragLookUpTolerance,u=e?t[e.sn-t[0].sn+1]:void 0,l=function(e){var t=Math.min(s,e.duration+(e.deltaPTS?e.deltaPTS:0));return e.start+e.duration-t<=n?1:e.start-t>n&&e.start?-1:0};return n<i&&(n>i-s&&(s=0),o=u&&!l(u)?u:a.a.search(t,l)),o},t.prototype._findFragment=function(e,t,n,i,r,o,a){var s=this.hls.config,u=void 0,l=void 0;if(l=r<o?a.programDateTime?this._findFragmentByPDT(i,1e3*r+(a.programDateTime?Date.parse(a.programDateTime):0)-1e3*e):this._findFragmentBySN(t,i,r,o):i[n-1]){u=l;var c=u.sn-a.startSN,d=t&&u.level===t.level,h=i[c-1],f=i[c+1];if(t&&u.sn===t.sn)if(d&&!u.backtracked)if(u.sn<a.endSN){var p=t.deltaPTS;p&&p>s.maxBufferHole&&t.dropped&&c?(u=h,m.b.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):(u=f,m.b.log("SN just loaded, load next one: "+u.sn))}else u=null;else u.backtracked&&(f&&f.backtracked?(m.b.warn("Already backtracked from fragment "+f.sn+", will not backtrack to fragment "+u.sn+". Loading fragment "+f.sn),u=f):(m.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),u.dropped=0,h?(u=h,u.backtracked=!0):c&&(u=null)))}return u},t.prototype._loadFragmentOrKey=function(e,t,n,i,r){if(e.decryptdata&&null!=e.decryptdata.uri&&null==e.decryptdata.key)m.b.log("Loading key for "+e.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+t),this.state=w.KEY_LOADING,this.hls.trigger(l.a.KEY_LOADING,{frag:e});else{m.b.log("Loading "+e.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+t+", currentTime:"+i.toFixed(3)+",bufferEnd:"+r.toFixed(3));var o=this.fragmentTracker.getState(e);this.fragCurrent=e,this.startFragRequested=!0,isNaN(e.sn)||e.bitrateTest||(this.nextLoadPosition=e.start+e.duration),e.backtracked||o===c.a.NOT_LOADED?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,this.hls.trigger(l.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new u.a(this.hls,"main")),this.state=w.FRAG_LOADING):o===c.a.APPENDING&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)}},t.prototype.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,h.a.LevelType.MAIN)},t.prototype.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},t.prototype._checkFragmentChanged=function(){var e=void 0,t=void 0,n=this.media;if(n&&n.readyState&&!1===n.seeking&&(t=n.currentTime,t>n.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),s.a.isBuffered(n,t)?e=this.getBufferedFrag(t):s.a.isBuffered(n,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var i=e;if(i!==this.fragPlaying){this.hls.trigger(l.a.FRAG_CHANGED,{frag:i});var r=i.level;this.fragPlaying&&this.fragPlaying.level===r||this.hls.trigger(l.a.LEVEL_SWITCHED,{level:r}),this.fragPlaying=i}}},t.prototype.immediateLevelSwitch=function(){if(m.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var n=this.fragCurrent;n&&n.loader&&n.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},t.prototype.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,s.a.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},t.prototype.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t=void 0,n=void 0,i=void 0;if(n=this.getBufferedFrag(e.currentTime),n&&n.startPTS>1&&this.flushMainBuffer(0,n.startPTS-1),e.paused)t=0;else{var r=this.hls.nextLoadLevel,o=this.levels[r],a=this.fragLastKbps;t=a&&this.fragCurrent?this.fragCurrent.duration*o.bitrate/(1e3*a)+1:0}if((i=this.getBufferedFrag(e.currentTime+t))&&(i=this.followingBufferedFrag(i))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(i.maxStartPTS,Number.POSITIVE_INFINITY)}}},t.prototype.flushMainBuffer=function(e,t){this.state=w.BUFFER_FLUSHING;var n={startOffset:e,endOffset:t};this.altAudio&&(n.type="video"),this.hls.trigger(l.a.BUFFER_FLUSHING,n)},t.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var n=this.config;this.levels&&n.autoStartLoad&&this.hls.startLoad(n.startPosition)},t.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(m.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},t.prototype.onMediaSeeking=function(){var e=this.media,t=e?e.currentTime:void 0,n=this.config;isNaN(t)||m.b.log("media seeking to "+t.toFixed(3));var i=this.mediaBuffer?this.mediaBuffer:e,r=s.a.bufferInfo(i,t,this.config.maxBufferHole);if(this.state===w.FRAG_LOADING){var o=this.fragCurrent;if(0===r.len&&o){var a=n.maxFragLookUpTolerance,u=o.start-a,l=o.start+o.duration+a;t<u||t>l?(o.loader&&(m.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=w.IDLE):m.b.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===w.ENDED&&(0===r.len&&(this.fragPrevious=0),this.state=w.IDLE);e&&(this.lastCurrentTime=t),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()},t.prototype.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;isNaN(t)||m.b.log("media seeked to "+t.toFixed(3)),this.tick()},t.prototype.onMediaEnded=function(){m.b.log("media ended"),this.startPosition=this.lastCurrentTime=0},t.prototype.onManifestLoading=function(){m.b.log("trigger BUFFER_RESET"),this.hls.trigger(l.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},t.prototype.onManifestParsed=function(e){var t=!1,n=!1,i=void 0;e.levels.forEach(function(e){(i=e.audioCodec)&&(-1!==i.indexOf("mp4a.40.2")&&(t=!0),-1!==i.indexOf("mp4a.40.5")&&(n=!0))}),this.audioCodecSwitch=t&&n,this.audioCodecSwitch&&m.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1;var r=this.config;(r.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(r.startPosition)},t.prototype.onLevelLoaded=function(e){var t=e.details,n=e.level,i=this.levels[this.levelLastLoaded],r=this.levels[n],o=t.totalduration,a=0;if(m.b.log("level "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+o),t.live){var s=r.details;s&&t.fragments.length>0?(f.a(s,t),a=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,s),t.PTSKnown&&!isNaN(a)?m.b.log("live playlist sliding:"+a.toFixed(3)):(m.b.log("live playlist - outdated PTS, unknown sliding"),Object(v.a)(this.fragPrevious,i,t))):(m.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,Object(v.a)(this.fragPrevious,i,t))}else t.PTSKnown=!1;if(r.details=t,this.levelLastLoaded=n,this.hls.trigger(l.a.LEVEL_UPDATED,{details:t,level:n}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var u=t.startTimeOffset;isNaN(u)?t.live?(this.startPosition=this.computeLivePosition(a,t),m.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(u<0&&(m.b.log("negative start time offset "+u+", count from end of last fragment"),u=a+o+u),m.b.log("start time offset found in playlist, adjust startPosition to "+u),this.startPosition=u),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===w.WAITING_LEVEL&&(this.state=w.IDLE),this.tick()},t.prototype.onKeyLoaded=function(){this.state===w.KEY_LOADING&&(this.state=w.IDLE,this.tick())},t.prototype.onFragLoaded=function(e){var t=this.fragCurrent,n=e.frag;if(this.state===w.FRAG_LOADING&&t&&"main"===n.type&&n.level===t.level&&n.sn===t.sn){var i=e.stats,r=this.levels[t.level],o=r.details;if(m.b.log("Loaded  "+t.sn+" of ["+o.startSN+" ,"+o.endSN+"],level "+t.level),this.bitrateTest=!1,this.stats=i,!0===n.bitrateTest&&this.hls.nextLoadLevel)this.state=w.IDLE,this.startFragRequested=!1,i.tparsed=i.tbuffered=performance.now(),this.hls.trigger(l.a.FRAG_BUFFERED,{stats:i,frag:t,id:"main"}),this.tick();else if("initSegment"===n.sn)this.state=w.IDLE,i.tparsed=i.tbuffered=performance.now(),o.initSegment.data=e.payload,this.hls.trigger(l.a.FRAG_BUFFERED,{stats:i,frag:t,id:"main"}),this.tick();else{this.state=w.PARSING;var a=o.totalduration,s=t.level,c=t.sn,d=this.config.defaultAudioCodec||r.audioCodec;this.audioCodecSwap&&(m.b.log("swapping playlist audio codec"),void 0===d&&(d=this.lastAudioCodec),d&&(d=-1!==d.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,m.b.log("Parsing "+c+" of ["+o.startSN+" ,"+o.endSN+"],level "+s+", cc "+t.cc);var h=this.demuxer;h||(h=this.demuxer=new u.a(this.hls,"main"));var f=this.media,p=f&&f.seeking,g=!p&&(o.PTSKnown||!o.live),v=o.initSegment?o.initSegment.data:[];h.push(e.payload,v,d,r.videoCodec,t,a,g,void 0)}}this.fragLoadError=0},t.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,n=e.frag;if(t&&"main"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===w.PARSING){var i=e.tracks,r=void 0,o=void 0;if(i.audio&&this.altAudio&&delete i.audio,o=i.audio){var a=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();a&&this.audioCodecSwap&&(m.b.log("swapping playlist audio codec"),a=-1!==a.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==o.metadata.channelCount&&-1===s.indexOf("firefox")&&(a="mp4a.40.5"),-1!==s.indexOf("android")&&"audio/mpeg"!==o.container&&(a="mp4a.40.2",m.b.log("Android: force audio codec to "+a)),o.levelCodec=a,o.id=e.id}o=i.video,o&&(o.levelCodec=this.levels[this.level].videoCodec,o.id=e.id),this.hls.trigger(l.a.BUFFER_CODECS,i);for(r in i){o=i[r],m.b.log("main track:"+r+",container:"+o.container+",codecs[level/parsed]=["+o.levelCodec+"/"+o.codec+"]");var u=o.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(l.a.BUFFER_APPENDING,{type:r,data:u,parent:"main",content:"initSegment"}))}this.tick()}},t.prototype.onFragParsingData=function(e){var t=this,n=this.fragCurrent,i=e.frag;if(n&&"main"===e.id&&i.sn===n.sn&&i.level===n.level&&("audio"!==e.type||!this.altAudio)&&this.state===w.PARSING){var r=this.levels[this.level],o=n;if(isNaN(e.endPTS)&&(e.endPTS=e.startPTS+n.duration,e.endDTS=e.startDTS+n.duration),!0===e.hasAudio&&o.addElementaryStream(d.a.ElementaryStreamTypes.AUDIO),!0===e.hasVideo&&o.addElementaryStream(d.a.ElementaryStreamTypes.VIDEO),m.b.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(o.dropped=e.dropped,o.dropped)if(o.backtracked)m.b.warn("Already backtracked on this fragment, appending with the gap");else{var a=r.details;if(!a||o.sn!==a.startSN)return m.b.warn("missing video frame(s), backtracking fragment"),this.fragmentTracker.removeFragment(o),o.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=w.IDLE,this.fragPrevious=o,void this.tick();m.b.warn("missing video frame(s) on first frag, appending with gap")}else o.backtracked=!1;var s=f.b(r.details,o,e.startPTS,e.endPTS,e.startDTS,e.endDTS),u=this.hls;u.trigger(l.a.LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:s,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach(function(n){n&&n.length&&t.state===w.PARSING&&(t.appended=!0,t.pendingBuffering=!0,u.trigger(l.a.BUFFER_APPENDING,{type:e.type,data:n,parent:"main",content:"data"}))}),this.tick()}},t.prototype.onFragParsed=function(e){var t=this.fragCurrent,n=e.frag;t&&"main"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===w.PARSING&&(this.stats.tparsed=performance.now(),this.state=w.PARSED,this._checkAppendedParsed())},t.prototype.onAudioTrackSwitching=function(e){var t=!!e.url,n=e.id;if(!t){if(this.mediaBuffer!==this.media){m.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var i=this.fragCurrent;i.loader&&(m.b.log("switching to main audio track, cancel main fragment load"),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=w.IDLE}var r=this.hls;r.trigger(l.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),r.trigger(l.a.AUDIO_TRACK_SWITCHED,{id:n}),this.altAudio=!1}},t.prototype.onAudioTrackSwitched=function(e){var t=e.id,n=!!this.hls.audioTracks[t].url;if(n){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(m.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=n,this.tick()},t.prototype.onBufferCreated=function(e){var t=e.tracks,n=void 0,i=void 0,r=!1;for(var o in t){var a=t[o];"main"===a.id?(i=o,n=a,"video"===o&&(this.videoBuffer=t[o].buffer)):r=!0}r&&n?(m.b.log("alternate track found, use "+i+".buffered to schedule main fragment loading"),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media},t.prototype.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==w.PARSING&&t!==w.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},t.prototype._checkAppendedParsed=function(){if(!(this.state!==w.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;m.b.log("main buffered : "+p.a.toString(t.buffered)),this.fragPrevious=e;var n=this.stats;n.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(l.a.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.state=w.IDLE}this.tick()}},t.prototype.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var n=!!this.media&&s.a.isBuffered(this.media,this.media.currentTime)&&s.a.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case g.a.FRAG_LOAD_ERROR:case g.a.FRAG_LOAD_TIMEOUT:case g.a.KEY_LOAD_ERROR:case g.a.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var i=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);m.b.warn("mediaController: frag loading failed, retry in "+i+" ms"),this.retryDate=performance.now()+i,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=w.FRAG_LOADING_WAITING_RETRY}else m.b.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=w.ERROR;break;case g.a.LEVEL_LOAD_ERROR:case g.a.LEVEL_LOAD_TIMEOUT:this.state!==w.ERROR&&(e.fatal?(this.state=w.ERROR,m.b.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==w.WAITING_LEVEL||(this.state=w.IDLE));break;case g.a.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==w.PARSING&&this.state!==w.PARSED||(n?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=w.IDLE):(m.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},t.prototype._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,m.b.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},t.prototype._checkBuffer=function(){var e=this.media,t=this.config;if(e&&e.readyState){var n=e.currentTime,i=this.mediaBuffer?this.mediaBuffer:e,r=i.buffered;if(!this.loadedmetadata&&r.length){this.loadedmetadata=!0;var o=e.seeking?n:this.startPosition;n!==o&&(m.b.log("target start position not buffered, seek to buffered.start(0) "+o+" from current time"+n+" "),e.currentTime=o)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var a=s.a.bufferInfo(e,n,t.maxBufferHole),u=!(e.paused&&e.readyState>1||e.ended||0===e.buffered.length),c=n!==this.lastCurrentTime;if(c)this.stallReported&&(m.b.warn("playback not stuck anymore @"+n+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(u){var d=performance.now(),h=this.hls;if(this.stalled){var f=d-this.stalled,p=a.len,v=this.nudgeRetry||0,y=this.fragmentTracker.getPartialFragment(n);if(null!==y)for(var b=0,w=0;w<e.buffered.length;w++){var _=e.buffered.start(w);if(n>=b&&n<_)return e.currentTime=Math.max(_,e.currentTime+.1),m.b.warn("skipping hole, adjusting currentTime from "+n+" to "+e.currentTime),this.stalled=void 0,void h.trigger(l.a.ERROR,{type:g.b.MEDIA_ERROR,details:g.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+n+" to "+e.currentTime,frag:y});b=e.buffered.end(w)}if(p>.5&&f>1e3*t.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,m.b.warn("playback stalling in high buffer @"+n),h.trigger(l.a.ERROR,{type:g.b.MEDIA_ERROR,details:g.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:p})),this.stalled=void 0,this.nudgeRetry=++v,v<t.nudgeMaxRetry){var E=e.currentTime,S=E+v*t.nudgeOffset;m.b.log("adjust currentTime from "+E+" to "+S),e.currentTime=S,h.trigger(l.a.ERROR,{type:g.b.MEDIA_ERROR,details:g.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else m.b.error("still stuck in high buffer @"+n+" after "+t.nudgeMaxRetry+", raise fatal error"),h.trigger(l.a.ERROR,{type:g.b.MEDIA_ERROR,details:g.a.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=d,this.stallReported=!1}}}},t.prototype.onFragLoadEmergencyAborted=function(){this.state=w.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},t.prototype.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;this.fragmentTracker.detectEvictedFragments(d.a.ElementaryStreamTypes.VIDEO,e.buffered),this.state=w.IDLE,this.fragPrevious=null},t.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},t.prototype.computeLivePosition=function(e,t){var n=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-n)},b(t,[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,m.b.log("main stream:"+t+"->"+e),this.hls.trigger(l.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(y.a);t.a=_},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(t,n){i(this,e),this.subtle=t,this.aesIV=n}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}();t.a=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(t,n){i(this,e),this.subtle=t,this.key=n}
return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}();t.a=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){var t=e.byteLength,n=t&&new DataView(e).getUint8(t-1);return n?e.slice(0,t-n):e}var o=function(){function e(){i(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return e.prototype.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),n=new Uint32Array(4),i=0;i<4;i++)n[i]=t.getUint32(4*i);return n},e.prototype.initTable=function(){var e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],o=n[2],a=n[3],s=this.invSubMix,u=s[0],l=s[1],c=s[2],d=s[3],h=new Uint32Array(256),f=0,p=0,g=0;for(g=0;g<256;g++)h[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var m=p^p<<1^p<<2^p<<3^p<<4;m=m>>>8^255&m^99,e[f]=m,t[m]=f;var v=h[f],y=h[v],b=h[y],w=257*h[m]^16843008*m;i[f]=w<<24|w>>>8,r[f]=w<<16|w>>>16,o[f]=w<<8|w>>>24,a[f]=w,w=16843009*b^65537*y^257*v^16843008*f,u[m]=w<<24|w>>>8,l[m]=w<<16|w>>>16,c[m]=w<<8|w>>>24,d[m]=w,f?(f=v^h[h[h[b^v]]],p^=h[h[p]]):f=p=1}},e.prototype.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),n=!0,i=0;i<t.length&&n;)n=t[i]===this.key[i],i++;if(!n){this.key=t;var r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);var o=this.ksRows=4*(r+6+1),a=void 0,s=void 0,u=this.keySchedule=new Uint32Array(o),l=this.invKeySchedule=new Uint32Array(o),c=this.sBox,d=this.rcon,h=this.invSubMix,f=h[0],p=h[1],g=h[2],m=h[3],v=void 0,y=void 0;for(a=0;a<o;a++)a<r?v=u[a]=t[a]:(y=v,a%r==0?(y=y<<8|y>>>24,y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y],y^=d[a/r|0]<<24):r>6&&a%r==4&&(y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y]),u[a]=v=(u[a-r]^y)>>>0);for(s=0;s<o;s++)a=o-s,y=3&s?u[a]:u[a-4],l[s]=s<4||a<=4?y:f[c[y>>>24]]^p[c[y>>>16&255]]^g[c[y>>>8&255]]^m[c[255&y]],l[s]=l[s]>>>0}},e.prototype.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},e.prototype.decrypt=function(e,t,n,i){for(var o=this.keySize+6,a=this.invKeySchedule,s=this.invSBox,u=this.invSubMix,l=u[0],c=u[1],d=u[2],h=u[3],f=this.uint8ArrayToUint32Array_(n),p=f[0],g=f[1],m=f[2],v=f[3],y=new Int32Array(e),b=new Int32Array(y.length),w=void 0,_=void 0,E=void 0,S=void 0,T=void 0,P=void 0,A=void 0,I=void 0,x=void 0,O=void 0,C=void 0,R=void 0,L=void 0,k=void 0,M=this.networkToHostOrderSwap;t<y.length;){for(x=M(y[t]),O=M(y[t+1]),C=M(y[t+2]),R=M(y[t+3]),T=x^a[0],P=R^a[1],A=C^a[2],I=O^a[3],L=4,k=1;k<o;k++)w=l[T>>>24]^c[P>>16&255]^d[A>>8&255]^h[255&I]^a[L],_=l[P>>>24]^c[A>>16&255]^d[I>>8&255]^h[255&T]^a[L+1],E=l[A>>>24]^c[I>>16&255]^d[T>>8&255]^h[255&P]^a[L+2],S=l[I>>>24]^c[T>>16&255]^d[P>>8&255]^h[255&A]^a[L+3],T=w,P=_,A=E,I=S,L+=4;w=s[T>>>24]<<24^s[P>>16&255]<<16^s[A>>8&255]<<8^s[255&I]^a[L],_=s[P>>>24]<<24^s[A>>16&255]<<16^s[I>>8&255]<<8^s[255&T]^a[L+1],E=s[A>>>24]<<24^s[I>>16&255]<<16^s[T>>8&255]<<8^s[255&P]^a[L+2],S=s[I>>>24]<<24^s[T>>16&255]<<16^s[P>>8&255]<<8^s[255&A]^a[L+3],L+=3,b[t]=M(w^p),b[t+1]=M(S^g),b[t+2]=M(E^m),b[t+3]=M(_^v),p=x,g=O,m=C,v=R,t+=4}return i?r(b.buffer):b.buffer},e.prototype.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}();t.a=o},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(20),o=n(0),a=n(5),s=function(){function e(t,n,r){i(this,e),this.observer=t,this.config=r,this.remuxer=n}return e.prototype.resetInitSegment=function(e,t,n,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},e.prototype.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=a.a.getID3Data(e,0)||[],n=t.length,i=e.length;n<i;n++)if(r.e(e,n))return o.b.log("ADTS sync word found !"),!0;return!1},e.prototype.append=function(e,t,n,i){for(var s=this._audioTrack,u=a.a.getID3Data(e,0)||[],l=a.a.getTimeStamp(u),c=l?90*l:9e4*t,d=0,h=c,f=e.length,p=u.length,g=[{pts:h,dts:h,data:u}];p<f-1;)if(r.d(e,p)&&p+5<f){r.c(s,this.observer,e,p,s.manifestCodec);var m=r.a(s,e,p,c,d);if(!m){o.b.log("Unable to parse AAC frame");break}p+=m.length,h=m.sample.pts,d++}else a.a.isHeader(e,p)?(u=a.a.getID3Data(e,p),g.push({pts:h,dts:h,data:u}),p+=u.length):p++;this.remuxer.remux(s,{samples:[]},{samples:g,inputTimeScale:9e4},{samples:[]},t,n,i)},e.prototype.destroy=function(){},e}();t.a=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(20),o=n(21),a=n(1),s=n(38),u=n(39),l=n(0),c=n(2),d={video:0,audio:1,id3:2,text:3},h=function(){function e(t,n,r,o){i(this,e),this.observer=t,this.config=r,this.typeSupported=o,this.remuxer=n,this.sampleAes=null}return e.prototype.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new u.a(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var n=e._syncOffset(t);return!(n<0||(n&&l.b.warn("MPEG2-TS detected but first sync word found @ offset "+n+", junk ahead ?"),0))},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71===e[n]&&71===e[n+188]&&71===e[n+376])return n;n++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:d[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},e.prototype.resetInitSegment=function(t,n,i,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video",r),this._audioTrack=e.createTrack("audio",r),this._id3Track=e.createTrack("id3",r),this._txtTrack=e.createTrack("text",r),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=n,this.videoCodec=i,this._duration=r},e.prototype.resetTimeStamp=function(){},e.prototype.append=function(t,n,i,r){var o=void 0,s=t.length,u=void 0,d=void 0,h=void 0,f=void 0,p=!1;this.contiguous=i;var g=this.pmtParsed,m=this._avcTrack,v=this._audioTrack,y=this._id3Track,b=m.pid,w=v.pid,_=y.pid,E=this._pmtId,S=m.pesData,T=v.pesData,P=y.pesData,A=this._parsePAT,I=this._parsePMT,x=this._parsePES,O=this._parseAVCPES.bind(this),C=this._parseAACPES.bind(this),R=this._parseMPEGPES.bind(this),L=this._parseID3PES.bind(this),k=e._syncOffset(t);for(s-=(s+k)%188,o=k;o<s;o+=188)if(71===t[o]){if(u=!!(64&t[o+1]),d=((31&t[o+1])<<8)+t[o+2],(48&t[o+3])>>4>1){if((h=o+5+t[o+4])===o+188)continue}else h=o+4;switch(d){case b:u&&(S&&(f=x(S))&&void 0!==f.pts&&O(f,!1),S={data:[],size:0}),S&&(S.data.push(t.subarray(h,o+188)),S.size+=o+188-h);break;case w:u&&(T&&(f=x(T))&&void 0!==f.pts&&(v.isAAC?C(f):R(f)),T={data:[],size:0}),T&&(T.data.push(t.subarray(h,o+188)),T.size+=o+188-h);break;case _:u&&(P&&(f=x(P))&&void 0!==f.pts&&L(f),P={data:[],size:0}),P&&(P.data.push(t.subarray(h,o+188)),P.size+=o+188-h);break;case 0:u&&(h+=t[h]+1),E=this._pmtId=A(t,h);break;case E:u&&(h+=t[h]+1);var M=I(t,h,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);b=M.avc,b>0&&(m.pid=b),w=M.audio,w>0&&(v.pid=w,v.isAAC=M.isAAC),_=M.id3,_>0&&(y.pid=_),p&&!g&&(l.b.log("reparse from beginning"),p=!1,o=k-188),g=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(a.a.ERROR,{type:c.b.MEDIA_ERROR,details:c.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});S&&(f=x(S))&&void 0!==f.pts?(O(f,!0),m.pesData=null):m.pesData=S,T&&(f=x(T))&&void 0!==f.pts?(v.isAAC?C(f):R(f),v.pesData=null):(T&&T.size&&l.b.log("last AAC PES packet truncated,might overlap between fragments"),v.pesData=T),P&&(f=x(P))&&void 0!==f.pts?(L(f),y.pesData=null):y.pesData=P,null==this.sampleAes?this.remuxer.remux(v,m,y,this._txtTrack,n,i,r):this.decryptAndRemux(v,m,y,this._txtTrack,n,i,r)},e.prototype.decryptAndRemux=function(e,t,n,i,r,o,a){if(e.samples&&e.isAAC){var s=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){s.decryptAndRemuxAvc(e,t,n,i,r,o,a)})}else this.decryptAndRemuxAvc(e,t,n,i,r,o,a)},e.prototype.decryptAndRemuxAvc=function(e,t,n,i,r,o,a){if(t.samples){var s=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){s.remuxer.remux(e,t,n,i,r,o,a)})}else this.remuxer.remux(e,t,n,i,r,o,a)},e.prototype.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},e.prototype._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},e.prototype._parsePMT=function(e,t,n,i){var r=void 0,o=void 0,a=void 0,s=void 0,u={audio:-1,avc:-1,id3:-1,isAAC:!0};for(r=(15&e[t+1])<<8|e[t+2],o=t+3+r-4,a=(15&e[t+10])<<8|e[t+11],t+=12+a;t<o;){switch(s=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!i){l.b.log("unkown stream type:"+e[t]);break}case 15:-1===u.audio&&(u.audio=s);break;case 21:-1===u.id3&&(u.id3=s);break;case 219:if(!i){l.b.log("unkown stream type:"+e[t]);break}case 27:-1===u.avc&&(u.avc=s);break;case 3:case 4:n?-1===u.audio&&(u.audio=s,u.isAAC=!1):l.b.log("MPEG audio found, not supported in this browser for now");break;case 36:l.b.warn("HEVC stream type found, not supported for now");break;default:l.b.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return u},e.prototype._parsePES=function(e){var t=0,n=void 0,i=void 0,r=void 0,o=void 0,a=void 0,s=void 0,u=void 0,c=void 0,d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;){var h=new Uint8Array(d[0].length+d[1].length);h.set(d[0]),h.set(d[1],d[0].length),d[0]=h,d.splice(1,1)}if(n=d[0],1===(n[0]<<16)+(n[1]<<8)+n[2]){if((r=(n[4]<<8)+n[5])&&r>e.size-6)return null;i=n[7],192&i&&(s=536870912*(14&n[9])+4194304*(255&n[10])+16384*(254&n[11])+128*(255&n[12])+(254&n[13])/2,s>4294967295&&(s-=8589934592),64&i?(u=536870912*(14&n[14])+4194304*(255&n[15])+16384*(254&n[16])+128*(255&n[17])+(254&n[18])/2,u>4294967295&&(u-=8589934592),s-u>54e5&&(l.b.warn(Math.round((s-u)/9e4)+"s delta between PTS and DTS, align them"),s=u)):u=s),o=n[8],c=o+9,e.size-=c,a=new Uint8Array(e.size);for(var f=0,p=d.length;f<p;f++){n=d[f];var g=n.byteLength;if(c){if(c>g){c-=g;continue}n=n.subarray(c),g-=c,c=0}a.set(n,t),t+=g}return r&&(r-=o+3),{data:a,pts:s,dts:u,len:r}}return null},e.prototype.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var n=t.samples,i=n.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(i||this.contiguous)?(e.id=i,n.push(e)):t.dropped++}e.debug.length&&l.b.log(e.pts+"/"+e.dts+":"+e.debug)},e.prototype._parseAVCPES=function(e,t){var n=this,i=this._avcTrack,r=this._parseAVCNALu(e.data),o=void 0,a=this.avcSample,u=void 0,l=!1,c=void 0,d=this.pushAccesUnit.bind(this),h=function(e,t,n,i){return{key:e,pts:t,dts:n,units:[],debug:i}};e.data=null,a&&r.length&&!i.audFound&&(d(a,i),a=this.avcSample=h(!1,e.pts,e.dts,"")),r.forEach(function(t){switch(t.type){case 1:u=!0,a||(a=n.avcSample=h(!0,e.pts,e.dts,"")),a.frame=!0;var r=t.data;if(l&&r.length>4){var f=new s.a(r).readSliceType();2!==f&&4!==f&&7!==f&&9!==f||(a.key=!0)}break;case 5:u=!0,a||(a=n.avcSample=h(!0,e.pts,e.dts,"")),a.key=!0,a.frame=!0;break;case 6:u=!0,o=new s.a(n.discardEPB(t.data)),o.readUByte();for(var p=0,g=0,m=!1,v=0;!m&&o.bytesAvailable>1;){p=0;do{v=o.readUByte(),p+=v}while(255===v);g=0;do{v=o.readUByte(),g+=v}while(255===v);if(4===p&&0!==o.bytesAvailable){if(m=!0,181===o.readUByte()&&49===o.readUShort()&&1195456820===o.readUInt()&&3===o.readUByte()){var y=o.readUByte(),b=o.readUByte(),w=31&y,_=[y,b];for(c=0;c<w;c++)_.push(o.readUByte()),_.push(o.readUByte()),_.push(o.readUByte());n._insertSampleInOrder(n._txtTrack.samples,{type:3,pts:e.pts,bytes:_})}}else if(g<o.bytesAvailable)for(c=0;c<g;c++)o.readUByte()}break;case 7:if(u=!0,l=!0,!i.sps){o=new s.a(t.data);var E=o.readSPS();i.width=E.width,i.height=E.height,i.pixelRatio=E.pixelRatio,i.sps=[t.data],i.duration=n._duration;var S=t.data.subarray(1,4),T="avc1.";for(c=0;c<3;c++){var P=S[c].toString(16);P.length<2&&(P="0"+P),T+=P}i.codec=T}break;case 8:u=!0,i.pps||(i.pps=[t.data]);break;case 9:u=!1,i.audFound=!0,a&&d(a,i),a=n.avcSample=h(!1,e.pts,e.dts,"");break;case 12:u=!1;break;default:u=!1,a&&(a.debug+="unknown NAL "+t.type+" ")}a&&u&&a.units.push(t)}),t&&a&&(d(a,i),this.avcSample=null)},e.prototype._insertSampleInOrder=function(e,t){var n=e.length;if(n>0){if(t.pts>=e[n-1].pts)e.push(t);else for(var i=n-1;i>=0;i--)if(t.pts<e[i].pts){e.splice(i,0,t);break}}else e.push(t)},e.prototype._getLastNalUnit=function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.length){var n=this._avcTrack,i=n.samples;e=i[i.length-1]}if(e){var r=e.units;t=r[r.length-1]}return t},e.prototype._parseAVCNALu=function(e){var t=0,n=e.byteLength,i=void 0,r=void 0,o=this._avcTrack,a=o.naluState||0,s=a,u=[],l=void 0,c=void 0,d=-1,h=void 0;for(-1===a&&(d=0,h=31&e[0],a=0,t=1);t<n;)if(i=e[t++],a)if(1!==a)if(i)if(1===i){if(d>=0)l={data:e.subarray(d,t-a-1),type:h},u.push(l);else{var f=this._getLastNalUnit();if(f&&(s&&t<=4-s&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-s)),(r=t-a-1)>0)){var p=new Uint8Array(f.data.byteLength+r);p.set(f.data,0),p.set(e.subarray(0,r),f.data.byteLength),f.data=p}}t<n?(c=31&e[t],d=t,h=c,a=0):a=-1}else a=0;else a=3;else a=i?0:2;else a=i?0:1;if(d>=0&&a>=0&&(l={data:e.subarray(d,n),type:h,state:a},u.push(l)),0===u.length){var g=this._getLastNalUnit();if(g){var m=new Uint8Array(g.data.byteLength+e.byteLength);m.set(g.data,0),m.set(e,g.data.byteLength),g.data=m}}return o.naluState=a,u},e.prototype.discardEPB=function(e){for(var t=e.byteLength,n=[],i=1,r=void 0,o=void 0;i<t-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return e;r=t-n.length,o=new Uint8Array(r);var a=0;for(i=0;i<r;a++,i++)a===n[0]&&(a++,n.shift()),o[i]=e[a];return o},e.prototype._parseAACPES=function(e){var t=this._audioTrack,n=e.data,i=e.pts,o=this.aacOverFlow,s=this.aacLastPTS,u=void 0,d=void 0,h=void 0,f=void 0,p=void 0;if(o){var g=new Uint8Array(o.byteLength+n.byteLength);g.set(o,0),g.set(n,o.byteLength),n=g}for(h=0,p=n.length;h<p-1&&!r.d(n,h);h++);if(h){var m=void 0,v=void 0;if(h<p-1?(m="AAC PES did not start with ADTS header,offset:"+h,v=!1):(m="no ADTS header found in AAC PES",v=!0),l.b.warn("parsing error:"+m),this.observer.trigger(a.a.ERROR,{type:c.b.MEDIA_ERROR,details:c.a.FRAG_PARSING_ERROR,fatal:v,reason:m}),v)return}if(r.c(t,this.observer,n,h,this.audioCodec),d=0,u=r.b(t.samplerate),o&&s){var y=s+u;Math.abs(y-i)>1&&(l.b.log("AAC: align PTS for overlapping frames by "+Math.round((y-i)/90)),i=y)}for(;h<p;)if(r.d(n,h)&&h+5<p){var b=r.a(t,n,h,i,d);if(!b)break;h+=b.length,f=b.sample.pts,d++}else h++;o=h<p?n.subarray(h,p):null,this.aacOverFlow=o,this.aacLastPTS=f},e.prototype._parseMPEGPES=function(e){for(var t=e.data,n=t.length,i=0,r=0,a=e.pts;r<n;)if(o.a.isHeader(t,r)){var s=o.a.appendFrame(this._audioTrack,t,r,a,i);if(!s)break;r+=s.length,i++}else r++},e.prototype._parseID3PES=function(e){this._id3Track.samples.push(e)},e}();t.a=h},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(0),o=function(){function e(t){i(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return e.prototype.loadWord=function(){var e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r},e.prototype.skipBits=function(e){var t=void 0;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},e.prototype.readBits=function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;return e>32&&r.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n},e.prototype.skipLZ=function(){var e=void 0;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},e.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},e.prototype.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},e.prototype.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},e.prototype.readBoolean=function(){return 1===this.readBits(1)},e.prototype.readUByte=function(){return this.readBits(8)},e.prototype.readUShort=function(){return this.readBits(16)},e.prototype.readUInt=function(){return this.readBits(32)},e.prototype.skipScalingList=function(e){var t=8,n=8,i=void 0,r=void 0;for(i=0;i<e;i++)0!==n&&(r=this.readEG(),n=(t+r+256)%256),t=0===n?t:n},e.prototype.readSPS=function(){var e=0,t=0,n=0,i=0,r=void 0,o=void 0,a=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),m=this.skipEG.bind(this),v=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(d(),r=d(),h(5),g(3),d(),v(),100===r||110===r||122===r||244===r||44===r||83===r||86===r||118===r||128===r){var b=f();if(3===b&&g(1),v(),v(),g(1),p())for(l=3!==b?8:12,c=0;c<l;c++)p()&&y(c<6?16:64)}v();var w=f();if(0===w)f();else if(1===w)for(g(1),m(),m(),o=f(),c=0;c<o;c++)m();v(),g(1),a=f(),s=f(),u=h(1),0===u&&g(1),g(1),p()&&(e=f(),t=f(),n=f(),i=f());var _=[1,1];if(p()&&p())switch(d()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(a+1)-2*e-2*t),height:(2-u)*(s+1)*16-(u?2:4)*(n+i),pixelRatio:_}},e.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}();t.a=o},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(9),o=function(){function e(t,n,o,a){i(this,e),this.decryptdata=o,this.discardEPB=a,this.decrypter=new r.a(t,n,{removePKCS7Padding:!1})}return e.prototype.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},e.prototype.decryptAacSample=function(e,t,n,i){var r=e[t].unit,o=r.subarray(16,r.length-r.length%16),a=o.buffer.slice(o.byteOffset,o.byteOffset+o.length),s=this;this.decryptBuffer(a,function(o){o=new Uint8Array(o),r.set(o,16),i||s.decryptAacSamples(e,t+1,n)})},e.prototype.decryptAacSamples=function(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)){var i=this.decrypter.isSync();if(this.decryptAacSample(e,t,n,i),!i)return}}},e.prototype.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t),i=0,r=32;r<=e.length-16;r+=160,i+=16)n.set(e.subarray(r,r+16),i);return n},e.prototype.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var n=0,i=32;i<=e.length-16;i+=160,n+=16)e.set(t.subarray(n,n+16),i);return e},e.prototype.decryptAvcSample=function(e,t,n,i,r,o){var a=this.discardEPB(r.data),s=this.getAvcEncryptedData(a),u=this;this.decryptBuffer(s.buffer,function(s){r.data=u.getAvcDecryptedUnit(a,s),o||u.decryptAvcSamples(e,t,n+1,i)})},e.prototype.decryptAvcSamples=function(e,t,n,i){for(;;t++,n=0){if(t>=e.length)return void i();for(var r=e[t].units;!(n>=r.length);n++){var o=r[n];if(!(o.length<=48||1!==o.type&&5!==o.type)){var a=this.decrypter.isSync();if(this.decryptAvcSample(e,t,n,i,o,a),!a)return}}}},e}();t.a=o},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(5),o=n(0),a=n(21),s=function(){function e(t,n,r){i(this,e),this.observer=t,this.config=r,this.remuxer=n}return e.prototype.resetInitSegment=function(e,t,n,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},e.prototype.resetTimeStamp=function(){},e.probe=function(e){var t=void 0,n=void 0,i=r.a.getID3Data(e,0);if(i&&void 0!==r.a.getTimeStamp(i))for(t=i.length,n=Math.min(e.length-1,t+100);t<n;t++)if(a.a.probe(e,t))return o.b.log("MPEG Audio sync word found !"),!0;return!1},e.prototype.append=function(e,t,n,i){for(var o=r.a.getID3Data(e,0),s=r.a.getTimeStamp(o),u=s?90*s:9e4*t,l=o.length,c=e.length,d=0,h=0,f=this._audioTrack,p=[{pts:u,dts:u,data:o}];l<c;)if(a.a.isHeader(e,l)){var g=a.a.appendFrame(f,e,l,u,d);if(!g)break;l+=g.length,h=g.sample.pts,d++}else r.a.isHeader(e,l)?(o=r.a.getID3Data(e,l),p.push({pts:h,dts:h,data:o}),l+=o.length):l++;this.remuxer.remux(f,{samples:[]},{samples:p,inputTimeScale:9e4},{samples:[]},t,n,i)},e.prototype.destroy=function(){},e}();t.a=s},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(42),o=n(1),a=n(0),s=n(43),u=n(2),l=function(){function e(t,n,r,o){i(this,e),this.observer=t,this.config=n,this.typeSupported=r;var a=navigator.userAgent;this.isSafari=o&&o.indexOf("Apple")>-1&&a&&!a.match("CriOS"),this.ISGenerated=!1}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},e.prototype.resetInitSegment=function(){this.ISGenerated=!1},e.prototype.remux=function(e,t,n,i,r,s,u){if(this.ISGenerated||this.generateIS(e,t,r),this.ISGenerated){var l=e.samples.length,c=t.samples.length,d=r,h=r;if(l&&c){var f=(e.samples[0].dts-t.samples[0].dts)/t.inputTimeScale;d+=Math.max(0,f),h+=Math.max(0,-f)}if(l){e.timescale||(a.b.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,r));var p=this.remuxAudio(e,d,s,u);if(c){var g=void 0;p&&(g=p.endPTS-p.startPTS),t.timescale||(a.b.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,r)),this.remuxVideo(t,h,s,g,u)}}else if(c){var m=this.remuxVideo(t,h,s,0,u);m&&e.codec&&this.remuxEmptyAudio(e,d,s,m)}}n.samples.length&&this.remuxID3(n,r),i.samples.length&&this.remuxText(i,r),this.observer.trigger(o.a.FRAG_PARSED)},e.prototype.generateIS=function(e,t,n){var i=this.observer,r=e.samples,l=t.samples,c=this.typeSupported,d="audio/mp4",h={},f={tracks:h},p=void 0===this._initPTS,g=void 0,m=void 0;if(p&&(g=m=1/0),e.config&&r.length&&(e.timescale=e.samplerate,a.b.log("audio sampling rate : "+e.samplerate),e.isAAC||(c.mpeg?(d="audio/mpeg",e.codec=""):c.mp3&&(e.codec="mp3")),h.audio={container:d,codec:e.codec,initSegment:!e.isAAC&&c.mpeg?new Uint8Array:s.a.initSegment([e]),metadata:{channelCount:e.channelCount}},p&&(g=m=r[0].pts-e.inputTimeScale*n)),t.sps&&t.pps&&l.length){var v=t.inputTimeScale;t.timescale=v,h.video={container:"video/mp4",codec:t.codec,initSegment:s.a.initSegment([t]),metadata:{width:t.width,height:t.height}},p&&(g=Math.min(g,l[0].pts-v*n),m=Math.min(m,l[0].dts-v*n),this.observer.trigger(o.a.INIT_PTS_FOUND,{initPTS:g}))}Object.keys(h).length?(i.trigger(o.a.FRAG_PARSING_INIT_SEGMENT,f),this.ISGenerated=!0,p&&(this._initPTS=g,this._initDTS=m)):i.trigger(o.a.ERROR,{type:u.b.MEDIA_ERROR,details:u.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},e.prototype.remuxVideo=function(e,t,n,i,r){var l=8,c=e.timescale,d=void 0,h=void 0,f=void 0,p=void 0,g=void 0,m=void 0,v=void 0,y=e.samples,b=[],w=y.length,_=this._PTSNormalize,E=this._initDTS,S=this.nextAvcDts,T=this.isSafari;if(0!==w){T&&(n|=y.length&&S&&(r&&Math.abs(t-S/c)<.1||Math.abs(y[0].pts-S-E)<c/5)),n||(S=t*c),y.forEach(function(e){e.pts=_(e.pts-E,S),e.dts=_(e.dts-E,S)}),y.sort(function(e,t){var n=e.dts-t.dts,i=e.pts-t.pts;return n||i||e.id-t.id});var P=y.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(P<0){a.b.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(P/90)+" ms to overcome this issue");for(var A=0;A<y.length;A++)y[A].dts+=P}var I=y[0];g=Math.max(I.dts,0),p=Math.max(I.pts,0);var x=Math.round((g-S)/90);n&&x&&(x>1?a.b.log("AVC:"+x+" ms hole between fragments detected,filling it"):x<-1&&a.b.log("AVC:"+-x+" ms overlapping between fragments detected"),g=S,y[0].dts=g,p=Math.max(p-x,S),y[0].pts=p,a.b.log("Video/PTS/DTS adjusted: "+Math.round(p/90)+"/"+Math.round(g/90)+",delta:"+x+" ms")),I=y[y.length-1],v=Math.max(I.dts,0),m=Math.max(I.pts,0,v),T&&(d=Math.round((v-g)/(y.length-1)));for(var O=0,C=0,R=0;R<w;R++){for(var L=y[R],k=L.units,M=k.length,D=0,N=0;N<M;N++)D+=k[N].data.length;C+=D,O+=M,L.length=D,L.dts=T?g+R*d:Math.max(L.dts,g),L.pts=Math.max(L.pts,L.dts)}var F=C+4*O+8;try{h=new Uint8Array(F)}catch(e){return void this.observer.trigger(o.a.ERROR,{type:u.b.MUX_ERROR,details:u.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:F,reason:"fail allocating video mdat "+F})}var V=new DataView(h.buffer);V.setUint32(0,F),h.set(s.a.types.mdat,4);for(var U=0;U<w;U++){for(var B=y[U],j=B.units,G=0,H=void 0,W=0,q=j.length;W<q;W++){var $=j[W],Y=$.data,z=$.data.byteLength;V.setUint32(l,z),l+=4,h.set(Y,l),l+=z,G+=4+z}if(T)H=Math.max(0,d*Math.round((B.pts-B.dts)/d));else{if(U<w-1)d=y[U+1].dts-B.dts;else{var K=this.config,X=B.dts-y[U>0?U-1:U].dts;if(K.stretchShortVideoTrack){var Z=K.maxBufferHole,Q=Math.floor(Z*c),J=(i?p+i*c:this.nextAudioPts)-B.pts;J>Q?(d=J-X,d<0&&(d=X),a.b.log("It is approximately "+J/90+" ms to the next segment; using duration "+d/90+" ms for the last video frame.")):d=X}else d=X}H=Math.round(B.pts-B.dts)}b.push({size:G,duration:d,cts:H,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:B.key?2:1,isNonSync:B.key?0:1}})}this.nextAvcDts=v+d;var ee=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,b.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var te=b[0].flags;te.dependsOn=2,te.isNonSync=0}e.samples=b,f=s.a.moof(e.sequenceNumber++,g,e),e.samples=[];var ne={data1:f,data2:h,startPTS:p/c,endPTS:(m+d)/c,startDTS:g/c,endDTS:this.nextAvcDts/c,type:"video",hasAudio:!1,hasVideo:!0,nb:b.length,dropped:ee};return this.observer.trigger(o.a.FRAG_PARSING_DATA,ne),ne}},e.prototype.remuxAudio=function(e,t,n,i){var l=e.inputTimeScale,c=e.timescale,d=l/c,h=e.isAAC?1024:1152,f=h*d,p=this._PTSNormalize,g=this._initDTS,m=!e.isAAC&&this.typeSupported.mpeg,v=void 0,y=void 0,b=void 0,w=void 0,_=void 0,E=void 0,S=void 0,T=e.samples,P=[],A=this.nextAudioPts;if(n|=T.length&&A&&(i&&Math.abs(t-A/l)<.1||Math.abs(T[0].pts-A-g)<20*f),T.forEach(function(e){e.pts=e.dts=p(e.pts-g,t*l)}),T=T.filter(function(e){return e.pts>=0}),0!==T.length){if(n||(A=i?t*l:T[0].pts),e.isAAC)for(var I=this.config.maxAudioFramesDrift,x=0,O=A;x<T.length;){var C,R=T[x],L=R.pts;C=L-O;var k=Math.abs(1e3*C/l);if(C<=-I*f)a.b.warn("Dropping 1 audio frame @ "+(O/l).toFixed(3)+"s due to "+Math.round(k)+" ms overlap."),T.splice(x,1),e.len-=R.unit.length;else if(C>=I*f&&k<1e4&&O){var M=Math.round(C/f);a.b.warn("Injecting "+M+" audio frame @ "+(O/l).toFixed(3)+"s due to "+Math.round(1e3*C/l)+" ms gap.");for(var D=0;D<M;D++){var N=Math.max(O,0);b=r.a.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),b||(a.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),b=R.unit.subarray()),T.splice(x,0,{unit:b,pts:N,dts:N}),e.len+=b.length,O+=f,x++}R.pts=R.dts=O,O+=f,x++}else Math.abs(C),R.pts=R.dts=O,O+=f,x++}for(var F=0,V=T.length;F<V;F++){var U=T[F],B=U.unit,j=U.pts;if(void 0!==S)y.duration=Math.round((j-S)/d);else{var G=Math.round(1e3*(j-A)/l),H=0;if(n&&e.isAAC&&G){if(G>0&&G<1e4)H=Math.round((j-A)/f),a.b.log(G+" ms hole between AAC samples detected,filling it"),H>0&&(b=r.a.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),b||(b=B.subarray()),e.len+=H*b.length);else if(G<-12){a.b.log("drop overlapping AAC sample, expected/parsed/delta:"+(A/l).toFixed(3)+"s/"+(j/l).toFixed(3)+"s/"+-G+"ms"),e.len-=B.byteLength;continue}j=A}if(E=j,!(e.len>0))return;var W=m?e.len:e.len+8;v=m?0:8;try{w=new Uint8Array(W)}catch(e){return void this.observer.trigger(o.a.ERROR,{type:u.b.MUX_ERROR,details:u.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:W,reason:"fail allocating audio mdat "+W})}m||(new DataView(w.buffer).setUint32(0,W),w.set(s.a.types.mdat,4));for(var q=0;q<H;q++)b=r.a.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),b||(a.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),b=B.subarray()),w.set(b,v),v+=b.byteLength,y={size:b.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},P.push(y)}w.set(B,v);var $=B.byteLength;v+=$,y={size:$,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},P.push(y),S=j}var Y=0,z=P.length;if(z>=2&&(Y=P[z-2].duration,y.duration=Y),z){this.nextAudioPts=A=S+d*Y,e.len=0,e.samples=P,_=m?new Uint8Array:s.a.moof(e.sequenceNumber++,E/d,e),e.samples=[];var K=E/l,X=A/l,Z={data1:_,data2:w,startPTS:K,endPTS:X,startDTS:K,endDTS:X,type:"audio",hasAudio:!0,hasVideo:!1,nb:z};return this.observer.trigger(o.a.FRAG_PARSING_DATA,Z),Z}return null}},e.prototype.remuxEmptyAudio=function(e,t,n,i){var o=e.inputTimeScale,s=e.samplerate?e.samplerate:o,u=o/s,l=this.nextAudioPts,c=(void 0!==l?l:i.startDTS*o)+this._initDTS,d=i.endDTS*o+this._initDTS,h=1024*u,f=Math.ceil((d-c)/h),p=r.a.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(a.b.warn("remux empty Audio"),!p)return void a.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(var g=[],m=0;m<f;m++){var v=c+m*h;g.push({unit:p,pts:v,dts:v}),e.len+=p.length}e.samples=g,this.remuxAudio(e,t,n)},e.prototype.remuxID3=function(e,t){var n=e.samples.length,i=void 0,r=e.inputTimeScale,a=this._initPTS,s=this._initDTS;if(n){for(var u=0;u<n;u++)i=e.samples[u],i.pts=(i.pts-a)/r,i.dts=(i.dts-s)/r;this.observer.trigger(o.a.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[],t=t},e.prototype.remuxText=function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var n=e.samples.length,i=void 0,r=e.inputTimeScale,a=this._initPTS;if(n){for(var s=0;s<n;s++)i=e.samples[s],i.pts=(i.pts-a)/r;this.observer.trigger(o.a.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[],t=t},e.prototype._PTSNormalize=function(e,t){var n=void 0;if(void 0===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e},e}();t.a=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(){i(this,e)}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])
;if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}();t.a=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=Math.pow(2,32)-1,o=function(){function e(){i(this,e)}return e.init=function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t=void 0;for(t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:n,audio:i};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=o,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,a,u,a,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,r))},e.box=function(e){for(var t=Array.prototype.slice.call(arguments,1),n=8,i=t.length,r=i,o=void 0;i--;)n+=t[i].byteLength;for(o=new Uint8Array(n),o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=255&n,o.set(e,4),i=0,n=8;i<r;i++)o.set(t[i],n),n+=t[i].byteLength;return o},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,n){n*=t;var i=Math.floor(n/(r+1)),o=Math.floor(n%(r+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,o>>24,o>>16&255,o>>8&255,255&o,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,n,i){return e.box(e.types.moof,e.mfhd(t),e.traf(i,n))},e.moov=function(t){for(var n=t.length,i=[];n--;)i[n]=e.trak(t[n]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(e.mvex(t)))},e.mvex=function(t){for(var n=t.length,i=[];n--;)i[n]=e.trex(t[n]);return e.box.apply(null,[e.types.mvex].concat(i))},e.mvhd=function(t,n){n*=t;var i=Math.floor(n/(r+1)),o=Math.floor(n%(r+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,o>>24,o>>16&255,o>>8&255,255&o,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)},e.sdtp=function(t){var n=t.samples||[],i=new Uint8Array(4+n.length),r=void 0,o=void 0;for(o=0;o<n.length;o++)r=n[o].flags,i[o+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,i)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var n=[],i=[],r=void 0,o=void 0,a=void 0;for(r=0;r<t.sps.length;r++)o=t.sps[r],a=o.byteLength,n.push(a>>>8&255),n.push(255&a),n=n.concat(Array.prototype.slice.call(o));for(r=0;r<t.pps.length;r++)o=t.pps[r],a=o.byteLength,i.push(a>>>8&255),i.push(255&a),i=i.concat(Array.prototype.slice.call(o));var s=e.box(e.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|t.sps.length].concat(n).concat([t.pps.length]).concat(i))),u=t.width,l=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var n=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var n=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var n=t.id,i=t.duration*t.timescale,o=t.width,a=t.height,s=Math.floor(i/(r+1)),u=Math.floor(i%(r+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,u>>24,u>>16&255,u>>8&255,255&u,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>8&255,255&o,0,0,a>>8&255,255&a,0,0]))},e.traf=function(t,n){var i=e.sdtp(t),o=t.id,a=Math.floor(n/(r+1)),s=Math.floor(n%(r+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,i.length+16+20+8+16+8+8),i)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var n=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,n){var i=t.samples||[],r=i.length,o=12+16*r,a=new Uint8Array(o),s=void 0,u=void 0,l=void 0,c=void 0,d=void 0,h=void 0;for(n+=8+o,a.set([0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0),s=0;s<r;s++)u=i[s],l=u.duration,c=u.size,d=u.flags,h=u.cts,a.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,c>>>24&255,c>>>16&255,c>>>8&255,255&c,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,61440&d.degradPrio,15&d.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*s);return e.box(e.types.trun,a)},e.initSegment=function(t){e.types||e.init();var n=e.moov(t),i=void 0;return i=new Uint8Array(e.FTYP.byteLength+n.byteLength),i.set(e.FTYP),i.set(n,e.FTYP.byteLength),i},e}();t.a=o},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(1),o=function(){function e(t){i(this,e),this.observer=t}return e.prototype.destroy=function(){},e.prototype.resetTimeStamp=function(){},e.prototype.resetInitSegment=function(){},e.prototype.remux=function(e,t,n,i,o,a,s,u){var l=this.observer,c="";e&&(c+="audio"),t&&(c+="video"),l.trigger(r.a.FRAG_PARSING_DATA,{data1:u,startPTS:o,startDTS:o,type:c,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),l.trigger(r.a.FRAG_PARSED)},e}();t.a=o},function(e,t,n){function i(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t.oe=function(e){throw console.error(e),e};var i=t(t.s=ENTRY_MODULE);return i.default||i}function r(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(e,t,i){var o={};o[i]=[];var a=t.toString(),s=a.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return o;for(var c,d=s[1],h=new RegExp("(\\\\n|\\W)"+r(d)+l,"g");c=h.exec(a);)"dll-reference"!==c[3]&&o[i].push(c[3]);for(h=new RegExp("\\("+r(d)+'\\("(dll-reference\\s('+u+'))"\\)\\)'+l,"g");c=h.exec(a);)e[c[2]]||(o[i].push(c[1]),e[c[2]]=n(c[1]).m),o[c[2]]=o[c[2]]||[],o[c[2]].push(c[4]);return o}function a(e){return Object.keys(e).reduce(function(t,n){return t||e[n].length>0},!1)}function s(e,t){for(var n={main:[t]},i={main:[]},r={main:{}};a(n);)for(var s=Object.keys(n),u=0;u<s.length;u++){var l=s[u],c=n[l],d=c.pop();if(r[l]=r[l]||{},!r[l][d]&&e[l][d]){r[l][d]=!0,i[l]=i[l]||[],i[l].push(d);for(var h=o(e,e[l][d],l),f=Object.keys(h),p=0;p<f.length;p++)n[f[p]]=n[f[p]]||[],n[f[p]]=n[f[p]].concat(h[f[p]])}}return i}var u="[\\.|\\-|\\+|\\w|/|@]+",l="\\((/\\*.*?\\*/)?s?.*?("+u+").*?\\)";e.exports=function(e,t){t=t||{};var r={main:n.m},o=t.all?{main:Object.keys(r)}:s(r,e),a="";Object.keys(o).filter(function(e){return"main"!==e}).forEach(function(e){for(var t=0;o[e][t];)t++;o[e].push(t),r[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",a=a+"var "+e+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o[e].map(function(t){return JSON.stringify(t)+": "+r[e][t].toString()}).join(",")+"});\n"}),a=a+"("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o.main.map(function(e){return JSON.stringify(e)+": "+r.main[e].toString()}).join(",")+"})(self);";var u=new window.Blob([a],{type:"text/javascript"});if(t.bare)return u;var l=window.URL||window.webkitURL||window.mozURL||window.msURL,c=l.createObjectURL(u),d=new window.Worker(c);return d.objectURL=c,d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(19),r=n(1),o=n(0),a=n(10),s=n.n(a),u=function(e){var t=new s.a;t.trigger=function(e){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t.emit.apply(t,[e,e].concat(i))},t.off=function(e){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t.removeListener.apply(t,[e].concat(i))};var n=function(t,n){e.postMessage({event:t,data:n})};e.addEventListener("message",function(r){var a=r.data;switch(a.cmd){case"init":var s=JSON.parse(a.config);e.demuxer=new i.a(t,a.typeSupported,s,a.vendor);try{Object(o.a)(!0===s.debug)}catch(e){console.warn("demuxerWorker: unable to enable logs")}n("init",null);break;case"demux":e.demuxer.push(a.data,a.decryptdata,a.initSegment,a.audioCodec,a.videoCodec,a.timeOffset,a.discontinuity,a.trackSwitch,a.contiguous,a.duration,a.accurateTimeOffset,a.defaultInitPTS)}}),t.on(r.a.FRAG_DECRYPTED,n),t.on(r.a.FRAG_PARSING_INIT_SEGMENT,n),t.on(r.a.FRAG_PARSED,n),t.on(r.a.ERROR,n),t.on(r.a.FRAG_PARSING_METADATA,n),t.on(r.a.FRAG_PARSING_USERDATA,n),t.on(r.a.INIT_PTS_FOUND,n),t.on(r.a.FRAG_PARSING_DATA,function(t,n){var i=[],r={event:t,data:n};n.data1&&(r.data1=n.data1.buffer,i.push(n.data1.buffer),delete n.data1),n.data2&&(r.data2=n.data2.buffer,i.push(n.data2.buffer),delete n.data2),e.postMessage(r,i)})};t.default=u},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=n(3),u=n(0),l=n(2),c=n(17),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,a.a.MANIFEST_LOADED,a.a.LEVEL_LOADED,a.a.FRAG_LOADED,a.a.ERROR));return o.canload=!1,o.currentLevelIndex=null,o.manualLevelIndex=-1,o.timer=null,o}return o(t,e),t.prototype.onHandlerDestroying=function(){this.cleanTimer(),this.manualLevelIndex=-1},t.prototype.cleanTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),null!==this.timer&&this.loadLevel()},t.prototype.stopLoad=function(){this.canload=!1},t.prototype.onManifestLoaded=function(e){var t=[],n=void 0,i={},r=null,o=!1,s=!1,d=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),h=[];if(e.levels.forEach(function(e){e.loadError=0,e.fragmentError=!1,o=o||!!e.videoCodec,s=s||!!e.audioCodec||!(!e.attrs||!e.attrs.AUDIO),!0===d&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),r=i[e.bitrate],void 0===r?(e.url=[e.url],e.urlId=0,i[e.bitrate]=e,t.push(e)):r.url.push(e.url)}),!0===o&&!0===s&&(t=t.filter(function(e){return!!e.videoCodec})),t=t.filter(function(e){var t=e.audioCodec,n=e.videoCodec;return(!t||Object(c.a)(t))&&(!n||Object(c.a)(n))}),e.audioTracks&&(h=e.audioTracks.filter(function(e){return!e.audioCodec||Object(c.a)(e.audioCodec,"audio")})),t.length>0){n=t[0].bitrate,t.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=t;for(var f=0;f<t.length;f++)if(t[f].bitrate===n){this._firstLevel=f,u.b.log("manifest loaded,"+t.length+" level(s) found, first bitrate:"+n);break}this.hls.trigger(a.a.MANIFEST_PARSED,{levels:t,audioTracks:h,firstLevel:this._firstLevel,stats:e.stats,audio:s,video:o,altAudio:h.length>0})}else this.hls.trigger(a.a.ERROR,{type:l.b.MEDIA_ERROR,details:l.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},t.prototype.setLevelInternal=function(e){var t=this._levels,n=this.hls;if(e>=0&&e<t.length){if(this.cleanTimer(),this.currentLevelIndex!==e){u.b.log("switching to level "+e),this.currentLevelIndex=e;var i=t[e];i.level=e,n.trigger(a.a.LEVEL_SWITCHING,i)}var r=t[e],o=r.details;if(!o||!0===o.live){var s=r.urlId;n.trigger(a.a.LEVEL_LOADING,{url:r.url[s],level:e,id:s})}}else n.trigger(a.a.ERROR,{type:l.b.OTHER_ERROR,details:l.a.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},t.prototype.onError=function(e){if(!0===e.fatal)return void(e.type===l.b.NETWORK_ERROR&&this.cleanTimer());var t=!1,n=!1,i=void 0;switch(e.details){case l.a.FRAG_LOAD_ERROR:case l.a.FRAG_LOAD_TIMEOUT:case l.a.KEY_LOAD_ERROR:case l.a.KEY_LOAD_TIMEOUT:i=e.frag.level,n=!0;break;case l.a.LEVEL_LOAD_ERROR:case l.a.LEVEL_LOAD_TIMEOUT:i=e.context.level,t=!0;break;case l.a.REMUX_ALLOC_ERROR:i=e.level,t=!0}void 0!==i&&this.recoverLevel(e,i,t,n)},t.prototype.recoverLevel=function(e,t,n,i){var r=this,o=this.hls.config,a=e.details,s=this._levels[t],l=void 0,c=void 0,d=void 0;if(s.loadError++,s.fragmentError=i,!0===n){if(!(this.levelRetryCount+1<=o.levelLoadingMaxRetry))return u.b.error("level controller, cannot recover from "+a+" error"),this.currentLevelIndex=null,this.cleanTimer(),void(e.fatal=!0);c=Math.min(Math.pow(2,this.levelRetryCount)*o.levelLoadingRetryDelay,o.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return r.loadLevel()},c),e.levelRetry=!0,this.levelRetryCount++,u.b.warn("level controller, "+a+", retry in "+c+" ms, current retry count is "+this.levelRetryCount)}!0!==n&&!0!==i||(l=s.url.length,l>1&&s.loadError<l?(u.b.warn("level controller, "+a+" for level "+t+": switching to redundant stream id "+s.urlId),s.urlId=(s.urlId+1)%l,s.details=void 0):-1===this.manualLevelIndex?(d=0===t?this._levels.length-1:t-1,u.b.warn("level controller, "+a+": switch to "+d),this.hls.nextAutoLevel=this.currentLevelIndex=d):!0===i&&(u.b.warn("level controller, "+a+": reload a fragment"),this.currentLevelIndex=null))},t.prototype.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var n=this._levels[t.level];void 0!==n&&(n.fragmentError=!1,n.loadError=0,this.levelRetryCount=0)}},t.prototype.onLevelLoaded=function(e){var t=this,n=e.level;if(n===this.currentLevelIndex){var i=this._levels[n];!1===i.fragmentError&&(i.loadError=0,this.levelRetryCount=0);var r=e.details;if(r.live){var o=1e3*(r.averagetargetduration?r.averagetargetduration:r.targetduration),a=o,s=i.details;s&&r.endSN===s.endSN&&(a/=2,u.b.log("same live playlist, reload twice faster")),a-=performance.now()-e.stats.trequest,a=Math.max(o/2,Math.round(a)),u.b.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout(function(){return t.loadLevel()},a)}else this.cleanTimer()}},t.prototype.loadLevel=function(){var e=void 0,t=void 0;null!==this.currentLevelIndex&&!0===this.canload&&void 0!==(e=this._levels[this.currentLevelIndex])&&e.url.length>0&&(t=e.urlId,this.hls.trigger(a.a.LEVEL_LOADING,{url:e.url[t],level:this.currentLevelIndex,id:t}))},d(t,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}]),t}(s.a);t.a=h},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=n(3),u=n(5),l=n(25),c=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,a.a.MEDIA_ATTACHED,a.a.MEDIA_DETACHING,a.a.FRAG_PARSING_METADATA));return o.id3Track=void 0,o.media=void 0,o}return o(t,e),t.prototype.destroy=function(){s.a.prototype.destroy.call(this)},t.prototype.onMediaAttached=function(e){this.media=e.media,this.media},t.prototype.onMediaDetaching=function(){Object(l.a)(this.id3Track),this.id3Track=void 0,this.media=void 0},t.prototype.getID3Track=function(e){for(var t=0;t<e.length;t++){var n=e[t];if("metadata"===n.kind&&"id3"===n.label)return Object(l.b)(n,this.media),n}return this.media.addTextTrack("metadata","id3")},t.prototype.onFragParsingMetadata=function(e){var t=e.frag,n=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,r=0;r<n.length;r++){var o=u.a.getID3Frames(n[r].data);if(o){var a=n[r].pts,s=r<n.length-1?n[r+1].pts:t.endPTS;a===s&&(s+=1e-4);for(var l=0;l<o.length;l++){var c=o[l];if(!u.a.isTimeStampFrame(c)){var d=new i(a,s,"");d.value=c,this.id3Track.addCue(d)}}}}},t}(s.a);t.a=c},function(e,t,n){"use strict";function i(){var e=Object(r.a)(),t=window.SourceBuffer||window.WebKitSourceBuffer,n=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!n&&!!i}t.a=i;var r=n(11)},function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n(51),r=n(54),o=n(55),a=n(56),s=n(57),u=n(58),l=n(59),c=n(60),d=n(62),h=n(66),f=n(67),p=n(68),g=n(69),m={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:s.a,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:i.a,bufferController:r.a,capLevelController:o.a,fpsController:a.a,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:g.a};m.subtitleStreamController=f.a,m.subtitleTrackController=h.a,m.timelineController=d.a,m.cueHandler=c,m.enableCEA708Captions=!0,m.enableWebVTT=!0,m.captionsTextTrack1Label="English",m.captionsTextTrack1LanguageCode="en",m.captionsTextTrack2Label="Spanish",m.captionsTextTrack2LanguageCode="es",m.audioStreamController=l.a,m.audioTrackController=u.a,m.emeController=p.a},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=n(3),u=n(8),l=n(2),c=n(0),d=n(52),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),f=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,a.a.FRAG_LOADING,a.a.FRAG_LOADED,a.a.FRAG_BUFFERED,a.a.ERROR));return o.lastLoadedFragLevel=0,o._nextAutoLevel=-1,o.hls=n,o.timer=null,o._bwEstimator=null,o.onCheck=o._abandonRulesCheck.bind(o),o}return o(t,e),t.prototype.destroy=function(){this.clearTimer(),s.a.prototype.destroy.call(this)},t.prototype.onFragLoading=function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var n=this.hls,i=e.frag.level,r=n.levels[i].details.live,o=n.config,a=void 0,s=void 0;r?(a=o.abrEwmaFastLive,s=o.abrEwmaSlowLive):(a=o.abrEwmaFastVoD,s=o.abrEwmaSlowVoD),this._bwEstimator=new d.a(n,s,a,o.abrEwmaDefaultEstimate)}this.fragCurrent=t}},t.prototype._abandonRulesCheck=function(){var e=this.hls,t=e.media,n=this.fragCurrent,i=n.loader,r=e.minAutoLevel;if(!i||i.stats&&i.stats.aborted)return c.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var o=i.stats;if(t&&o&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&n.autoLevel&&n.level){var s=performance.now()-o.trequest,l=Math.abs(t.playbackRate);if(s>500*n.duration/l){var d=e.levels,h=Math.max(1,o.bw?o.bw/8:1e3*o.loaded/s),f=d[n.level],p=f.realBitrate?Math.max(f.realBitrate,f.bitrate):f.bitrate,g=o.total?o.total:Math.max(o.loaded,Math.round(n.duration*p/8)),m=t.currentTime,v=(g-o.loaded)/h,y=(u.a.bufferInfo(t,m,e.config.maxBufferHole).end-m)/l;if(y<2*n.duration/l&&v>y){var b=void 0,w=void 0;for(w=n.level-1;w>r;w--){var _=d[w].realBitrate?Math.max(d[w].realBitrate,d[w].bitrate):d[w].bitrate;if((b=n.duration*_/(6.4*h))<y)break}b<v&&(c.b.warn("loading too slow, abort fragment loading and switch to level "+w+":fragLoadedDelay["+w+"]<fragLoadedDelay["+(n.level-1)+"];bufferStarvationDelay:"+b.toFixed(1)+"<"+v.toFixed(1)+":"+y.toFixed(1)),e.nextLoadLevel=w,this._bwEstimator.sample(s,o.loaded),i.abort(),this.clearTimer(),e.trigger(a.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,stats:o}))}}}},t.prototype.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&!isNaN(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var n=this.hls.levels[t.level],i=(n.loaded?n.loaded.bytes:0)+e.stats.loaded,r=(n.loaded?n.loaded.duration:0)+e.frag.duration;n.loaded={bytes:i,duration:r},n.realBitrate=Math.round(8*i/r)}if(e.frag.bitrateTest){var o=e.stats;o.tparsed=o.tbuffered=o.tload,this.onFragBuffered(e)}}},t.prototype.onFragBuffered=function(e){var t=e.stats,n=e.frag;if(!(!0===t.aborted||"main"!==n.type||isNaN(n.sn)||n.bitrateTest&&t.tload!==t.tbuffered)){var i=t.tparsed-t.trequest;c.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(i,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}},t.prototype.onError=function(e){switch(e.details){case l.a.FRAG_LOAD_ERROR:case l.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},t.prototype.clearTimer=function(){clearInterval(this.timer),this.timer=null},t.prototype._findBestLevel=function(e,t,n,i,r,o,a,s,u){for(var l=r;l>=i;l--){var d=u[l],h=d.details,f=h?h.totalduration/h.fragments.length:t,p=!!h&&h.live,g=void 0;g=l<=e?a*n:s*n;var m=u[l].realBitrate?Math.max(u[l].realBitrate,u[l].bitrate):u[l].bitrate,v=m*f/g;if(c.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+l+"/"+Math.round(g)+"/"+m+"/"+f+"/"+o+"/"+v),g>m&&(!v||p&&!this.bitrateTestDelay||v<o))return l}return-1},h(t,[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var n=this._nextABRAutoLevel;return-1!==e&&(n=Math.min(e,n)),n},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,n=e.levels,i=e.config,r=e.minAutoLevel,o=e.media,a=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=o?o.currentTime:0,d=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,h=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,f=(u.a.bufferInfo(o,l,i.maxBufferHole).end-l)/d,p=this._findBestLevel(a,s,h,r,t,f,i.abrBandWidthFactor,i.abrBandWidthUpFactor,n);if(p>=0)return p;c.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var g=s?Math.min(s,i.maxStarvationDelay):i.maxStarvationDelay,m=i.abrBandWidthFactor,v=i.abrBandWidthUpFactor;if(0===f){var y=this.bitrateTestDelay;y&&(g=(s?Math.min(s,i.maxLoadingDelay):i.maxLoadingDelay)-y,c.b.trace("bitrate test took "+Math.round(1e3*y)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*g)+" ms"),m=v=1)}return p=this._findBestLevel(a,s,h,r,t,f+g,m,v,n),Math.max(p,0)}}]),t}(s.a);t.a=f},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(53),o=function(){function e(t,n,o,a){i(this,e),this.hls=t,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new r.a(n),this.fast_=new r.a(o)}return e.prototype.sample=function(e,t){e=Math.max(e,this.minDelayMs_);var n=8e3*t/e,i=e/1e3;this.fast_.sample(i,n),this.slow_.sample(i,n)},e.prototype.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},e.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.prototype.destroy=function(){},e}();t.a=o},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(t){i(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return e.prototype.sample=function(e,t){var n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e},e.prototype.getTotalWeight=function(){return this.totalWeight_},e.prototype.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}();t.a=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=n(3),u=n(0),l=n(2),c=n(11),d=Object(c.a)(),h=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,a.a.MEDIA_ATTACHING,a.a.MEDIA_DETACHING,a.a.MANIFEST_PARSED,a.a.BUFFER_RESET,a.a.BUFFER_APPENDING,a.a.BUFFER_CODECS,a.a.BUFFER_EOS,a.a.BUFFER_FLUSHING,a.a.LEVEL_PTS_UPDATED,a.a.LEVEL_UPDATED));return o._msDuration=null,o._levelDuration=null,o._live=null,o._objectUrl=null,o.onsbue=o.onSBUpdateEnd.bind(o),o.onsbe=o.onSBUpdateError.bind(o),o.pendingTracks={},o.tracks={},o}return o(t,e),t.prototype.destroy=function(){s.a.prototype.destroy.call(this)},t.prototype.onLevelPtsUpdated=function(e){var t=e.type,n=this.tracks.audio;if("audio"===t&&n&&"audio/mpeg"===n.container){var i=this.sourceBuffer.audio;if(Math.abs(i.timestampOffset-e.start)>.1){var r=i.updating;try{i.abort()}catch(e){r=!0,u.b.warn("can not abort audio buffer: "+e)}r?this.audioTimestampOffset=e.start:(u.b.warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+e.start),i.timestampOffset=e.start)}}},t.prototype.onManifestParsed=function(e){var t=e.audio,n=e.video||e.levels.length&&e.audio,i=0;e.altAudio&&(t||n)&&(i=(t?1:0)+(n?1:0),u.b.log(i+" sourceBuffer(s) expected")),this.sourceBufferNb=i},
t.prototype.onMediaAttaching=function(e){var t=this.media=e.media;if(t){var n=this.mediaSource=new d;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),n.addEventListener("sourceopen",this.onmso),n.addEventListener("sourceended",this.onmse),n.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(n),this._objectUrl=t.src}},t.prototype.onMediaDetaching=function(){u.b.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){u.b.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):u.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(a.a.MEDIA_DETACHED)},t.prototype.onMediaSourceOpen=function(){u.b.log("media source opened"),this.hls.trigger(a.a.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()},t.prototype.checkPendingTracks=function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())},t.prototype.onMediaSourceClose=function(){u.b.log("media source closed")},t.prototype.onMediaSourceEnded=function(){u.b.log("media source ended")},t.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;u.b.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,n=this.segments.reduce(function(e,n){return n.parent===t?e+1:e},0),i={},r=this.sourceBuffer;for(var o in r)i[o]=r[o].buffered;this.hls.trigger(a.a.BUFFER_APPENDED,{parent:t,pending:n,timeRanges:i}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()},t.prototype.onSBUpdateError=function(e){u.b.error("sourceBuffer error:",e),this.hls.trigger(a.a.ERROR,{type:l.b.MEDIA_ERROR,details:l.a.BUFFER_APPENDING_ERROR,fatal:!1})},t.prototype.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var n=e[t];try{this.mediaSource.removeSourceBuffer(n),n.removeEventListener("updateend",this.onsbue),n.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},t.prototype.onBufferCodecs=function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var n=this.mediaSource;n&&"open"===n.readyState&&this.checkPendingTracks()}},t.prototype.createSourceBuffers=function(e){var t=this.sourceBuffer,n=this.mediaSource;for(var i in e)if(!t[i]){var r=e[i],o=r.levelCodec||r.codec,s=r.container+";codecs="+o;u.b.log("creating sourceBuffer("+s+")");try{var c=t[i]=n.addSourceBuffer(s);c.addEventListener("updateend",this.onsbue),c.addEventListener("error",this.onsbe),this.tracks[i]={codec:o,container:r.container},r.buffer=c}catch(e){u.b.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(a.a.ERROR,{type:l.b.MEDIA_ERROR,details:l.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:s})}}this.hls.trigger(a.a.BUFFER_CREATED,{tracks:e})},t.prototype.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},t.prototype.onBufferAppendFail=function(e){u.b.error("sourceBuffer error:",e.event),this.hls.trigger(a.a.ERROR,{type:l.b.MEDIA_ERROR,details:l.a.BUFFER_APPENDING_ERROR,fatal:!1})},t.prototype.onBufferEos=function(e){var t=this.sourceBuffer,n=e.type;for(var i in t)n&&i!==n||t[i].ended||(t[i].ended=!0,u.b.log(i+" sourceBuffer now EOS"));this.checkEos()},t.prototype.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(!t||"open"!==t.readyState)return void(this._needsEos=!1);for(var n in e){var i=e[n];if(!i.ended)return;if(i.updating)return void(this._needsEos=!0)}u.b.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){u.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1},t.prototype.onBufferFlushing=function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()},t.prototype.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._live=t.live,this.updateMediaElementDuration())},t.prototype.updateMediaElementDuration=function(){var e=this.hls.config,t=void 0;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var n in this.sourceBuffer)if(!0===this.sourceBuffer[n].updating)return;t=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===e.liveDurationInfinity?(u.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>t||t===1/0||isNaN(t))&&(u.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},t.prototype.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,n=this.sourceBuffer;try{for(var i in n)t+=n[i].buffered.length}catch(e){u.b.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(a.a.BUFFER_FLUSHED)}},t.prototype.doAppending=function(){var e=this.hls,t=this.sourceBuffer,n=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void u.b.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(n&&n.length){var i=n.shift();try{var r=i.type,o=t[r];o?o.updating?n.unshift(i):(o.ended=!1,this.parent=i.parent,o.appendBuffer(i.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){u.b.error("error while trying to append buffer:"+t.message),n.unshift(i);var s={type:l.b.MEDIA_ERROR,parent:i.parent};22!==t.code?(this.appendError?this.appendError++:this.appendError=1,s.details=l.a.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry?(u.b.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),n=[],s.fatal=!0,e.trigger(a.a.ERROR,s)):(s.fatal=!1,e.trigger(a.a.ERROR,s))):(this.segments=[],s.details=l.a.BUFFER_FULL_ERROR,s.fatal=!1,e.trigger(a.a.ERROR,s))}}}},t.prototype.flushBuffer=function(e,t,n){var i=void 0,r=void 0,o=void 0,a=void 0,s=void 0,l=void 0,c=this.sourceBuffer;if(Object.keys(c).length){if(u.b.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var d in c)if(!n||d===n){if(i=c[d],i.ended=!1,i.updating)return u.b.warn("cannot flush, sb updating in progress"),!1;try{for(r=0;r<i.buffered.length;r++)if(o=i.buffered.start(r),a=i.buffered.end(r),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(s=e,l=t):(s=Math.max(o,e),l=Math.min(a,t)),Math.min(l,a)-s>.5)return this.flushBufferCounter++,u.b.log("flush "+d+" ["+s+","+l+"], of ["+o+","+a+"], pos:"+this.media.currentTime),i.remove(s,l),!1}catch(e){u.b.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else u.b.warn("abort flushing too many retries");u.b.log("buffer flushed")}return!0},t}(s.a);t.a=h},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=n(3),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(e){function t(n){return i(this,t),r(this,e.call(this,n,a.a.FPS_DROP_LEVEL_CAPPING,a.a.MEDIA_ATTACHING,a.a.MANIFEST_PARSED))}return o(t,e),t.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))},t.prototype.onFpsDropLevelCapping=function(e){t.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},t.prototype.onMediaAttaching=function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null},t.prototype.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],t.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,t.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},t.prototype.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},t.prototype.getMaxLevel=function(e){var n=this;if(!this.levels)return-1;var i=this.levels.filter(function(i,r){return t.isLevelAllowed(r,n.restrictedLevels)&&r<=e});return t.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},t.isLevelAllowed=function(e){return-1===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).indexOf(e)},t.getMaxLevelByMediaSize=function(e,t,n){if(!e||e&&!e.length)return-1;for(var i=e.length-1,r=0;r<e.length;r+=1){var o=e[r];if((o.width>=t||o.height>=n)&&function(e,t){return!t||e.width!==t.width||e.height!==t.height}(o,e[r+1])){i=r;break}}return i},u(t,[{key:"mediaWidth",get:function(){var e=void 0,n=this.media;return n&&(e=n.width||n.clientWidth||n.offsetWidth,e*=t.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,n=this.media;return n&&(e=n.height||n.clientHeight||n.offsetHeight,e*=t.contentScaleFactor),e}}],[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}]),t}(s.a);t.a=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=n(3),u=n(0),l=function(e){function t(n){return i(this,t),r(this,e.call(this,n,a.a.MEDIA_ATTACHING))}return o(t,e),t.prototype.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},t.prototype.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},t.prototype.checkFPS=function(e,t,n){var i=performance.now();if(t){if(this.lastTime){var r=i-this.lastTime,o=n-this.lastDroppedFrames,s=t-this.lastDecodedFrames,l=1e3*o/r,c=this.hls;if(c.trigger(a.a.FPS_DROP,{currentDropped:o,currentDecoded:s,totalDroppedFrames:n}),l>0&&o>c.config.fpsDroppedMonitoringThreshold*s){var d=c.currentLevel;u.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=d)&&(d-=1,c.trigger(a.a.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:c.currentLevel}),c.autoLevelCapping=d,c.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}},t.prototype.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},t}(s.a);t.a=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(0),o=function(){function e(t){i(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return e.prototype.destroy=function(){this.abort(),this.loader=null},e.prototype.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.prototype.load=function(e,t,n){this.context=e,this.config=t,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},e.prototype.loadInternal=function(){var e=void 0,t=this.context;e=this.loader=new XMLHttpRequest;var n=this.stats;n.tfirst=0,n.loaded=0;var i=this.xhrSetup;try{if(i)try{i(e,t.url)}catch(n){e.open("GET",t.url,!0),i(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(n){return void this.callbacks.onError({code:e.status,text:n.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},e.prototype.readystatechange=function(e){var t=e.currentTarget,n=t.readyState,i=this.stats,o=this.context,a=this.config;if(!i.aborted&&n>=2)if(window.clearTimeout(this.requestTimeout),0===i.tfirst&&(i.tfirst=Math.max(performance.now(),i.trequest)),4===n){var s=t.status;if(s>=200&&s<300){i.tload=Math.max(i.tfirst,performance.now());var u=void 0,l=void 0;"arraybuffer"===o.responseType?(u=t.response,l=u.byteLength):(u=t.responseText,l=u.length),i.loaded=i.total=l;var c={url:t.responseURL,data:u};this.callbacks.onSuccess(c,i,o,t)}else i.retry>=a.maxRetry||s>=400&&s<499?(r.b.error(s+" while loading "+o.url),this.callbacks.onError({code:s,text:t.statusText},o,t)):(r.b.warn(s+" while loading "+o.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),i.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},e.prototype.loadtimeout=function(){r.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},e.prototype.loadprogress=function(e){var t=e.currentTarget,n=this.stats;n.loaded=e.loaded,e.lengthComputable&&(n.total=e.total);var i=this.callbacks.onProgress;i&&i(n,this.context,null,t)},e}();t.a=o},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=n(3),u=n(0),l=n(2),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,a.a.MANIFEST_LOADING,a.a.MANIFEST_PARSED,a.a.AUDIO_TRACK_LOADED,a.a.ERROR));return o.ticks=0,o.ontick=o.tick.bind(o),o}return o(t,e),t.prototype.destroy=function(){this.cleanTimer(),s.a.prototype.destroy.call(this)},t.prototype.cleanTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.tick=function(){1==++this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)},t.prototype.doTick=function(){this.updateTrack(this.trackId)},t.prototype.onError=function(e){e.fatal&&e.type===l.b.NETWORK_ERROR&&this.cleanTimer()},t.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},t.prototype.onManifestParsed=function(e){var t=this,n=e.audioTracks||[],i=!1;this.tracks=n,this.hls.trigger(a.a.AUDIO_TRACKS_UPDATED,{audioTracks:n});var r=0;n.forEach(function(e){if(e.default&&!i)return t.audioTrack=r,void(i=!0);r++}),!1===i&&n.length&&(u.b.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)},t.prototype.onAudioTrackLoaded=function(e){e.id<this.tracks.length&&(u.b.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*e.details.targetduration)),!e.details.live&&this.timer&&this.cleanTimer())},t.prototype.setAudioTrackInternal=function(e){if(e>=0&&e<this.tracks.length){this.cleanTimer(),this.trackId=e,u.b.log("switching to audioTrack "+e);var t=this.tracks[e],n=this.hls,i=t.type,r=t.url,o={id:e,type:i,url:r};n.trigger(a.a.AUDIO_TRACK_SWITCHING,o);var s=t.details;!r||void 0!==s&&!0!==s.live||(u.b.log("(re)loading playlist for audioTrack "+e),n.trigger(a.a.AUDIO_TRACK_LOADING,{url:r,id:e}))}},t.prototype.updateTrack=function(e){if(e>=0&&e<this.tracks.length){this.cleanTimer(),this.trackId=e,u.b.log("updating audioTrack "+e);var t=this.tracks[e],n=t.url,i=t.details;!n||void 0!==i&&!0!==i.live||(u.b.log("(re)loading playlist for audioTrack "+e),this.hls.trigger(a.a.AUDIO_TRACK_LOADING,{url:n,id:e}))}},c(t,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.trackId===e&&void 0!==this.tracks[e].details||this.setAudioTrackInternal(e)}}]),t}(s.a);t.a=d},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(7),s=n(8),u=n(18),l=n(1),c=n(22),d=n(23),h=n(2),f=n(0),p=n(24),g=n(13),m=n(12),v=n(6),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),b={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},w=function(e){function t(n,o){i(this,t);var a=r(this,e.call(this,n,l.a.MEDIA_ATTACHED,l.a.MEDIA_DETACHING,l.a.AUDIO_TRACKS_UPDATED,l.a.AUDIO_TRACK_SWITCHING,l.a.AUDIO_TRACK_LOADED,l.a.KEY_LOADED,l.a.FRAG_LOADED,l.a.FRAG_PARSING_INIT_SEGMENT,l.a.FRAG_PARSING_DATA,l.a.FRAG_PARSED,l.a.ERROR,l.a.BUFFER_RESET,l.a.BUFFER_CREATED,l.a.BUFFER_APPENDED,l.a.BUFFER_FLUSHED,l.a.INIT_PTS_FOUND));return a.fragmentTracker=o,a.config=n.config,a.audioCodecSwap=!1,a._state=b.STOPPED,a.initPTS=[],a.waitingFragment=null,a.videoTrackCC=null,a}return o(t,e),t.prototype.onHandlerDestroying=function(){this.stopLoad()},t.prototype.onHandlerDestroyed=function(){this.state=b.STOPPED,this.fragmentTracker=null},t.prototype.onInitPtsFound=function(e){var t=e.id,n=e.frag.cc,i=e.initPTS;"main"===t&&(this.initPTS[n]=i,this.videoTrackCC=n,f.b.log("InitPTS for cc: "+n+" found from video track: "+i),this.state===b.WAITING_INIT_PTS&&this.tick())},t.prototype.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(f.b.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=b.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=b.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=b.STOPPED},t.prototype.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=b.STOPPED},t.prototype.doTick=function(){var e=void 0,t=void 0,n=void 0,i=this.hls,r=i.config;switch(this.state){case b.ERROR:case b.PAUSED:case b.BUFFER_FLUSHING:break;case b.STARTING:this.state=b.WAITING_TRACK,this.loadedmetadata=!1;break;case b.IDLE:var o=this.tracks;if(!o)break;if(!this.media&&(this.startFragRequested||!r.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var u=this.mediaBuffer?this.mediaBuffer:this.media,c=this.videoBuffer?this.videoBuffer:this.media,d=s.a.bufferInfo(u,e,r.maxBufferHole),h=s.a.bufferInfo(c,e,r.maxBufferHole),g=d.len,v=d.end,y=this.fragPrevious,w=Math.min(r.maxBufferLength,r.maxMaxBufferLength),_=Math.max(w,h.len),E=this.audioSwitch,S=this.trackId;if((g<_||E)&&S<o.length){if(void 0===(n=o[S].details)){this.state=b.WAITING_TRACK;break}if(!E&&!n.live&&y&&y.sn===n.endSN&&!d.nextStart&&(!this.media.seeking||this.media.duration-v<y.duration/2)){this.hls.trigger(l.a.BUFFER_EOS,{type:"audio"}),this.state=b.ENDED;break}var T=n.fragments,P=T.length,A=T[0].start,I=T[P-1].start+T[P-1].duration,x=void 0;if(E)if(n.live&&!n.PTSKnown)f.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),v=0;else if(v=e,n.PTSKnown&&e<A){if(!(d.end>A||d.nextStart))return;f.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=A+.05}if(n.initSegment&&!n.initSegment.data)x=n.initSegment;else if(v<=A){if(x=T[0],null!==this.videoTrackCC&&x.cc!==this.videoTrackCC&&(x=Object(p.b)(T,this.videoTrackCC)),n.live&&x.loadIdx&&x.loadIdx===this.fragLoadIdx){var O=d.nextStart?d.nextStart:A;return f.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(O+.05)),void(this.media.currentTime=O+.05)}}else{var C=void 0,R=r.maxFragLookUpTolerance,L=y?T[y.sn-T[0].sn+1]:void 0,k=function(e){var t=Math.min(R,e.duration);return e.start+e.duration-t<=v?1:e.start-t>v&&e.start?-1:0};v<I?(v>I-R&&(R=0),C=L&&!k(L)?L:a.a.search(T,k)):C=T[P-1],C&&(x=C,A=C.start,y&&x.level===y.level&&x.sn===y.sn&&(x.sn<n.endSN?(x=T[x.sn+1-n.startSN],f.b.log("SN just loaded, load next one: "+x.sn)):x=null))}x&&(x.decryptdata&&null!=x.decryptdata.uri&&null==x.decryptdata.key?(f.b.log("Loading key for "+x.sn+" of ["+n.startSN+" ,"+n.endSN+"],track "+S),this.state=b.KEY_LOADING,i.trigger(l.a.KEY_LOADING,{frag:x})):(f.b.log("Loading "+x.sn+", cc: "+x.cc+" of ["+n.startSN+" ,"+n.endSN+"],track "+S+", currentTime:"+e+",bufferEnd:"+v.toFixed(3)),this.fragmentTracker.getState(x)===m.a.NOT_LOADED&&(this.fragCurrent=x,this.startFragRequested=!0,isNaN(x.sn)||(this.nextLoadPosition=x.start+x.duration),i.trigger(l.a.FRAG_LOADING,{frag:x}),this.state=b.FRAG_LOADING)))}break;case b.WAITING_TRACK:(t=this.tracks[this.trackId])&&t.details&&(this.state=b.IDLE);break;case b.FRAG_LOADING_WAITING_RETRY:var M=performance.now(),D=this.retryDate;u=this.media;var N=u&&u.seeking;(!D||M>=D||N)&&(f.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=b.IDLE);break;case b.WAITING_INIT_PTS:var F=this.videoTrackCC;if(void 0===this.initPTS[F])break;var V=this.waitingFragment;if(V){var U=V.frag.cc;F!==U?(t=this.tracks[this.trackId],t.details&&t.details.live&&(f.b.warn("Waiting fragment CC ("+U+") does not match video track CC ("+F+")"),this.waitingFragment=null,this.state=b.IDLE)):(this.state=b.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=b.IDLE;break;case b.STOPPED:case b.FRAG_LOADING:case b.PARSING:case b.PARSED:case b.ENDED:}},t.prototype.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var n=this.config;this.tracks&&n.autoStartLoad&&this.startLoad(n.startPosition)},t.prototype.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(f.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.stopLoad()},t.prototype.onMediaSeeking=function(){this.state===b.ENDED&&(this.state=b.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),this.tick()},t.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},t.prototype.onAudioTracksUpdated=function(e){f.b.log("audio tracks updated"),this.tracks=e.audioTracks},t.prototype.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=b.PAUSED,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=b.IDLE),this.tick()},t.prototype.onAudioTrackLoaded=function(e){var t=e.details,n=e.id,i=this.tracks[n],r=t.totalduration,o=0;if(f.b.log("track "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+r),t.live){var a=i.details;a&&t.fragments.length>0?(c.a(a,t),o=t.fragments[0].start,t.PTSKnown?f.b.log("live audio playlist sliding:"+o.toFixed(3)):f.b.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,f.b.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(i.details=t,!this.startFragRequested){if(-1===this.startPosition){var s=t.startTimeOffset;isNaN(s)?this.startPosition=0:(f.b.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s)}this.nextLoadPosition=this.startPosition}this.state===b.WAITING_TRACK&&(this.state=b.IDLE),this.tick()},t.prototype.onKeyLoaded=function(){this.state===b.KEY_LOADING&&(this.state=b.IDLE,this.tick())},t.prototype.onFragLoaded=function(e){var t=this.fragCurrent,n=e.frag;if(this.state===b.FRAG_LOADING&&t&&"audio"===n.type&&n.level===t.level&&n.sn===t.sn){var i=this.tracks[this.trackId],r=i.details,o=r.totalduration,a=t.level,s=t.sn,c=t.cc,d=this.config.defaultAudioCodec||i.audioCodec||"mp4a.40.2",h=this.stats=e.stats;if("initSegment"===s)this.state=b.IDLE,h.tparsed=h.tbuffered=performance.now(),r.initSegment.data=e.payload,this.hls.trigger(l.a.FRAG_BUFFERED,{stats:h,frag:t,id:"audio"}),this.tick();else{this.state=b.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new u.a(this.hls,"audio"));var p=this.initPTS[c],g=r.initSegment?r.initSegment.data:[];r.initSegment||void 0!==p?(this.pendingBuffering=!0,f.b.log("Demuxing "+s+" of ["+r.startSN+" ,"+r.endSN+"],track "+a),this.demuxer.push(e.payload,g,d,null,t,o,!1,p)):(f.b.log("unknown video PTS for continuity counter "+c+", waiting for video PTS before demuxing audio frag "+s+" of ["+r.startSN+" ,"+r.endSN+"],track "+a),this.waitingFragment=e,this.state=b.WAITING_INIT_PTS)}}this.fragLoadError=0},t.prototype.onFragParsingInitSegment=function(e){var t=this.fragCurrent,n=e.frag;if(t&&"audio"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===b.PARSING){var i=e.tracks,r=void 0;if(i.video&&delete i.video,r=i.audio){r.levelCodec=r.codec,r.id=e.id,this.hls.trigger(l.a.BUFFER_CODECS,i),f.b.log("audio track:audio,container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var o=r.initSegment;if(o){var a={type:"audio",data:o,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[a]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(l.a.BUFFER_APPENDING,a))}this.tick()}}},t.prototype.onFragParsingData=function(e){var t=this,n=this.fragCurrent,i=e.frag;if(n&&"audio"===e.id&&"audio"===e.type&&i.sn===n.sn&&i.level===n.level&&this.state===b.PARSING){var r=this.trackId,o=this.tracks[r],a=this.hls;isNaN(e.endPTS)&&(e.endPTS=e.startPTS+n.duration,e.endDTS=e.startDTS+n.duration),n.addElementaryStream(v.a.ElementaryStreamTypes.AUDIO),f.b.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),c.b(o.details,n,e.startPTS,e.endPTS);var s=this.audioSwitch,u=this.media,d=!1;if(s&&u)if(u.readyState){var p=u.currentTime;f.b.log("switching audio track : currentTime:"+p),p>=e.startPTS&&(f.b.log("switching audio track : flushing all audio"),this.state=b.BUFFER_FLUSHING,a.trigger(l.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),d=!0,this.audioSwitch=!1,a.trigger(l.a.AUDIO_TRACK_SWITCHED,{id:r}))}else this.audioSwitch=!1,a.trigger(l.a.AUDIO_TRACK_SWITCHED,{id:r});var g=this.pendingData;if(!g)return console.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void a.trigger(l.a.ERROR,{type:h.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([e.data1,e.data2].forEach(function(t){t&&t.length&&g.push({type:e.type,data:t,parent:"audio",content:"data"})}),!d&&g.length&&(g.forEach(function(e){t.state===b.PARSING&&(t.pendingBuffering=!0,t.hls.trigger(l.a.BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}},t.prototype.onFragParsed=function(e){var t=this.fragCurrent,n=e.frag;t&&"audio"===e.id&&n.sn===t.sn&&n.level===t.level&&this.state===b.PARSING&&(this.stats.tparsed=performance.now(),this.state=b.PARSED,this._checkAppendedParsed())},t.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},t.prototype.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},t.prototype.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==b.PARSING&&t!==b.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},
t.prototype._checkAppendedParsed=function(){if(!(this.state!==b.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,n=this.hls;if(e){this.fragPrevious=e,t.tbuffered=performance.now(),n.trigger(l.a.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var i=this.mediaBuffer?this.mediaBuffer:this.media;f.b.log("audio buffered : "+d.a.toString(i.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,n.trigger(l.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=b.IDLE}this.tick()}},t.prototype.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case h.a.FRAG_LOAD_ERROR:case h.a.FRAG_LOAD_TIMEOUT:if(!e.fatal){var n=this.fragLoadError;n?n++:n=1;var i=this.config;if(n<=i.fragLoadingMaxRetry){this.fragLoadError=n;var r=Math.min(Math.pow(2,n-1)*i.fragLoadingRetryDelay,i.fragLoadingMaxRetryTimeout);f.b.warn("audioStreamController: frag loading failed, retry in "+r+" ms"),this.retryDate=performance.now()+r,this.state=b.FRAG_LOADING_WAITING_RETRY}else f.b.error("audioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=b.ERROR}break;case h.a.AUDIO_TRACK_LOAD_ERROR:case h.a.AUDIO_TRACK_LOAD_TIMEOUT:case h.a.KEY_LOAD_ERROR:case h.a.KEY_LOAD_TIMEOUT:this.state!==b.ERROR&&(this.state=e.fatal?b.ERROR:b.IDLE,f.b.warn("audioStreamController: "+e.details+" while loading frag,switch to "+this.state+" state ..."));break;case h.a.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===b.PARSING||this.state===b.PARSED)){var o=this.mediaBuffer,a=this.media.currentTime;if(o&&s.a.isBuffered(o,a)&&s.a.isBuffered(o,a+.5)){var u=this.config;u.maxMaxBufferLength>=u.maxBufferLength&&(u.maxMaxBufferLength/=2,f.b.warn("audio:reduce max buffer length to "+u.maxMaxBufferLength+"s")),this.state=b.IDLE}else f.b.warn("buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=b.BUFFER_FLUSHING,this.hls.trigger(l.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},t.prototype.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(f.b.log("appending pending audio data on Buffer Flushed"),t.forEach(function(t){e.hls.trigger(l.a.BUFFER_APPENDING,t)}),this.appended=!0,this.pendingData=[],this.state=b.PARSED):(this.state=b.IDLE,this.fragPrevious=null,this.tick())},y(t,[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,f.b.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}]),t}(g.a);t.a=w},function(e,t,n){"use strict";function i(e,t,n,i){for(var o=void 0,a=void 0,s=void 0,u=void 0,l=void 0,c=window.VTTCue||window.TextTrackCue,d=0;d<i.rows.length;d++)if(o=i.rows[d],s=!0,u=0,l="",!o.isEmpty()){for(var h=0;h<o.chars.length;h++)o.chars[h].uchar.match(/\s/)&&s?u++:(l+=o.chars[h].uchar,s=!1);o.cueStartTime=t,t===n&&(n+=1e-4),a=new c(t,n,Object(r.b)(l.trim())),u>=16?u--:u++,navigator.userAgent.match(/Firefox\//)?a.line=d+1:a.line=d>7?d-2:d+1,a.align="left",a.position=Math.max(0,Math.min(100,u/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(a)}}Object.defineProperty(t,"__esModule",{value:!0}),t.newCue=i;var r=n(26)},function(e,t,n){"use strict";t.a=function(){function e(e){return"string"==typeof e&&!!o[e.toLowerCase()]&&e.toLowerCase()}function t(e){return"string"==typeof e&&!!a[e.toLowerCase()]&&e.toLowerCase()}function n(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}function i(i,o,a){var s=this,u=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),l={};u?s=document.createElement("custom"):l.enumerable=!0,s.hasBeenReset=!1;var c="",d=!1,h=i,f=o,p=a,g=null,m="",v=!0,y="auto",b="start",w=50,_="middle",E=50,S="middle";if(Object.defineProperty(s,"id",n({},l,{get:function(){return c},set:function(e){c=""+e}})),Object.defineProperty(s,"pauseOnExit",n({},l,{get:function(){return d},set:function(e){d=!!e}})),Object.defineProperty(s,"startTime",n({},l,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",n({},l,{get:function(){return f},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",n({},l,{get:function(){return p},set:function(e){p=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",n({},l,{get:function(){return g},set:function(e){g=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",n({},l,{get:function(){return m},set:function(t){var n=e(t);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");m=n,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",n({},l,{get:function(){return v},set:function(e){v=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",n({},l,{get:function(){return y},set:function(e){if("number"!=typeof e&&e!==r)throw new SyntaxError("An invalid number or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",n({},l,{get:function(){return b},set:function(e){var n=t(e);if(!n)throw new SyntaxError("An invalid or illegal string was specified.");b=n,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",n({},l,{get:function(){return w},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");w=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",n({},l,{get:function(){return _},set:function(e){var n=t(e);if(!n)throw new SyntaxError("An invalid or illegal string was specified.");_=n,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",n({},l,{get:function(){return E},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",n({},l,{get:function(){return S},set:function(e){var n=t(e);if(!n)throw new SyntaxError("An invalid or illegal string was specified.");S=n,this.hasBeenReset=!0}})),s.displayState=void 0,u)return s}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var r="auto",o={"":!0,lr:!0,rl:!0},a={start:!0,middle:!0,end:!0,left:!0,right:!0};return i.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},i}()},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}function s(e,t,n,i){return Math.min(t,i)-Math.max(e,n)}var u=n(1),l=n(3),c=n(63),d=n(64),h=n(65),f=n(0),p=n(25),g=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,u.a.MEDIA_ATTACHING,u.a.MEDIA_DETACHING,u.a.FRAG_PARSING_USERDATA,u.a.FRAG_DECRYPTED,u.a.MANIFEST_LOADING,u.a.MANIFEST_LOADED,u.a.FRAG_LOADED,u.a.LEVEL_SWITCHING,u.a.INIT_PTS_FOUND));if(o.hls=n,o.config=n.config,o.enabled=!0,o.Cues=n.config.cueHandler,o.textTracks=[],o.tracks=[],o.unparsedVttFrags=[],o.initPTS=void 0,o.cueRanges=[],o.config.enableCEA708Captions){var a=new d.a(o,1),s=new d.a(o,2);o.cea608Parser=new c.a(0,a,s)}return o}return o(t,e),t.prototype.addCues=function(e,t,n,i){for(var r=this.cueRanges,o=!1,a=r.length;a--;){var u=r[a],l=s(u[0],u[1],t,n);if(l>=0&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],n),o=!0,l/(n-t)>.5))return}o||r.push([t,n]),this.Cues.newCue(this[e],t,n,i)},t.prototype.onInitPtsFound=function(e){var t=this;void 0===this.initPTS&&(this.initPTS=e.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(e){t.onFragLoaded(e)}),this.unparsedVttFrags=[])},t.prototype.getExistingTrack=function(e){var t=this.media;if(t)for(var n=0;n<t.textTracks.length;n++){var i=t.textTracks[n],r="textTrack"+e;if(!0===i[r])return i}return null},t.prototype.createCaptionsTrack=function(e){var t="textTrack"+e;if(!this[t]){var n=this.getExistingTrack(e);if(n)this[t]=n,Object(p.a)(this[t]),Object(p.b)(this[t],this.media);else{var i=this.createTextTrack("captions",this.config["captionsTextTrack"+e+"Label"],this.config["captionsTextTrack"+e+"LanguageCode"]);i&&(i[t]=!0,this[t]=i)}}},t.prototype.createTextTrack=function(e,t,n){var i=this.media;if(i)return i.addTextTrack(e,t,n)},t.prototype.destroy=function(){l.a.prototype.destroy.call(this)},t.prototype.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},t.prototype.onMediaDetaching=function(){Object(p.a)(this.textTrack1),Object(p.a)(this.textTrack2)},t.prototype.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0},this._cleanTracks()},t.prototype._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var n=0;n<t.length;n++)Object(p.a)(t[n])}},t.prototype.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var n=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,i){var r=void 0;if(i<n.length){var o=n[i];a(o,e)&&(r=o)}r||(r=t.createTextTrack("subtitles",e.name,e.lang)),e.default?r.mode=t.hls.subtitleDisplay?"showing":"hidden":r.mode="disabled",t.textTracks.push(r)})}},t.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},t.prototype.onFragLoaded=function(e){var t=e.frag,n=e.payload;if("main"===t.type){var i=t.sn;if(i!==this.lastSn+1){var r=this.cea608Parser;r&&r.reset()}this.lastSn=i}else if("subtitle"===t.type)if(n.byteLength){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(e);var o=t.decryptdata;null!=o&&null!=o.key&&"AES-128"===o.method||this._parseVTTs(t,n)}else this.hls.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},t.prototype._parseVTTs=function(e,t){var n=this.vttCCs;n[e.cc]||(n[e.cc]={start:e.start,prevCC:this.prevCC,new:!0},this.prevCC=e.cc);var i=this.textTracks,r=this.hls;h.a.parse(t,this.initPTS,n,e.cc,function(t){var n=i[e.trackId];if("disabled"===n.mode)return void r.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e});t.forEach(function(e){if(!n.cues.getCueById(e.id))try{n.addCue(e)}catch(i){var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,n.addCue(t)}}),r.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(t){f.b.log("Failed to parse VTT cue: "+t),r.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})})},t.prototype.onFragDecrypted=function(e){var t=e.payload,n=e.frag;if("subtitle"===n.type){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(e);this._parseVTTs(n,t)}},t.prototype.onFragParsingUserdata=function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var n=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,n)}},t.prototype.extractCea608Data=function(e){for(var t=31&e[0],n=2,i=void 0,r=void 0,o=void 0,a=void 0,s=void 0,u=[],l=0;l<t;l++)i=e[n++],r=127&e[n++],o=127&e[n++],a=0!=(4&i),s=3&i,0===r&&0===o||a&&0===s&&(u.push(r),u.push(o));return u},t}(l.a);t.a=g},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},o=function(e){var t=e;return r.hasOwnProperty(e)&&(t=r[e]),String.fromCharCode(t)},a=15,s=100,u={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},l={17:2,18:4,21:6,22:8,23:10,19:13,20:15},c={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},d={25:2,26:4,29:6,30:8,31:10,27:13,28:15},h=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],f={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},p=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},g=function(){function e(t,n,r,o,a){i(this,e),this.foreground=t||"white",this.underline=n||!1,this.italics=r||!1,this.background=o||"black",this.flash=a||!1}return e.prototype.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},e.prototype.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}},e.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},e.prototype.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},e.prototype.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},e.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),m=function(){function e(t,n,r,o,a,s){i(this,e),this.uchar=t||" ",this.penState=new g(n,r,o,a,s)}return e.prototype.reset=function(){this.uchar=" ",this.penState.reset()},e.prototype.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},e.prototype.setPenState=function(e){this.penState.copy(e)},e.prototype.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},e.prototype.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},e.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),v=function(){function e(){i(this,e),this.chars=[];for(var t=0;t<s;t++)this.chars.push(new m);this.pos=0,this.currPenState=new g}return e.prototype.equals=function(e){for(var t=!0,n=0;n<s;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<s;t++)this.chars[t].copy(e.chars[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<s;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},e.prototype.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(f.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>s&&(f.log("ERROR","Too large cursor position "+this.pos),this.pos=s)},e.prototype.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},e.prototype.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.prototype.insertChar=function(e){e>=144&&this.backSpace();var t=o(e);if(this.pos>=s)return void f.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)},e.prototype.clearFromPos=function(e){var t=void 0;for(t=e;t<s;t++)this.chars[t].reset()},e.prototype.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},e.prototype.getTextString=function(){for(var e=[],t=!0,n=0;n<s;n++){var i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")},e.prototype.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),y=function(){function e(){i(this,e),this.rows=[];for(var t=0;t<a;t++)this.rows.push(new v);this.currRow=a-1,this.nrRollUpRows=null,this.reset()}return e.prototype.reset=function(){for(var e=0;e<a;e++)this.rows[e].clear();this.currRow=a-1},e.prototype.equals=function(e){for(var t=!0,n=0;n<a;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},e.prototype.copy=function(e){for(var t=0;t<a;t++)this.rows[t].copy(e.rows[t])},e.prototype.isEmpty=function(){for(var e=!0,t=0;t<a;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},e.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},e.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},e.prototype.insertChar=function(e){this.rows[this.currRow].insertChar(e)},e.prototype.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},e.prototype.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},e.prototype.setCursor=function(e){f.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},e.prototype.setPAC=function(e){f.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var n=0;n<a;n++)this.rows[n].clear();var i=this.currRow+1-this.nrRollUpRows,r=this.lastOutputScreen;if(r){var o=r.rows[i].cueStartTime;if(o&&o<f.time)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(r.rows[i+s])}}this.currRow=t;var u=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,c=Math.max(l-1,0);u.setCursor(e.indent),e.color=u.chars[c].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)},e.prototype.setBkgData=function(e){f.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},e.prototype.setRollUpRows=function(e){this.nrRollUpRows=e},e.prototype.rollUp=function(){if(null===this.nrRollUpRows)return void f.log("DEBUG","roll_up but nrRollUpRows not set yet");f.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),f.log("INFO","Rolling up")},e.prototype.getDisplayText=function(e){e=e||!1;for(var t=[],n="",i=-1,r=0;r<a;r++){var o=this.rows[r].getTextString();o&&(i=r+1,e?t.push("Row "+i+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},e.prototype.getTextAndFormat=function(){return this.rows},e}(),b=function(){function e(t,n){i(this,e),this.chNr=t,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new y,this.nonDisplayedMemory=new y,this.lastOutputScreen=new y,this.currRollUpRow=this.displayedMemory.rows[a-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return e.prototype.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[a-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},e.prototype.getHandler=function(){return this.outputFilter},e.prototype.setHandler=function(e){this.outputFilter=e},e.prototype.setPAC=function(e){this.writeScreen.setPAC(e)},e.prototype.setBkgData=function(e){this.writeScreen.setBkgData(e)},e.prototype.setMode=function(e){e!==this.mode&&(this.mode=e,f.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},e.prototype.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";f.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(f.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},e.prototype.ccRCL=function(){f.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},e.prototype.ccBS=function(){f.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},e.prototype.ccAOF=function(){},e.prototype.ccAON=function(){},e.prototype.ccDER=function(){f.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},e.prototype.ccRU=function(e){f.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},e.prototype.ccFON=function(){f.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},e.prototype.ccRDC=function(){f.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},e.prototype.ccTR=function(){f.log("INFO","TR"),this.setMode("MODE_TEXT")},e.prototype.ccRTD=function(){f.log("INFO","RTD"),this.setMode("MODE_TEXT")},e.prototype.ccEDM=function(){f.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},e.prototype.ccCR=function(){f.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},e.prototype.ccENM=function(){f.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},e.prototype.ccEOC=function(){if(f.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,f.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},e.prototype.ccTO=function(e){f.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},e.prototype.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}f.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},e.prototype.outputDataUpdate=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=f.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),!0===e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},e.prototype.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),w=function(){function e(t,n,r){i(this,e),this.field=t||1,this.outputs=[n,r],this.channels=[new b(1,n),new b(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return e.prototype.getHandler=function(e){return this.channels[e].getHandler()},e.prototype.setHandler=function(e,t){this.channels[e].setHandler(t)},e.prototype.addData=function(e,t){var n=void 0,i=void 0,r=void 0,o=!1;this.lastTime=e,f.setTime(e);for(var a=0;a<t.length;a+=2)if(i=127&t[a],r=127&t[a+1],0!==i||0!==r){if(f.log("DATA","["+p([t[a],t[a+1]])+"] -> ("+p([i,r])+")"),n=this.parseCmd(i,r),n||(n=this.parseMidrow(i,r)),n||(n=this.parsePAC(i,r)),n||(n=this.parseBackgroundAttributes(i,r)),!n&&(o=this.parseChars(i,r)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(o)}else f.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:o?this.dataCounters.char+=2:(this.dataCounters.other+=2,f.log("WARNING","Couldn't parse cleaned data "+p([i,r])+" orig: "+p([t[a],t[a+1]])))}else this.dataCounters.padding+=2},e.prototype.parseCmd=function(e,t){var n=null,i=(20===e||28===e)&&t>=32&&t<=47,r=(23===e||31===e)&&t>=33&&t<=35;if(!i&&!r)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,f.log("DEBUG","Repeated command ("+p([e,t])+") is dropped"),!0;n=20===e||23===e?1:2;var o=this.channels[n-1];return 20===e||28===e?32===t?o.ccRCL():33===t?o.ccBS():34===t?o.ccAOF():35===t?o.ccAON():36===t?o.ccDER():37===t?o.ccRU(2):38===t?o.ccRU(3):39===t?o.ccRU(4):40===t?o.ccFON():41===t?o.ccRDC():42===t?o.ccTR():43===t?o.ccRTD():44===t?o.ccEDM():45===t?o.ccCR():46===t?o.ccENM():47===t&&o.ccEOC():o.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},e.prototype.parseMidrow=function(e,t){var n=null;return(17===e||25===e)&&t>=32&&t<=47&&((n=17===e?1:2)!==this.currChNr?(f.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[n-1].ccMIDROW(t),f.log("DEBUG","MIDROW ("+p([e,t])+")"),!0))},e.prototype.parsePAC=function(e,t){var n=null,i=null,r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,o=(16===e||24===e)&&t>=64&&t<=95;if(!r&&!o)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;n=e<=23?1:2,i=t>=64&&t<=95?1===n?u[e]:c[e]:1===n?l[e]:d[e];var a=this.interpretPAC(i,t);return this.channels[n-1].setPAC(a),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},e.prototype.interpretPAC=function(e,t){var n=t,i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=1==(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i},e.prototype.parseChars=function(e,t){var n=null,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){var a=t;a=17===r?t+80:18===r?t+112:t+144,f.log("INFO","Special char '"+o(a)+"' in channel "+n),i=[a]}else e>=32&&e<=127&&(i=0===t?[e]:[e,t]);if(i){var s=p(i);f.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return i},e.prototype.parseBackgroundAttributes=function(e,t){var n=void 0,i=void 0,r=void 0,o=void 0,a=(16===e||24===e)&&t>=32&&t<=47,s=(23===e||31===e)&&t>=45&&t<=47;return!(!a&&!s||(n={},16===e||24===e?(i=Math.floor((t-32)/2),n.background=h[i],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),r=e<24?1:2,o=this.channels[r-1],o.setBkgData(n),this.lastCmdA=null,this.lastCmdB=null,0))},e.prototype.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},e.prototype.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},e}();t.a=w},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(t,n){i(this,e),this.timelineController=t,this.track=n,this.startTime=null,this.endTime=null,this.screen=null}return e.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues("textTrack"+this.track,this.startTime,this.endTime,this.screen),this.startTime=null)},e.prototype.newCue=function(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.track)},e}();t.a=r},function(e,t,n){"use strict";var i=n(26),r=n(5),o=function(e,t,n){return e.substr(n||0,t.length)===t},a=function(e){var t=parseInt(e.substr(-3)),n=parseInt(e.substr(-6,2)),i=parseInt(e.substr(-9,2)),r=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;return isNaN(t)||isNaN(n)||isNaN(i)||isNaN(r)?-1:(t+=1e3*n,t+=6e4*i,t+=36e5*r)},s=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()},u=function(e,t,n){var i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);for(;r&&r.new;)e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC];e.presentationOffset=n},l={parse:function(e,t,n,l,c,d){var h=/\r\n|\n\r|\n|\r/g,f=Object(r.b)(new Uint8Array(e)).trim().replace(h,"\n").split("\n"),p="00:00.000",g=0,m=0,v=0,y=[],b=void 0,w=!0,_=new i.a;_.oncue=function(e){var t=n[l],i=n.ccOffset;t&&t.new&&(void 0!==m?i=n.ccOffset=t.start:u(n,l,v)),v&&(i=v+n.ccOffset-n.presentationOffset),e.startTime+=i-m,e.endTime+=i-m,e.id=s(e.startTime.toString())+s(e.endTime.toString())+s(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&y.push(e)},_.onparsingerror=function(e){b=e},_.onflush=function(){if(b&&d)return void d(b);c(y)},f.forEach(function(e){if(w){if(o(e,"X-TIMESTAMP-MAP=")){w=!1,e.substr(16).split(",").forEach(function(e){o(e,"LOCAL:")?p=e.substr(6):o(e,"MPEGTS:")&&(g=parseInt(e.substr(7)))});try{t=t<0?t+8589934592:t,g-=t,m=a(p)/1e3,v=g/9e4,-1===m&&(b=new Error("Malformed X-TIMESTAMP-MAP: "+e))}catch(t){b=new Error("Malformed X-TIMESTAMP-MAP: "+e)}return}""===e&&(w=!1)}_.parse(e+"\n")}),_.flush()}};t.a=l},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){for(var t=[],n=0;n<e.length;n++)"subtitles"===e[n].kind&&t.push(e[n]);return t}var s=n(1),u=n(3),l=n(0),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,s.a.MEDIA_ATTACHED,s.a.MEDIA_DETACHING,s.a.MANIFEST_LOADING,s.a.MANIFEST_LOADED,s.a.SUBTITLE_TRACK_LOADED));return o.tracks=[],o.trackId=-1,o.media=void 0,o.subtitleDisplay=!1,o}return o(t,e),t.prototype._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=a(this.media.textTracks),n=0;n<t.length;n++)if("hidden"===t[n].mode)e=n;else if("showing"===t[n].mode){e=n;break}this.subtitleTrack=e}},t.prototype.destroy=function(){u.a.prototype.destroy.call(this)},t.prototype.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(void 0!==this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},t.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=void 0)},t.prototype.onManifestLoading=function(){this.tracks=[],this.trackId=-1},t.prototype.onManifestLoaded=function(e){var t=this,n=e.subtitles||[];this.tracks=n,this.trackId=-1,
this.hls.trigger(s.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:n}),n.forEach(function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)})},t.prototype.onTick=function(){var e=this.trackId,t=this.tracks[e];if(t){var n=t.details;void 0!==n&&!0!==n.live||(l.b.log("(re)loading playlist for subtitle track "+e),this.hls.trigger(s.a.SUBTITLE_TRACK_LOADING,{url:t.url,id:e}))}},t.prototype.onSubtitleTrackLoaded=function(e){var t=this;e.id<this.tracks.length&&(l.b.log("subtitle track "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(function(){t.onTick()},1e3*e.details.targetduration,this)),!e.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))},t.prototype.setSubtitleTrackInternal=function(e){if(!(e<-1||e>=this.tracks.length)){this.timer&&(clearInterval(this.timer),this.timer=null);var t=a(this.media.textTracks);if(-1!==this.trackId&&(t[this.trackId].mode="disabled"),this.trackId=e,l.b.log("switching to subtitle track "+e),this.hls.trigger(s.a.SUBTITLE_TRACK_SWITCH,{id:e}),-1!==e){var n=this.tracks[e];e<t.length&&(t[e].mode=this.subtitleDisplay?"showing":"hidden");var i=n.details;void 0!==i&&!0!==i.live||(l.b.log("(re)loading playlist for subtitle track "+e),this.hls.trigger(s.a.SUBTITLE_TRACK_LOADING,{url:n.url,id:e}))}}},c(t,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&this.setSubtitleTrackInternal(e)}}]),t}(u.a);t.a=d},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(1),s=n(0),u=n(9),l=n(13),c={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING"},d=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,a.a.MEDIA_ATTACHED,a.a.ERROR,a.a.KEY_LOADED,a.a.FRAG_LOADED,a.a.SUBTITLE_TRACKS_UPDATED,a.a.SUBTITLE_TRACK_SWITCH,a.a.SUBTITLE_TRACK_LOADED,a.a.SUBTITLE_FRAG_PROCESSED));return o.config=n.config,o.vttFragSNsProcessed={},o.vttFragQueues=void 0,o.currentlyProcessing=null,o.state=c.STOPPED,o.currentTrackId=-1,o.decrypter=new u.a(n.observer,n.config),o}return o(t,e),t.prototype.onHandlerDestroyed=function(){this.state=c.STOPPED},t.prototype.clearVttFragQueues=function(){var e=this;this.vttFragQueues={},this.tracks.forEach(function(t){e.vttFragQueues[t.id]=[]})},t.prototype.nextFrag=function(){if(null===this.currentlyProcessing&&this.currentTrackId>-1&&this.vttFragQueues[this.currentTrackId].length){var e=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.fragCurrent=e,this.hls.trigger(a.a.FRAG_LOADING,{frag:e}),this.state=c.FRAG_LOADING}},t.prototype.onSubtitleFragProcessed=function(e){e.success&&this.vttFragSNsProcessed[e.frag.trackId].push(e.frag.sn),this.currentlyProcessing=null,this.state=c.IDLE,this.nextFrag()},t.prototype.onMediaAttached=function(){this.state=c.IDLE},t.prototype.onError=function(e){var t=e.frag;t&&"subtitle"!==t.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())},t.prototype.doTick=function(){var e=this;switch(this.state){case c.IDLE:var t=this.tracks,n=this.currentTrackId,i=this.vttFragSNsProcessed[n],r=this.vttFragQueues[n],o=this.currentlyProcessing?this.currentlyProcessing.sn:-1,u=function(e){return i.indexOf(e.sn)>-1},l=function(e){return r.some(function(t){return t.sn===e.sn})};if(!t)break;var d;if(n<t.length&&(d=t[n].details),void 0===d)break;d.fragments.forEach(function(t){u(t)||t.sn===o||l(t)||(t.decryptdata&&null!=t.decryptdata.uri&&null==t.decryptdata.key?(s.b.log("Loading key for "+t.sn),e.state=c.KEY_LOADING,e.hls.trigger(a.a.KEY_LOADING,{frag:t})):(t.trackId=n,r.push(t),e.nextFrag()))})}},t.prototype.onSubtitleTracksUpdated=function(e){var t=this;s.b.log("subtitle tracks updated"),this.tracks=e.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach(function(e){t.vttFragSNsProcessed[e.id]=[]})},t.prototype.onSubtitleTrackSwitch=function(e){this.currentTrackId=e.id,-1!==this.currentTrackId&&void 0!==this.tracks[this.currentTrackId].details&&this.tick()},t.prototype.onSubtitleTrackLoaded=function(){this.tick()},t.prototype.onKeyLoaded=function(){this.state===c.KEY_LOADING&&(this.state=c.IDLE,this.tick())},t.prototype.onFragLoaded=function(e){var t=this.fragCurrent,n=e.frag.decryptdata,i=e.frag,r=this.hls;if(this.state===c.FRAG_LOADING&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&null!=n&&null!=n.key&&"AES-128"===n.method){var o=void 0;try{o=performance.now()}catch(e){o=Date.now()}this.decrypter.decrypt(e.payload,n.key.buffer,n.iv.buffer,function(e){var t=void 0;try{t=performance.now()}catch(e){t=Date.now()}r.trigger(a.a.FRAG_DECRYPTED,{frag:i,payload:e,stats:{tstart:o,tdecrypt:t}})})}},t}(l.a);t.a=d},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n(3),s=n(1),u=n(2),l=n(0),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready"},h=function(e,t,n){var i={videoCapabilities:[]};return t.forEach(function(e){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})}),[i]},f=function(e,t,n){switch(e){case d.WIDEVINE:return h(0,n);default:throw Error("Unknown key-system: "+e)}},p=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n,s.a.MEDIA_ATTACHED,s.a.MANIFEST_PARSED));return o._widevineLicenseUrl=n.config.widevineLicenseUrl,o._licenseXhrSetup=n.config.licenseXhrSetup,o._emeEnabled=n.config.emeEnabled,o._requestMediaKeySystemAccess=n.config.requestMediaKeySystemAccessFunc,o._mediaKeysList=[],o._media=null,o._hasSetMediaKeys=!1,o._isMediaEncrypted=!1,o._requestLicenseFailureCount=0,o}return o(t,e),t.prototype.getLicenseServerUrl=function(e){var t=void 0;switch(e){case d.WIDEVINE:t=this._widevineLicenseUrl;break;default:t=null}return t||(l.b.error('No license server URL configured for key-system "'+e+'"'),this.hls.trigger(s.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),t},t.prototype._attemptKeySystemAccess=function(e,t,n){var i=this,r=f(e,0,n);if(!r)return void l.b.warn("Can not create config for key-system (maybe because platform is not supported):",e);l.b.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(e,r).then(function(t){i._onMediaKeySystemAccessObtained(e,t)}).catch(function(t){l.b.error('Failed to obtain key-system "'+e+'" access:',t)})},t.prototype._onMediaKeySystemAccessObtained=function(e,t){var n=this;l.b.log('Access for key-system "'+e+'" obtained');var i={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(i),t.createMediaKeys().then(function(t){i.mediaKeys=t,l.b.log('Media-keys created for key-system "'+e+'"'),n._onMediaKeysCreated()}).catch(function(e){l.b.error("Failed to create media-keys:",e)})},t.prototype._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))})},t.prototype._onNewMediaKeySession=function(e){var t=this;l.b.log("New key-system session "+e.sessionId),e.addEventListener("message",function(n){t._onKeySessionMessage(e,n.message)},!1)},t.prototype._onKeySessionMessage=function(e,t){l.b.log("Got EME message event, creating license request"),this._requestLicense(t,function(t){l.b.log("Received license data, updating key-session"),e.update(t)})},t.prototype._onMediaEncrypted=function(e,t){l.b.log('Media is encrypted using "'+e+'" init data type'),this._isMediaEncrypted=!0,this._mediaEncryptionInitDataType=e,this._mediaEncryptionInitData=t,this._attemptSetMediaKeys(),this._generateRequestWithPreferredKeySession()},t.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return l.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(s.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_NO_KEYS,fatal:!0});l.b.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},t.prototype._generateRequestWithPreferredKeySession=function(){var e=this,t=this._mediaKeysList[0];if(!t)return l.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(s.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(t.mediaKeysSessionInitialized)return void l.b.warn("Key-Session already initialized but requested again");var n=t.mediaKeysSession;n||(l.b.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(s.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_NO_SESSION,fatal:!0}));var i=this._mediaEncryptionInitDataType,r=this._mediaEncryptionInitData;l.b.log('Generating key-session request for "'+i+'" init data type'),t.mediaKeysSessionInitialized=!0,n.generateRequest(i,r).then(function(){l.b.debug("Key-session generation succeeded")}).catch(function(t){l.b.error("Error generating key-session request:",t),e.hls.trigger(s.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_NO_SESSION,fatal:!1})})},t.prototype._createLicenseXhr=function(e,t,n){var i=new XMLHttpRequest,r=this._licenseXhrSetup;try{if(r)try{r(i,e)}catch(t){i.open("POST",e,!0),r(i,e)}i.readyState||i.open("POST",e,!0)}catch(e){return l.b.error("Error setting up key-system license XHR",e),void this.hls.trigger(s.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return i.responseType="arraybuffer",i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,e,t,n),i},t.prototype._onLicenseRequestReadyStageChange=function(e,t,n,i){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,l.b.log("License request succeeded"),i(e.response);else{if(l.b.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),++this._requestLicenseFailureCount<=3){var r=3-this._requestLicenseFailureCount+1;return l.b.warn("Retrying license request, "+r+" attempts left"),void this._requestLicense(n,i)}this.hls.trigger(s.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}},t.prototype._generateLicenseRequestChallenge=function(e,t){var n=void 0;return e.mediaKeySystemDomain===d.PLAYREADY?l.b.error("PlayReady is not supported (yet)"):e.mediaKeySystemDomain===d.WIDEVINE?n=t:l.b.error("Unsupported key-system:",e.mediaKeySystemDomain),n},t.prototype._requestLicense=function(e,t){l.b.log("Requesting content license for key-system");var n=this._mediaKeysList[0];if(!n)return l.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(s.a.ERROR,{type:u.b.KEY_SYSTEM_ERROR,details:u.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});var i=this.getLicenseServerUrl(n.mediaKeySystemDomain),r=this._createLicenseXhr(i,e,t);l.b.log("Sending license request to URL: "+i),r.send(this._generateLicenseRequestChallenge(n,e))},t.prototype.onMediaAttached=function(e){var t=this;if(this._emeEnabled){var n=e.media;this._media=n,n.addEventListener("encrypted",function(e){t._onMediaEncrypted(e.initDataType,e.initData)})}},t.prototype.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map(function(e){return e.audioCodec}),n=e.levels.map(function(e){return e.videoCodec});this._attemptKeySystemAccess(d.WIDEVINE,t,n)}},c(t,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),t}(a.a);t.a=p},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=function(){return window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null}()},function(e,t){String.prototype.endsWith||function(){"use strict";var e=function(){try{var e={},t=Object.defineProperty,n=t(e,e,e)&&t}catch(e){}return n}(),t={}.toString,n=function(e){if(null==this)throw TypeError();var n=String(this);if(e&&"[object RegExp]"==t.call(e))throw TypeError();var i=n.length,r=String(e),o=r.length,a=i;if(arguments.length>1){var s=arguments[1];void 0!==s&&(a=s?Number(s):0)!=a&&(a=0)}var u=Math.min(Math.max(a,0),i),l=u-o;if(l<0)return!1;for(var c=-1;++c<o;)if(n.charCodeAt(l+c)!=r.charCodeAt(c))return!1;return!0};e?e(String.prototype,"endsWith",{value:n,configurable:!0,writable:!0}):String.prototype.endsWith=n}()}]).default}),define("modules/page/views/components/video/DesktopVideoComponentView",["jquery","lodash","device","log","modules/page/views/components/video/AbstractVideoComponentView","modules/page/models/video/HTMLVideo","modules/page/utils/VideoTracker","hlsjs"],function(e,t,n,i,r,o,a,s){"use strict";return r.extend({_getVideoFormats:function(){var e=[];return n.isIE11()&&n.isWindowsLessThan("8.1")||e.push({format:"hls-playlist",type:"vnd.apple.mpegurl"}),e.concat([{format:"original",type:"mp4"},{format:"h264-high",type:"mp4"},{format:"h264-low",type:"mp4"}])},doPlatformSpecificSetup:function(){var e=this.getResolvedVideoUrlForFormat("hls-playlist");if(s.isSupported()&&e){var i=new s;i.startLevel=-1,i.loadSource(e),i.attachMedia(this.videoHandle)}else this._setVideoSources();n.isBrowserChromeGreaterThanOrEqualTo(67)&&this._isShowControls()&&(this.$el.addClass("hide-native-play-button"),this.$el.on("mouseenter",t.bind(function(e){this.videoHandle.readyState<=1||(this._isPlaying()?this.showPauseButton():this.showPlayButton())},this)).on("mouseleave",t.bind(function(e){this.$pauseButton&&this.$pauseButton.fadeOut()},this)),this.$vid.on("ended",t.bind(function(e){this.showPlayButton()},this)),this.$el.on("mousemove",t.bind(function(e){this._isPlaying()&&this.showPauseButton()},this)))},configurePlatformSpecificEvents:function(){this.$vid.on("progress load canplaythrough",t.bind(function(){this.videoHandle.readyState>1&&(this.isVideoReady=!0,this.canAutoplay()?this._hidePosterAndShowVideo():this.showPlayButton(),this.trigger(this.EVENTS.VIDEO_READY),this.$vid.off("progress load canplaythrough"))},this)),this.$vid.on("play",t.bind(function(e){this.$playButton&&this.$playButton.hide()},this))},showPlayButton:function(){if(!this._isPlaying()){if(this.$playButton)return this.$playButton.removeAttr("aria-hidden"),void this.$playButton.show();this.$playButton=e("<button>",{attr:{"aria-label":"Play Video"},class:"video-play-button"}),this.options.width>64&&this.options.height>64?this.$playButton.addClass("video-play-button-large"):this.$playButton.addClass("video-play-button-small"),this.$el.append(this.$playButton),this.$playButton.on("click",t.bind(function(e){e.preventDefault(),this._hidePosterAndShowVideo(),this.$playButton.hide(),this.$playButton.attr("aria-hidden",!0),this.videoHandle.play(),n.isBrowserChromeGreaterThanOrEqualTo(67)&&this.showPauseButton()},this))}},showPauseButton:function(){if(this._isPlaying()){if(this.$pauseButton)return this.pauseButtonTimeout&&clearTimeout(this.pauseButtonTimeout),this.$pauseButton.show(),this.$pauseButton.removeAttr("aria-hidden"),void this.setPauseButtonTimeout();this.$pauseButton=e("<div>",{attr:{"aria-label":"Pause Video"},class:"video-pause-button"}),this.options.width>64&&this.options.height>64?this.$pauseButton.addClass("video-pause-button-large"):this.$pauseButton.addClass("video-pause-button-small"),this.$el.append(this.$pauseButton),this.$pauseButton.on("click",t.bind(function(e){e.preventDefault(),this.manuallyPause(),this.$pauseButton.hide(),this.$pauseButton.attr("aria-hidden",!0),this.showPlayButton()},this)),this.setPauseButtonTimeout()}},setPauseButtonTimeout:function(){this.pauseButtonTimeout=setTimeout(t.bind(function(){this.$pauseButton.fadeOut()},this),2500)}})}),define("modules/page/views/components/video/MobileVideoComponentView",["jquery","lodash","device","log","modules/page/views/components/video/AbstractVideoComponentView"],function(e,t,n,i,r){"use strict";return r.extend({_getVideoFormats:function(){var e="h264-high";return n.smartPhone()&&(e="h264-low"),[{format:"hls-playlist",type:"vnd.apple.mpegurl"},{format:e,type:"mp4"},{format:"original",type:"mp4"}]},onClick:function(e){return e&&e.preventDefault(),this._isPlaying()?this.manuallyPause():this.play(),!1},show:function(){r.prototype.show.apply(this),this.loadAndShowVideo()},getElementWidth:function(){var e=this.options.pageView.getScaleContext().ratio;return this.options.width*e},getElementHeight:function(){var e=this.options.pageView.getScaleContext().ratio;return this.options.height*e},doPlatformSpecificSetup:function(){this._setVideoSources(),this.applyVideoControlsFix(!0),n.isMobileSafari()&&this._isShowControls()&&this.$vid.on("touchmove",function(e){e.stopPropagation()})},configurePlatformSpecificEvents:function(){this._isShowControls()||this.bindInteraction(this.$el,t.bind(this.onClick,this)),this.$vid.on("progress load canplaythrough",t.bind(function(){this.videoHandle.readyState>=1&&(this.isVideoReady=!0,this._hidePosterAndShowVideo(),this.applyVideoControlsFix(!1),window.addEventListener("resize",t.bind(this.applyVideoControlsFix,this,!1)),this.trigger(this.EVENTS.VIDEO_READY),this.$vid.off("progress load canplaythrough"))},this))},applyVideoControlsFix:function(e){var t=this.options.pageView.getScaleContext().ratio,n="";e&&(n="translateX(-2048px) "),n+="scale("+1/t+", "+1/t+")",this.$vid.css({transform:n,"transform-origin":"top left",left:this.options.x*t,top:this.options.y*t,width:Math.ceil(this.options.width*t),height:Math.ceil(this.options.height*t)})}})}),define("modules/page/utils/VideoAutoplayCapabilities",["lodash","device"],function(e,t){"use strict";var n={FULL:"full",MUTED:"muted",NONE:"none"},i=e.once(function(){return t.isIos()?t.isIosLessThan(10)?n.NONE:n.MUTED:t.isAndroid()&&t.isBrowserChrome()?t.isBrowserChromeLessThan(53)?n.NONE:n.MUTED:t.isDesktopSafari()&&!t.isDesktopSafariLessThan(11)?n.MUTED:t.desktop()&&t.isBrowserChrome()&&!t.isBrowserChromeLessThan(66)?n.MUTED:t.desktop()&&t.isBrowserFirefoxGreaterThanOrEqualTo(63)?n.MUTED:n.FULL});return{isFullSupport:function(){return i()===n.FULL},isMutedSupport:function(){return i()===n.MUTED},isNoSupport:function(){return i()===n.NONE}}}),define("libs/utils/VideoAutoplayConstants",[],function(){"use strict";return{NO_AUTOPLAY_FALLBACK_OPTIONS:{TAP_TO_PLAY:"tap-to-play",SHOW_THUMBNAIL_IMAGE:"show-thumbnail-image"},MUTED_AUTOPLAY_FALLBACK_OPTIONS:{PLAY_MUTED_VIDEO:"play-muted-video",TAP_TO_PLAY:"tap-to-play",SHOW_THUMBNAIL_IMAGE:"show-thumbnail-image"}}}),define("modules/page/views/components/video/VideoComponentViewFactory",["device","modules/page/views/components/video/DesktopVideoComponentView","modules/page/views/components/video/MobileVideoComponentView","modules/page/views/components/ImageComponentView","modules/page/utils/VideoAutoplayCapabilities","libs/utils/VideoAutoplayConstants"],function(e,t,n,i,r,o){"use strict";function a(i){return e.mobile()?new n(i):new t(i)}function s(e){return e.imageLoader=e.posterLoader,new i(e)}function u(e){return r.isNoSupport()?c(e):r.isMutedSupport()?l(e):(e.tapToPlay=!1,a(e))}function l(e){var t=e.mutedAutoplayFallbackOption;return t===o.MUTED_AUTOPLAY_FALLBACK_OPTIONS.TAP_TO_PLAY?a(e):t===o.MUTED_AUTOPLAY_FALLBACK_OPTIONS.SHOW_THUMBNAIL_IMAGE?s(e):(e.tapToPlay=!1,e.muted=!0,a(e))}function c(e){return e.noAutoplayFallbackOption===o.NO_AUTOPLAY_FALLBACK_OPTIONS.SHOW_THUMBNAIL_IMAGE?s(e):a(e)}return{create:function(e){return e.videoAutoPlay?u(e):a(e)}}}),define("modules/page/views/GroupView",["jquery","lodash","backbone","modules/page/views/AbstractTransformableGroupView"],function(e,t,n,i){"use strict";return i.extend({initialize:function(){i.prototype.initialize.call(this),this.$el.addClass("group"),this.childViews={}},addParentView:function(e){i.prototype.addParentView.call(this,e),t.each(this.childViews,function(t){t.addParentView(e)})},areAllParentsVisible:function(){return t.every(this.parentViews,function(e){return e.visible})},removePointerEventsIfNoInteractions:function(){t.each(this.childViews,function(e){e.removePointerEventsIfNoInteractions()})},prepareGroupForBlendingModes:function(){var t,n=this.$el.css("left"),i=this.$el.css("top"),r=this.options.width,o=this.options.height,a=this;t=e(this.hasClickInteraction()?'<button class="wrapper-for-blending-modes" data-for="'+this.id+'"></button>':'<div class="wrapper-for-blending-modes" data-for="'+this.id+'"></div>'),t.css("position","absolute"),t.css("left",n),t.css("top",i),this.hasClickInteraction()&&(t.on("focus",function(){var t=e('[data-for="'+a.id+'"]');t.css("width",r+"px"),t.css("height",o+"px")}),t.on("blur",function(){var t=e('[data-for="'+a.id+'"]');t.css("width","1px"),t.css("height","1px")}),t.on("click",function(e){e.originalEvent.target===e.currentTarget&&a.$el.click()})),this.$el.wrapAll(t),this.$el.css("display","contents")}})}),define("@frontend/player/custom-shape/CustomShapeComponentView",["@frontend/player/custom-path/common/AbstractCustomPathComponentView"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=39)}({16:function(e,t){e.exports=require("@frontend/player/custom-path/common/AbstractCustomPathComponentView")},39:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="custom-shape",t}return r(t,e),t}(n(16).AbstractCustomPathComponentView);t.CustomShapeComponentView=o}})}),define("modules/page/utils/ComponentFactory",["log","globals","lodash","modules/page/views/components/CanvasBackgroundComponentView","modules/page/views/components/SquareShapeComponentView","modules/page/views/components/ShapeComponentView","modules/page/views/components/HtmlComponentView","modules/page/views/components/ChartblocksChartComponentView","modules/page/views/components/HubspotFormComponentView","modules/page/views/components/MarketoFormComponentView","modules/page/views/components/HotspotComponentView","@frontend/player/hotspot-path/HotspotPathComponentView","modules/page/views/components/ImageComponentView","modules/page/views/components/VectorImageComponentView","modules/page/views/components/LineComponentView","modules/page/views/components/TextComponentView","modules/page/views/components/video/VideoComponentViewFactory","modules/page/views/SmartgroupView","modules/page/views/GroupView","@frontend/player/custom-shape/CustomShapeComponentView","VectorImageUtils","modules/page/utils/PlayerVariantUtil"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f,p,g,m,v,y,b,w,_){"use strict";return{createComponentFromObject:function(t){var n=null;switch(t.type){case"html-component":n=new a(t);break;case"chartblocks-chart-component":n=new s(t);break;case"hubspot-form-component":n=new u(t);break;case"marketo-form-component":n=new l(t);break;case"hotspot-component":n=new c(t);break;case"hotspot-path-component":n=new d.HotspotPathComponentView(t);break;case"canvas-background-component":n=new i(t);break;case"shape-component":n="square"===t.shape?new r(t):new o(t);break;case"line-component":n=new p(t);break;case"image-component":n=w.isVectorBased(t.contentType)?new f(t):new h(t);break;case"smartgroup":n=new v(t);break;case"group":n=new y(t);break;case"text-component":n=new g(t);break;case"video-widget":n=m.create(t);break;case"custom-shape-component":n=new b.CustomShapeComponentView(t);break;default:return e.warn("Object type not supported:",t.type),null}return n}}}),define("modules/page/utils/Record",["lodash"],function(e){"use strict";var t=function(e,t){this.parentItem=e,this.model=t,this.childViews=[],this.view=null};return t.prototype={isScranchor:function(){return"scranchor"===this.model.type},isSmartgroupLayer:function(){return this.model&&!e.isUndefined(this.model.smartgroupId)},isFolder:function(){return this.model&&"folder"===this.model.type},isGroup:function(){return this.model&&"group"===this.model.type},findParentSmartgroupOrGroupModel:function(){for(var e=null,t=this;null!==t;){if(t.isSmartgroupLayer()||t.isGroup()){e=t.model;break}t=t.parentItem}return e},setView:function(e){this.view=e,this.parentItem.childViews.push(e)}},t}),define("@frontend/player/modules/page/utils/Scranchor",["lodash","jquery","modules/page/utils/Record"],function(e,t,n){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=108)}({1:function(t,n){t.exports=e},108:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),a=n(1),s=function(e){function t(t){var n=e.call(this)||this;return n.x=0,n.y=0,n.model={type:"scranchor"},n.childViews=[],n.y=t.top||0,n.$el=o("<a>",{class:"scranchor",id:t.id,tabindex:-1}).css({position:"absolute",top:n.y,left:n.x,height:0,width:t.width}),t.id.match(/^page-[0-9]+-top$/)&&n.$el.on("focus",function(){n.$el.attr("tabindex",1)}).on("blur",function(){n.$el.attr("tabindex",-1)}),n}return r(t,e),t.prototype.adjustYCoordinateWithinGroup=function(){var e=this;this.$el.parents(".group, .smart-group").each(function(t,n){e.y-=parseInt(n.style.top),e.$el.css("top",e.y)})},t.scranchorsForPage=function(e){var n=[],i=e.model.getPageWidth(e.documentVersion),r=e.model.getPageHeight(e.documentVersion);return n.push(new t({width:i,id:"page-"+(e.model.pageIndex+1)+"-top"})),a.forEach(e.model.getScranchorsForCurrentVariant(),function(e,r){n.push(new t({top:e,id:r,width:i}))}),n.push(new t({top:r-1,width:i,id:"page-"+(e.model.pageIndex+1)+"-bottom"})),n},t}(n(109));t.Scranchor=s},109:function(e,t){e.exports=require("modules/page/utils/Record")},4:function(e,t){e.exports=require("jquery")}})}),define("modules/page/utils/PageChildPreRenderList",["lodash","modules/page/utils/Record","@frontend/player/modules/page/utils/Scranchor","modules/page/utils/PlayerVariantDetector"],function(e,t,n,i){"use strict";return{createPreRenderList:function(i){var r=i.model.get("layers"),o=n.Scranchor.scranchorsForPage(i);if(!r)return o;var a=function(n,i){n&&e.each(n,function(e){var n=new t(i,e);o.push(n),e.smartgroupId?a(e.layers,n):"folder"!==e.type&&"group"!==e.type||a(e.items,n)})},s=new t(null,null);return s.childViews=i.childViews,a(r,s),o.reverse()}}}),define("modules/page/utils/SortedDocumentFragment",["jquery"],function(e){"use strict";var t=function(t){if(!t)return Number.POSITIVE_INFINITY;var n=parseInt(t.style.top);return e(t).parents(".group, .smart-group").each(function(e,t){n+=parseInt(t.style.top)}),n};return{insert:function(t,n,i,r,o){var a=this.getChildNodeToInsertBefore(t,i,r,o);a?e(n).insertBefore(a,t):t.appendChild(n)},getChildNodeToInsertBefore:function(n,i,r,o,a,s){for(var u,l,c=0,d=n.children||n.childNodes,h=d.length-1;c<=h;){u=Math.floor((c+h)/2);var f=parseInt(d[u].style.left)+(a||0),p=parseInt(d[u].style.top)+(s||0),g=p===r?f-i:p-r;if(0===g)return d[u];if(g<0){if(o&&e(d[u]).is(".group, .smart-group")){var m=this.getChildNodeToInsertBefore(d[u],i,r,o,f,p);m&&(!l||parseInt(m.style.top)<t(l))&&(l=m)}c=u+1}else{h=u-1;(!l||!o||parseInt(d[u].style.top)<t(l))&&(l=d[u])}}return l}}}),define("modules/page/utils/PageViewPrerenderer",["device","jquery","lodash","log","modules/page/views/FolderView","modules/page/views/SmartgroupView","modules/page/utils/ComponentFactory","modules/page/utils/PageChildPreRenderList","@frontend/common/libs/BlendingModes","modules/page/utils/SortedDocumentFragment"],function(e,t,n,i,r,o,a,s,u,l){"use strict";var u=u.BlendingModes,c=function(e){this.prerenderDeferred=new t.Deferred,this.prerenderWorkQueue=[],this.pageView=e,this.pageIndex=this.pageView.getPageIndex(),this.nextZIndex=1,this.docFrag=document.createDocumentFragment(),this.pinnedDocFrag=document.createDocumentFragment()};return c.prototype={prerender:function(){i.debug("Pre-rendering page idx: "+this.pageIndex);var e=Date.now();for(this.isPrerenderQueueEmpty()&&this.initPrerenderQueue();!this.isPrerenderQueueEmpty();)this.prerenderNextWorkItem();i.debug("Prerender complete for page idx: "+this.pageIndex+". Elapsed time: "+(Date.now()-e)+" ms"),this.prerenderDeferred.resolve()},lazyPrerender:function(){if(!this.isPrerendered()){var e=Date.now();i.debug("Starting lazy prerender on page idx: "+this.pageIndex);var t=n.bind(function(){var n=Date.now();if(!this.isPrerendered()){
if(this.isPrerenderQueueEmpty())this.initPrerenderQueue();else for(this.prerenderNextWorkItem();!this.isPrerenderQueueEmpty()&&Date.now()-n<10;)this.prerenderNextWorkItem();this.isPrerenderQueueEmpty()?(i.debug("Lazy prerender complete for page idx: "+this.pageIndex+". Elapsed time: "+(Date.now()-e)+" ms"),this.prerenderDeferred.resolve()):window.requestAnimationFrame(t)}},this);window.requestAnimationFrame(t)}return this.prerenderDeferred.promise()},initPrerenderQueue:function(){this.pageView.resetPageForPrerender(),this.nextZIndex=1,this.docFrag=document.createDocumentFragment(),this.pinnedDocFrag=document.createDocumentFragment(),this.prerenderWorkQueue=s.createPreRenderList(this.pageView),this.prerenderWorkQueue.unshift(this.getCanvasBackgroundFromQueue(this.prerenderWorkQueue)),i.debug("Prerender queue for page idx: "+this.pageIndex+" has "+this.prerenderWorkQueue.length+" items.")},getCanvasBackgroundFromQueue:function(e){for(var t,n=e.length-1;n>=0;--n){var i=e[n];if(t="canvas-background-component"===i.model.type?e.splice(n,1)[0]:this.getCanvasBackgroundFromQueue(i.childViews))break}return t},addViewToDOM:function(e,t){l.insert(e,t.$el[0],t.options.x,t.options.y)},addComponentToDOM:function(t){t.options.fixedPosition&&e.desktop()?this.addViewToDOM(this.pinnedDocFrag,t):this.addViewToDOM(this.docFrag,t)},prerenderObjectView:function(e,t){e=this.pageView.applyPageContext(e);var n=a.createComponentFromObject(e);return null!==n&&(n.render(),n.doTriggerOnScroll()&&this.pageView._addScrollTriggeredObject(n),n.hasResettableHoverInteractions()&&this.pageView.addResetWhenOffscreenHoverTrigger(n),n.options.fixedPosition&&this.pageView.setFixedPosition(n),t||(this.setObjectViewToNextHighestZIndex(n),this.addComponentToDOM(n))),n},prerenderFolderView:function(e,t){var i=new r(e);return i.childViews=t,n.each(i.childViews,n.bind(function(e){i.isInitiallyVisible()||e.hide(),e.addParentView(i),e.addContainerId(i.getId())},this)),i},prerenderGroupView:function(e,t){var i=this;e=this.pageView.applyPageContext(e);var r=a.createComponentFromObject(e);return r.childViews=t,r.childrenUseBlendingModes()?this.addBlendingModesFocusClass(r):this.setObjectViewToNextHighestZIndex(r),n.each(t,function(e){var t=e;t.addParentView(r),t.addContainerId(r.getId()),t.childrenUseBlendingModes()||i.setObjectViewToNextHighestZIndex(t),t.hasActiveBlendingMode()&&i.addBlendingModesFocusClass(t),i.addViewToDOM(r.$el[0],t)}),r.render(),r.doTriggerOnScroll()&&this.pageView._addScrollTriggeredObject(r),r.hasResettableHoverInteractions()&&this.pageView.addResetWhenOffscreenHoverTrigger(r),r.options.fixedPosition&&this.pageView.setFixedPosition(r),this.addComponentToDOM(r),r},prerenderSmartgroupView:function(e,t){function i(e){n.each(e,function(e){if("folder"===e.options.type)i(e.childViews);else{var t=e;r.setObjectViewToNextHighestZIndex(t),r.addViewToDOM(o.$el[0],t),"image-component"===e.options.type&&e.$el.css("mix-blend-mode",u.getDefault()),t.options.parentSmartgroup=o}})}var r=this;e=this.pageView.applyPageContext(e);var o=a.createComponentFromObject(e);return o.childViews=t,this.setObjectViewToNextHighestZIndex(o),i(o.childViews),o.render(),o.addContainerId(o.id),o.doTriggerOnScroll()&&this.pageView._addScrollTriggeredObject(o),o.options.fixedPosition&&this.pageView.setFixedPosition(o),this.addComponentToDOM(o),o},setObjectViewToNextHighestZIndex:function(e){e.$el.css("zIndex",this.nextZIndex),this.nextZIndex++},addBlendingModesFocusClass:function(t){var n=e.isBrowserFirefox()?"blending-modes-focus-mozilla":"blending-modes-focus";t.$el.addClass(n)},isPrerendered:function(){return"resolved"===this.prerenderDeferred.state()},getPrerenderPromise:function(){return this.prerenderDeferred.promise()},getDocumentFragment:function(){return this.docFrag},getPinnedDocumentFragment:function(){return this.pinnedDocFrag},isPrerenderQueueEmpty:function(){return!this.prerenderWorkQueue||0===this.prerenderWorkQueue.length},prerenderNextWorkItem:function(){var e=this.prerenderWorkQueue.shift();this.prerenderSingleWorkItem(e)},prerenderSingleWorkItem:function(e){if(e)if(e.isSmartgroupLayer()){var t=this.prerenderSmartgroupView(e.model,e.childViews);e.setView(t)}else if(e.isFolder()){var n=this.prerenderFolderView(e.model,e.childViews);e.setView(n)}else if(e.isGroup()){var i=this.prerenderGroupView(e.model,e.childViews);e.setView(i)}else if(e.isScranchor())l.insert(this.docFrag,e.$el[0],e.x,e.y,!0),e.adjustYCoordinateWithinGroup();else{var r;r=e.findParentSmartgroupOrGroupModel();var o=this.prerenderObjectView(e.model,r);e.setView(o)}}},c}),define("modules/page/utils/PageChildViewFinder",["lodash","modules/page/views/components/video/AbstractVideoComponentView"],function(e,t){"use strict";function n(n,i){var r=null,o=function(n){return e.some(n,function(e){return e.id===i?(r=e,!0):e instanceof t&&e.el&&e.el.id===i?(r=e,!0):!!e.childViews&&o(e.childViews)})};return n&&o(n),r}return{find:n}}),define("modules/page/utils/AnimationRunner",["jquery","lodash","modules/page/views/components/AbstractComponentView","modules/page/views/components/video/AbstractVideoComponentView","modules/page/views/FolderView","modules/page/utils/PageChildViewFinder"],function(e,t,n,i,r,o){"use strict";function a(e,i){var r=function(e){t.each(e,function(e){if(e instanceof n&&(t.isUndefined(e.visible)||e.visible)){var o=e.isAnyPartOfComponentWithinBoundaries(i);o&&e.setWasInsideVisibleBoundaries(!0),(o||e.isOutsideOfPage())&&e.activateAndRunEntryAnimations()}e.childViews&&e.visible&&r(e.childViews)})};r(e)}function s(e,n){t.each(e,function(e){e.isAnyPartOfComponentWithinBoundaries(n)&&e.createTimedTriggers()})}function u(e,t){e.areAllParentsVisible()&&(p(e),l(e,t),c(e))}function l(e,i){e instanceof n&&e.isAnyPartOfComponentWithinBoundaries(i)&&e.createTimedTriggers(),e.childViews&&t.each(e.childViews,function(e){l(e,i)})}function c(e){null!==e&&!1!==e.visible&&(e.reset(),e instanceof n&&e.activateAndRunEntryAnimations(),e.childViews&&t.each(e.childViews,function(e){c(e)}))}function d(n){t.each(n,function(t){if(!t.runningExitAnimations){var n=t.runAllChildViewExitAnimations();e.when.apply(e,n).done(function(){g(t),_(t)})}})}function h(e,t){for(var n=0;n<e.length;n++){var i=e[n],r=i.getComponentBoundaries(),o=i.isAnyPartOfComponentWithinBoundaries(t,r),a=i.getWasInsideVisibleBoundaries(),s=a&&!o,u=!a&&o;if(s?(i.setWasInsideVisibleBoundaries(!1),i.whenLeavingVisibleBoundaries()):u&&(i.setWasInsideVisibleBoundaries(!0),i.createTimedTriggers()),o){if(!i.visible||i.areAnyParentsNotVisible())continue;i.isAnyPartOfComponentWithinEntryAnimationBoundaries(t,r)&&!i.isOutsideOfPage()&&i.activateAndRunEntryAnimations()}}}function f(e,n,i){for(var r=b(e,n,i),o=0;o<r.length;o++){var a=r[o];t.isUndefined(a.initiallyVisible)||a.initiallyVisible?p(a):v(a)}}function p(e){e&&(e.visible=!0,e instanceof n&&e.show(),t.isEmpty(e.childViews)||t.each(e.childViews,function(e){e.visible&&p(e)}))}function g(e){e&&(e.visible=!1,(e instanceof n||e instanceof r)&&e.hide(),m(e))}function m(e){e instanceof n&&e.resetTimers(),e.childViews&&t.each(e.childViews,function(e){m(e)})}function v(e){e&&(e.visible=!1,(e instanceof n||e instanceof r)&&e.hide(),y(e))}function y(e){e instanceof n&&(e.resetTimers(),e instanceof i&&e.disableVideoTrackingAndAutoPlayingVideo()),e.childViews&&t.each(e.childViews,function(e){y(e)})}function b(e,n,i){function a(e){if(!e.resetWhenScrolledOffscreen)return[];var i=t.map(e.layerTargets,function(e){return o.find(n,e)});return t.every(i,s)?i:[]}function s(e){function n(e){e instanceof r?t.each(e.childViews,function(e){n(e)}):o.push(e)}var o=[];return n(e),t.every(o,function(e){return!(e&&e.isAnyPartOfComponentWithinBoundaries(i))})}for(var u=[],l=0;l<e.length;l++){var c=e[l];if(!c.isAnyPartOfComponentWithinBoundaries(i)){var d=t.flatMap(c.getResettableHoverInteractions(),a);d.length>0&&(u.push(c),u=u.concat(d))}}return u}function w(e){var n=function(e){t.each(e,function(e){e.childViews&&n(e.childViews),t.isUndefined(e.initiallyVisible)||e.initiallyVisible?p(e):g(e),e.reset()})};n(e)}function _(e){e.reset(),e.childViews&&t.each(e.childViews,function(e){e.reset()})}function E(){}return E.prototype={activateAndRunEntryAnimationsForAllVisible:a,createTimedTriggers:s,whenVisibleBoundariesChange:h,resetHoverInteractionViewsToInitialVisibility:f,resetAnimationsAndInitialVisibility:w,showChildViewIfAllParentsVisible:u,hideAllChildViewsAndRunExitAnimations:d},E}),define("@frontend/player/interactions/links/GoToURLInteraction",["jquery","@frontend/player/interactions/links/BaseURLInteraction"],function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=73)}({4:function(e,t){e.exports=require("jquery")},73:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),a=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.domain=o("<a>",{href:t.url}).get(0).hostname||void 0,i.urlOpenInNewWindow=t.urlOpenInNewWindow||!1,i.url=t.url||"",i}return r(t,e),t.prototype.hasGlobalScope=function(){return!1},t.prototype.constructUrl=function(){return this.url},t.prototype.getModuleAction=function(){return this.pageView.module.publishedEvents.PAGE_ACTION_GO_TO_URL},t.prototype.isValid=function(){return("submit"!==this.trigger||!this.urlOpenInNewWindow)&&!!this.url&&e.prototype.isValid.call(this)},t}(n(8).BaseURLInteraction);t.GoToURLInteraction=a},8:function(e,t){e.exports=require("@frontend/player/interactions/links/BaseURLInteraction")}})}),define("@frontend/player/interactions/visibility/BaseVisibilityInteraction",["@frontend/player/interactions/BaseInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=91)}({3:function(e,t){e.exports=require("@frontend/player/interactions/BaseInteraction")},91:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.layerTargets=t.layerTargets,i}return r(t,e),t.prototype.getModuleAction=function(){return this.pageView.module.publishedEvents.PAGE_ACTION_LAYER_VISIBILITY},t.prototype.getHoverTargets=function(){return this.layerTargets},t}(n(3).BaseInteraction);t.BaseVisibilityInteraction=o}})}),define("@frontend/player/interactions/group-visibility/CycleNextInteraction",["@frontend/player/interactions/visibility/BaseVisibilityInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=47)}({47:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.triggerAction=function(t){return this.pageView.invokeCycleNextAction(this.layerTargets),e.prototype.triggerAction.call(this,t)},t}(n(6).BaseVisibilityInteraction);t.CycleNextInteraction=o},6:function(e,t){e.exports=require("@frontend/player/interactions/visibility/BaseVisibilityInteraction")}})}),define("@frontend/player/interactions/group-visibility/CyclePreviousInteraction",["@frontend/player/interactions/visibility/BaseVisibilityInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=49)}({49:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.triggerAction=function(t){return this.pageView.invokeCyclePreviousAction(this.layerTargets),e.prototype.triggerAction.call(this,t)},t}(n(6).BaseVisibilityInteraction);t.CyclePreviousInteraction=o},6:function(e,t){e.exports=require("@frontend/player/interactions/visibility/BaseVisibilityInteraction")}})}),define("@frontend/player/interactions/group-visibility/BaseLayerVisibilityInteraction",["@frontend/player/interactions/visibility/BaseVisibilityInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=45)}({45:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.isValid=function(){return!!this.layerTargets&&e.prototype.isValid.call(this)},t}(n(6).BaseVisibilityInteraction);t.BaseLayerVisibilityInteraction=o},6:function(e,t){e.exports=require("@frontend/player/interactions/visibility/BaseVisibilityInteraction")}})}),define("@frontend/player/interactions/group-visibility/HideLayersInteraction",["@frontend/player/interactions/group-visibility/BaseLayerVisibilityInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=51)}({11:function(e,t){e.exports=require("@frontend/player/interactions/group-visibility/BaseLayerVisibilityInteraction")},51:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.triggerAction=function(t){return this.pageView.invokeHideAction(this.layerTargets),e.prototype.triggerAction.call(this,t)},t}(n(11).BaseLayerVisibilityInteraction);t.HideLayersInteraction=o}})}),define("@frontend/player/interactions/group-visibility/ShowLayersInteraction",["@frontend/player/interactions/group-visibility/BaseLayerVisibilityInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=53)}({11:function(e,t){e.exports=require("@frontend/player/interactions/group-visibility/BaseLayerVisibilityInteraction")},53:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.createHoverArea=!!t.createHoverArea,i}return r(t,e),t.prototype.triggerAction=function(t){return this.pageView.invokeShowAction(this.layerTargets),e.prototype.triggerAction.call(this,t)},t.prototype.getHoverTargets=function(){var e=this;if(!this.createHoverArea)return this.layerTargets;if(!this.layerTargets)return[];var t=[];return this.layerTargets.forEach(function(n){t.push(n);var i=e.pageView.findChildView(n);i&&i.childViews&&i.childViews.forEach(function(n){e.getAllValidLayerTargets(n,t)})}),t},t.prototype.shouldCreateHoverArea=function(){return this.createHoverArea},t.prototype.getAllValidLayerTargets=function(e,t){var n=this;void 0===t&&(t=[]),e.visible&&t.push(e.id),"folder"===e.options.type&&e.childViews&&e.childViews.forEach(function(e){n.getAllValidLayerTargets(e,t)})},t}(n(11).BaseLayerVisibilityInteraction);t.ShowLayersInteraction=o}})}),define("@frontend/player/interactions/group-visibility/ToggleLayersInteraction",["@frontend/player/interactions/group-visibility/BaseLayerVisibilityInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=55)}({11:function(e,t){e.exports=require("@frontend/player/interactions/group-visibility/BaseLayerVisibilityInteraction")},55:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.triggerAction=function(t){return this.pageView.invokeToggleAction(this.layerTargets),e.prototype.triggerAction.call(this,t)},t}(n(11).BaseLayerVisibilityInteraction);t.ToggleLayersInteraction=o}})}),define("@frontend/player/interactions/visibility/HideComponentInteraction",["@frontend/player/interactions/visibility/BaseVisibilityInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=95)}({6:function(e,t){e.exports=require("@frontend/player/interactions/visibility/BaseVisibilityInteraction")},95:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.triggerAction=function(t){return this.pageView.invokeHideOnlyAction(this.layerTargets),e.prototype.triggerAction.call(this,t)},t}(n(6).BaseVisibilityInteraction);t.HideComponentInteraction=o}})}),define("@frontend/player/interactions/visibility/ShowComponentInteraction",["@frontend/player/interactions/visibility/BaseVisibilityInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=105)}({105:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.triggerAction=function(t){return this.pageView.invokeShowOnlyAction(this.layerTargets),e.prototype.triggerAction.call(this,t)},t}(n(6).BaseVisibilityInteraction);t.ShowComponentInteraction=o},6:function(e,t){e.exports=require("@frontend/player/interactions/visibility/BaseVisibilityInteraction")}})}),define("@frontend/player/interactions/visibility/PageVisibilityInteraction",["lodash","@frontend/player/interactions/BaseInteraction"],function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=99)}({1:function(t,n){t.exports=e},3:function(e,t){e.exports=require("@frontend/player/interactions/BaseInteraction")},99:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.pageTargets=t.pageTargets||[],i}return r(t,e),t.prototype.getModuleAction=function(){return this.pageView.module.publishedEvents.PAGE_ACTION_ENABLE_DISABLE_PAGES},t.prototype.isValid=function(){return!o.isEmpty(this.pageTargets)},t}(n(3).BaseInteraction);t.PageVisibilityInteraction=a}})}),define("@frontend/player/interactions/visibility/LightboxVisibilityInteraction",["@frontend/player/interactions/BaseInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=97)}({3:function(e,t){e.exports=require("@frontend/player/interactions/BaseInteraction")},97:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),
e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.lightboxHasCloseButton=t.lightboxHasCloseButton||!1,i.lightboxHeight=t.lightboxHeight||0,i.lightboxWidth=t.lightboxWidth||0,i.lightboxUrl=t.lightboxUrl||"",i}return r(t,e),t.prototype.hasGlobalScope=function(){return!1},t.prototype.getModuleAction=function(){return this.pageView.module.publishedEvents.PAGE_ACTION_OPEN_LIGHTBOX},t}(n(3).BaseInteraction);t.LightboxVisibilityInteraction=o}})}),define("@frontend/player/interactions/visibility/ProductPanelVisibilityInteraction",["@frontend/player/interactions/BaseInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=101)}({101:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.productPanelId=t.productPanelId||"",i}return r(t,e),t.prototype.hasGlobalScope=function(){return!1},t.prototype.getModuleAction=function(){return this.pageView.module.publishedEvents.PAGE_ACTION_OPEN_PRODUCT_PANEL},t.prototype.isValid=function(){return!!this.productPanelId&&e.prototype.isValid.call(this)},t}(n(3).BaseInteraction);t.ProductPanelVisibilityInteraction=o},3:function(e,t){e.exports=require("@frontend/player/interactions/BaseInteraction")}})}),define("@frontend/player/interactions/visibility/ShoppingCartVisibilityInteraction",["@frontend/player/interactions/BaseInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=103)}({103:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.hasGlobalScope=function(){return!1},t.prototype.getModuleAction=function(){return this.pageView.module.publishedEvents.PAGE_ACTION_OPEN_SHOPPING_CART},t}(n(3).BaseInteraction);t.ShoppingCartVisibilityInteraction=o},3:function(e,t){e.exports=require("@frontend/player/interactions/BaseInteraction")}})}),define("@frontend/player/interactions/visibility/FullScreenInteraction",["@frontend/player/interactions/BaseInteraction"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=93)}({3:function(e,t){e.exports=require("@frontend/player/interactions/BaseInteraction")},93:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getModuleAction=function(){},t.prototype.triggerAction=function(e){var t=document.body;return t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen(),!0},t.prototype.isValid=function(){return"submit"!==this.trigger&&e.prototype.isValid.call(this)},t}(n(3).BaseInteraction);t.FullScreenInteraction=o}})}),define("@frontend/common/utils/jQueryUtils",[],function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=204)}({204:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escapeComponentId=function(e){return void 0===e&&(e=""),e.replace(/([^\\])\|/g,"$1\\|")}}})}),define("modules/url-navigation/module",["log","ceros","device","shared/utils/NavigationUtils","lodash","jquery","shared/utils/ModuleEventManager","@frontend/common/utils/jQueryUtils"],function(e,t,n,i,r,o,a,s){"use strict";var u=new t.Module({id:"url-navigation",description:"",version:"1.0",publishedEvents:{POPSTATE:"url-navigation.popstate"},handledEvents:{},dependencies:{},PAGE_MODES:{NUMBER:"page_number",SLUG:"page_slug"},delegate:{buildHistoryState:function(e,t,n,i,r){var o={mode:e,pageNumber:null,pageSlug:null,layoutSlug:n,title:i,hash:r};return e===u.PAGE_MODES.NUMBER?o.pageNumber=t:o.pageSlug=t,o},getCurrentHistoryState:function(){var e=u.getWindowContext();if(e.history&&e.history.state&&e.history.state.mode)return e.history.state;var t=i.parsePageFromLocation(),n=r.isString(t)?u.PAGE_MODES.SLUG:u.PAGE_MODES.NUMBER,o=i.parseLayoutFromLocation(),a=e.document.title,s=e.location.hash;return u.buildHistoryState(n,t,o,a,s)},navigateTo:function(e,t,a,l){var c=u.getWindowContext(),d=s.escapeComponentId(c.location.hash);d=d&&o(d).parents(".page-viewport").hasClass("top")?c.location.hash:void 0;var h=i.buildUri(e,t,a,d);if(h){if(l||(l=c.document.title),r.endsWith(c.location.href,h)&&null!==c.history.state)return void(document.title=l);if(n.html5()&&c.history&&c.history.pushState){var f=u.buildHistoryState(e,t,a,l,d);c.history.pushState(f,l,h)}document.title=l}},navigateToPageNumber:function(e,t){var n=u.getCurrentHistoryState(),i=n.layoutSlug;u.navigateTo(u.PAGE_MODES.NUMBER,e,i,t)},navigateToLayout:function(e){var t=u.getCurrentHistoryState(),n=t.mode,i=n===u.PAGE_MODES.NUMBER?t.pageNumber:t.pageSlug,r=t.title;u.navigateTo(n,i,e,r)},navigateToPageSlug:function(e,t){var n=u.getCurrentHistoryState(),i=n.layoutSlug;u.navigateTo(u.PAGE_MODES.SLUG,e,i,t)},bindPopstate:r.once(function(){u.getWindowContext().onpopstate=function(e){e.state&&e.state.mode&&a.trigger(u.publishedEvents.POPSTATE,e.state)}}),getWindowContext:function(){return window}}});return u}),define("@frontend/player/interactions/links/BasePageURLInteraction",["@frontend/player/interactions/links/BaseURLInteraction","globals","shared/utils/NavigationUtils","modules/url-navigation/module"],function(e,t,n,i){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=67)}({29:function(e,t){e.exports=require("shared/utils/NavigationUtils")},67:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),a=n(29),s=n(68),u=n(9),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.constructUrl=function(){if(!u.isEmbedded){var e=a.parseLayoutFromLocation(),t=this.pageView.documentVersion.getNearestEnabledPage(Math.max(1,this.getTargetPageNumber()));return a.buildUri(s.PAGE_MODES.NUMBER,t,e)}},t}(o.BaseURLInteraction);t.BasePageURLInteraction=l},68:function(e,t){e.exports=require("modules/url-navigation/module")},8:function(e,t){e.exports=require("@frontend/player/interactions/links/BaseURLInteraction")},9:function(e,t){e.exports=require("globals")}})}),define("@frontend/player/interactions/links/NextPageInteraction",["lodash","@frontend/player/interactions/links/BasePageURLInteraction"],function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=74)}({1:function(t,n){t.exports=e},15:function(e,t){e.exports=require("@frontend/player/interactions/links/BasePageURLInteraction")},74:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(15),a=n(1),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getModuleAction=function(){return this.pageView.module.publishedEvents.PAGE_ACTION_GO_TO_NEXT_PAGE},t.prototype.getTargetPageNumber=function(){var e=a.get(this.pageView,"model.pageIndex")+1;return e?e+1:0},t}(o.BasePageURLInteraction);t.NextPageInteraction=s}})}),define("@frontend/player/interactions/share/SocialMediaInteraction",["lodash","@frontend/player/interactions/links/BaseURLInteraction","shared/utils/NavigationUtils","urlUtils"],function(e,t,n,i){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=88)}({1:function(t,n){t.exports=e},29:function(e,t){e.exports=require("shared/utils/NavigationUtils")},8:function(e,t){e.exports=require("@frontend/player/interactions/links/BaseURLInteraction")},88:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),a=n(1),s=n(29),u=n(89),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getModuleAction=function(){return this.pageView.module.publishedEvents.PAGE_ACTION_SHARE_PAGE},t.prototype.urlForCurrentPage=function(){var e=a.get(this.pageView,"model.pageIndex",0)+1,t=u.removeEmbedParams(s.buildUri("page_number",e));return window.location.protocol+"//"+window.location.host+t},t.prototype.isValid=function(){return"submit"!==this.trigger&&e.prototype.isValid.call(this)},t}(o.BaseURLInteraction);t.SocialMediaInteraction=l},89:function(e,t){e.exports=require("urlUtils")}})}),define("@frontend/player/interactions/share/ShareLinkedInInteraction",["@frontend/player/interactions/share/SocialMediaInteraction","socialSharing"],function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=84)}({10:function(e,t){e.exports=require("socialSharing")},7:function(e,t){e.exports=require("@frontend/player/interactions/share/SocialMediaInteraction")},84:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=n(10),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.constructUrl=function(){return a.urlForLinkedIn(this.urlForCurrentPage())},t}(o.SocialMediaInteraction);t.ShareLinkedInInteraction=s}})}),define("@frontend/player/interactions/share/ShareEmailInteraction",["@frontend/player/interactions/share/SocialMediaInteraction","socialSharing"],function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=82)}({10:function(e,t){e.exports=require("socialSharing")},7:function(e,t){e.exports=require("@frontend/player/interactions/share/SocialMediaInteraction")},82:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=n(10),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.constructUrl=function(){return a.urlForEmail(this.urlForCurrentPage())},t}(o.SocialMediaInteraction);t.ShareEmailInteraction=s}})}),define("@frontend/player/interactions/share/ShareFacebookInteraction",["@frontend/player/interactions/share/SocialMediaInteraction","socialSharing"],function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=83)}({10:function(e,t){e.exports=require("socialSharing")},7:function(e,t){e.exports=require("@frontend/player/interactions/share/SocialMediaInteraction")},83:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=n(10),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.constructUrl=function(){return a.urlForFacebook(this.urlForCurrentPage())},t}(o.SocialMediaInteraction);t.ShareFacebookInteraction=s}})}),define("@frontend/player/interactions/share/SharePinterestInteraction",["@frontend/player/interactions/share/SocialMediaInteraction","globals","socialSharing"],function(e,t,n){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=85)}({10:function(e,t){e.exports=require("socialSharing")},7:function(e,t){e.exports=require("@frontend/player/interactions/share/SocialMediaInteraction")},85:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=n(10),s=n(9),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.constructUrl=function(){var e=s.previewMode?void 0:this.pageView.getThumbnail();return a.urlForPinterest(this.urlForCurrentPage(),e)},t}(o.SocialMediaInteraction);t.SharePinterestInteraction=u},9:function(e,t){e.exports=require("globals")}})}),define("@frontend/player/interactions/share/ShareTwitterInteraction",["@frontend/player/interactions/share/SocialMediaInteraction","socialSharing"],function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=86)}({10:function(e,t){e.exports=require("socialSharing")},7:function(e,t){e.exports=require("@frontend/player/interactions/share/SocialMediaInteraction")},86:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=n(10),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.constructUrl=function(){return a.urlForTwitter(this.urlForCurrentPage())},t}(o.SocialMediaInteraction);t.ShareTwitterInteraction=s}})}),define("@frontend/player/interactions/links/GoToPageInteraction",["lodash","@frontend/player/interactions/links/BasePageURLInteraction"],function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=71)}({1:function(t,n){t.exports=e},15:function(e,t){e.exports=require("@frontend/player/interactions/links/BasePageURLInteraction")},71:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.pageTarget=0,o.isString(t.pageTarget)?i.pageTarget=parseInt(String(t.pageTarget).replace(/#/,""),10):t.pageTarget&&(i.pageTarget=t.pageTarget),i}return r(t,e),t.prototype.getModuleAction=function(){return this.pageView.module.publishedEvents.PAGE_ACTION_GO_TO_PAGE},t.prototype.isValid=function(){return!!this.pageTarget&&e.prototype.isValid.call(this)},t.prototype.getTargetPageNumber=function(){return this.pageTarget},t}(n(15).BasePageURLInteraction);t.GoToPageInteraction=a}})}),define("@frontend/player/interactions/links/PreviousPageInteraction",["lodash","@frontend/player/interactions/links/BasePageURLInteraction"],function(e,t){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=75)}({1:function(t,n){t.exports=e},15:function(e,t){e.exports=require("@frontend/player/interactions/links/BasePageURLInteraction")},75:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(15),a=n(1),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getModuleAction=function(){return this.pageView.module.publishedEvents.PAGE_ACTION_GO_TO_PREV_PAGE},t.prototype.getTargetPageNumber=function(){var e=a.get(this.pageView,"model.pageIndex")+1;return e?e-1:0},t}(o.BasePageURLInteraction);t.PreviousPageInteraction=s}})}),define("@frontend/player/interactions/InteractionFactory",["lodash","@frontend/player/interactions/BaseInteraction","@frontend/player/interactions/links/GoToURLInteraction","@frontend/player/interactions/links/ScrollToInteraction","@frontend/player/interactions/links/ScrollToObjectInteraction","@frontend/player/interactions/group-visibility/CycleNextInteraction","@frontend/player/interactions/group-visibility/CyclePreviousInteraction","@frontend/player/interactions/group-visibility/HideLayersInteraction","@frontend/player/interactions/group-visibility/ShowLayersInteraction","@frontend/player/interactions/group-visibility/ToggleLayersInteraction","@frontend/player/interactions/visibility/HideComponentInteraction","@frontend/player/interactions/visibility/ShowComponentInteraction","@frontend/player/interactions/visibility/PageVisibilityInteraction","@frontend/player/interactions/visibility/LightboxVisibilityInteraction","@frontend/player/interactions/visibility/ProductPanelVisibilityInteraction","@frontend/player/interactions/visibility/ShoppingCartVisibilityInteraction","@frontend/player/interactions/visibility/FullScreenInteraction","@frontend/player/interactions/links/NextPageInteraction","@frontend/player/interactions/share/ShareLinkedInInteraction","@frontend/player/interactions/share/ShareEmailInteraction","@frontend/player/interactions/share/ShareFacebookInteraction","@frontend/player/interactions/share/SharePinterestInteraction","@frontend/player/interactions/share/ShareTwitterInteraction","@frontend/player/interactions/links/GoToPageInteraction","@frontend/player/interactions/links/PreviousPageInteraction"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f,p,g,m,v,y,b,w,_,E,S,T){return function(e){function t(i){if(n[i])return n[i].exports
;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=56)}([,function(t,n){t.exports=e},,function(e,t){e.exports=require("@frontend/player/interactions/BaseInteraction")},,,,,,,,,function(e,t){e.exports=require("@frontend/player/interactions/links/GoToURLInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/links/ScrollToInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/links/ScrollToObjectInteraction")},,,function(e,t){e.exports=require("@frontend/player/interactions/group-visibility/CycleNextInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/group-visibility/CyclePreviousInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/group-visibility/HideLayersInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/group-visibility/ShowLayersInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/group-visibility/ToggleLayersInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/visibility/HideComponentInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/visibility/ShowComponentInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/visibility/PageVisibilityInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/visibility/LightboxVisibilityInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/visibility/ProductPanelVisibilityInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/visibility/ShoppingCartVisibilityInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/visibility/FullScreenInteraction")},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(12),o=n(3),a=n(57),s=n(58),u=n(59),l=n(60),c=n(61),d=n(62),h=n(63),f=n(13),p=n(64),g=n(19),m=n(21),v=n(18),y=n(17),b=n(20),w=n(22),_=n(23),E=n(24),S=n(25),T=n(26),P=n(27),A=n(28),I=n(14),x=function(){function e(){}return e.constructorFor=function(e){switch(e){case"page-next":return a.NextPageInteraction;case"page-prev":return p.PreviousPageInteraction;case"page-goto":return h.GoToPageInteraction;case"url":return r.GoToURLInteraction;case"scroll-to":return f.ScrollToInteraction;case"scroll-to-object":return I.ScrollToObjectInteraction;case"show-only":return _.ShowComponentInteraction;case"hide-only":return w.HideComponentInteraction;case"toggle-layers":return m.ToggleLayersInteraction;case"page-enable-disable":return E.PageVisibilityInteraction;case"lightbox":return S.LightboxVisibilityInteraction;case"product":return T.ProductPanelVisibilityInteraction;case"shopping-cart":return P.ShoppingCartVisibilityInteraction;case"show-fullscreen":return A.FullScreenInteraction;case"show-layers-on-hover":case"show-layers":return b.ShowLayersInteraction;case"hide-layers":return g.HideLayersInteraction;case"cycle-next":return y.CycleNextInteraction;case"cycle-previous":return v.CyclePreviousInteraction;case"share-email":return u.ShareEmailInteraction;case"share-facebook":return l.ShareFacebookInteraction;case"share-twitter":return d.ShareTwitterInteraction;case"share-pinterest":return c.SharePinterestInteraction;case"share-linkedin":return s.ShareLinkedInInteraction;default:return o.BaseInteraction}},e.initializeInteractions=function(t,n){var r=[];if(!i.get(t,"length"))return r;for(var o=0,a=t;o<a.length;o++){var s=a[o];if(s.trigger&&s.action){var u=e.constructorFor(s.action);r.push(new u(s,n))}}return r},e}();t.InteractionFactory=x},function(e,t){e.exports=require("@frontend/player/interactions/links/NextPageInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/share/ShareLinkedInInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/share/ShareEmailInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/share/ShareFacebookInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/share/SharePinterestInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/share/ShareTwitterInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/links/GoToPageInteraction")},function(e,t){e.exports=require("@frontend/player/interactions/links/PreviousPageInteraction")}])}),define("@frontend/player/utils/FocusArbiter",["jquery","whatInput","@frontend/common/utils/jQueryUtils"],function(e,t,n){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=118)}({118:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(31),o=n(119),a=function(){function e(e){this.pageView=e}return e.prototype.searchFoldersForTarget=function(e){var t=this.pageView.model.findLayerById(e);if(t&&"folder"===t.type){var n=this.pageView.model.constructor.findTopmostFolderContent(t);if(n)return this.pageView.$pageContainer.find("#"+o.escapeComponentId(n.id))}return i()},e.prototype.prepareTargetOutlineForFocus=function(t){return("keyboard"!==r.ask()||!t.is("button, a"))&&(t.addClass(e.HIDDEN_OUTLINE_CLASS_NAME),t.off("blur.outline").on("blur.outline",function(){t.off("blur.outline"),t.removeClass(e.HIDDEN_OUTLINE_CLASS_NAME)})),t},e.prototype.prepareTargetOpacityForFocus=function(t){if("none"===t.css("display")){var n=t.attr("aria-hidden");t.off("blur.opacity").on("blur.opacity",function(){t.off("blur.opacity"),t.removeClass(e.FAKELY_HIDDEN_COMPONENT_CLASS_NAME),n?t.attr("aria-hidden",n):t.removeAttr("aria-hidden")}).addClass(e.FAKELY_HIDDEN_COMPONENT_CLASS_NAME).attr("aria-hidden","true")}return t},e.prototype.prepareTargetTabIndexForFocus=function(e){var t=e.attr("tabindex");return t&&"0"!==t?e:e.attr("tabindex",-1).off("blur.tabindex").on("blur.tabindex",function(){e.off("blur.tabindex"),t?e.attr("tabindex",t):e.removeAttr("tabindex")})},e.prototype.moveFocusToElement=function(e){if(e){var t="#"+o.escapeComponentId(e),n=this.pageView.$pageContainer.find(t);n.length||(n=this.searchFoldersForTarget(e)),n.length&&(n=this.prepareTargetOpacityForFocus(n),n=this.prepareTargetOutlineForFocus(n),(n=this.prepareTargetTabIndexForFocus(n)).get(0).focus({preventScroll:!0}))}},e.HIDDEN_OUTLINE_CLASS_NAME="outline-hidden",e.FAKELY_HIDDEN_COMPONENT_CLASS_NAME="fakely-hidden",e}();t.FocusArbiter=a},119:function(e,t){e.exports=require("@frontend/common/utils/jQueryUtils")},31:function(e,t){e.exports=require("whatInput")},4:function(e,t){e.exports=require("jquery")}})}),define("modules/page/views/PageView",["log","jquery","lodash","backbone","device","globals","shared/models/EmbeddedViewportModel","shared/views/PlayerAbstractView","modules/page/views/FolderView","modules/page/views/components/AbstractComponentView","modules/page/views/components/video/AbstractVideoComponentView","modules/page/utils/PageViewPrerenderer","modules/page/utils/AnimationRunner","modules/page/utils/PageChildViewFinder","modules/page/utils/VisibleBoundaries","modules/splash-screen/module","modules/page/utils/PlayerVariantService","modules/page/utils/PlayerVariantDetector","shared/utils/ModuleEventManager","ExtentsUtils","InteractionUtils","@frontend/player/interactions/InteractionFactory","@frontend/common/utils/jQueryUtils","@frontend/player/utils/FocusArbiter","urlUtils"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f,p,g,m,v,y,b,w,_,E,S,T){"use strict";return s.extend({className:"page-viewport",tagName:"div",activated:!1,documentVersion:null,$pageContainer:null,$pinnedContainer:null,$pageScroll:null,scaleContext:null,scaleTransformKey:null,scaleTransformValue:null,scaleExperience:null,prerenderer:null,focusArbiter:null,activeHoversGroupedByInteraction:null,defaults:{physicalPageNumber:"unknown"},initialize:function(){if(this.options=n.defaults(this.options,this.defaults),this.animationRunner=new h,this.documentVersion=this.options.documentVersion,this.scaleContext=this.options.scaleContext,this.scaleExperience=this.documentVersion.getScaleExperience(),this.scrollTriggeredObjects=[],this.resetWhenOffscreenHoverTriggers=[],this.prerenderer=new d(this),this.$pageContainer=t("<div>",{class:"page-container"}),this.throttleReload=n.debounce(n.bind(this.reload,this),1e3),this.documentVersion.on("reload",this.throttleReload),this.$pageScroll=t("<div>",{class:"page-scroll"}),this.$pageContainer.append(this.$pageScroll),this.documentVersion.shouldLazyLoad()&&T.getUrlParams(window.location.href).showLazyLoadBreakpoint){var e=t("<hr/>",{class:"lazyLoadingBreakpointLine"});e.css("top",this.model.getlazyLoadingVerticalBreakpoint()+"px"),this.$pageScroll.append(e)}this.focusArbiter=new S.FocusArbiter(this);var i=this;r.desktop()&&(this.$pinnedContainer=t("<div>",{class:"pinned-container"}),this.$el.append(this.$pinnedContainer),this.$pinnedContainer.on("wheel mousewheel",function(e){if(e.originalEvent.deltaY){e.preventDefault(),e.stopPropagation();var t=i.$pageContainer.scrollTop(),n=e.originalEvent.deltaY;1===e.originalEvent.deltaMode&&(n*=i.getUnstyledLineHeight()),i.$pageContainer.scrollTop(t+n)}})),this.$pageContainer.on("wheel mousewheel",function(e){if(e.originalEvent.deltaY){var t=i.$pageContainer.scrollTop(),n=t+e.originalEvent.deltaY;1===e.originalEvent.deltaMode&&(n=t+e.originalEvent.deltaY*i.getUnstyledLineHeight());var r=i.$pageContainer[0].scrollHeight>i.$pageContainer[0].offsetHeight,a=i.$pageContainer[0].scrollHeight-i.$pageContainer[0].scrollTop>0,s=i.$pageContainer[0].scrollHeight-i.$pageContainer[0].scrollTop<i.$pageContainer[0].clientHeight;if(o.isEmbedded){if(!(-1===window.location.href.indexOf("?heightOverride=")&&r&&a&&s))return;e.preventDefault(),e.stopPropagation(),i.$pageContainer.scrollTop(n)}else e.preventDefault(),e.stopPropagation(),i.$pageContainer.scrollTop(n)}});var u=r.isDesktopSafari()||r.isMobileSafari();r.isIpadPretendingToBeDesktop()&&r.isIosGreaterThanOrEqualTo(13)&&u&&(this.$pageContainer.addClass("page-container-for-ipad-pretending-to-be-desktop"),this.$pinnedContainer.addClass("pinned-container-for-ipad-pretending-to-be-desktop")),this.$el.append(this.$pageContainer),s.prototype.initialize.call(this),this.el=function(){return this.$el},this.$el.attr("data-slug",this.model.get("slug")),this.prepare=n.once(n.bind(this.prepare,this)),this.attach=n.once(n.bind(this.attach,this)),this.spinner=null,this.pageReady=new t.Deferred,this.renderPlaceholder(),this.activeHoversGroupedByInteraction=[],this.lastViewportUpdate=performance.now(),this.isProcessingScroll=!1;var l=this,c=function(e){e-l.lastViewportUpdate>100?(l.onScrollAndWindowResize(),l.lastViewportUpdate=e,l.isProcessingScroll=!1):requestAnimationFrame(c)};this.$pageContainer.on("scroll",function(e){l.isProcessingScroll||(l.isProcessingScroll=!0,requestAnimationFrame(c))}),a.getInstance().on("change",n.bind(this.onScrollAndWindowResize,this)),o.previewMode&&this.registerVariantListeners(),this.childViews=[]},registerVariantListeners:function(){v.on("change",n.debounce(n.bind(this.reload,this),50,{leading:!0,trailing:!0})),a.getInstance().on("change:windowWidth change:windowHeight",function(){v.detect()}),t(window).on("resize",function(){v.detect()})},startLazyPrerender:function(){return this.prerenderer.lazyPrerender()},prerender:function(){this.prerenderer.prerender()},getPrerenderDeferred:function(){return this.prerenderer.prerenderDeferred},isPrerendered:function(){return this.prerenderer.isPrerendered()},resetPageForPrerender:function(){this.closeAllComponents(),this.childViews=[],this.scrollTriggeredObjects=[],this.resetWhenOffscreenHoverTriggers=[]},getUnstyledLineHeight:function(){if(!this.unstyledLineHeight){var e=document.createElement("iframe");e.src="#",document.body.appendChild(e);var t=e.contentWindow,n=t.document;n.open(),n.write("<!DOCTYPE html><html><head></head><body><span>a</span></body></html>"),n.close();var i=n.body.firstElementChild;this.unstyledLineHeight=i.offsetHeight,document.body.removeChild(e)}return this.unstyledLineHeight},getPageHeight:function(){return this.model.getPageHeight(this.documentVersion)},getPageWidth:function(){return this.model.getPageWidth(this.documentVersion)},getScrollPosition:function(){return this.$pageContainer.scrollTop()},setScrollPosition:function(e){this.$pageContainer.scrollTop(e)},focusScrollContainer:function(){this.$pageContainer.trigger("focus")},triggerModuleScrollEvent:function(e){this.getModule().trigger(this.getModule().publishedEvents.PAGE_SCROLL,{slug:this.model.get("slug"),topY:e.topY,bottomY:e.bottomY,pageHeight:this.getPageHeight()})},onScrollAndWindowResize:function(){if(this.activated){var e=this.getVisibleBoundaries();this.animationRunner.whenVisibleBoundariesChange(this.scrollTriggeredObjects,e),this.animationRunner.resetHoverInteractionViewsToInitialVisibility(this.resetWhenOffscreenHoverTriggers,this.childViews,e),this.triggerModuleScrollEvent(e)}},resetTimedTriggers:function(){n.each(this.childViews,function(e){e.resetTimers&&e.resetTimers(),e.timedTriggersCreatedAtLeastOnce=!1})},getVisibleBoundaries:function(){var e=this.getVisibleYBoundaries(),t=this.getVisibleXBoundaries();return t?new p(e.topY,e.bottomY,t.leftX,t.rightX):new p(e.topY,e.bottomY)},getVisibleYBoundaries:function(){var e,t,n=this.getScaleContext(),i=n.height/n.ratio,r=a.getInstance(),o=this.$pageContainer.scrollTop();if(r.isActive()){var s=this.getPageHeight(),u=Math.max((i-s)/2,0),l=r.getTop()/n.ratio,c=r.getBottom()/n.ratio;e=Math.max(l,0)+o-u,t=Math.min(c,i)+o-u}else e=o,t=e+i;return{topY:Math.round(e),bottomY:Math.round(t)}},getVisibleXBoundaries:function(){if(this.scaleExperience)return null;var e=this.getScaleContext();return{leftX:this.$pageContainer.scrollLeft(),rightX:this.$pageContainer.scrollLeft()+e.width}},getScaleContext:function(){return this.scaleContext.getPageScaleContext(this.model)},getSlug:function(){return this.model.get("slug")},onClose:function(){this.closeAllComponents()},closeAllComponents:function(){if(this.childViews){var e=function(t){n.each(t,function(t){t.close(),t.childViews&&e(t.childViews)})};e(this.childViews)}},_bindModel:function(){this.model.on("remote",this.applyRemoteChange,this),this.model.on("reload",this.throttleReload,this)},renderPlaceholder:function(){this.closeAllComponents();var e=t(window);this.$el.css({width:e.width(),height:e.height()}),this._createSpinner(!1)},setFixedPosition:function(e){var t=this;r.desktop()||(e.$el.css("position","fixed"),e.$el.on("mousewheel",function(e){e.preventDefault(),e.stopPropagation();var n=t.$pageContainer.scrollTop();e.originalEvent.deltaY&&t.$pageContainer.scrollTop(n+e.originalEvent.deltaY)}))},findChildView:function(e){return f.find(this.childViews,e)},findVideo:function(e){var t=null,i=function(r){return n.some(r,function(n){return n.el&&n.el.id===e?(t=n,!0):!!n.childViews&&i(n.childViews)})};return this.childViews&&i(this.childViews),t},_addScrollTriggeredObject:function(e){n.some(this.scrollTriggeredObjects,function(t){return t.id==e.id})||this.scrollTriggeredObjects.push(e)},_removeScrollTriggeredObject:function(e){var t;n.find(this.scrollTriggeredObjects,function(n,i){return n.id==e.id&&(t=i,!0)})&&this.scrollTriggeredObjects.splice(t,1)},addResetWhenOffscreenHoverTrigger:function(e){n.some(this.resetWhenOffscreenHoverTriggers,function(t){return t.id==e.id})||this.resetWhenOffscreenHoverTriggers.push(e)},removeResetWhenOffscreenHoverTrigger:function(e){var t;n.find(this.resetWhenOffscreenHoverTriggers,function(n,i){return n.id==e.id&&(t=i,!0)})&&this.resetWhenOffscreenHoverTriggers.splice(t,1)},prepare:function(){return this.prerenderer.isPrerendered()||this.prerenderer.prerender(),this.prerenderer.getPrerenderPromise().done(n.bind(function(){t.when.apply(t,this.attachInitialMedia()).done(n.bind(function(){e.debug("All page media attached"),this.pageReady.resolve()},this)).fail(n.bind(function(){e.debug("Page media failed"),this.pageReady.reject()},this))},this)),this.pageReady.promise()},attachInitialMedia:function(){return this.documentVersion.shouldLazyLoad()?(this.attachChildMedia(this,!0),this.attachInitialViewportMedia(this)):this.attachChildMedia(this,!0)},attachViewMedia:function(e){var t=[];t.push(e.attachMedia());return t=t.concat(this.attachChildMedia(e,!1))},attachChildMedia:function(e,t){var i=[],r=this,o=function(e){n.each(e,function(e){t&&!e.initiallyVisible||((!r.documentVersion.shouldLazyLoad()||r.documentVersion.shouldLazyLoad()&&!e.options.isInInitialViewport)&&i.push(e.attachMedia()),e.childViews&&o(e.childViews))})};return e&&e.childViews&&o(e.childViews),i},attachInitialViewportMedia:function(e){var t=[],i=function(e){n.each(e,function(e){e.options.isInInitialViewport&&t.push(e.attachMedia()),e.childViews&&i(e.childViews)})};return e&&e.childViews&&i(e.childViews),t},scale:function(){var e=this.getScaleContext();this.model.preloadImages(e);var t=function(e){n.each(e,function(e){(e.mediaHasBeenLoaded||e.initiallyVisible)&&(e.scaleComponent(),e.childViews&&t(e.childViews))})};t(this.childViews)},doCustomScaling:function(){var e=function(t){n.each(t,function(t){(t.mediaHasBeenLoaded||t.initiallyVisible)&&(t.doCustomScaling(!0),t.childViews&&e(t.childViews))})};e(this.childViews)},attach:function(){this._destroySpinner(),this.pageReady.resolve(),this.render(),e.debug("Page idx: "+this.getPageIndex()+" attached!")},render:function(){this.$pageScroll[0].appendChild(this.prerenderer.getDocumentFragment()),r.desktop()&&this.$pinnedContainer[0].appendChild(this.prerenderer.getPinnedDocumentFragment());var e=function(t){n.each(t,function(t){t.onAttach(),t.childViews&&(r.isDesktopSafari()&&t.childrenUseBlendingModes()&&n.isFunction(t.prepareGroupForBlendingModes)&&t.prepareGroupForBlendingModes(),e(t.childViews))})};e(this.childViews),this.$pageScroll.trigger("focus")},applyRemoteChange:function(e){var t=this,n=this.findChildView(e.id);if(t.model.updateLayerDictionaryFromRemoteChange(e),n&&n instanceof l){var i=!1;i=!n.areAllParentsVisible(),n.applyChanges(t.applyPageContext(e.options)),i&&n.hide(),n.doTriggerOnScroll()?t._addScrollTriggeredObject(n):t._removeScrollTriggeredObject(n),n.getResettableHoverInteractions()?t.addResetWhenOffscreenHoverTrigger(n):t.removeResetWhenOffscreenHoverTrigger(n)}},reload:function(){var e=v.getVariant();if(e!==this.model.getReconciledVariant()){var t=this.model.reconcileLayers(this.model.get("layerHierarchies")[e],this.model.get("layerDictionary"));this.model.set("layers",t),this.model.resolveSmartgroupsAndMedia()}this.scaleExperience=this.documentVersion.getScaleExperience();var n=this.getScaleContext();this.documentVersion.shouldLazyLoad()?this.model.lazyPreloadAllMedia(n,this.options.isRequestedPage):(this.model.preloadVisibleMedia(n,!0),this.model.preloadHiddenMedia(n)),this.prerender(),this.$pageScroll.empty(),r.desktop()&&this.$pinnedContainer.empty(),this.resetTimedTriggers(),this.render(),this.getModule().trigger(this.getModule().publishedEvents.PAGE_RELOAD),this.attachInitialMedia(),this.activateAndRunEntryAnimationsForAllVisible()},storeScaleTransform:function(e,t){this.scaleTransformKey=e,this.scaleTransformValue=t},setBackgroundPositionAndScaleTransform:function(e,t){var n={"background-position-x":e+"px",zoom:"",transform:""};(this.scaleExperience||t)&&(t?"transform"===this.scaleTransformKey?n.transform="translateX("+e+"px) "+this.scaleTransformValue:(n.transform="translateX("+e+"px)",n[this.scaleTransformKey]=this.scaleTransformValue):n[this.scaleTransformKey]=this.scaleTransformValue),this.$el.css(n)},getLeft:function(){return parseInt(this.$el.css("background-position-x"),10)},setOpacity:function(e){this.$pageScroll.css("opacity",e)},isInTransition:function(){return this.$el.hasClass("in-transition")},isPending:function(){return this.$el.hasClass("pending")},isTop:function(){return this.$el.hasClass("top")},isViewed:function(){return this.$el.hasClass("viewed")},isReady:function(){return"resolved"===this.pageReady.state()},isDisabled:function(){return!0===this.model.get("disabled")},disable:function(){this.model.set("disabled",!0)},enable:function(){this.model.set("disabled",!1)},makeInTransition:function(){this.$el.addClass("in-transition"),this._startSpinner()},makePending:function(){this.$el.removeClass("top viewed in-transition").addClass("pending").attr("aria-hidden",!0);var e=this.getScaleContext();this.setBackgroundPositionAndScaleTransform(e.originalWindowWidth,!1),this._stopSpinner()},makeTop:function(){this._startSpinner(),this.$el.removeClass("pending viewed in-transition").addClass("top").attr("aria-hidden",!1),this.setBackgroundPositionAndScaleTransform(0,!1)},activate:function(){this.activateAndRunEntryAnimationsForAllVisible();var e=this.getVisibleBoundaries();this.animationRunner.createTimedTriggers(this.scrollTriggeredObjects,e),this.getModule().trigger(this.getModule().publishedEvents.PAGE_ACTIVATED,{slug:this.model.get("slug"),pageName:this.model.get("name"),topY:e.topY,bottomY:e.bottomY,pageHeight:this.getPageHeight()}),this.activated=!0},triggerScrollTo:function(e){e=e.replace(/^#?/,""),e=window.decodeURIComponent(e);var t="#"+E.escapeComponentId(e),n="component",i=e.match(/page-[0-9]+-(top|bottom)/);i?n=i[1]:this.$pageContainer.find(t).hasClass("scranchor")&&(n="scranchor"),y.trigger(this.module.publishedEvents.PAGE_ACTION_SCROLL_TO,{scrollTargetType:n,scrollTargetScranchor:e})},makeViewed:function(){this.$el.removeClass("top pending in-transition").addClass("viewed").attr("aria-hidden",!0);var e=this.getScaleContext();this.setBackgroundPositionAndScaleTransform(-e.originalWindowWidth,!1),this._stopSpinner()},getThumbnail:function(){return this.options&&this.options.thumbnail?T.makeUrlAbsolute(this.options.thumbnail):null},getChildViews:function(){return this.childViews},isChildVisible:function(e){return null!==e&&!0===e.visible},reset:function(){this.childViews&&(this.deactivateHovers(),this.animationRunner.resetAnimationsAndInitialVisibility(this.childViews))},activateAndRunEntryAnimationsForAllVisible:function(){this.childViews&&this.animationRunner.activateAndRunEntryAnimationsForAllVisible(this.childViews,this.getVisibleBoundaries())},pauseAnimations:function(){if(this.childViews){var e=function(t){n.each(t,function(t){t.pauseAnimations(),t.childViews&&e(t.childViews)})};e(this.childViews)}},resumeAnimations:function(){if(this.childViews){var e=function(t){n.each(t,function(t){t.resumeAnimations(),t.childViews&&e(t.childViews)})};e(this.childViews)}},isValidChildView:function(e){return null!==this.findChildView(e)},applyPageContext:function(e){return e.interactions=_.InteractionFactory.initializeInteractions(e.interactions,this),n.defaults(e,{pageWidth:this.getPageWidth(),pageHeight:this.getPageHeight(),module:this.getModule(),pageView:this,theme:this.options.theme,allowCommerceIntegration:this.options.allowCommerceIntegration})},invokeShowAction:function(e){if(e&&0!==e.length){var t=this,i=[];n.each(e,function(e){var n=t.findChildView(e);n&&i.push(n)}),this.loadAllMediaThenShowChildViews(n.uniq(i))}},invokeHideAction:function(e){if(e&&0!==e.length){var t=[],i=this;n.each(e,function(e){var n=i.findChildView(e);n&&t.push(n)}),this.hideAllChildViews(n.uniq(t))}},invokeToggleAction:function(e){if(e&&0!==e.length){var t=[],i=[],r=this;n.each(e,function(e){var n=r.findChildView(e);n&&(r.isChildVisible(n)?t.push(n):i.push(n))}),this.hideAllChildViews(n.uniq(t)),this.loadAllMediaThenShowChildViews(n.uniq(i))}},invokeShowOrHideOnlyAction:function(e,t){if(e&&0!==e.length){var i=[];n.each(e,n.bind(function(e){var t=this.findChildView(e);t&&(t.parentViews.length>0?i.push(t.parentViews[0]):i.push(this))},this));var r=[],o=[];n.each(n.uniq(i),function(i){n.each(i.childViews,function(n){var i=-1!==e.indexOf(n.id);i&&t||!i&&!t?o.push(n):r.push(n)})}),this.loadAllMediaThenShowChildViews(n.uniq(o)),this.hideAllChildViews(n.uniq(r))}},invokeShowOnlyAction:function(e){this.invokeShowOrHideOnlyAction(e,!0)},invokeHideOnlyAction:function(e){this.invokeShowOrHideOnlyAction(e,!1)},invokeCycleNextOrPreviousAction:function(e,t){if(e&&0!==e.length){var i=[],r=[];n.each(e,n.bind(function(e){var o=this.findChildView(e);if(o&&o.childViews&&0!==o.childViews.length){var a,s=n.findLast(o.childViews,function(e){return e.visible});if(s){var u=o.childViews.indexOf(s);a=t?0===u?o.childViews.length-1:u-1:u===o.childViews.length-1?0:u+1}else a=t?o.childViews.length-1:0;r.push(o.childViews[a]),i=i.concat(o.childViews.slice(0,a)).concat(o.childViews.slice(a+1))}},this)),this.loadAllMediaThenShowChildViews(n.uniq(r)),this.hideAllChildViews(n.uniq(i))}},invokeCycleNextAction:function(e){this.invokeCycleNextOrPreviousAction(e,!0)},invokeCyclePreviousAction:function(e){this.invokeCycleNextOrPreviousAction(e,!1)},loadAllMediaThenShowChildViews:function(i){function r(){var e=o.getVisibleBoundaries();n.each(i,function(t){t.mediaHasBeenLoaded=!0,o.animationRunner.showChildViewIfAllParentsVisible(t,e)})}var o=this,a=[];if(n.each(i,function(e){e.mediaHasBeenLoaded||(a=a.concat(o.attachViewMedia(e)))}),n.isEmpty(a))r();else{n.isNull(o.childLoadingTimeout)||clearTimeout(o.childLoadingTimeout),o.childLoadingTimeout=n.delay(function(){o._createSpinner(!0)},200);var s=function(){clearTimeout(o.childLoadingTimeout),o.childLoadingTimeout=null,o._destroySpinner(),r()};t.when.apply(t,a).done(function(){e.debug("Successfully attached child media being shown."),s()}).fail(function(){e.debug("Failed to load child media being shown."),s()})}},hideAllChildViews:function(e){this.animationRunner.hideAllChildViewsAndRunExitAnimations(e)},_createSpinner:function(e){n.isNull(this.spinner)&&(this.spinner=g.showLoading(this.$el,{startImmediately:e}))},_destroySpinner:function(){this.spinner&&(this.spinner.destroy(),this.spinner=null)},_stopSpinner:function(){this.spinner&&this.spinner.stop()},_startSpinner:function(){this.spinner&&this.spinner.start()},addActiveHoverAndBindMouseEvents:function(e,t){0===this.activeHoversGroupedByInteraction.length&&(this.$pageScroll.on("mousemove",n.bind(this._handleMouseMove,this)),this.$pageScroll.on("mouseleave",n.bind(this._handleMouseLeave,this)),this.$pinnedContainer.on("mousemove",n.bind(this._handleMouseMove,this)));var i=t.getHoverTargets(),r=e.getExtents(),o=[];if(n.isEmpty(r))return void this.deactivateHovers();n.each(i,n.bind(function(n){if(this.isValidChildView(n)){var i=e.isFixedPosition(),r=this.calculateHoverArea(e,e.getExtents(),n,t,i),a=this.findChildView(n),s=parseInt(a.$el.css("zIndex"),10)||0;"folder"===a.options.type&&(s=a.getFirstAvailableZIndex());var u={object:e,interaction:t,area:r,target:a,targetZIndex:s,pinned:i};o.push(u)}},this)),this.activeHoversGroupedByInteraction.push(o)},calculateHoverArea:function(e,t,i,r,o){var a,s=this.getChildViewExtents(i);if(n.isEmpty(s))return void this.deactivateHovers();if(o){var u=n.cloneDeep(e.getExtents()),l=e.getTopAndBottomFixedPosition(u.y1,u.y2);u.y1=l.top,u.y2=l.bottom,a=b.createHoverArea(u,s,!1)}else a=b.createHoverArea(t,s,!1);return a},getMouseXAndMouseYFromEvent:function(e){var t,n,i=this.getScaleContext(),r=this.$pageScroll.offset();return this.scaleContext.useZoom(i.ratio)?(t=e.pageX/i.ratio-r.left,n=e.pageY/i.ratio-r.top):(t=(e.pageX-r.left)/i.ratio,n=(e.pageY-r.top)/i.ratio),{mouseX:t,mouseY:n}},_handleMouseMove:function(e){var t=this,i=this.getMouseXAndMouseYFromEvent(e),r=i.mouseX,o=i.mouseY,a=[],s=Math.ceil(r),u=Math.floor(r),l=Math.ceil(o),c=Math.floor(o);n.each(this.activeHoversGroupedByInteraction,n.bind(function(e){n.every(e,function(e){var i,r,o=e.object.isHovered()||e.target.isHovered();if(w.shouldCreateHoverArea(e.interaction)||e.pinned){var a=n.cloneDeep(e.object.getExtents());i=t.calculateHoverArea(e.object,a,e.target.id,e.interaction,e.pinned),r=!(Math.pointInPoly(i,s,l)||Math.pointInPoly(i,s,c)||Math.pointInPoly(i,u,l)||Math.pointInPoly(i,u,c)||o)}else r=!o;return e.target.mediaHasBeenLoaded&&r})?e[0].object.triggerMouseOutAction(e[0].interaction):a.push(e)},this)),this.activeHoversGroupedByInteraction=a,0===this.activeHoversGroupedByInteraction.length&&this.deactivateHovers()},_handleMouseLeave:function(e){n.each(this.activeHoversGroupedByInteraction,n.bind(function(e){e[0].object.triggerMouseOutAction(e[0].interaction)},this)),this.deactivateHovers()},deactivateNonParentHovers:function(e){var t=[];n.each(this.activeHoversGroupedByInteraction,n.bind(function(i){if(i.length>0){n.every(i,n.bind(function(t){var n=e.idBelongsToParent(t.target.id)||t.target.id===e.id,i=t.object.id===e.id;return!(n||i||!t.target.mediaHasBeenLoaded)},this))?i[0].object.triggerMouseOutAction(i[0].interaction):t.push(i)}},this)),this.activeHoversGroupedByInteraction=t},isMouseOverAnActiveHoverAreaWithHigherZIndex:function(e,t){var i=this.getMouseXAndMouseYFromEvent(t),r=i.mouseX,o=i.mouseY,a=Math.ceil(r),s=Math.floor(r),u=Math.ceil(o),l=Math.floor(o),c=!1,d=parseInt(e.$el.css("zIndex"),10)||0;return"folder"===e.options.type&&(d=e.getFirstAvailableZIndex()),n.each(this.activeHoversGroupedByInteraction,n.bind(function(e){if(e.length>0&&(c=n.some(e,n.bind(function(e){return!!(e.interaction.createHoverArea&&e.targetZIndex>d)&&(Math.pointInPoly(e.area,a,u)||Math.pointInPoly(e.area,a,l)||Math.pointInPoly(e.area,s,u)||Math.pointInPoly(e.area,s,l))},this))))return!0},this)),c},deactivateHovers:function(){this.activeHoversGroupedByInteraction=[],this.$pageScroll.off("mousemove"),this.$pageScroll.off("mouseleave")},getChildViewExtents:function(e){var t=this.findChildView(e),n={};if(t&&(n=t.getExtents(),t.isFixedPosition())){var i=t.getTopAndBottomFixedPosition(n.y1,n.y2);n.y1=i.top,n.y2=i.bottom}return n},getPageIndex:function(){return this.model.getPageIndex()}})}),define("modules/page/module",["lodash","ceros","globals","modules/page/views/PageView"],function(e,t,n,i){"use strict";var r=new t.Module({id:"page",description:"",version:"1.0",dependencies:{splashScreen:"1.0"},publishedEvents:{PAGE_COMPONENT_INTERACTION:"page.component.interaction",PAGE_COMPONENT_HOVER_INTERACTION:"page.component.hover.interaction",PAGE_COMPONENT_CLICKED:"page.component.clicked",PAGE_COMPONENT_FORM_SUBMITTED:"page.component.form_submitted",PAGE_PRELOAD_READY:"page.preload_ready",PAGE_ACTIVATED:"page.activated",PAGE_SCROLL:"page.scroll",PAGE_ACTION_SCROLL_TO:"page.action.scroll_to",PAGE_ACTION_GO_TO_PREV_PAGE:"page.action.go_to_prev_page",PAGE_ACTION_GO_TO_NEXT_PAGE:"page.action.go_to_next_page",PAGE_ACTION_GO_TO_PAGE:"page.action.go_to_page",
PAGE_ACTION_ENABLE_DISABLE_PAGES:"page.action.enable_disable_pages",PAGE_ACTION_GO_TO_URL:"page.action.go_to_url",PAGE_ACTION_OPEN_LIGHTBOX:"page.action.open_lightbox",PAGE_ACTION_OPEN_PRODUCT_PANEL:"page.action.open_product_panel",PAGE_ACTION_OPEN_SHOPPING_CART:"page.action.open_shopping_cart",PAGE_ACTION_LAYER_VISIBILITY:"page.action.layer_visibility",PAGE_ACTION_INVOKE_ANIMATION:"page.action.invoke.animation",PAGE_ACTION_PLAY_AUDIO:"page.action.play_audio",PAGE_ACTION_SHARE_PAGE:"page.action.share.page",PAGE_VIDEO_PLAY:"page.video.play",PAGE_VIDEO_PROGRESS_TIME:"page.video.progress_time",PAGE_VIDEO_PROGRESS_PERCENT:"page.video.progress_percent",PAGE_RELOAD:"page.reload",PAGE_COMPONENT_ANIMATION_START:"page.component.animation.start",PAGE_COMPONENT_ANIMATION_END:"page.component.animation.end",TIMED_INTERACTION:"page.component.timed.interaction"},INTERACTION_TRIGGERS:{CLICK:"click",HOVER:"hover",VIEW:"view",SUBMIT:"submit"},delegate:{createPageView:function(t,o){var a={theme:e.isUndefined(n.themeObj)?{}:n.themeObj};return o=e.extend({enableLoadingThumbnail:!1,enableLoadingSpinner:!1,allowCommerceIntegration:n.allowCommerceIntegration},a,o||{}),new i(e.extend(o,{module:r,model:t}))}}});return r});define("modules/viewport/module",["jquery","lodash","log","ceros","globals","modules/viewport/views/ViewportView","socialSharing","device","shared/utils/NavigationUtils","shared/utils/CerosResourceLoader","libs/image/ImageResource","modules/viewport/utils/PageLoadPolicy","modules/page/module","shared/utils/ScaleContext","shared/utils/ModuleEventManager","urlUtils"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f,p,g){"use strict";var m={TOP:"top",BOTTOM:"bottom",SCRANCHOR:"scranchor",COMPONENT:"component"},v=null,y=null,b=null,w=null,_=null,E=null,S=null,T=new i.Module({id:"viewport",description:"",version:"1.0",dependencies:{page:"1.0"},firstPageShown:new e.Deferred,publishedEvents:{LONGPRESS:"viewport.longpress",SCALE:"viewport.scale",PAGE_CHANGE:"viewport.page_change",PAGE_CHANGING:"viewport.page_changing",PAGE_BATCH_LOAD_START:"viewport.page_batch_load_start",PAGE_UPDATE:"viewport.page_update",PAGE_ENABLED_CHANGE:"viewport.page_enabled_change",CURRENT_PAGE_DELETED:"viewport.current_page_deleted",TIMED_LIGHTBOX:"viewport.timed.lightbox",TIMED_PRODUCT_PANEL:"viewport.timed.product_panel",TIMED_SHOPPING_CART:"viewport.timed.shopping_cart"},delegate:{init:function(e,i){b=e,S=i.performanceTracker;var a=t.extend({module:T,marginTopCallback:function(){return 0},documentVersion:b},i||{});y=new f(a);var s=t.extend({module:T,documentVersion:b,scaleContext:y},i||{});v=new o(s),v.preloadMedia();var l=new d(b.getEnabledPageIndexes(),b.isCarousel()),c=u.parsePageFromLocation();_=b.getPageInfoByNumberOrSlug(c).number;var h=b.getNearestEnabledPage(_);_===h||r.previewMode||(n.info("Requesting disabled page",_),_=h),E=l.getPageIndexesToLoad(_-1),this.registerEvents()},triggerExperienceLevelInteractions:function(e){e.get("interactions")&&t.each(e.get("interactions"),function(e){switch(e.action){case"lightbox":setTimeout(function(){T.trigger(T.publishedEvents.TIMED_LIGHTBOX,e)},1e3*e.delay);break;case"product":setTimeout(function(){T.trigger(T.publishedEvents.TIMED_PRODUCT_PANEL,e)},1e3*e.delay);break;case"shopping-cart":setTimeout(function(){T.trigger(T.publishedEvents.TIMED_SHOPPING_CART,e)},1e3*e.delay)}})},registerEvents:function(){p.on("sdk.experience.page.goto",t.bind(function(e){this.jumpToPage(e.pageNum,!0)},this)),p.on("sdk.experience.page.next",t.bind(function(e){this.nextPage()},this)),p.on("sdk.experience.page.previous",t.bind(function(e){this.previousPage()},this)),p.on("sdk.component.video.start",t.bind(function(e){this.startVideo(e.componentId)},this)),p.on("sdk.component.video.stop",t.bind(function(e){this.stopVideo(e.componentId)},this)),p.on("sdk.component.text.settext",t.bind(function(e){this.setComponentText(e.componentId,e.textContent)},this)),p.on("sdk.component.image.seturl",t.bind(function(e){this.setImageUrl(e.componentId,e.url,e.useNewImageSize)},this)),p.on("sdk.component.image.reset",t.bind(function(e){this.resetImage(e.componentId)},this)),p.on("sdk.component.click",t.bind(function(e){this.clickComponent(e.componentId)},this)),p.on("sdk.component.show",t.bind(function(e){this.showComponent(e.componentId)},this)),p.on("sdk.component.hide",t.bind(function(e){this.hideComponent(e.componentId)},this)),p.on("sdk.layer.show",t.bind(function(e){this.showLayer(e.layerId)},this)),p.on("sdk.layer.hide",t.bind(function(e){this.hideLayer(e.layerId)},this)),p.on("sdk.page.animations.start",t.bind(function(e){this.startPageAnimations(e.pageSlug)},this)),p.on("sdk.page.animations.pause",t.bind(function(e){this.pausePageAnimations(e.pageSlug)},this)),p.on("sdk.page.disable",t.bind(function(e){this.disablePage(e.pageNum)},this)),p.on("sdk.page.enable",t.bind(function(e){this.enablePage(e.pageNum)},this))},createPageViews:function(){var e=[];h.on(h.publishedEvents.PAGE_RELOAD,function(){v.scale()}),w=b.editorPagesManifest,w.each(t.bind(function(t,n){var i=this.createSinglePageView(t,n);e.push(i)},this)),this.pageViews=e},createSinglePageView:function(e,t){var n=b.getPages()[t],i=h.createPageView(n,{physicalPageNumber:t,enableLoadingThumbnail:!1,enableLoadingSpinner:!0,thumbnail:e.get("thumbnail"),documentVersion:b,scaleContext:y,isRequestedPage:t===_-1});return r.previewMode&&n.on("remote",function(){t===v.getCurrentPage().getPageIndex()&&v.mainContentLink.render()}.bind(this)),i},getPageViews:function(){return this.pageViews},scale:function(){v.scalePageComponents()},preloadPageMedia:function(){var e=t.map(b.getPages(),function(e){return y.getPageScaleContext(e)});b.shouldLazyLoad()?(t.each(E,t.bind(function(t,i){var r=b.getPages()[t];0===i?S.mark(S.MARKS.PLAYER.HIGH_PRIORITY_IMAGES_START_LOADING):1===i&&S.mark(S.MARKS.PLAYER.LOW_PRIORITY_IMAGES_START_LOADING),n.debug("Lazy preloading media for page: "+(t+1));var o=0===i;r.lazyPreloadAllMedia(e[t],o)},this)),1===E.length&&S.mark(S.MARKS.PLAYER.LOW_PRIORITY_IMAGES_START_LOADING),t.each(b.getPages(),function(i,r){t.includes(E,r)||(n.debug("Lazy preloading media for page: "+(r+1)),i.lazyPreloadAllMedia(e[r],!1))})):(S.mark(S.MARKS.PLAYER.HIGH_PRIORITY_IMAGES_START_LOADING),t.each(E,t.bind(function(t,i){var r=b.getPages()[t],o=e[t];n.debug("Preloading visible media for page: "+(t+1)),r.preloadVisibleMedia(o,!0)},this)),S.mark(S.MARKS.PLAYER.LOW_PRIORITY_IMAGES_START_LOADING),t.each(b.getPages(),function(i,r){t.includes(E,r)||(n.debug("Preloading visible media for page: "+(r+1)),i.preloadVisibleMedia(e[r],!1))}),t.each(b.getPages(),function(t,i){n.debug("Preloading hidden media for page: "+(i+1)),t.preloadHiddenMedia(e[i])}))},renderPages:function(){this.createPageViews(),v.reset(this.pageViews,_),this.preRenderPages(),n.debug("Setting up the lazy preRender Defer"),t.defer(t.bind(T.startLazyPrerender,T));var e=v.showPage(_);return e.done(T.firstPageShown.resolve),e},activateFirstPage:function(){v.getBackgroundImagePromise().done(t.bind(v.showBackground,v));var e=v.getCurrentPage();if(v.activatePage(e),T.triggerExperienceLevelInteractions(b),window.location.hash)e.triggerScrollTo(window.location.hash);else if(!r.isEmbedded&&s.isWindows()){var n="page-"+this.getCurrentPageNumber()+"-top";e.focusArbiter.moveFocusToElement(n)}},preRenderPages:function(){S.mark(S.MARKS.PLAYER.BEGIN_PRERENDERING_PAGES);var n=this.pageViews;n=b.shouldLazyLoad()?[this.pageViews[E[0]]]:t.map(E,t.bind(function(e){return this.pageViews[e]},this));var i=[];t.each(n,t.bind(function(e){e.prerender(),i.push(e.getPrerenderDeferred())},this)),e.when.apply(e,i).done(t.bind(function(){S.mark(S.MARKS.PLAYER.ALL_PAGES_PRERENDERED)},this))},isFirstPageReadyToShow:function(){return"resolved"===T.firstPageShown.state()},getFirstPageReadyPromise:function(){return T.firstPageShown},nextPage:function(){v&&v.nextPage()},previousPage:function(){v&&v.previousPage()},jumpToPage:function(e,t){v&&v.jumpToPage(e,t)},show:function(){v&&v.show()},hide:function(){v&&v.hide()},el:function(){return v?v.$el:null},getCurrentPageHeight:function(){if(v){var e=v.getCurrentPage();if(e)return e.getPageHeight()}return null},getCurrentPageSlug:function(){return v?v.currentPageSlug:null},getCurrentPageNumber:function(){return v?v.currentPage:null},isLastPage:function(e){var n=w.length,i=w.at(n-1);return t.last(i.uri.split("/"))===e},isFirstPage:function(e){var n=w.at(0);return t.last(n.uri.split("/"))===e},scrollTo:function(e,t){var n=v.getCurrentPage(),i=this.getScrollPositionForInteraction(e,t),o=r.shouldReduceMotion?0:300;return e!==m.TOP&&e!==m.BOTTOM||(t="page-"+(n.model.pageIndex+1)+"-"+e),n.$pageContainer.animate({scrollTop:i},o,"easeOutCubic",function(){n.focusArbiter.moveFocusToElement(t)}),{scrollPosition:i,pageHeight:n.model.getPageHeight(b),visibleHeight:n.$pageContainer.height()}},getScrollPositionForInteraction:function(e,i){switch(e){case m.TOP:return 0;case m.BOTTOM:return v.getCurrentPage().model.getPageHeight(b);case m.SCRANCHOR:var r=v.getCurrentPage().model.getScranchorsForCurrentVariant();return r&&t.has(r,i)?r[i]:(n.warn("Could not find scranchor for id: "+i),null);case m.COMPONENT:var o=v.getCurrentPage().model,a=o.findLayerById(i);if(!a)return n.warn("Could not find component to scroll to: "+i),null;if("folder"===a.type&&!(a=o.constructor.findTopmostFolderContent(a)))return n.warn("Attempted to scroll to empty folder component: "+i),null;var s=a.y;return a.parentSmartgroup&&(s+=a.parentSmartgroup.options.y),s;default:return n.warn("Scroll interaction target type is invalid: "+e),null}},shareCurrentPageOnSocial:function(e,t){if(r.previewMode)return void alert("Pages can not be shared as a preview.  Social sharing will be enabled in the published experience.");if(v){var n=u.buildUriForPageNumber(v.currentPage),i=v.getCurrentPage(),o=i.getThumbnail();this.shareOnSocial(e,window.location.protocol+"//"+window.location.host+n,o)}},shareOnSocial:function(e,n,i){n=g.removeEmbedParams(n);var o=t.isEmpty(r.openGraphUrl)?n:r.openGraphUrl;switch(e){case"share-twitter":a.shareOnTwitter(o);break;case"share-linkedin":a.shareOnLinkedIn(o);break;case"share-pinterest":a.shareOnPinterest(o,i);break;case"share-facebook":a.shareOnFacebook(n);break;case"share-email":a.shareViaEmail(n)}},addClickShield:function(){v&&v.addClickShield()},removeClickShield:function(){v&&v.removeClickShield()},disableGestures:function(){t.isFunction(v.disableGestures)&&v.disableGestures()},enableGestures:function(){t.isFunction(v.enableGestures)&&v.enableGestures()},getExperienceWidth:function(){return v.getExperienceWidth()},getExperienceHeight:function(){return v.getExperienceHeight()},startVideo:function(e){var n=v.getCurrentPage(),i=n.model.getAllSmartgroupInstanceComponentIds(e),r=[e].concat(i);t.each(r,function(e){var t=v.getCurrentPage().findVideo(e);t&&t.play()})},stopVideo:function(e){var n=v.getCurrentPage(),i=n.model.getAllSmartgroupInstanceComponentIds(e),r=[e].concat(i);t.each(r,function(e){var t=v.getCurrentPage().findVideo(e);t&&t.manuallyPause()})},setComponentText:function(e,n){var i=v.getCurrentPage(),r=i.model.getAllSmartgroupInstanceComponentIds(e),o=[e].concat(r);t.each(o,function(e){var i=v.getCurrentPage().findChildView(e);i&&"text"===i.type&&i.setTextFromSDK(t.isNil(n)?"":String(n))})},setImageUrl:function(n,i,r){var o=v.getCurrentPage(),a=o.model.getAllSmartgroupInstanceComponentIds(n),s=[n].concat(a);t.each(s,function(t){var n=v.getCurrentPage().findChildView(t);if(n&&"image"===n.type)if(n.srcOverride=i,n.dimensionsOverride=r,r){var o=new Image;o.onload=function(){var t=n.$imgEl.attr("style"),i=n.$imgEl.attr("alt");n.$imgEl.remove();var r=e(o);r.attr("style",t).attr("alt",i),n.$imgEl=e(r),n.$el.append(n.$imgEl)},o.src=i}else n.$imgEl.attr("src",i)})},resetImage:function(e){var n=v.getCurrentPage(),i=n.model.getAllSmartgroupInstanceComponentIds(e),r=[e].concat(i);t.each(r,function(e){var t=v.getCurrentPage().findChildView(e);t&&"image"===t.type&&(t.srcOverride=null,t.dimensionsOverride=null,t.render())})},showLayer:function(e){var t=v.getCurrentPage(),n=t.model.getAllSmartgroupInstanceLayerIds(e),i=[e].concat(n);v.getCurrentPage().invokeShowAction(i)},hideLayer:function(e){var t=v.getCurrentPage(),n=t.model.getAllSmartgroupInstanceLayerIds(e),i=[e].concat(n);t.invokeHideAction(i)},clickComponent:function(e){var n=v.getCurrentPage(),i=n.model.getAllSmartgroupInstanceComponentIds(e),r=[e].concat(i);t.each(r,function(e){var t=n.findChildView(e);t&&t.simulateClick()})},showComponent:function(e){var n=v.getCurrentPage(),i=n.model.getAllSmartgroupInstanceComponentIds(e),r=[e].concat(i);t.each(r,function(e){var t=v.getCurrentPage().findChildView(e);t&&(t.reset(),t._applyVisibility(!0),t.activateAndRunEntryAnimations())})},hideComponent:function(e){var n=v.getCurrentPage(),i=n.model.getAllSmartgroupInstanceComponentIds(e),r=[e].concat(i);t.each(r,function(e){var t=v.getCurrentPage().findChildView(e);t&&t._applyVisibility(!1)})},startPageAnimations:function(e){var t=v.getCurrentPage();t.model.get("slug")===e&&(t.reset(),t.activateAndRunEntryAnimationsForAllVisible())},pausePageAnimations:function(e){var t=v.getCurrentPage();t.model.get("slug")===e&&t.pauseAnimations()},disablePage:function(e){v.disablePage(e)},enablePage:function(e){v.enablePage(e)},isLayerVisible:function(e){return t.some(this.pageViews,function(t){return t.isChildVisible(e)})}},startLazyPrerender:function(){n.debug("Lazy prerender process starting...");var i=Date.now(),r=[],o=this.getPageViews();t.each(E,function(e){r.push(o[e])}),t.each(o,function(e,n){t.includes(E,n)||r.push(e)});var a=e.Deferred().resolve();return t.each(r,function(e){e.isPrerendered()||(a=a.then(t.bind(e.startLazyPrerender,e)))}),a.then(function(){n.debug("Lazy prerender process complete. Total elapsed time: "+(Date.now()-i)+" ms")}),a.promise()},currentPageNumber:function(){return v.currentPage||1}});return T}),define("shared/utils/IconFontMap",[],function(){"use strict";return{PAGES:"&#xe001;",FACEBOOK:"&#xe002;",EMAIL:"&#xe003;",CART:"&#xe004;",LINK:"&#xe005;",TWITTER:"&#xe006;",LEFT_ARROW:"&#xe007;",PINTEREST:"&#xe008;",RIGHT_ARROW:"&#xe009;",SHARE:"&#xe000;"}}),define("modules/flippers/views/FlippersView",["jquery","lodash","backbone","globals","shared/models/EmbeddedViewportModel","modules/viewport/module","modules/url-navigation/module","shared/views/PlayerAbstractView","device","shared/utils/IconFontMap","shared/utils/NavigationUtils"],function(e,t,n,i,r,o,a,s,u,l,c){"use strict";return s.extend({id:"flippers",leftArrow:null,rightArrow:null,scaleData:null,currentPageNumber:0,smallWindowThreshold:600,options:null,initialize:function(){s.prototype.initialize.call(this),u.desktop()&&e(document).on("keydown",t.bind(this.keyHandler,this)),this.render(),this.bindInteraction(this.leftArrow,t.bind(this._previousPage,this)),this.bindInteraction(this.rightArrow,t.bind(this._nextPage,this)),this.bindInteraction(this.$el)},onClose:function(){s.prototype.initialize.call(this),this.unbindInteraction(this.leftArrow),this.unbindInteraction(this.rightArrow),this.unbindInteraction(this.$el)},_previousPageHref:function(){if(!this.currentPageNumber)return"#";var e=c.parseLayoutFromLocation();return c.buildUri(a.PAGE_MODES.NUMBER,Math.max(1,this.currentPageNumber-1),e)},_nextPageHref:function(){if(!this.currentPageNumber)return"#";var e=c.parseLayoutFromLocation();return c.buildUri(a.PAGE_MODES.NUMBER,this.currentPageNumber+1,e)},replaceHrefs:function(){this.currentPageNumber=o.currentPageNumber(),this.$(".prev.left a").attr("href",this._previousPageHref()),this.$(".next.right a").attr("href",this._nextPageHref())},render:function(){var t=i.isEmbedded?"<button>":"<a>";this.leftArrow=e("<div>",{class:"prev left",css:{"background-color":this.options.menuBackgroundColor}}),this.leftArrowA=e(t,{title:"Previous Page",html:l.LEFT_ARROW,attr:{"aria-label":"Previous Page"},css:{color:this.options.menuForegroundColor}}),this.leftArrow.append(this.leftArrowA),this.rightArrow=e("<div>",{class:"next right",css:{"background-color":this.options.menuBackgroundColor}}),this.rightArrowA=e(t,{title:"Next Page",html:l.RIGHT_ARROW,attr:{"aria-label":"Next Page"},css:{color:this.options.menuForegroundColor}}),this.rightArrow.append(this.rightArrowA),i.isEmbedded||(this.leftArrowA.attr("href",this._previousPageHref()),this.rightArrowA.attr("href",this._nextPageHref()));var n=this.options.menuHoverOpacity;u.touch()&&(this.leftArrowA.on("touchstart",function(){e(this).css("opacity",n)}).on("touchend",function(){e(this).css("opacity","1.0")}),this.rightArrowA.on("touchstart",function(){e(this).css("opacity",n)}).on("touchend",function(){e(this).css("opacity","1.0")})),u.desktop()&&(this.leftArrowA.on("mouseenter",function(){e(this).css("opacity",n)}).on("mouseleave",function(){e(this).css("opacity","1.0")}),this.rightArrowA.on("mouseenter",function(){e(this).css("opacity",n)}).on("mouseleave",function(){e(this).css("opacity","1.0")})),this.disableNext(),this.disablePrevious(),this.$el.append(this.leftArrow),this.$el.append(this.rightArrow),!1===this.options.arrowsEnabled&&this.hide()},scale:function(e){e&&(this.scaleData=e);var t=this.scaleData.height,n=this.scaleData.marginTop,i=this.scaleData.originalWindowWidth;this.scaleData.windowHeight<this.smallWindowThreshold||i<this.smallWindowThreshold?(this.rightArrow.addClass("small"),this.leftArrow.addClass("small")):(this.leftArrow.removeClass("small"),this.rightArrow.removeClass("small"));var o,a=parseFloat(this.rightArrowA.css("height")),s=r.getInstance();o=s.isActive()?s.getVerticalCenterOfVisibleArea(t)-a/2:t/2-a/2+n,o=Math.round(o)+"px",this.leftArrow.css("top",o),this.rightArrow.css("top",o)},isPreviousDisabled:function(){return this.leftArrow.hasClass("disabled")},isNextDisabled:function(){return this.rightArrow.hasClass("disabled")},disablePrevious:function(){this.isPreviousDisabled()||(this.leftArrow.addClass("disabled"),this.leftArrow.attr("aria-hidden",!0),this.leftArrowA.attr("title",""),this.leftArrowA.attr("tabindex","-1"))},disableNext:function(){this.isNextDisabled()||(this.rightArrow.addClass("disabled"),this.rightArrow.attr("aria-hidden",!0),this.rightArrowA.attr("title",""),this.rightArrowA.attr("tabindex","-1"))},enablePrevious:function(){this.isPreviousDisabled()&&(this.leftArrow.removeClass("disabled"),this.leftArrow.removeAttr("aria-hidden"),this.leftArrowA.attr("title","Previous Page"),this.leftArrowA.removeAttr("tabindex"))},enableNext:function(){this.isNextDisabled()&&(this.rightArrow.removeClass("disabled"),this.rightArrow.removeAttr("aria-hidden"),this.rightArrowA.attr("title","Next Page"),this.rightArrowA.removeAttr("tabindex"))},show:function(){!0===this.options.arrowsEnabled&&this.$el.show()},hide:function(){this.$el.hide()},_nextPage:function(e){e.preventDefault(),this.options.module.trigger(this.options.module.publishedEvents.NEXT_PAGE)},_previousPage:function(e){e.preventDefault(),this.options.module.trigger(this.options.module.publishedEvents.PREVIOUS_PAGE)},keyHandler:function(e){(!e.target||"SELECT"!=e.target.tagName&&"INPUT"!=e.target.tagName&&"TEXTAREA"!=e.target.tagName)&&(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||this.options.arrowsEnabled&&(39!==e.keyCode||this.isNextDisabled()?37!==e.keyCode||this.isPreviousDisabled()?37!==e.keyCode&&39!==e.keyCode||(e.stopPropagation(),e.preventDefault()):(e.stopPropagation(),e.preventDefault(),this._previousPage(e)):(e.stopPropagation(),e.preventDefault(),this._nextPage(e))))}})}),define("modules/flippers/module",["jquery","lodash","ceros","globals","color","shared/models/EmbeddedViewportModel","modules/flippers/views/FlippersView","shared/utils/ModuleEventManager"],function(e,t,n,i,r,o,a,s){"use strict";var u=new n.Module({id:"flippers",description:"Provides left/right (previous/next) arrows for navigation between pages",version:"1.0",flippersView:null,publishedEvents:{NEXT_PAGE:"flippers.next_page",PREVIOUS_PAGE:"flippers.previous_page"},dependencies:{viewport:"1.0"},delegate:{load:function(e){var n={theme:t.isUndefined(i.themeObj)?{}:i.themeObj};this.options=t.extend({},n,e);var o=this.options.theme.menuFgColor,s=this.options.theme.menuBgColor,l=r.fromHex(o);l.a=.1,this.flippersView=new a({arrowsEnabled:this.options.theme.arrowsEnabled,menuBackgroundColor:s,menuBorderColor:l,menuForegroundColor:o,menuHoverOpacity:this.options.theme.menuHoverOpacity,module:u}),this.registerEvents()},el:function(){if(this.flippersView)return this.flippersView.$el;throw new Error("FlippersView is missing")},show:function(){if(!this.flippersView)throw new Error("FlippersView is missing");this.flippersView.show()},hide:function(){if(!this.flippersView)throw new Error("FlippersView is missing");this.flippersView.hide()},updateScale:function(e){if(!this.flippersView)throw new Error("FlippersView is missing");this.flippersView.scale(e)},determineFlipperState:function(e,t,n){var i=!n||e,r=!n||t;this.updateFlippers(i,r)},updateFlippers:function(e,t){if(!this.flippersView)throw new Error("FlippersView is missing");e?this.flippersView.disablePrevious():this.flippersView.enablePrevious(),t?this.flippersView.disableNext():this.flippersView.enableNext()},updateFlipperHrefs:function(){this.flippersView.replaceHrefs()},registerEvents:function(){o.getInstance().on("change",t.bind(function(){this.flippersView.scale(null)},this))}}});return u}),define("text!modules/lightbox/templates/lightbox.html",[],function(){return'<div class="container ceros-lightbox">\n    <button class="close"><span class="sr-only">Close modal</span></span>&#xE00B;</button>\n    <div class="scrolling">\n        <iframe src="about:blank" frameborder="0" allowfullscreen></iframe>\n    </div>\n</div>\n'}),define("modules/lightbox/views/LightboxView",["log","jquery","lodash","backbone","shared/utils/CerosResourceLoader","shared/models/EmbeddedViewportModel","shared/views/PlayerAbstractView","device","modules/page/utils/PlayerVariantService","text!modules/lightbox/templates/lightbox.html","globals"],function(e,t,n,i,r,o,a,s,u,l,c){"use strict";var d={"click .close":"_close",click:"_backgroundClick"},h={"touchstart .close":"_close",touchstart:"_backgroundClick"};return a.extend({id:"lightbox",attributes:{"aria-modal":"true","aria-hidden":"true"},events:function(){var e={};return s.desktop()&&n.extend(e,d),s.touch()&&n.extend(e,h),e}(),lightboxWidth:null,lightboxHeight:null,opened:!1,initialize:function(){a.prototype.initialize.apply(this,arguments),this._render(),c.previewMode&&t(window).on("resize",n.debounce(n.bind(this._handleSizeChangesDueToZoom,this),1))},setSizeAndPosition:function(){if(this.opened){var e=o.getInstance();if(e.isActive()){var t=this.$el,n=this.$(".container"),i=e.getVerticalCenterOfVisibleArea(t.height())-this.lightboxHeight/2,r=Math.max(window.innerWidth-this.lightboxWidth,0)/2;t.css({padding:0}),n.css({transform:"none",top:i+"px",left:r+"px"})}if(s.smallWindow()){var a=this.lightboxHeight/this.lightboxWidth,u=Math.min(window.innerWidth,this.lightboxWidth);this.$el.addClass("fullscreen-lightbox"),this.$(".container").css({"max-height":a*u})}else this.$(".container").css({"max-width":this.lightboxWidth,"max-height":this.lightboxHeight});c.previewMode&&this._handleSizeChangesDueToZoom()}},_handleSizeChangesDueToZoom:function(){if(this.opened){var e=t(".adaptive-layouts-frame #main"),n=e.get(0).getBoundingClientRect(),i=window.innerWidth/window.outerWidth;this.lightboxWidth=i*this.originalWidth,this.lightboxWidth=Math.min(n.width-2,this.lightboxWidth);var r=0;this.usesCloseButton&&(r=2*i*42),this.lightboxHeight=i*this.originalHeight,this.lightboxHeight=Math.min(n.height-r,this.lightboxHeight),this.usesCloseButton&&this.resizeCloseButton(i),this.$(".container").css({"max-width":this.lightboxWidth,"max-height":this.lightboxHeight}),this._adjustCenter()}},resizeCloseButton:function(e){var n=16*e,i=40*e;t(".ceros-lightbox .close").css({"font-size":n+"px","line-height":i+"px",height:i+"px",width:i+"px",top:"-"+i+"px"})},_adjustCenter:function(){var e=t(".adaptive-layouts-frame"),i=e.get(0).getBoundingClientRect(),r=i.height/2-this.lightboxHeight/2,o=e.css("top"),a=this.$el.css("padding-top"),s=0;a&&o&&(o=n.trimEnd(o,"px"),a=n.trimEnd(a,"px"),s=n.toNumber(a)-n.toNumber(o),this.$(".container").css({top:r-s,transform:"translate(-50%,0)","-webkit-transform":"translate(-50%, 0%)"}))},_close:function(e){e&&e.preventDefault(),this.deactivate()},_backgroundClick:function(e){e.target==this.$el[0]&&this._close(e)},onKeypress:function(e){"Esc"!==e.key&&"Escape"!==e.key||this.deactivate()},_render:function(){this.$el.html(l)},openLightbox:function(t){return n.isEmpty(t)?void e.warn("missing options for lightbox"):n.isEmpty(t.url)?void e.warn("missing URL for lightbox"):t.width?t.height?(t.showCloseButton?(this.$el.removeClass("without-close-button"),this.$el.addClass("with-close-button")):(this.$el.removeClass("with-close-button"),this.$el.addClass("without-close-button")),this.lightboxWidth=t.width,this.lightboxHeight=t.height,this.originalWidth=n.clone(t.width),this.originalHeight=n.clone(t.height),this.usesCloseButton=t.showCloseButton,this.$(".close").css("background-color",t.closeButtonBgColor),this.$(".close").css("color",t.closeButtonFgColor),this.$("iframe").attr("src",t.url),this.show(),this.focusLightbox(),this.setSizeAndPosition(),void r.pause()):void e.warn("missing height for lightbox"):void e.warn("missing width for lightbox")},focusLightbox:function(){var e=this.$("iframe");e.on("load.focus",function(){e[0].contentWindow.focus(),e.off("load.focus")})},deactivate:function(){r.resume(),this.$("iframe").attr("src","about:blank"),this.hide()},hide:function(){this.$el.hide(),this.opened=!1,t(document).off("keyup.lightbox"),this.$el.attr("aria-hidden","true")},show:function(){this.$el.show(),this.opened=!0,t(document).on("keyup.lightbox",this.onKeypress.bind(this)),this.$el.attr("aria-hidden","false")}})}),define("modules/lightbox/module",["lodash","jquery","ceros","globals","device","shared/models/EmbeddedViewportModel","modules/lightbox/views/LightboxView","urlUtils"],function(e,t,n,i,r,o,a,s){"use strict";var u=new n.Module({id:"lightbox",description:"",version:"1.0",dependencies:{},lightboxView:null,delegate:{load:function(){return this.lightboxView=new a({module:u}),this.registerEvents(),this},showLightbox:function(t,n,r,o){var a=e.isUndefined(i.themeObj)?{}:i.themeObj,u=e.extend({},this.getBrowserUrlParams(),this.getDefaultUrlParams());this.lightboxView.openLightbox({url:s.appendQueryParams(t,u),width:n,height:r,showCloseButton:o,closeButtonBgColor:a.menuBgColor,closeButtonFgColor:a.menuFgColor})},showProduct:function(t){if(!e.isEmpty(t)){var n=this.getUrlForProduct(t);e.isEmpty(n)||this.lightboxView.openLightbox({url:n,width:i.commerceSettings.panelWidth,height:i.commerceSettings.panelHeight})}},getUrlForProduct:function(t){var n=i.allowCommerceIntegration?i.commerceSettings.productUrl:"";if(e.isUndefined(n)||e.isEmpty(n)||-1===n.indexOf("{id}"))return"";var r=!1;-1!==n.indexOf("?")&&n.indexOf("?")<n.indexOf("{id}")&&(r=!0);var o=null,a=t.lastIndexOf("?");a>0&&(o=s.getUrlParams(t.substring(a)),t=t.substring(0,a));var u;u=r?encodeURIComponent(t):t.replace(/[^\/]+/gi,function(e,t){return encodeURIComponent(e)}),n=n.replace("{id}",u);var l=e.extend({},this.getBrowserUrlParams(),o,this.getDefaultUrlParams());return n=s.appendQueryParams(n,l)},showShoppingCart:function(){var t=this.getUrlForShoppingCart();e.isEmpty(t)||this.lightboxView.openLightbox({url:t,showCloseButton:!0,width:i.commerceSettings.panelWidth,height:i.commerceSettings.panelHeight})},getUrlForShoppingCart:function(){var t=i.allowCommerceIntegration?i.commerceSettings.shoppingCartUrl:"";return e.isUndefined(t)||e.isEmpty(t)?"":s.appendQueryParams(t,this.getDefaultUrlParams())},getDefaultUrlParams:function(){return{ceros_device_pixel_ratio:r.pixelRatio(),ceros_account_slug:i.accountSlug,ceros_app_slug:i.appSlug,ceros_issue_slug:i.issue.slug,ceros_device_type:r.deviceType(),ceros_player_type:r.playerType()}},getBrowserUrlParams:function(){var e=s.removeEmbedParams(this.getWindowUrl());return s.getUrlParams(e)},show:function(){this.lightboxView.show()},hide:function(){this.lightboxView.hide()},deactivate:function(){this.lightboxView.deactivate()},el:function(){return this.lightboxView.$el},iframe:function(){return this.lightboxView.$("iframe")[0]},getWindowUrl:function(){return window.location.href},registerEvents:function(){o.getInstance().on("change",this.lightboxView.setSizeAndPosition,this.lightboxView)}}});return u}),define("text!modules/error/templates/error.html",[],function(){return'<div id="float"></div>\n<div id="dialog">\n    <div id="content">\n        <div id="title">\n            {{title}}\n        </div>\n        <div id="image" {{#imageCssClass}}class="{{imageCssClass}}"{{/imageCssClass}}></div>\n        <div id="message">\n            {{{message}}}\n        </div>\n    </div>\n</div>'}),define("modules/error/views/ErrorView",["jquery","lodash","backbone","mustache","shared/views/PlayerAbstractView","text!modules/error/templates/error.html"],function(e,t,n,i,r,o){"use strict";return r.extend({id:"errorModal",initialize:function(e){r.prototype.initialize.call(this,e),this.options=e,this.render()},render:function(){var e=i.render(o,{title:this.options.title,message:this.options.message,imageCssClass:this.options.imageCssClass});this.$el.html(e)}})}),define("modules/error/module",["jquery","ceros","modules/error/views/ErrorView"],function(e,t,n){"use strict";return new t.Module({id:"Error",description:"Provides an error display module",version:"1.0",publishedEvents:{},dependencies:{},delegate:{load:function(e){this.errorView=new n({title:e.title,message:e.message,imageCssClass:e.imageCssClass})},el:function(){return this.errorView.$el}}})}),define("applications/html5-player/TopView",["log","lodash","jquery","device","globals","backbone","modules/page/utils/PlayerVariantService","shared/utils/CerosResourceLoader","shared/utils/ModuleEventManager","shared/models/EmbeddedViewportModel","applications/html5-player/PreviewerSelectionView","applications/html5-player/AdaptiveLayoutsPreviewerFrameView","applications/html5-player/InfoBarView","modules/splash-screen/module","modules/chrome/module","modules/branding/module","modules/flippers/module","modules/viewport/module","modules/lightbox/module","modules/error/module"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f,p,g,m,v,y,b){"use strict";var w=null;return t.extend({},o.Events,{publishedEvents:{PLAYER_DOCUMENT_SHOWN:"player.document.shown"},setupInitialDom:function(){var e=n("html");i.mobile()?e.addClass("mobile"):e.addClass("desktop"),i.msie?e.addClass("msie"+i.msieVersion()):e.addClass("non-msie"),e.addClass(i.renderingEngine()),e.addClass(i.orientation()),i.retina()&&e.addClass("retina"),n(window).on(i.supportsOrientationChange()?"orientationchange":"resize",t.debounce(t.bind(function(){e.removeClass("portrait landscape"),e.addClass(i.orientation())},this),100)),this.appendAccessibilityStyleOverrides();var r=n("body"),o=n("#main");p.shouldShow()&&o.append('<div id="chrome"></div>'),o.append('<div id="viewport"></div>'),o.append('<div id="flippers"></div>'),r.append('<div id="lightbox"></div>')},appendAccessibilityStyleOverrides:function(){r.shouldReduceMotion&&n("head").append("<style>@media (prefers-reduced-motion: reduce) {[class^='sequenceRun'], [class*=' sequenceRun'] {animation-duration: 1ms !important;transition-duration: 1ms !important;animation-iteration-count: 1 !important;}}</style>")},attachModuleViews:function(e){n("#viewport").replaceWith(v.el()),n("#flippers").replaceWith(m.el()),n("#lightbox").replaceWith(y.el()),n("#main").append(g.el()),r.isEmbedded||(n("#chrome").replaceWith(p.el()),p.setTitle(e.get("title")))},setupAdaptiveLayoutsPreviewerSelectionView:function(){this.isUsingNativeTouchDevice()||this.initPreviewerSelectionView()},setupAdaptiveLayoutsPreviewerFrameView:function(){this.previewerFrame=this.initPreviewerFrameView()},setupAdaptiveLayoutsPreviewerTouchDeviceView:function(){
this.isUsingNativeTouchDevice()&&!a.fullScreenMode&&a.setFullScreenMode(!0)},isUsingNativeTouchDevice:function(){return i.deviceType()!==i.DEVICE_TYPE_DESKTOP},showPreviewerFadingMessage:function(){var e=this.isUsingNativeTouchDevice();r.previewMode&&r.allowAdaptiveLayouts&&!e&&this.previewerFrame.showFadingHelpMessage()},showInfo:function(e){var t=n("#information-bar-container");if(0==t.length){n("body").append('<div id="information-bar-container"></div>'),t=n("#information-bar-container")}new h({el:t}).showMessage(e)},initPreviewerSelectionView:function(){return new c({el:".previewer-selection-header"})},initPreviewerFrameView:function(){return new d({el:".adaptive-layouts-frame"})},showDocument:function(){p.shouldShow()&&(p.show(),p.initiallyHidden()&&p.hide()),g.shouldShow()&&g.show(),n("#main").addClass("document"),v.show(),m.show(),this.hideLoadingExperience(),this.trigger(this.publishedEvents.PLAYER_DOCUMENT_SHOWN)},showLoadingExperience:function(){w=f.showLoading(n("#main"),{whiteLabeling:r.whiteLabeling,showPreviewLabel:r.previewMode,overlayed:!1})},hideLoadingExperience:function(){w?w.destroy():e.warn("Showing document but never showed the loading experience")},show404:function(){this.showError({title:"Sorry, page not found",message:"Please check the url and<br/>try again"})},show503:function(){this.showError({title:"Previewer for this experience is currently unavailable due to an excessive number of requests",message:"Please try again later",imageCssClass:"error503"})},showError:function(e){this.hideLoadingExperience(),b.load(e),n("html").css({height:"100%"}),n("body").empty().css({display:"block",height:"100%"}).append(b.el())}})}),define("modules/page/utils/ShareJSConnection",["jquery","lodash","globals","log","applications/html5-player/TopView"],function(e,t,n,i,r){"use strict";var o=!1,a=function(){if(!1!==o)return o;if("undefined"==typeof sharejs)throw Error("Unable to connect to ShareJS Server");return o=new sharejs.Connection(n.shareJsServer,n.sharejsAccessPolicy),o.on("error",t.bind(s._showErrorInternal,s)),e(window).on("unload",function(){o&&o.disconnect()}),o},s={initialize:function(){a()},getConnection:function(){return o},_showErrorInternal:function(e){if("Unknown session ID"===e)return!1;var t="There was a problem connecting to the server.";return e&&(t=e,t.match(/\bOp apply failed/gi)&&(t="Your changes were unable to be saved.")),this.showError(t)},showError:function(e){return this.readOnlyConnectionLimitExceededError||window.onerror(e,null,null),o&&(o.disconnect(),o=!1),!0},listenForReadOnlyConnectionLimitError:function(e){e.on("shout",t.bind(function(e){if(e){try{e=JSON.parse(e)}catch(e){return}"READONLY_CONNECTION_LIMIT_EXCEEDED"===e.name&&(this.readOnlyConnectionLimitExceededError=!0,r.show503())}},this))}};return s}),define("modules/page/models/media-loaders/ComponentImageLoader",["lodash","backbone","log"],function(e,t,n){"use strict";var i=function(e,t){this.componentWidth=e.width,this.componentHeight=e.height,this.componentId=e.id,this.currentResource=null,this.url=t.url};return e.extend(i.prototype,t.Events,{IMAGE_LOADED_EVENT:"image-loaded",LOW_RES_IMAGE_LOADED_EVENT:"low-res-image-loaded",url:null,loadLowRes:function(e){throw"implement loadLowRes in subclasses"},load:function(e){throw"implement load in subclasses"},getCurrentUrl:function(){throw"implement getCurrentUrl in subclasses"},loadNow:function(e){this.load(e),this.currentResource&&this.currentResource.loadNow()},loadLowResNow:function(e){this.loadLowRes(e),this.currentResource&&this.currentResource.loadNow()},onImageLoaded:function(e,t){this.currentResource?("resolved"===this.currentResource.getPromise().state()&&e.call(t),this.bind(this.IMAGE_LOADED_EVENT,e,t)):n.warn("No resource was ever loaded",{componentId:this.componentId})},onLowResImageLoaded:function(e,t){this.currentResource?("resolved"===this.currentResource.getPromise().state()&&e.call(t),this.bind(this.LOW_RES_IMAGE_LOADED_EVENT,e,t)):n.warn("No resource was ever loaded",{componentId:this.componentId})},getFullResolutionUrl:function(){return this.url},getCurrentResource:function(){return this.currentResource}}),i}),define("modules/page/models/media-loaders/ComponentVectorImageLoader",["lodash","urlUtils","modules/page/models/media-loaders/ComponentImageLoader","shared/utils/CerosResourceLoader"],function(e,t,n,i){"use strict";var r=function(e,t){n.call(this,e,t)};return e.extend(r.prototype,n.prototype,{loadLowRes:function(e){this.load(e)},load:function(n){if(!this.currentResource){var r=t.replaceProtocolIfHttpsRequest(this.url);this.currentResource=i.addVectorImage(r),this.currentResource.getPromise().done(e.bind(function(){this.trigger(this.IMAGE_LOADED_EVENT)},this))}},getCurrentUrl:function(){return this.url}}),r}),define("modules/page/models/media-loaders/ComponentRasterImageLoader",["lodash","modules/page/models/media-loaders/ComponentImageLoader","shared/utils/CerosResourceLoader","ImageUtils","ImageCroppingUtils"],function(e,t,n,i,r){"use strict";var o=function(n,i){t.call(this,n,i),this.imageId=i.id,r.isValidCropObject(n.crop)?(this.cropDimensions=n.crop,this.originalWidth=this.cropDimensions.width,this.originalHeight=this.cropDimensions.height):(this.originalWidth=e.get(i,["original","width"],null),this.originalHeight=e.get(i,["original","height"],null))};return e.extend(o.prototype,t.prototype,{imageId:null,originalWidth:null,originalHeight:null,currentUrl:null,currentWidth:-1,cropDimensions:null,loadLowRes:function(e){var t=this.componentWidth*e.adjustedRatio,n=this.componentHeight*e.adjustedRatio,i=this._calculateLowResDimensions(t,n);i.width<=50&&i.height<=50?this.load(e):this._loadLowResWidth(i.width,e)},load:function(t){var n=Math.round(this.componentWidth*t.ratio),r=i.calculateWidthForDevicePixelRatio(n);this.loadWidth(r).done(e.bind(function(){this.trigger(this.IMAGE_LOADED_EVENT)},this))},getCurrentUrl:function(){return this.currentUrl},loadWidth:function(t){if(this.currentResource){if(t<=this.currentWidth)return this.currentResource.getPromise();this.currentResource.cancel()}return this.currentResource=n.addRasterImage(this.imageId,t,this.cropDimensions),this.currentResource.getPromise().done(e.bind(function(e){this.currentUrl=e.getSrc(),this.currentWidth=e.getWidth()},this))},_loadLowResWidth:function(t,n){this.loadWidth(t).done(e.bind(function(){this.trigger(this.LOW_RES_IMAGE_LOADED_EVENT),this.loadNow(n)},this))},_calculateLowResDimensions:function(e,t){var n,i,r=Math.min(e,this.originalWidth),o=Math.min(t,this.originalHeight),a=r/this.originalWidth,s=o/this.originalHeight,u=this.originalWidth/this.originalHeight;return a<s?(n=Math.ceil(.25*r),i=Math.ceil(r*u*.25)):(n=Math.ceil(o*u*.25),i=Math.ceil(.25*o)),{width:n,height:i}}}),o}),define("modules/page/models/media-loaders/ComponentImageLoaderFactory",["globals","VectorImageUtils","modules/page/models/media-loaders/ComponentVectorImageLoader","modules/page/models/media-loaders/ComponentRasterImageLoader"],function(e,t,n,i){"use strict";return{create:function(e,r){return t.isVectorBased(e.contentType)?new n(e,r):new i(e,r)}}}),define("shared/models/OverrideablePropertyModelMixin",["lodash","backbone","modules/page/utils/PlayerVariantDetector"],function(e,t,n){"use strict";return{getOverrideablePropertyForCurrentVariant:function(t){var i=n.getVariant();if("desktop"===i)return this.get(t);var r=this.get("overrides");return e.get(r,[i,t])}}}),define("LazyMigrationUtils",["lodash","@frontend/common/libs/ImageEffects","@frontend/common/libs/BlendingModes"],function(e,t,n){"use strict";var t=t.ImageEffects,n=n.BlendingModes,i={crop:null,flipHorizontal:!1,flipVertical:!1,effects:t.getDefaults(),blendingMode:n.getDefault()};return{isLazyAddedField:function(e){var t=this.getOpFieldName(e);return t&&i.hasOwnProperty(t)},isUpdateForLazyAddedField:function(t){return(!e.isUndefined(t.oi)||!e.isUndefined(t.od))&&this.isLazyAddedField(t)},normalizeIfLazyAddedField:function(e){if(this.isUpdateForLazyAddedField(e)){var t=this.getOpFieldName(e),n=i[t];e.od&&!e.oi?e.oi=n:e.oi&&!e.od&&(e.od=n)}},getOpFieldName:function(t){return e.get(t.p,t.p.length-1)}}}),define("shared/utils/ShareJSUtils",["lodash","modules/page/utils/PlayerVariantDetector","LazyMigrationUtils"],function(e,t,n){"use strict";var i=["image","background","backgroundHasBeenSet","crop"],r=["video","poster"],o=["guides","autosnap","name","thumbnailUrl"];return{isMediaReloadRequiredForComponent:function(t,n){if(n){if(this.isComponentCreation(t)){var i=this.getLayerTypeFromLayer(n);if(e.includes(["smartgroup_definition","folder","group"],i)||this.isMediaComponentWithMediaPropertiesSet(n))return!0}else if(this.isComponentUpdate(t)){var r=this.someOpPropertySuchThat(t,e.bind(function(e){return this.isMediaProperty(n,e)||"visible"===e},this));return r}}return!1},isMediaReloadRequiredForOp:function(e,t){var n=this.getComponentFromOp(e,t);return this.isMediaReloadRequiredForComponent(t,n)},someOpPropertySuchThat:function(n,i){var r=t.getVariant();if("desktop"===r){return i(this.getPropertyNameFromPath(n.p))}var o=this.getPropertyNamesFromOverridesOp(n,r);return e.some(o,i)},isPageReloadRequiredForComponent:function(t,n){if(n){if(this.isInvalidGlyphMetricsOp(t,n))return!1;if(this.isComponentCreation(t))return!0;if(this.isComponentUpdate(t)){var i=!1;return e.includes(t.p,"interactions")&&e.each(t.oi,function(e){!e||"view"!==e.trigger||"cycle-previous"!==e.action&&"cycle-next"!==e.action||(i=!0)}),this.someOpPropertySuchThat(t,function(t){"video-widget"===n.type&&e.includes(["height","width"],t)?i=!0:"smartgroup"===n.type&&e.includes(["x","y","height","width"],t)?i=!0:"opacity"===t?i=!0:"blendingMode"===t?i=!0:"fixedPosition"===t&&(i=!0)}),i}throw"Wrong Op Type passed"}return!0},isInvalidGlyphMetricsOp:function(t,n){return"text-component"===n.type&&e.has(t,"oi")&&!e.has(t,"od")&&e.includes(t.p,"glyphMetrics")},isComponentCreation:function(t){return!!e.isArray(t.p)&&(2===t.p.length&&"layerDictionary"===t.p[0]&&!e.isUndefined(t.oi)&&e.isUndefined(t.od))},isLayerHierarchiesChange:function(e){return"layerHierarchies"===e.p[0]},isLayerHierarchiesMoveOrDelete:function(t){return"layerHierarchies"===t.p[0]&&!e.isUndefined(t.ld)},isLayerDictionaryDelete:function(t){return!n.isUpdateForLazyAddedField(t)&&("layerDictionary"===t.p[0]&&!e.isUndefined(t.od)&&e.isUndefined(t.oi))},isComponentUpdate:function(t){return!!e.isArray(t.p)&&(!!n.isUpdateForLazyAddedField(t)||!(2!==t.p.length&&3!==t.p.length||"layerDictionary"!==t.p[0]||e.isUndefined(t.oi)||e.isUndefined(t.od)))},getPropertyNameFromPath:function(t){var n;return t.length>2&&e.isString(e.last(t))&&(n=e.last(t)),n},getPropertyNamesFromOverridesOp:function(t,n){if(e.isUndefined(t.oi)||e.isUndefined(t.od))throw"Cannot get properties changed without old and new objects";var i=t.oi[n],r=t.od[n],o=e.union(e.keys(i),e.keys(r));return e.filter(o,function(t){return!e.isEqual(i[t],r[t])})},getComponentFromOp:function(t,n){if(!("layerDictionary"!==n.p[0]||e.isUndefined(n.oi)&&e.isUndefined(n.od))){var i=e.slice(n.p,0,2),r=i.join(".");return e.at(t.snapshot,r)[0]}return null},getLayerTypeFromLayer:function(e){return e.type?e.type:void 0!==e.layers?"smartgroup_definition":void 0},isMediaProperty:function(t,n){return!!t&&("image-component"===t.type?e.includes(i,n):"video-widget"===t.type&&e.includes(r,n))},isMediaComponentWithMediaPropertiesSet:function(e){return e&&("image-component"===e.type&&e.image||"video-widget"===e.type&&e.video&&e.poster)},isBlacklistedPagePropertyForPreviewOps:function(t){return!("layerDictionary"===t.p[0]||!e.includes(o,t.p[0]))}}}),define("modules/page/utils/MediaPreloader",["jquery","lodash","globals","device","log","screenSize"],function(e,t,n,i,r,o){"use strict";var a=function(e,n){this.documentVersion=e,this.layers=n,this.visibleMedia=[],this.hiddenMedia=[],this.visibleImages=[],this.hiddenImages=[],this.sortMediaForLayers(this.layers,!1,0),this.visibleMedia=t.orderBy(this.visibleMedia,"absoluteY"),this.hiddenMedia=t.orderBy(this.hiddenMedia,"absoluteY")};return a.prototype={lazyPreloadAllMedia:function(e,t){this.lazyLoadingVerticalBreakpoint=this.getHighPriorityMediaLoadVerticalBreakpoint(e);var n,i=null,r=0;for(n=0;n<this.visibleMedia.length&&(r=n,i=this.visibleMedia[n],i.absoluteY<=this.lazyLoadingVerticalBreakpoint);n++)i.layer.isInInitialViewport=!0,this.loadMediaItem(i,e,t);var o=0;for(n=0;n<this.hiddenMedia.length&&(o=n,i=this.hiddenMedia[n],i.absoluteY<=this.lazyLoadingVerticalBreakpoint);n++)i.layer.isInInitialViewport=!0,this.loadMediaItem(i,e,t);for(n=r;n<this.visibleMedia.length;n++)i=this.visibleMedia[n],this.loadMediaItem(i,e,t);for(n=o;n<this.hiddenMedia.length;n++)i=this.hiddenMedia[n],this.loadMediaItem(i,e,t)},preloadVisibleMedia:function(e,t){this.loadMediaItems(this.visibleMedia,e,t)},preloadImages:function(e){this.loadMediaItems(this.visibleImages,e,!1),this.loadMediaItems(this.hiddenImages,e,!1)},preloadHiddenMedia:function(e){this.loadMediaItems(this.hiddenMedia,e,!1)},getlazyLoadingVerticalBreakpoint:function(){return this.lazyLoadingVerticalBreakpoint},sortMediaForLayers:function(e,n,i){i||(i=0),t.each(e,t.bind(function(e){if(this.isContainerLayer(e)){var t=n||!e.visible;this.sortMediaForLayers(this.getChildLayers(e),t,this.isSmartGroupOrGroup(e)?i+e.y:i)}else this.sortMediaForLayer(e,n,i)},this))},sortMediaForLayer:function(e,t,n){if(this.getLoader(e)){var i={layer:e,absoluteY:e.y+n};t||!e.visible?(this.hiddenMedia.push(i),this.isImage(e)&&this.hiddenImages.push(i)):(this.visibleMedia.push(i),this.isImage(e)&&this.visibleImages.push(i))}},getHighPriorityMediaLoadVerticalBreakpoint:function(t){var r=e(window).height(),a=r/t.ratio;if(n.isEmbedded&&n.heightOverride){var s=o.getDimensions();if(i.desktop())a=Math.min(a,s.height/t.ratio);else{var u=s.height/s.width;i.landscape()&&u>1&&(u=1/u),a=this.documentVersion.getExperienceWidth()*u}}return a},isSmartGroupOrGroup:function(e){return!(!e.smartgroupId&&"group"!==e.type)},getChildLayers:function(e){return e.smartgroupId?e.layers:e.items},isContainerLayer:function(e){return!(!e.smartgroupId&&"folder"!==e.type&&"group"!==e.type)},getLoader:function(e){return e.imageLoader||e.posterLoader||e.fontLoader},isImage:function(e){return!(!e.imageLoader&&!e.posterLoader)},shouldLoadLowRes:function(e){return t.isFunction(this.getLoader(e).loadLowRes)&&!e.posterLoader&&this.documentVersion.shouldLoadLowRes()},loadMediaItems:function(e,n,i){t.each(e,t.bind(function(e){this.loadMediaItem(e,n,i)},this))},loadMediaItem:function(e,t,n){var i=this.getLoader(e.layer);this.shouldLoadLowRes(e.layer)?n?i.loadLowResNow(t):i.loadLowRes(t):n?i.loadNow(t):i.load(t)}},a}),define("modules/page/models/PageModel",["jquery","lodash","backbone","globals","log","urlUtils","device","modules/page/utils/ShareJSConnection","modules/page/models/media-loaders/ComponentImageLoaderFactory","modules/page/models/media-loaders/ComponentFontLoader","shared/models/OverrideablePropertyModelMixin","shared/utils/ShareJSUtils","modules/page/utils/MediaPreloader","libs/media/MediaInfoCache","libs/media/MediaInfoService","modules/page/utils/PlayerVariantDetector","modules/page/utils/PlayerVariantUtil"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f,p,g,m){"use strict";var v={},y=n.Model.extend({idAttribute:"slug",urlRoot:"/{api-version}/account/{scope}/pages",defaults:{sdkTags:[],sdkPayload:""},initialize:function(e,t){n.Model.prototype.initialize.call(this,e,t),this.documentVersion=t.documentVersion,this.pageIndex=t.pageIndex},fetch:function(t){if(t=t||{},i.previewMode)return this._fetchFromShareJS();this._finishLoading();var n=new e.Deferred;return n.resolve(),n.promise()},getSlug:function(){return this.get("slug")},getSdkTags:function(){return this.get("sdkTags")},getSdkPayload:function(){return this.get("sdkPayload")},getDisabled:function(){return this.get("disabled")},getPageWidth:function(e){if(t.isUndefined(e))throw new Error("Document Version Model is required.");return e.getExperienceWidth()},getPageHeight:function(e){if(t.isUndefined(e))throw new Error("Document Version Model is required.");var n=this.getOverHeight(),i=e.getExperienceHeight();return n>i?n:i},getOverHeight:function(){return this.getOverrideablePropertyForCurrentVariant("overHeight")},_fetchFromShareJS:function(){var n=new e.Deferred;s.getConnection().openExisting(this._getDocumentName(),t.bind(function(e,i){if(e)throw r.error(e),n.reject(e),Error(e);i.on("remoteop",t.bind(function(e){this._processRemoteOps(i,e)},this)),s.listenForReadOnlyConnectionLimitError(i),this.setDocSnapshotAndReconciledLayers(i.snapshot),this.documentVersion.on("resolveMedia",t.bind(this.refetchMedia,this,i)),n.resolve()},this));var i=this._loadResolvedMedia();return e.when(n,i).done(t.bind(function(){this._finishLoading()},this))},reconcileLayers:function(e,n){var i=this,r=[],o=g.getVariant();return t.reduce(e,function(e,r){var a=t.cloneDeep(n[r.id]);return a&&(m.reconcileComponentForVariant(o,a),r.items&&r.items.length>0&&(a.items=i.reconcileLayers(r.items,n)),e.push(a)),e},r),i.setReconciledVariant(o),r},getScranchorsForCurrentVariant:function(){var e=g.getVariant(),t=this.get("scranchors");if("desktop"!==e){t=this.get("overrides")[e].scranchors||t}return t},setReconciledVariant:function(e){this.reconciledVariant=e},getReconciledVariant:function(){return this.reconciledVariant},_finishLoading:function(){if(!this.get("layers")){var e=this.get("layerHierarchies")[g.getVariant()],t=this.get("layerDictionary"),n=this.reconcileLayers(e,t);this.set("layers",n)}this.documentVersion.on("reload",this.resolveSmartgroupsAndMedia,this),this.resolveSmartgroupsAndMedia(),this.trigger("loaded")},_loadResolvedMedia:function(){return p.loadMediaForUri(this.getUri())},resolveSmartgroupsAndMedia:function(e){var n=this,i=e||n.get("layers")||[];t.each(i,function(e){return e.smartgroupId?n.resolveSmartgroupReference(e):e.items&&e.items.length>0?n.resolveSmartgroupsAndMedia(e.items):n.resolveObjectMedia(e),e}),n.mediaPreloader=new h(n.documentVersion,n.get("layers"))},refetchMedia:function(e){this._loadResolvedMedia().done(t.bind(function(t){f.putMediaArray(t),this.setDocSnapshotAndReconciledLayers(e.snapshot),this.set("media",t),this.resolveSmartgroupsAndMedia(),this.trigger("reload")},this))},resolveSmartgroupReference:function(n){var i=this,o=this.documentVersion.getSmartgroupDefinition(n.smartgroupId);o?n.layers=t.map(o.layerHierarchies.desktop,t.bind(function(r){function a(r){var s=o.layerDictionary[r.id];return r=e.extend(!0,{},s,r),r.id=y.buildSmartgroupInstanceObjectId(n.id,r.id),r.parentSmartGroup=n,"folder"===r.type?r.items=t.map(r.items,a):i.resolveObjectInSmartgroup(r,n.id),r}return r=a(r)},this)):r.warn("Smartgroup "+n.smartgroupId+" could not be resolved")},resolveObjectInSmartgroup:function(e,n){e.originalObjectId=e.id,e.interactions&&t.each(e.interactions,t.bind(function(e){e.layerTargets&&(e.layerTargets=t.map(e.layerTargets,t.bind(function(e){return y.buildSmartgroupInstanceObjectId(n,e)},this)))},this)),this.resolveObjectMedia(e)},resolveObjectMedia:function(e){var t=null;switch(e.type){case"image-component":t=f.get(e.image),t&&(e.imageLoader=u.create(e,t));break;case"video-widget":t=f.get(e.poster),t&&(e.posterLoader=u.create(e,t)),e.videoMedia=f.get(e.video);break;case"text-component":e.fontLoader=new l(e),e.forceMode=this.documentVersion.getForcedTextLayoutMode()}},lazyPreloadAllMedia:function(e,t){this.mediaPreloader.lazyPreloadAllMedia(e,t)},preloadVisibleMedia:function(e,t){this.mediaPreloader.preloadVisibleMedia(e,t)},preloadImages:function(e){this.mediaPreloader.preloadImages(e)},preloadHiddenMedia:function(e){this.mediaPreloader.preloadHiddenMedia(e)},getlazyLoadingVerticalBreakpoint:function(){return this.mediaPreloader.getlazyLoadingVerticalBreakpoint()},_processRemoteOps:function(e,n){for(var i={},r=!1,o=!1,a=0;a<n.length;a++){var s=n[a];if(d.isLayerHierarchiesMoveOrDelete(s))o=!0;else if(!d.isLayerDictionaryDelete(s)&&!d.isBlacklistedPagePropertyForPreviewOps(s)){var u=d.getComponentFromOp(e,s);if(d.isMediaReloadRequiredForComponent(s,u)){r=!0;break}!u||d.isPageReloadRequiredForComponent(s,u)?o=!0:i[u.id]=JSON.parse(JSON.stringify(u))}}r?this.refetchMedia(e):o?this.triggerPageReload(e):t.each(i,t.bind(function(e,t){this.trigger("remote",{id:t,options:e})},this))},setDocSnapshotAndReconciledLayers:function(e){var n=JSON.parse(JSON.stringify(e));this.set(n,{silent:!0});var i=this.reconcileLayers(t.cloneDeep(n.layerHierarchies[g.getVariant()]),n.layerDictionary);this.set("layers",i)},triggerPageReload:function(e){this.setDocSnapshotAndReconciledLayers(e.snapshot),this.resolveSmartgroupsAndMedia(),this.trigger("reload")},_getDocumentName:function(){return this.getUri().replace(/\//g,"_")},getPageIndex:function(){return this.pageIndex},getAllSmartgroupInstanceLayerIds:function(e,t){return this.getAllSmartgroupInstanceComponentIds(e,t)},getAllSmartgroupInstanceComponentIds:function(e,n){var i=n||this.get("layerDictionary"),r=t.filter(i,"smartgroupId");return t.reduce(r,t.bind(function(n,i){var r=this.getSmartgroupLayerDictionary(i.smartgroupId);return t.some(r,function(t){return t.id===e})&&n.push(y.buildSmartgroupInstanceObjectId(i.id,e)),n},this),[])},getSmartgroupLayerDictionary:function(e){return t.get(this.documentVersion.getSmartgroupDefinition(e),"layerDictionary")},getUri:function(){return n.Model.prototype.url.call(this).replace(/\{api-version\}/,i.apiVersion).replace(/\{scope\}/,i.accountSlug)},updateLayerDictionaryFromRemoteChange:function(e){var n=this.get("layerDictionary");n[e.id]=t.cloneDeep(e.options),this.set("layerDictionary",n)},findLayerById:function(e){if(!e)return null;if(!v.hasOwnProperty(e)){var n=function(i){for(var r=0;r<t.get(i,"length");++r){if(i[r].id===e)return i[r];if(i[r].items||i[r].layers){var o=i[r].items||i[r].layers,a=n(o);if(a)return a}}return null};v[e]=n(this.get("layers"))}return v[e]}},{layerIsComponentWithId:function(e,n){return"folder"===n.type?t.some(n.items,t.partial(y.layerIsComponentWithId,e)):n.id===e},buildSmartgroupInstanceObjectId:function(e,t){return e+"|"+t},extractObjectIdFromSmartgroupInstanceId:function(e){var t=e.indexOf("|");return-1!==t&&(e=e.substr(t+1)),e},findTopmostFolderContent:function(e){for(var n=null,i=0;i<t.get(e,"items.length",0);++i){var r=e.items[i];"folder"===r.type&&(r=y.findTopmostFolderContent(r)),n?r.y===n.y?n=r.y<n.y?r:n:r.y<n.y&&(n=r):n=r}return n}});return t.extend(y.prototype,c),y}),define("shared/models/OverridesGetterModelMixin",["lodash","backbone","modules/page/utils/PlayerVariantDetector"],function(e,t,n){"use strict";return{setParentModel:function(e){if(!(e.prototype instanceof t.Model))throw new Error("ParentModel should extend Backbone.Model");this.ParentModel=e},get:function(e,t){var i=t&&t.variant?t.variant:n.getVariant();return"overrides"===e||"desktop"===i?this.nonVariantGet(e):this.getVariantAttribute(i,e,t)},getVariantAttribute:function(t,n,i){var r=!i||!i.doNotFallbackToDesktop,o=this.nonVariantGet("overrides"),a=e.get(o,[t,n],void 0);return e.isUndefined(a)&&r?this.nonVariantGet(n):a},nonVariantGet:function(e){return(this.ParentModel?this.ParentModel:t.Model).prototype.get.call(this,e)}}}),define("modules/viewport/models/PageManifestModel",["backbone","lodash","shared/models/OverridesGetterModelMixin"],function(e,t,n){"use strict";var i=e.Model.extend({getSlug:function(){var n=e.Model.prototype.get.call(this,"uri");return t.last(n.split("/"))}});return t.extend(i.prototype,n),i}),define("modules/viewport/models/DocumentVersionModel",["lodash","jquery","backbone","globals","log","urlUtils","modules/page/utils/ShareJSConnection","modules/page/models/PageModel","modules/viewport/models/PageManifestModel","shared/models/OverrideablePropertyModelMixin","shared/utils/ShareJSUtils","libs/font/FontConstants","libs/media/MediaInfoService","libs/media/MediaInfoCache","utils/ScaleConstants","modules/page/utils/PlayerVariantDetector","libs/utils/FeatureFlagsLookupService","libs/utils/FeatureFlags","modules/page/constants/TextModeConstants"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f,p,g,m,v,y){"use strict";var b=n.Collection.extend({model:u}),w=n.Model.extend({idAttribute:"slug",urlRoot:"/{api-version}/account/{scope}/document-versions",MANIFEST_ADD_PAGE:"manifestAddPage",MANIFEST_REMOVE_PAGE:"manifestRemovePage",MANIFEST_MOVE_PAGE:"manifestMovePage",initialize:function(e,t){if(n.Model.prototype.initialize.call(this,e,t),!i.previewMode&&!t.docVersionRequest)throw new Error("A doc version request must be passed in when not in preview mode");this.docVersionRequest=t.docVersionRequest,this.pages=[]},fetch:function(e){return this.loadBackgroundImageInfo(),i.previewMode?this.fetchForPreviewMode(e):this.fetchForPublished(e)},fetchForPreviewMode:function(n){var i=t.Deferred();try{a.getConnection().openExisting(this._getDocumentName(),e.bind(function(e,t){if(e)r.warn(e),i.reject();else if(t){a.listenForReadOnlyConnectionLimitError(t);var n=JSON.parse(JSON.stringify(t.snapshot));this.set(n),i.resolve(n,t)}},this))}catch(e){r.warn(e),i.reject()}i.then(e.bind(function(e,t){this.bindToDocChanges(t)},this));var o=this.loadResolvedMedia().fail(function(){r.warn("Could not fetch docversion media!")});return t.when(i,o)},fetchForPublished:function(t){return this.docVersionRequest.then(e.bind(function(e){f.putMediaArray(e.media),delete e.media,this.set(e)},this))},loadPageModels:function(){r.debug("Loading page models");var n=this.editorPagesManifest.map(e.bind(function(e,t){var n=this.createPageModel(e,t);return this.pages.push(n),n.fetch()},this));return t.when.apply(t,n)},createPageModel:function(t,n){var r={slug:t.getSlug(),disabled:t.get("initiallyDisabled",{doNotFallbackToDesktop:!0})};if(!i.previewMode){var o=this.get("pages")[t.getSlug()];f.putMediaArray(o.media),delete o.media,r=e.extend(r,o)}var a=new s(r,{documentVersion:this,pageIndex:n});return t.on("change:initiallyDisabled change:overrides",function(){a.set("disabled",t.get("initiallyDisabled",{doNotFallbackToDesktop:!0}))}),g.on("change",function(){a.set("disabled",t.get("initiallyDisabled",{doNotFallbackToDesktop:!0}))}),a},processRemoteOps:function(t,n){for(var i=!1,r=!1,o=0;o<n.length;o++){var a=n[o],s=a.p[0];"editorPagesManifest"===s?this.processManifestRemoteOp(a):(this.set(s,JSON.parse(JSON.stringify(t.snapshot[s]))),"smartgroups"===s?(i=i||c.isMediaReloadRequiredForOp(t,a),r=!0):"fonts"===s&&this.processFontRemoteOp(a))}i?this.loadResolvedMedia().done(e.bind(function(){this.trigger("reload")},this)):r&&this.trigger("reload")},processFontRemoteOp:function(n){2===n.p.length&&n.p[1]===d.EXPERIENCE_FAMILY_GUIDS_KEY&&t.when(this.loadFontMetrics()).done(e.bind(function(e){i.fontManifest=e,this.trigger("reload")},this))},createManifestCollection:function(){this.editorPagesManifest=new b(this.get("editorPagesManifest")),i.previewMode&&this.bindToManifestChanges()},bindToDocChanges:function(t){t.on("shout",e.bind(function(e){e=JSON.parse(e),"updateViewportSize"!==e.name&&"updateScaleExperience"!==e.name||window.location.reload()},this)),t.on("remoteop",e.bind(function(e){this.processRemoteOps(t,e)},this))},bindToManifestChanges:function(){this.editorPagesManifest.on("add",e.bind(function(t,n,i){var r=i.at,o=this.createPageModel(t,r);this.pages.splice(r,0,o),o.fetch().done(e.bind(function(){this.trigger(this.MANIFEST_ADD_PAGE,t,i.at)},this))},this)),this.editorPagesManifest.on("remove",e.bind(function(e,t,n){this.pages.splice(n.index,1),this.trigger(this.MANIFEST_REMOVE_PAGE,n.index)},this)),this.editorPagesManifest.on("move",e.bind(function(e,t){this.pages.splice(t,0,this.pages.splice(e,1)[0]),this.trigger(this.MANIFEST_MOVE_PAGE,e,t)},this))},processManifestRemoteOp:function(t){var n,i=t.p[1];if(2===t.p.length)if(e.isUndefined(t.li))if(e.isUndefined(t.ld)){if(!e.isUndefined(t.lm)){var r=t.lm;n=this.editorPagesManifest.at(i),this.editorPagesManifest.remove(n,{silent:!0}),this.editorPagesManifest.add(n,{at:r,silent:!0}),this.editorPagesManifest.trigger("move",i,r)}}else n=this.editorPagesManifest.at(i),this.editorPagesManifest.remove(n);else this.editorPagesManifest.add(t.li,{at:i});else if(3===t.p.length&&!e.isUndefined(t.oi)){var o=t.p[2];this.editorPagesManifest.at(i).set(o,t.oi)}},getPageNumberBySlug:function(t){var n=this.editorPagesManifest;if(e.isEmpty(n))return null;var i=null;return n.find(function(e,n){return e.getSlug()===t&&(i=n+1,!0)}),i},getPageInfoByNumberOrSlug:function(t){var n=this.editorPagesManifest,i=null,r=null;return e.isString(t)?(i=this.getPageNumberBySlug(t),i?r=t:i=1):((i=parseInt(t,10))<1||i>n.length)&&(i=1),!r&&n.at(i-1)&&(r=n.at(i-1).getSlug()),{number:i,slug:r}},getExperienceWidth:function(){return this.getOverrideablePropertyForCurrentVariant("viewportWidth")},getExperienceHeight:function(){return this.getOverrideablePropertyForCurrentVariant("viewportHeight")},getScaleExperience:function(){var e=this.getScaleExperienceType();return"string"==typeof e?e!==p.SCALE_EXPERIENCE_TYPE.NO_SCALING:this.getOverrideablePropertyForCurrentVariant("scaleExperience")},getScaleExperienceType:function(){return this.getOverrideablePropertyForCurrentVariant("scaleExperienceType")},getPages:function(){return this.pages},getEnabledPageIndexes:function(){var t=[];return e.each(this.pages,function(e,n){e.get("disabled")||t.push(n)}),t},getNearestEnabledPage:function(t){var n=e.clamp(t,1,this.pages.length)-1;if(!this.pages[n].get("disabled"))return n+1;for(var i=1;n-i>=0||n+i<this.pages.length;i++){if(this.pages[n+i]&&!this.pages[n+i].get("disabled"))return n+i+1;if(this.pages[n-i]&&!this.pages[n-i].get("disabled"))return n-i+1}},isCarousel:function(){var e=this.editorPagesManifest,t=this.get("carousel");return t&&t.enabled&&e.length>1},isAutoTransitioning:function(){var e=this.get("carousel");return this.isCarousel()&&e.autoTransition},shouldLoadLowRes:function(){return this.get("loadLowRes")},shouldLazyLoad:function(){return this.get("lazyLoading")},getForcedTextLayoutMode:function(){var e=y.DEFAULT;return m.hasFeature(v.ACCESSIBILITY)?e=y.PARAGRAPH:this.get("forceLineMode")&&(e=y.LINE),e},getAutoTransitionDelay:function(){var e=this.get("carousel");return e?e.autoTransitionDelay:0},_getDocumentName:function(){return this.get("uri").replace(/\//g,"_")},getSmartgroupDefinition:function(t){return e.find(this.get("smartgroups"),function(e){return e.id===t})},loadBackgroundImageInfo:function(){var t=e.get(i,"themeObj.backgroundImage",null);t&&f.put(t.id,t)},loadResolvedMedia:function(){return h.loadMediaForRestUri(this.getUri())},loadFontMetrics:function(){return t.ajax({url:this.getUri()+"/font-metrics",type:"GET",dataType:"json"})},getUri:function(){return"/rest"+n.Model.prototype.url.call(this).replace(/\{api-version\}/,i.apiVersion).replace(/\{scope\}/,i.accountSlug)}});return e.extend(w.prototype,l),w}),define("libs/analytics/AbstractTracker",["jquery","lodash"],function(e,t){"use strict";var n=function(e){this.options=e||{},this.enabled=!!this.options.enabled};return t.extend(n.prototype,{isEnabled:function(){return this.enabled},sendEvent:function(t,n){return e.Deferred().resolve()},updateScale:function(e){}}),n}),define("libs/uuid/UuidGenerator",[],function(){"use strict";var e=navigator.userAgent;return{generate:function(){var t=function(){for(var e=1*new Date,t=0;e==1*new Date;)t++;return e.toString(16)+t.toString(16)},n=function(){return Math.random().toString(16).replace(".","")},i=function(t){function n(e,t){var n,i=0;for(n=0;n<t.length;n++)i|=a[n]<<8*n;return e^i}var i,r,o=e,a=[],s=0;for(i=0;i<o.length;i++)r=o.charCodeAt(i),a.unshift(255&r),a.length>=4&&(s=n(s,a),a=[]);return a.length>0&&(s=n(s,a)),s.toString(16)};return function(){var e=(screen.height*screen.width).toString(16);return t()+"-"+n()+"-"+i()+"-"+e+"-"+t()}}()}}),define("libs/analytics/AnalyticsEnvironmentData",["lodash","jquery","device","globals","urlUtils","screenSize"],function(e,t,n,i,r,o){"use strict";var a=window.navigator.userAgent,s=function(){};return s.prototype={data:null,scale:null,initialScale:null,getData:function(){
return this.data||(this.data=e.extend(this.getStandardParams(),this.getCampaignParams())),e.extend(this.data,this.getDynamicTrackingInfo())},updateScale:function(e){this.initialScale=this.initialScale||e,this.scale=e},getDynamicTrackingInfo:function(){var e=o.getDimensions(),t={screen_width:e.width,screen_height:e.height};return this.initialScale&&(t.initial_scale=this.initialScale),this.scale&&(t.scale=this.scale),t},getBrowserAndVersionUsingMixpanelAlgorithm:function(t,n,i){var r=function(e){var n=t.match(e);return n&&n[1]},o=null,a=null;n=n||"",e.includes(t,"PhantomJS")?(o="PhantomJS",a=r(/PhantomJS\/(\d+)/)):i?o=e.includes(t,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(t)?o="BlackBerry":e.includes(t,"Edge")?(o="Microsoft Edge",a=r(/Edge\/(\d+)/)):e.includes(t,"FBIOS")?o="Facebook Mobile":e.includes(t,"Chrome")?(o="Chrome",a=r(/Chrome\/(\d+)/)):e.includes(t,"CriOS")?(o="Chrome iOS",a=r(/CriOS\/(\d+)/)):e.includes(n||"","Apple")?(o=e.includes(t,"Mobile")?"Mobile Safari":"Safari",a=r(/Version\/(\d+)/)):e.includes(t,"Android")?o="Android Mobile":e.includes(t,"Konqueror")?o="Konqueror":e.includes(t,"Firefox")?(o="Firefox",a=r(/Firefox\/(\d+)/)):/msie|trident/i.test(t)?(o="Internet Explorer",a=r(/(?:msie |rv:)(\d+)/i)):e.includes(t,"Gecko")&&(o="Mozilla");var s={};return o&&(s.name=o),a&&(s.version=a),s},getStandardParams:function(){var e=window.document.referrer,t=this.getSearchEngine(e),r=this.getBrowserAndVersionUsingMixpanelAlgorithm(a,navigator.vendor,window.opera);return{browser:r.name,trial:i.isTrialAccount?1:0,browser_version:r.version,user_agent:a,device_type:n.deviceType(),player_type:n.playerType(),initial_orientation:n.orientation(),cookies_enabled:n.cookies()?1:0,embedded:n.isIframe()?1:0,https:"https:"===window.location.protocol?1:0,device:this.getDevice(),device_pixel_ratio:n.pixelRatio(),search_engine:t,search_keyword:this.getSearchKeyword(t,e),os:n.os.name,os_version:n.os.version,referrer:e||null,referring_domain:this.extractReferringDomain(e)}},extractReferringDomain:function(e){var t=null;return e&&((t=r.extractDomain(e))||(t=e)),t},getDevice:function(){return/Windows Phone/i.test(a)||/WPDesktop/.test(a)?"Windows Phone":/iPad/.test(a)?"iPad":/iPod/.test(a)?"iPod Touch":/iPhone/.test(a)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":/Android/.test(a)?"Android":null},getSearchEngine:function(e){return 0===e.search("https?://(.*)google.([^/?]*)")?"google":0===e.search("https?://(.*)bing.com")?"bing":0===e.search("https?://(.*)yahoo.com")?"yahoo":0===e.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},getSearchKeyword:function(e,t){var n="yahoo"!=e?"q":"p";if(null!==e){var i=r.getUrlParams(t)[n];if(i&&i.length)return i}return null},getCampaignParams:function(){return e.pick(r.getUrlParams(window.document.URL),"utm_source","utm_medium","utm_campaign","utm_content","utm_term")}},s}),define("libs/analytics/EventQueue",["jquery","lodash","backbone"],function(e,t,n){"use strict";var i=function(){this.queue=[],this.timerId=null};return i.prototype=t.extend({},n.Events,{EVENTS:{AGGREGATE_EVENT:"aggregate-event"},addEvent:function(e){this.queue.push(e),this.startTimer()},isEmpty:function(){return 0===this.queue.length},popEvents:function(){var e=this.queue.splice(0,5);return this.clearTimer(),t.isEmpty(this.queue)||this.startTimer(),e},startTimer:function(){null===this.timerId&&(this.timerId=setTimeout(t.bind(this.postEvents,this),5e3))},clearTimer:function(){null!==this.timerId&&(clearTimeout(this.timerId),this.timerId=null)},postEvents:function(){this.queue.length>0?this.trigger(this.EVENTS.AGGREGATE_EVENT,this.popEvents()):this.clearTimer()}}),i}),define("@frontend/common/constants/CookieName",[],function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=155)}({155:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.CEROS_ID="ceros_id",e.AUTH_REFERER="auth_referer",e.ORIGINAL_REFERER="original_referer",e.CEROS_DOMAIN_TRACKING="cerosdomaintracking",e.CEROS_EXPERIENCE_TRACKING="cerosexperiencetracking"}(t.CookieName||(t.CookieName={}))}})}),define("@frontend/common/utils/DataUtils",["lodash"],function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=202)}({0:function(t,n){t.exports=e},202:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(){}return e.isNullOrUndefined=function(e){return i.isNull(e)||i.isUndefined(e)},e}();t.DataUtils=r}})}),define("libs/analytics/AnalyticsCookies",["cookie","@frontend/common/constants/CookieName","@frontend/common/utils/DataUtils"],function(e,t,n){"use strict";var i=t.CookieName,r=n.DataUtils;return{setExperienceTrackingCookie:function(e,t,n){this.setCookie(i.CEROS_EXPERIENCE_TRACKING,e,t,n,!1)},setDomainTrackingCookie:function(e,t,n){this.setCookie(i.CEROS_DOMAIN_TRACKING,e,t,n,!1)},getExperienceTrackingCookieData:function(){return this.getCookieData(i.CEROS_EXPERIENCE_TRACKING)},getDomainTrackingCookieData:function(){return this.getCookieData(i.CEROS_DOMAIN_TRACKING)},getCookieData:function(t){var n=e.get(t);if(n){var i=decodeURIComponent(n);try{return JSON.parse(i)}catch(e){this.parseError(t,e)}}return{}},setCookie:function(t,n,i,o,a){n=encodeURIComponent(JSON.stringify(n)),a=!!r.isNullOrUndefined(a)||a,e.set(t,n,{expires:365,path:i||"/",domain:o||"",samesite:"lax",secure:a})},parseError:function(e,t){var n=(new Date).getTime();n-(this.lastParseError||0)>36e5&&(window.Rollbar.error("Unable to parse "+e+" cookie data, the content was malformed. Exception was: "+t),this.lastParseError=n)}}}),define("libs/analytics/CerosTracker",["jquery","lodash","cookie","globals","libs/uuid/UuidGenerator","device","libs/analytics/AnalyticsEnvironmentData","libs/analytics/EventQueue","libs/analytics/AbstractTracker","libs/analytics/AnalyticsCookies"],function(e,t,n,i,r,o,a,s,u,l){"use strict";var c=["player.page.dwell","player.video.progress_percent","player.video.progress_time","player.performance.marker","previewer.performance.marker","studio.performance.marker","admin.performance.marker"],d=function(e){if(u.call(this,e),this.options=e||{},this.userEmail=null,this.fullName=null,this.clientVersion=9,this.anonymousUserTrackingData=null,this.domain=this.getRootDomain(),this.experienceCookiePath=this.getExperienceCookiePath(),this.defaultAttributes={timezone:this.getTimezoneOffset(),user_agent:navigator.userAgent,visit_slug:r.generate()},this.eventQueue=new s,this.eventQueue.on(this.eventQueue.EVENTS.AGGREGATE_EVENT,t.bind(function(e){this.trackEvents(e,!1)},this)),this.environmentData=new a,this.options.trackInitialReferrer){var n=this.environmentData.getData();this.setInitialReferrer(n.referrer,n.referring_domain)}};return d.prototype=Object.create(u.prototype),d.prototype.constructor=d,t.extend(d.prototype,{setUser:function(e,t,n){this.setDomainTrackingCookie({email:e,full_name:t,user_token:e,slug:n}),this.userEmail=e,this.fullName=t,this.userSlug=n},setInitialReferrer:function(e,n){var i=this.getExperienceTrackingCookieData();(t.isUndefined(i.initial_referrer)||t.isUndefined(i.initial_referring_domain))&&(i.initial_referrer=e||null,i.initial_referring_domain=n||null,this.setExperienceTrackingCookie(i))},encodeData:function(e){return encodeURIComponent(btoa(unescape(encodeURIComponent(JSON.stringify(e)))))},getEvent:function(e,n){var i=t.extend({},{event_slug:r.generate()},n||{},{event_name:e,client_timestamp:(new Date).getTime()});return i=t.omitBy(i,t.isNull)},track:function(n,i){var r=this.getEvent(n,i);return t.includes(c,r.event_name)?(this.eventQueue.addEvent(r),e.Deferred().resolve()):this.trackEvents([r],!0)},trackEvents:function(n,r){if(!this.isEnabled())return e.Deferred().resolve();if(!i.analyticsUrl)return e.Deferred().resolve();if(!n||0===n.length)return e.Deferred().resolve();var o=this.getDomainTrackingCookieData();o.user_token||(o=this.createDomainTrackingData()),this.setDomainTrackingCookie(o);var a=this.getCommonProps(o),s=this.environmentData.getData();this.options.envPropertyList&&(s=t.pick(s,this.options.envPropertyList));var u=this.getExperienceTrackingCookieData();s=t.extend(s,{email:o.email,full_name:o.full_name,timezone:this.defaultAttributes.timezone,user_agent:this.defaultAttributes.user_agent,initial_referrer:u.initial_referrer,initial_referring_domain:u.initial_referring_domain}),a=t.omitBy(a,t.isNull),s=t.omitBy(s,t.isNull),r&&(n=n.concat(this.eventQueue.popEvents()));var l={common:a,extended_common:s,events:n},c=i.analyticsUrl+"?data="+this.encodeData(l);return this._sendTrackingRequest(c,0)},getCommonProps:function(e){return{account_slug:i.accountSlug,client_version:this.clientVersion,user_token:e.user_token,visit_slug:this.defaultAttributes.visit_slug}},_handleTrackingError:function(e,t,n,i){var r=this;i<3?setTimeout(function(){r._sendTrackingRequest(n,i)},3e3):3!==i||window.sentRollbarForAnalyticsRetryFail||(window.Rollbar&&window.Rollbar.error("One or more analytics events are failing due to HTTP or connection errors.",{errorThrown:t,errorCode:e.status,url:n}),window.sentRollbarForAnalyticsRetryFail=!0)},_sendTrackingRequest:function(t,n){var i=this,r=new e.Deferred;if(o.isIE9OrEarlier()&&"http:"===location.protocol){var a=new Image;a.crossOrigin="Anonymous",a.src=t+"&_="+Math.random(),a.onload=function(){r.resolve()},a.onerror=function(){r.resolve()}}else e.ajax({url:t,type:"GET",cache:!1,crossDomain:!0}).then(r.resolve,function(e,o,a){i._handleTrackingError(e,a,t,++n),r.resolve()});return r},getRootDomain:function(){var e=location.host.split(".").reverse();return"."+e[1]+"."+e[0]},getExperienceCookiePath:function(){var e=window.location.pathname,t=e.search(/\/p\/\d+/g);return t>=0?e.substr(0,t):e},getTimezoneOffset:function(){var e=(new Date).getTimezoneOffset()/60;return Math.abs(e)>15?null:e},createAnonymousUserDomainTrackingData:function(){return{user_token:r.generate()}},createDomainTrackingData:function(){return this.userEmail?{email:this.userEmail,full_name:this.fullName,user_token:this.userEmail,slug:this.userSlug}:(null===this.anonymousUserTrackingData&&(this.anonymousUserTrackingData=this.createAnonymousUserDomainTrackingData()),this.anonymousUserTrackingData)},setDomainTrackingCookie:function(e){this.isEnabled()&&l.setDomainTrackingCookie(e,"/",this.domain)},setExperienceTrackingCookie:function(e){this.isEnabled()&&l.setExperienceTrackingCookie(e,this.experienceCookiePath,this.domain)},getDomainTrackingCookieData:function(){return l.getDomainTrackingCookieData()},getExperienceTrackingCookieData:function(){return l.getExperienceTrackingCookieData()},updateScale:function(e){this.environmentData.updateScale(e)},isPlayerPreviewer:function(){return"player"===i.analyticsApplicationKey||"previewer"===i.analyticsApplicationKey}}),d}),define("modules/analytics/trackers/CerosPlayerTracker",["jquery","lodash","libs/analytics/CerosTracker","modules/page/utils/PlayerVariantDetector","globals"],function(e,t,n,i,r){"use strict";var o=["previewer.component.hover","player.component.hover"],a=["previewer.page.view","player.page.view"],s=["page_slug","page_num"],u=function(e){n.call(this,t.extend({trackInitialReferrer:!0,application:r.analyticsApplicationKey},e))};return u.prototype=Object.create(n.prototype),u.prototype.constructor=u,t.extend(u.prototype,{sendEvent:function(i,r){return t.includes(o,i)?e.Deferred().resolve():(r=this.filterEventData(i,r),n.prototype.track.call(this,i,r))},getCommonProps:function(e){var o=n.prototype.getCommonProps.call(this,e);return t.extend(o,{experience_alias:r.issueAliasSlug,experience_slug:r.issue.slug,experience_version_slug:r.docVersion.slug,project_slug:r.appSlug,current_layout:i.hasDetectedVariant()?i.getVariant():"unknown"})},filterEventData:function(e,n){return t.includes(a,e)&&(n=t.pick(n,s)),n}}),u}),define("modules/analytics/trackers/BaseThirdPartyTracker",["jquery","lodash","log","libs/analytics/AbstractTracker","shared/utils/ScrollProxy"],function(e,t,n,i,r){"use strict";var o=function(e){i.call(this,e),this.eventHandlerMap={}};return o.prototype=Object.create(i.prototype),o.prototype.constructor=o,t.extend(o.prototype,{sendEvent:function(t,n){return this.isEnabled()&&this.eventHandlerMap[t]&&this.eventHandlerMap[t].call(this,n),e.Deferred().resolve()},invokeOnParentPage:function(e){e=t.isArray(e)?e:[e],e=t.map(e,function(e){return e.toJSON()}),r.invokeGlobalFunctions(e)},registerEventHandler:function(e,t){this.eventHandlerMap[e]=t}}),o}),define("modules/analytics/functions/GlobalFunction",["jquery","lodash","log"],function(e,t,n){"use strict";var i=function(e,n){this.functionPath=e,this.args=t.isArray(n)?n:[n]};return t.extend(i.prototype,{invoke:function(){for(var e=window,t=null,n=this.functionPath.split("."),i=0;i<n.length&&(i>0&&(e=t),t=e[n[i]]);i++);if(e&&t&&"function"==typeof t)return t.apply(e,this.args)},toJSON:function(){return{functionPath:this.functionPath,args:this.args}},toString:function(){return JSON.stringify(this.toJSON())}}),i}),define("modules/analytics/functions/GoogleAnalyticsFunction",["jquery","lodash","log","modules/analytics/functions/GlobalFunction"],function(e,t,n,i){"use strict";var r=function(e){i.call(this,"ga",["send",e])};return r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r}),define("modules/analytics/functions/GoogleGlobalSiteTagFunction",["jquery","lodash","log","modules/analytics/functions/GlobalFunction"],function(e,t,n,i){"use strict";var r=function(e,t){i.call(this,"gtag",["event",e,t])};return r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r}),define("modules/analytics/trackers/GoogleAnalyticsTracker",["log","lodash","globals","shared/utils/NavigationUtils","modules/analytics/trackers/BaseThirdPartyTracker","modules/analytics/functions/GoogleAnalyticsFunction","modules/analytics/functions/GoogleGlobalSiteTagFunction"],function(e,t,n,i,r,o,a){"use strict";var s=function(e){r.call(this,e),this.options=e,this.isPageViewTrackingEnabled()&&(this.registerEventHandler("player.page.view",this.handlePageViewEvent),this.registerEventHandler("previewer.page.view",this.handlePageViewEvent)),this.isClickTrackingEnabled()&&(this.registerEventHandler("player.component.click",this.handleClickComponentEvent),this.registerEventHandler("previewer.component.click",this.handleClickComponentEvent)),this.isHoverTrackingEnabled()&&(this.registerEventHandler("player.component.hover",this.handleHoverComponentEvent),this.registerEventHandler("previewer.component.hover",this.handleHoverComponentEvent))};return s.prototype=Object.create(r.prototype),s.prototype.constructor=s,t.extend(s.prototype,{isEnabled:function(){return this.options.enabled&&!!this.options.trackingID&&(this.isPageViewTrackingEnabled()||this.isClickTrackingEnabled()||this.isHoverTrackingEnabled())},isPageViewTrackingEnabled:function(){return!n.isEmbedded&&!!this.options.trackPageViewsForStandaloneExperiences},isClickTrackingEnabled:function(){return!!this.options.trackClicks},isHoverTrackingEnabled:function(){return!!this.options.trackHovers},handlePageViewEvent:function(t){var r={hitType:"pageview",page:i.buildUriForPageNumber(t.page_num)},a=new o(r);n.previewMode?e.forceInfo("GA page view event",a.toString()):a.invoke()},handleClickComponentEvent:function(e){this.sendCustomEvent({hitType:"event",eventCategory:this.options.eventCategory,eventAction:this.options.clickEventAction,eventLabel:e.component_name})},handleHoverComponentEvent:function(e){this.sendCustomEvent({hitType:"event",eventCategory:this.options.eventCategory,eventAction:this.options.hoverEventAction,eventLabel:e.component_name})},sendCustomEvent:function(t){var i=new o(t);if(n.previewMode)e.forceInfo("GA custom event",i.toString());else if(n.isEmbedded){var r=new a(t.eventAction,{send_to:this.options.trackingID,event_category:t.eventCategory,event_label:t.eventLabel});this.invokeOnParentPage([r,i])}else i.invoke()}}),s}),define("modules/analytics/functions/GoogleTagManagerFunction",["jquery","lodash","log","modules/analytics/functions/GlobalFunction"],function(e,t,n,i){"use strict";var r=function(e){i.call(this,"dataLayer.push",e)};return r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r}),define("modules/analytics/trackers/GoogleTagManagerTracker",["log","lodash","globals","shared/utils/NavigationUtils","modules/analytics/trackers/BaseThirdPartyTracker","modules/analytics/functions/GoogleTagManagerFunction"],function(e,t,n,i,r,o){"use strict";var a=function(e){r.call(this,e),this.options=e,this.isPageViewTrackingEnabled()&&(this.registerEventHandler("player.page.view",this.handlePageViewEvent),this.registerEventHandler("previewer.page.view",this.handlePageViewEvent)),this.isClickTrackingEnabled()&&(this.registerEventHandler("player.component.click",this.handleClickComponentEvent),this.registerEventHandler("previewer.component.click",this.handleClickComponentEvent)),this.isHoverTrackingEnabled()&&(this.registerEventHandler("player.component.hover",this.handleHoverComponentEvent),this.registerEventHandler("previewer.component.hover",this.handleHoverComponentEvent))};return a.prototype=Object.create(r.prototype),a.prototype.constructor=a,t.extend(a.prototype,{isEnabled:function(){return this.options.enabled&&!!this.options.containerID&&(this.isPageViewTrackingEnabled()||this.isClickTrackingEnabled()||this.isHoverTrackingEnabled())},isPageViewTrackingEnabled:function(){return!n.isEmbedded&&!!this.options.trackPageViewsForStandaloneExperiences},isClickTrackingEnabled:function(){return!!this.options.trackClicks},isHoverTrackingEnabled:function(){return!!this.options.trackHovers},handlePageViewEvent:function(t){var r={event:"ceros-pageview",cerosPagePath:i.buildUriForPageNumber(t.page_num),cerosPageTitle:t.page_name,cerosPageLocation:window.location.href},a=new o(r);n.previewMode?e.forceInfo("GTM page view event",a.toString()):a.invoke()},handleClickComponentEvent:function(e){this.sendCustomEvent({event:"ceros-event",cerosCategory:this.options.eventCategory,cerosAction:this.options.clickEventAction,cerosLabel:e.component_name})},handleHoverComponentEvent:function(e){this.sendCustomEvent({event:"ceros-event",cerosCategory:this.options.eventCategory,cerosAction:this.options.hoverEventAction,cerosLabel:e.component_name})},sendCustomEvent:function(t){var i=new o(t);n.previewMode?e.forceInfo("GTM custom event",i.toString()):n.isEmbedded?this.invokeOnParentPage(i):i.invoke()}}),a}),define("modules/analytics/trackers/MarketoAnalyticsTracker",["log","lodash","globals","modules/analytics/trackers/BaseThirdPartyTracker"],function(e,t,n,i){"use strict";var r=function(e){i.call(this,e),this.options=e,this.isPageViewTrackingEnabled()&&(this.registerEventHandler("player.page.view",this.handlePageEvent),this.registerEventHandler("previewer.page.view",this.handlePageEvent))};return r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.extend(r.prototype,{didInit:!1,isEnabled:function(){return this.options.enabled&&!!this.options.accountId},isPageViewTrackingEnabled:function(){return this.isEnabled()},init:function(t){this.didInit=!!n.previewMode||!!window.Munchkin,n.previewMode&&e.forceInfo("Marketo page view event",JSON.stringify(this.formatPageUri(t.page_num))),window.Munchkin&&window.Munchkin.init(this.options.accountId)},formatPageUri:function(e){var t=window.location.pathname;return t.match(/\/p\/\d+$/)||(t=t+"/p/"+e),{url:t}},handlePageEvent:function(t){if(!this.didInit)return void this.init(t);var i=this.formatPageUri(t.page_num);n.previewMode?e.forceInfo("Marketo page view event",JSON.stringify(i)):window.Munchkin.munchkinFunction("visitWebPage",i)}}),r}),define("modules/analytics/trackers/EloquaAnalyticsTracker",["log","lodash","globals","modules/analytics/trackers/BaseThirdPartyTracker"],function(e,t,n,i){"use strict";var r=function(e){i.call(this,e),this.options=e,this.isPageViewTrackingEnabled()&&(this.registerEventHandler("player.page.view",this.handlePageEvent),this.registerEventHandler("previewer.page.view",this.handlePageEvent)),this.isEnabled()&&(window._elqQ=window._elqQ||[],window._elqQ.push(["elqSetSiteId",this.options.siteId]),e.cookieDomain&&window._elqQ.push(["elqUseFirstPartyCookie",this.options.cookieDomain]))};return r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.extend(r.prototype,{isEnabled:function(){return this.options.enabled&&!!this.options.siteId},isPageViewTrackingEnabled:function(){return this.isEnabled()},formatPageUri:function(e){var t=window.location.href;return t.match(/\/p\/\d+$/)||(t=t+"/p/"+e),t},handlePageEvent:function(t){var i=this.formatPageUri(t.page_num);n.previewMode?e.forceInfo("Eloqua page view event",i):window._elqQ.push(["elqTrackPageView",i])}}),r}),define("modules/analytics/trackers/AnalyticsTrackerManager",["jquery","lodash","device","libs/analytics/AbstractTracker","modules/analytics/trackers/CerosPlayerTracker","modules/analytics/trackers/GoogleAnalyticsTracker","modules/analytics/trackers/GoogleTagManagerTracker","modules/analytics/trackers/MarketoAnalyticsTracker","modules/analytics/trackers/EloquaAnalyticsTracker"],function(e,t,n,i,r,o,a,s,u){"use strict";var l=function(e){this.options=e||{},this.trackers=[],this.options.cerosPlayerTracker&&this.trackers.push(new r(this.options.cerosPlayerTracker)),this.options.googleAnalyticsTracker&&this.trackers.push(new o(this.options.googleAnalyticsTracker)),this.options.googleTagManagerTracker&&this.trackers.push(new a(this.options.googleTagManagerTracker)),this.options.marketoTracker&&this.trackers.push(new s(this.options.marketoTracker)),this.options.eloquaTracker&&this.trackers.push(new u(this.options.eloquaTracker))};return t.extend(l.prototype,{sendEvent:function(i,r){if(n.isBot())return e.Deferred().resolve();var o=[];return t.each(this.trackers,function(e){e.isEnabled()&&o.push(e.sendEvent(i,r))}),e.when.apply(e,o).promise()},updateScale:function(e){t.each(this.trackers,function(t){t.isEnabled()&&t.updateScale(e)})}}),l}),define("libs/analytics/PerformanceTracker",["jquery","lodash","backbone"],function(e,t,n,i){"use strict";var r=function(){this.startTime=null};return r.prototype=t.extend(r.prototype,n.Events,{EVENTS:{PERFORMANCE_MARK:"performance_mark"},MARKS:{PLAYER:{RUN_START:"run-start",DOM_READY:"dom-ready",SPINNER_SHOWN:"spinner-shown",DOC_VERSION_LOADED:"doc-version-loaded",SPINNER_HIDDEN:"spinner-hidden",HIGH_PRIORITY_IMAGES_START_LOADING:"high-priority-images-start-loading",LOW_PRIORITY_IMAGES_START_LOADING:"low-priority-images-start-loading",BEGIN_PRERENDERING_PAGES:"begin-prerendering-pages",ALL_PAGES_PRERENDERED:"all-pages-prerendered",PRIORITY_QUEUE_EMPTIED:"priority-queue-emptied",ALL_RESOURCES_LOADED:"all-resources-loaded"},STUDIO:{SHAREJS_CONNECTION_INITIALIZED:"sharejs-connection-initialized",ALL_DATA_LOADED:"all-data-loaded",ALL_PAGES_LOADED:"all-pages-loaded",USER_LOADED:"user-loaded",THUMBNAIL_POLICY_LOADED:"thumbnail-policy-loaded"}},optionalProperties:{},setOptionalProperties:function(e){return this.optionalProperties=e,this},startTracking:function(e){this.startTime=e||(new Date).getTime();var n=t.extend({},this.optionalProperties,{performance_marker_name:"start-tracking",performance_marker_time:0});this.trigger(this.EVENTS.PERFORMANCE_MARK,n)},mark:function(e){if(null===this.startTime)return!1;var n=(new Date).getTime()-this.startTime;if(n<0||n>18e5)return!1;var i=t.extend({},this.optionalProperties,{performance_marker_name:e,performance_marker_time:n});return this.trigger(this.EVENTS.PERFORMANCE_MARK,i),!0}}),r}),define("libs/analytics/AbstractPageViewTracker",["jquery","lodash","backbone"],function(e,t,n){"use strict";var i=function(){this.lastUserActivityTime=null,this.timerId=null,this.paused=!1,this.pageActivated=!1,document.addEventListener&&document.addEventListener("visibilitychange",t.bind(function(){"hidden"===document.visibilityState?this.pause():"visible"===document.visibilityState&&this.registerUserActivity()},this))};return i.prototype=t.extend({},n.Events,{EVENTS:{USER_ACTIVITY_PING:"user-activity-ping"},PAGE_PING_INTERVAL_MILLIS:5e3,USER_INACTIVITY_TIMEOUT_MILLIS:3e4,pause:function(){this.isRunning()&&(this.logDebug("Pausing page ping timer"),clearTimeout(this.timerId),this.timerId=null,this.paused=!0)},registerUserActivity:function(){this.pageActivated&&(this.lastUserActivityTime=new Date,this.paused=!1,this.isRunning()||this.startTimer())},registerUserActivityIfNotPaused:function(){this.paused||this.registerUserActivity()},startTimer:function(){this.logDebug("Starting page ping timer");var e=t.bind(function(){this.timerId=setTimeout(t.bind(function(){this.trigger(this.EVENTS.USER_ACTIVITY_PING,this.getDwellTimeEventData()),this.setPostEventFireData(),this.shouldStartPagePingEventTimer()?e():(this.logDebug("Stopping page pings. User is not active."),this.timerId=null)},this),this.PAGE_PING_INTERVAL_MILLIS),this.timerStartTime=Date.now()},this);e()},getDwellTimeEventData:function(){return{dwellTime:this.PAGE_PING_INTERVAL_MILLIS/1e3}},setPostEventFireData:function(){},shouldStartPagePingEventTimer:function(){return this.isUserActive()},isUserActive:function(){return new Date-this.lastUserActivityTime<this.USER_INACTIVITY_TIMEOUT_MILLIS},isRunning:function(){return null!==this.timerId},logDebug:function(e){console.debug(e)}}),i}),define("modules/analytics/PlayerPageViewTracker",["jquery","log","lodash","backbone","libs/analytics/AbstractPageViewTracker"],function(e,t,n,i,r){"use strict";var o=function(){r.call(this)};o.prototype=Object.create(r.prototype),o.prototype.constructor=o;return n.extend(o.prototype,{activatePage:function(e,n,i){this.timerId&&(t.debug("Stopping page ping timer"),clearTimeout(this.timerId),this.timerId=null),e=isNaN(e)?0:e,n=isNaN(n)?i:n,this.minY=e,this.maxY=n,this.lastTopY=e,this.lastBottomY=n,this.pageHeight=i,this.pageActivated=!0,this.registerUserActivity()},resetYMinMax:function(){this.minY=void 0,this.maxY=void 0},trackPageScroll:n.throttle(function(e,t){isNaN(e)||isNaN(t)||(this.minY=void 0===this.minY?e:Math.min(e,this.minY),this.maxY=void 0===this.maxY?t:Math.max(t,this.maxY),this.lastTopY=e,this.lastBottomY=t,this.registerUserActivity())},200),setPostEventFireData:function(){this.minY=this.lastTopY,this.maxY=this.lastBottomY},shouldStartPagePingEventTimer:function(){return this.isUserActive()||this.isLightboxOpen()},getDwellTimeEventData:function(){var e=Math.max(0,this.minY),t=this.maxY;return this.pageHeight&&(t=Math.min(this.pageHeight,t)),{minY:e,maxY:t,dwellTime:this.PAGE_PING_INTERVAL_MILLIS/1e3}},isLightboxOpen:function(){return e(".ceros-lightbox").is(":visible")},logDebug:function(e){t.debug(e)}}),o}),define("modules/analytics/Analytics",["log","lodash","jquery","device","globals","modules/analytics/trackers/AnalyticsTrackerManager","libs/analytics/PerformanceTracker","modules/analytics/PlayerPageViewTracker","libs/analytics/AnalyticsCookies"],function(e,t,n,i,r,o,a,s,u){"use strict";var l=function(){this.ready=!1,this.lastPageLoadedAttr=null};return l.prototype={init:function(e){this.options=t.extend({application:"player"},e||{}),this.analyticsTrackerManager=new o(e.analyticsTrackers),this.performanceTracker=new a,this.performanceTracker.on(this.performanceTracker.EVENTS.PERFORMANCE_MARK,this.sendPerformanceMarkEvent,this),this.playerPageViewTracker=new s,this.playerPageViewTracker.on(this.playerPageViewTracker.EVENTS.USER_ACTIVITY_PING,this.sendPageDwellEvent,this),this.ready=!0},getPerformanceTracker:function(){return this.performanceTracker},updateScale:function(e){return this.analyticsTrackerManager.updateScale(e)},unsupportedOpen:function(e){return this._track(this.options.application+".unsupported_browser.open",e)},_openExperience:function(e){this._track(this.options.application+".experience.open",e)},viewExperience:function(n){if(window.cerosPlayerLoadStart){var i=new Date,r=(i-window.cerosPlayerLoadStart)/1e3;e.info("First Page Load Time: "+r);r<0&&(e.warn(new Error("Analytics: negative load time calculated. Start time: "+window.cerosPlayerLoadStart+", End time: "+i)),r=0),this._openExperience(t.extend({load_time:r},n)),window.cerosPlayerLoadStart=null}},viewPage:function(e){i.isBot()||this._trackViewPage(e)},playVideo:function(e){this._track(this.options.application+".video.play",e)},trackVideoProgressTime:function(e){this.isPlayer()&&this._track(this.options.application+".video.progress_time",e)},trackVideoProgressPercent:function(e){this.isPlayer()&&this._track(this.options.application+".video.progress_percent",e)},clickComponent:function(e){this._track(this.options.application+".component.click",e)},hoverComponent:function(e){this._track(this.options.application+".component.hover",e)},clickLink:function(e){this._track(this.options.application+".link.click",e)},clickLightbox:function(e){this._track(this.options.application+".lightbox.click",e)},clickProduct:function(e){this._track(this.options.application+".product.click",e)},clickShoppingCart:function(e){this._track(this.options.application+".shopping_cart.click",e)},clickPageShare:function(e){this._track(this.options.application+".page.share",e)},clickCerosBranding:function(e){this._track(this.options.application+".ceros_branding.click",e)},experienceLoadInteraction:function(e){this._track(this.options.application+".experience_load.timed",e)},formSubmit:function(e){t.isNil(e.form_origin_form_id)||(e=t.clone(e),e.form_origin_form_id=""+e.form_origin_form_id),this._track(this.options.application+".component.form_submit",e)},handleApiRequest:function(e,t){this._track(this.options.application+".ceros.api.request",{sdk_event_name:e.name,sdk_version:e.client.sdkVersion})},sendPerformanceMarkEvent:function(e){this._track(this.options.application+".performance.marker",e,!0)},_trackViewPage:function(e){this._track(this.options.application+".page.view",e),this.playerPageViewTracker.activatePage(e.topY,e.bottomY,e.pageHeight),this.lastPageLoadedAttr=e},_track:function(e,t,r){if(!this.ready)throw Error("please call init() before attempting to capture analytics!");return i.isBot()?n.Deferred().resolve():(r||this.playerPageViewTracker.registerUserActivity(),this.analyticsTrackerManager.sendEvent(e,t))},resetPageTrackingMinMaxY:function(){this.playerPageViewTracker.resetYMinMax()},trackPageScroll:function(e){
this.lastPageLoadedAttr&&this.lastPageLoadedAttr.page_slug===e.page_slug&&this.playerPageViewTracker.trackPageScroll(e.topY,e.bottomY)},registerUserActivity:function(){this.playerPageViewTracker.registerUserActivity()},registerUserActivityIfVisible:function(){this.playerPageViewTracker.registerUserActivityIfNotPaused()},sendPageDwellEvent:function(t){if(!i.isBot()&&this.isPlayer()&&this.lastPageLoadedAttr){var n={page_slug:this.lastPageLoadedAttr.page_slug,page_num:this.lastPageLoadedAttr.page_num,page_height:this.lastPageLoadedAttr.pageHeight,min_y:t.minY,max_y:t.maxY,dwell_time:t.dwellTime};e.debug("SENDING PING, min_y: "+n.min_y+", max_y: "+n.max_y+", Dur: "+n.dwell_time+", page_height: "+n.page_height),this.analyticsTrackerManager.sendEvent(this.options.application+".page.dwell",n)}},isPlayer:function(){return"player"===this.options.application},getUserToken:function(){return u.getDomainTrackingCookieData().user_token}},new l}),define("modules/analytics/module",["lodash","ceros","modules/analytics/Analytics"],function(e,t,n){"use strict";return new t.Module({id:"analytics",description:"Provides an interface for tracking statistics on the analytics service.",version:"1.0",delegate:function(){var t={},i=e.functionsIn(n);return e.each(i,function(i){"_"!=i.substr(0,1)&&(t[i]=e.bind(n[i],n))}),t}()})}),define("modules/sdk-backend/module",["jquery","lodash","log","ceros","globals","shared/utils/ModuleEventManager","shared/utils/NavigationUtils","modules/page/models/PageModel","modules/page/utils/PlayerVariantDetector","modules/page/utils/PlayerVariantUtil"],function(e,t,n,i,r,o,a,s,u,l){"use strict";var c=["sdk.experience.container.ready","sdk.experience.container.scrolled","sdk.experience.container.resized","sdk.experience.page.goto","sdk.experience.page.next","sdk.experience.page.previous","sdk.component.video.start","sdk.component.video.stop","sdk.component.text.settext","sdk.component.image.seturl","sdk.component.image.reset","sdk.component.click","sdk.component.show","sdk.component.hide","sdk.layer.show","sdk.layer.hide","sdk.page.animations.start","sdk.page.animations.pause","sdk.page.disable","sdk.page.enable"],d=function(e,t){t=JSON.stringify(t),e.postMessage(t,"*")},h=function(e,t){var n={name:"ceros.sdk.player:"+e,version:"1.1.0",params:t};r.isEmbedded&&d(parent,n),d(window,n)},f=function(e){var t=new RegExp("^ceros.sdk.player:");return e.replace(t,"")},p=function(e){if(e=e.originalEvent,t.isString(e.data)&&-1!==e.data.indexOf("ceros.sdk.player:")){var i={};try{i=JSON.parse(e.data)}catch(e){return void n.debug("Error processing message: "+e)}if(i.name){if(i.name=f(i.name),-1===c.indexOf(i.name))return void n.debug("Received message that is not an SDK event: "+i.name);o.trigger(i.name,i.params)}}},g=function(){var e={},n=function(n,i,r){r&&!t.isEmpty(r)&&t.each(r,function(t){e[t]||(e[t]={pages:[],syncedObjects:[],smartgroups:[],layers:[],components:[]}),e[t][n].push(i)})};this.addPageTags=function(e,t){n("pages",e,t)},this.addSyncedObjectTags=function(e,t){n("syncedObjects",e,t),n("smartgroups",e,t)},this.addLayerTags=function(e,t){n("layers",e,t)},this.addComponentTags=function(e,t){n("components",e,t)},this.getTags=function(){return e}};return new i.Module({id:"sdk-backend",description:"The API for the player SDK.",version:"1.0",delegate:{experienceID:null,initialize:function(i,r,o){if(t.isUndefined(window.postMessage))return void n.warn("This browser does not support inter-frame communication.");n.debug("Embedded Player SDK listening for inter-frame messages."),e(window).on("message",p);var a=this.buildExperienceData(i,r,o);this.experienceID=i.get("slug"),this.registerEvents(),h("ready",a)},buildExperienceData:function(e,t,n){var i=new g,o=this.buildPages(t,i),s=this.buildSyncedObjects(t.get("smartgroups"),i),u={experienceId:e.get("slug"),experienceAlias:r.issueAliasSlug,experienceTitle:e.get("title"),currentPageNumber:t.getPageInfoByNumberOrSlug(a.parsePageFromLocation()).number,documentVersion:r.docVersion,allPageData:o,allSyncedObjectData:s,allSmartgroupData:s,tags:i.getTags(),userToken:n};return u.documentVersion.viewportWidth=t.get("viewportWidth"),u.documentVersion.viewportHeight=t.get("viewportHeight"),u},buildSyncedObjects:function(e,n){var i=[],r=this;return t.each(e,t.bind(function(e){var t=[];e.layerHierarchies&&(t=r.buildLayers(e.layerHierarchies.desktop,n,void 0,e.layerDictionary,e)),i.push({id:e.id,payload:e.sdkPayload,tags:e.sdkTags,layers:t})},this)),i},buildPages:function(e,n){var i=[];return t.each(e.getPages(),t.bind(function(t,r){var o=[];t.get("layerHierarchies")&&(o=this.buildLayers(t.get("layerHierarchies")[u.getVariant()],n,t.getSlug(),t.get("layerDictionary"))),i.push({pageSlug:t.getSlug(),pageNumber:t.getPageIndex()+1,payload:t.getSdkPayload(),tags:t.getSdkTags(),layers:o,width:t.getPageWidth(e),height:t.getPageHeight(e),enabled:!t.getDisabled()}),n.addPageTags(t.getSlug(),t.getSdkTags())},this)),i},buildLayers:function(e,i,r,o,a){function s(e){var u=e.items,d=t.cloneDeep(o[e.id]);if(!d)return void n.warn("SDKLayersCollection: Layer from hierarchy not found in dictionary",{hierarchyLayer:e});if(a&&(d.parentSmartGroup=a),l.reconcileComponentForCurrentVariant(d),d.items=u,delete d.parentSmartGroup,d.smartgroupId)return i.addSyncedObjectTags(d.id,d.sdkTags),{id:d.id,syncedObjectId:d.smartgroupId,smartgroupId:d.smartgroupId,tags:d.sdkTags,payload:d.sdkPayload,pageSlug:r,objects:[]};if("folder"===d.type||"group"===d.type){i.addLayerTags(d.id,d.sdkTags);var h=[];return t.each(d.items,function(e){var t=s(e);t&&h.push(t)}),{id:d.id,payload:d.sdkPayload,items:h,tags:d.sdkTags,pageSlug:r,type:d.type}}return c.buildComponent(d,i,r)}var u=[],c=this;return e&&t.each(e,function(e){var t=s(e);t&&u.push(t)}),u},buildComponent:function(e,t,n){var i=e.id;t.addComponentTags(e.id,e.sdkTags),t.addLayerTags(e.id,e.sdkTags);var r;switch(e.type){case"hotspot-component":r="hotspot";break;case"image-component":r="image";break;case"line-component":r="line";break;case"shape-component":r="shape";break;case"text-component":r="text";break;case"video-widget":r="video"}var o={id:i,type:r,payload:e.sdkPayload,tags:e.sdkTags,x:e.x,y:e.y,width:e.width,height:e.height,pageSlug:n};return"text"===r&&(o.textContent=e.textContent),"image"===r&&e.imageLoader&&(o.fullResolutionUrl=e.imageLoader.getFullResolutionUrl(),o.url=e.imageLoader.getCurrentUrl()),o},registerEvents:function(){o.on("page.action.share.page",t.bind(function(e){this.announceSocialShare(e.componentSlug,e.action)},this)),o.on("page.component.clicked",t.bind(function(e){this.announceComponentClick(e.componentSlug)},this)),o.on("page.component.animation.start",t.bind(function(e){this.announceAnimationStarted(e)},this)),o.on("page.component.animation.end",t.bind(function(e){this.announceAnimationEnded(e)},this))},announcePageChanged:function(e){h("page.changed",{pageNum:e,experienceId:this.experienceID})},announcePageChanging:function(e){h("page.changing",{pageNum:e,experienceId:this.experienceID})},announceSocialShare:function(e,t){e=s.extractObjectIdFromSmartgroupInstanceId(e),h("social.share",{componentId:e,shareType:t,experienceId:this.experienceID})},announceComponentClick:function(e){e=s.extractObjectIdFromSmartgroupInstanceId(e),h("component.clicked",{componentId:e,experienceId:this.experienceID})},announceLayersShown:function(e){e=t.map(e,s.extractObjectIdFromSmartgroupInstanceId),t.each(e,t.bind(function(e){h("layer.shown",{layerId:e,experienceId:this.experienceID})},this))},announceLayersHidden:function(e){e=t.map(e,s.extractObjectIdFromSmartgroupInstanceId),t.each(e,t.bind(function(e){h("layer.hidden",{layerId:e,experienceId:this.experienceID})},this))},announceVideoPlayed:function(e){e=s.extractObjectIdFromSmartgroupInstanceId(e),h("video.played",{componentId:e,experienceId:this.experienceID})},announceAnimationStarted:function(e){e=s.extractObjectIdFromSmartgroupInstanceId(e),h("animation.started",{componentId:e,experienceId:this.experienceID})},announceAnimationEnded:function(e){e=s.extractObjectIdFromSmartgroupInstanceId(e),h("animation.ended",{componentId:e,experienceId:this.experienceID})},announceScrollTo:function(e){h("scroll.to",{scrollPosition:e.scrollPosition,pageHeight:e.pageHeight,experienceId:this.experienceID,innerHeight:window.innerHeight})},announceTimedInteraction:function(e){h("timed.interaction.fired",e)},getNewTagMap:function(){return new g}}})}),define("iosorientationfix",[],function(){"use strict";!function(e){function t(){c.setAttribute("content",f),p=!0}function n(){c.setAttribute("content",h),p=!1}function i(i){l=i.accelerationIncludingGravity,a=Math.abs(l.x),s=Math.abs(l.y),u=Math.abs(l.z),e.orientation&&180!==e.orientation||!(a>7||(u>6&&s<8||u<8&&s>6)&&a>5)?p||t():p&&n()}var r=navigator.userAgent;if(/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(r)&&r.indexOf("AppleWebKit")>-1){var o=e.document;if(o.querySelector){var a,s,u,l,c=o.querySelector("meta[name=viewport]"),d=c&&c.getAttribute("content"),h=d+",maximum-scale=1",f=d+",maximum-scale=10",p=!0;c&&(e.addEventListener("orientationchange",t,!1),e.addEventListener("devicemotion",i,!1))}}}(window)}),define("applications/html5-player/Player",["log","lodash","jquery","backbone","device","globals","domReady","playerApi","cookie","whatInput","shared/utils/NavigationUtils","shared/utils/CerosResourceLoader","shared/utils/ModuleEventManager","shared/utils/ScrollProxy","@frontend/common/libs/ImageEffects","@frontend/common/libs/BlendingModes","@frontend/player/utils/KeepAlive","modules/viewport/models/DocumentVersionModel","shared/models/EmbeddedViewportModel","modules/splash-screen/module","modules/page/module","modules/page/utils/PlayerVariantDetector","modules/page/utils/PlayerVariantService","modules/chrome/module","modules/branding/module","modules/flippers/module","modules/viewport/module","modules/analytics/module","modules/lightbox/module","modules/url-navigation/module","modules/error/module","modules/page/utils/ShareJSConnection","modules/sdk-backend/module","applications/html5-player/TopView","InteractionUtils","libs/utils/FeatureFlagsLookupService","libs/utils/FeatureFlags","iosorientationfix"],function(e,t,n,i,r,o,a,s,u,l,c,d,h,f,p,g,m,v,y,b,w,_,E,S,T,P,A,I,x,O,C,R,L,k,M,D,N){"use strict";var p=p.ImageEffects,g=g.BlendingModes,F=new m.KeepAlive,V=null,U=null,B={documentVersion:null,issue:null},j=D.hasFeature(N.ACCESSIBILITY);o.absorb({shouldReduceMotion:j&&window.matchMedia("(prefers-reduced-motion: reduce)").matches});var G=function(){Z(),ie(),H(),U.mark(U.MARKS.PLAYER.RUN_START),e.init(o.logging),e.debug("Player.run() start"),ce().done(function(){re(),de()||(he(),a(function(){U.mark(U.MARKS.PLAYER.DOM_READY),e.debug("domReady: About to load the doc version."),k.setupInitialDom(),ue(),k.showLoadingExperience(),U.mark(U.MARKS.PLAYER.SPINNER_SHOWN),ae().then(t.bind(k.showPreviewerFadingMessage,k)),S.load();var n=ge();n.done(function(){e.debug("Doc Version is loaded"),U.mark(U.MARKS.PLAYER.DOC_VERSION_LOADED),le(),te();var t=fe();o.isEmbedded&&E.hasVariants()?(e.debug("Waiting for ScrollProxy to send first message with viewport dimensions"),W(t,q)):q()}),n.fail(t.bind(k.show404,k))}))})},H=function(){o.previewMode&&o.privatePreviewer&&F.pollForSession()},W=function(t,n){t.done(function(){e.debug("ScrollProxy received viewport dimensions, rendering experience"),n()}),setTimeout(function(){"resolved"!==t.state()&&(e.devWarn("ScrollProxy viewport dimensions promise timed out"),n())},2e3)},q=function(){_.detect(),z().done(function(){K().done(function(){$(),Y()})}),k.on(k.publishedEvents.PLAYER_DOCUMENT_SHOWN,function(){ee()})},$=function(){oe(),ye(),Ae(),P.load({}),x.load(),T.load(),ve()},Y=function(){k.attachModuleViews(B.issue),A.renderPages().always(function(){L.initialize(B.issue,B.documentVersion,I.getUserToken())});var t=A.getFirstPageReadyPromise();t.fail(function(){k.show404()});var i=[V.promise(),t];n.when.apply(n,i).then(function(){e.debug("About to render initial pages."),k.showDocument(),U.mark(U.MARKS.PLAYER.SPINNER_HIDDEN),O.bindPopstate(),document.hidden?document.addEventListener("visibilitychange",X):X()})},z=function(){return B.documentVersion.createManifestCollection(),B.documentVersion.loadPageModels().done(function(){e.debug("Page models loaded")})},K=function(){return me().done(function(){e.debug("initViewportAndPreloadMedia done. About to render initial pages.")}).fail(function(){k.show404()})},X=function(){document.hidden||(e.debug("First page(s) media is loaded. Showing first page."),A.activateFirstPage()),document.removeEventListener("visibilitychange",X)},Z=function(){u.remove("mobile-help-overlay")},Q={hasImageEffects:function(e){return!!r.msie&&(!t.isNil(e.effects)&&!p.isDefaultEffects(e.effects))},hasBlendingMode:function(e){if(r.msie||r.edge)return!t.isNil(e.blendingMode)&&!g.isDefaultBlendingMode(e.blendingMode)},isUnsupportedComponent:function(e){return Q.hasBlendingMode(e)||Q.hasImageEffects(e)},smartGroupHasUnsupportedComponent:function(e,n){var i=e.documentVersion.getSmartgroupDefinition(n.smartgroupId);return t.some(i.layerDictionary,function(e,t){return"image-component"===e.type&&(e=J(e),Q.isUnsupportedComponent(e))})}},J=function(e){if(t.isNil(e.effects))e.effects=p.getDefaults();else{var n=p.getDefaults();for(var i in n)t.isNil(e.effects[i])&&(e.effects[i]=n[i])}return e},ee=function(){if(r.msie||r.edge){var e=!1;o.previewMode?t.each(B.documentVersion.pages,function(n){var i=function(e){return"smartgroup"===e.type?Q.smartGroupHasUnsupportedComponent(n,e):"image-component"===e.type?(e=J(e),Q.isUnsupportedComponent(e)):("folder"===e.type||"group"===e.type)&&t.some(e.items,i)};if(e=t.some(n.get("layers"),i))return!1}):(e=t.some(B.documentVersion.pages,function(e){return!0===e.get("hasUnsupportedComponent")}))||(e=t.some(B.documentVersion.get("smartgroups"),function(e){return!0===e.hasUnsupportedComponent})),e&&k.showInfo("Your current browser does not support certain content in this experience. Try opening this page in Chrome, Safari, or Firefox.")}},te=function(){var e=ne();o.heightOverridesPerLayout=e,o.heightOverride=t.get(e,"desktop",null),_.on("change",function(n){o.heightOverride=t.get(e,n,null)})},ne=function(){var e={desktop:"heightOverride"};return t.each(E.getExistingVariants(),function(n){e[n]=t.lowerFirst(n)+"HeightOverride"}),t.mapValues(e,function(e){var t=new RegExp("[\\?&]"+e+"=(\\d+)(&|$)"),n=window.location.search.match(t);return n?+n[1]:null})},ie=function(){I.init({application:o.analyticsApplicationKey,analyticsTrackers:o.analyticsTrackers}),U=I.getPerformanceTracker(),window.cerosPlayerLoadStart&&U.startTracking(window.cerosPlayerLoadStart),d.onPriorityQueueCompletion(function(){U.mark(U.MARKS.PLAYER.PRIORITY_QUEUE_EMPTIED)}),d.onAllResourcesLoaded(function(){U.mark(U.MARKS.PLAYER.ALL_RESOURCES_LOADED)})},re=function(){var e=null;o.previewMode?R.initialize():e=window.docVersionRequest,B.issue=new i.Model(o.issue),B.documentVersion=new v(o.docVersion,{docVersionRequest:e})},oe=function(){if(e.isEnabled("debug")){var n=[k,b,w,A,P,I,x,C];o.isEmbedded||(n=n.concat([S,O])),t.each(n,function(n){t.each(n.publishedEvents,function(t){n.on(t,function(n){e.debug("EVENT: "+t,n)})})})}},ae=function(){if(!V){V=new n.Deferred;var t=o.publicAssetsBaseUrl+"ceros-fonts-2019-12-05.css",i=d.addCustomWebFont(["CerosIcons-Regular"],t,"").loadNow(),r=d.addGoogleWebFont("Varela+Round::latin").loadNow(),a=d.addGoogleWebFont("Montserrat::latin").loadNow();n.when(i,a,r).always(function(){V.resolve()}),setTimeout(function(){"resolved"!==V.state()&&(e.devWarn("Font loading timed out"),V.resolve())},5e3)}return V.promise().then(function(){e.debug("InitialFontsReady promise is resolved.")})},se=function(){return o.previewMode&&o.allowAdaptiveLayouts},ue=function(){se()&&(k.setupAdaptiveLayoutsPreviewerTouchDeviceView(),k.setupAdaptiveLayoutsPreviewerFrameView())},le=function(){E.setDocVersion(B.documentVersion),se()&&(E.on(E.EVENTS.UPDATE_URL,function(e){O.navigateToLayout(e)}),E.detectPreviewerFrameSizeFromUrl(),k.setupAdaptiveLayoutsPreviewerSelectionView())},ce=function(){var e=new n.Deferred;return o.previewMode&&o.isEmbedded&&!o.isMarkup?ae().always(function(){b.showEmbeddedPreviewerWarning(n("body")),b.on(b.publishedEvents.EMBED_WARNING_DISMISSED,function(){e.resolve(),b.hideEmbeddedPreviewerWarning(n("body"))})}):e.resolve(),e},de=function(){return o.gracePeriodExpired&&ae().done(function(){b.showUnavailableScreen(n("body"),{theme:B.documentVersion.get("theming")});var e=B.documentVersion.getPageInfoByNumberOrSlug(c.parsePageFromLocation());I.viewExperience({page_slug:e.slug,page_num:e.number,grace_period_expired:!0})}),o.gracePeriodExpired},he=function(){if(o.previewMode){var e={"X-Powered-By":"Ceros Player/HTML5"};o.revalidateWithCore&&(e["Cache-Control"]="must-revalidate"),n.ajaxSetup({timeout:6e4,cache:o.ajaxCaching,headers:e,statusCode:{404:function(){a(t.bind(k.show404,k))}}}),n.ajaxPrefilter(function(e){e.crossDomain&&(e.headers={})})}},fe=function(){var e=n.Deferred();f.init(B.issue.get("slug")),pe();var i=!1;f.on(f.EVENTS.UPDATE_POSITION,function(t){var n=A.getCurrentPageHeight(),r=n&&t.top<n&&t.top<t.bottom;e.resolve(),!i&&r&&(I.resetPageTrackingMinMaxY(),i=!0)});var r=function(e){y.getInstance().setPositionData(e)};return h.on("sdk.experience.container.ready",r),h.on("sdk.experience.container.scrolled",t.debounce(r,50)),h.on("sdk.experience.container.resized",r),e.promise()},pe=function(){var e=function(){if(E.hasVariants()){var e=_.getVariant();f.announceVariantDetection(e)}};_.on("change",e),_.hasDetectedVariant()&&e()},ge=function(){var t=new n.Deferred;return e.debug("Fetching docVersion"),B.documentVersion.fetch().done(t.resolve).fail(t.reject),t.promise()},me=function(){var i=new n.Deferred;return e.debug("Init viewport"),A.init(B.documentVersion,{performanceTracker:U,marginTopCallback:function(){return S.shouldShow()&&!S.initiallyHidden()?S.getHeight():0}}),e.debug("About to preload media"),A.preloadPageMedia(),t.defer(i.resolve),i.promise()},ve=function(){s.on("*",t.bind(I.handleApiRequest,I)).on("ceros.sdk.ping",function(e,t){t.data="pong"}).on("ceros.sdk.productPanel.close",x.deactivate),s.bindToIframe(x.iframe())},ye=function(){h.registerEvents(w.publishedEvents,w),h.registerEvents(O.publishedEvents,O),_e(),Se(),Ee(),Pe(),be(),we()},be=function(){var e=function(e){var t=A.getFirstPageReadyPromise();"pending"===t.state()?t.done(A.scale):A.scale()};A.on(A.publishedEvents.SCALE,e)},we=function(){A.on(A.publishedEvents.SCALE,function(e){P.updateScale(e)}),A.on(A.publishedEvents.PAGE_CHANGE,function(e){P.determineFlipperState(e.isFirstPage,e.isLastPage,!0),A.removeClickShield(),A.enableGestures(),L.announcePageChanged(A.getCurrentPageNumber())}),A.on(A.publishedEvents.PAGE_CHANGING,function(e){P.determineFlipperState(e.isFirstPage,e.isLastPage,e.isPageReady),L.announcePageChanging(A.getCurrentPageNumber())}),A.on(A.publishedEvents.PAGE_UPDATE,function(e){P.determineFlipperState(e.isFirstPage,e.isLastPage,e.isPageReady)}),A.on(A.publishedEvents.PAGE_ENABLED_CHANGE,function(e){P.determineFlipperState(e.isFirstPage,e.isLastPage,e.isPageReady)}),A.on(A.publishedEvents.PAGE_BATCH_LOAD_START,function(){A.addClickShield(),A.disableGestures()}),A.on(A.publishedEvents.TIMED_LIGHTBOX,function(e){x.showLightbox(e.lightboxUrl,e.lightboxWidth,e.lightboxHeight,e.lightboxHasCloseButton),L.announceTimedInteraction(e),I.experienceLoadInteraction({action:e.action,delay:e.delay})}),A.on(A.publishedEvents.TIMED_PRODUCT_PANEL,function(e){x.showProduct(e.productPanelId),L.announceTimedInteraction(e),I.experienceLoadInteraction({action:e.action,delay:e.delay})}),A.on(A.publishedEvents.TIMED_SHOPPING_CART,function(e){x.showShoppingCart(),L.announceTimedInteraction(e),I.experienceLoadInteraction({action:e.action,delay:e.delay})}),P.on(P.publishedEvents.NEXT_PAGE,function(){A.nextPage()}),P.on(P.publishedEvents.PREVIOUS_PAGE,function(){A.previousPage()}),w.on(w.publishedEvents.PAGE_ACTIVATED,function(){P.updateFlipperHrefs()})},_e=function(){A.on(A.publishedEvents.SCALE,function(e){b.scale()}),A.on(A.publishedEvents.CURRENT_PAGE_DELETED,function(e){b.showDeletedPageWarning(n("body"))})},Ee=function(){T.on(T.publishedEvents.BRANDING_CEROS_BRANDING_CLICK,function(e){window.open(T.getBrandingUrl())})},Se=function(){S.shouldShow()&&(S.initiallyHidden()&&(A.on(A.publishedEvents.LONGPRESS,function(e){S.toggle()}),w.on(w.publishedEvents.PAGE_COMPONENT_INTERACTION,function(e){S.hide(!0)})),S.on(S.publishedEvents.CHROME_SHARE_PAGE,function(e){A.shareCurrentPageOnSocial(e.action,B.issue)}),S.on(S.publishedEvents.CHROME_SHOPPING_CART,function(e){x.showShoppingCart()}),S.on(S.publishedEvents.CHROME_TITLE_CLICK,function(e){A.jumpToPage(1,!1)}),A.on(A.publishedEvents.PAGE_CHANGE,function(e){S.setMenuLinkHrefs(A.getCurrentPageNumber())}))},Te=function(){var e=t.get(o,"analyticsTrackers.googleAnalyticsTracker");return!!(o.isEmbedded&&e&&e.enabled&&e.trackingID)},Pe=function(){h.on(w.publishedEvents.PAGE_ACTION_SCROLL_TO,function(e){var t=A.scrollTo(e.scrollTargetType,e.scrollTargetScranchor);L.announceScrollTo(t),f.announceScrollTo(t)}),h.on(w.publishedEvents.PAGE_ACTION_GO_TO_PREV_PAGE,function(e){A.previousPage()}),h.on(w.publishedEvents.PAGE_ACTION_GO_TO_NEXT_PAGE,function(e){A.nextPage()}),h.on(w.publishedEvents.PAGE_ACTION_GO_TO_PAGE,function(e){A.jumpToPage(e.pageTarget)}),h.on(w.publishedEvents.PAGE_ACTION_ENABLE_DISABLE_PAGES,function(e){t.each(e.pageTargets,function(e,t){e?A.enablePage(t):A.disablePage(t)})}),o.isEmbedded||w.on(w.publishedEvents.PAGE_ACTIVATED,function(e){if(e.slug&&B.issue.get("slug")){var t=o.docVersion.pageNamesInTitle?e.pageName:void 0,n=B.issue.get("title");t&&(n+=" - "+t),o.usePageSlugsInNavigation?O.navigateToPageSlug(e.slug,n):O.navigateToPageNumber(B.documentVersion.getPageNumberBySlug(e.slug),n)}}),h.on(O.publishedEvents.POPSTATE,function(e){if(e.pageNumber)A.jumpToPage(e.pageNumber);else if(e.pageSlug){var t=B.documentVersion.getPageNumberBySlug(e.pageSlug);A.jumpToPage(t)}}),w.on(w.publishedEvents.PAGE_ACTION_GO_TO_URL,function(e){Te()?f.announceGotoUrl(e.url,e.urlOpenInNewWindow):e.urlOpenInNewWindow?window.open(e.url):top.location=e.url}),w.on(w.publishedEvents.PAGE_ACTION_OPEN_LIGHTBOX,function(e){x.showLightbox(e.lightboxUrl,e.lightboxWidth,e.lightboxHeight,e.lightboxHasCloseButton)}),w.on(w.publishedEvents.PAGE_ACTION_OPEN_PRODUCT_PANEL,function(e){x.showProduct(e.productPanelId)}),w.on(w.publishedEvents.PAGE_ACTION_OPEN_SHOPPING_CART,function(e){x.showShoppingCart()}),h.on(w.publishedEvents.PAGE_ACTION_SHARE_PAGE,function(e){A.shareCurrentPageOnSocial(e.action,B.issue)}),h.on(w.publishedEvents.TIMED_INTERACTION,function(e){L.announceTimedInteraction(e)}),h.on(w.publishedEvents.PAGE_ACTION_LAYER_VISIBILITY,function(e){if(M.isShowLayersInteraction(e)&&L.announceLayersShown(e.layerTargets),M.isHideLayersInteraction(e)&&L.announceLayersHidden(e.layerTargets),"toggle-layers"===e.action){var n=[],i=[];t.each(e.layerTargets,function(e){A.isLayerVisible(e)?n.push(e):i.push(e)}),n.length>0&&L.announceLayersShown(n),i.length>0&&L.announceLayersHidden(i)}})},Ae=function(){if(o.analyticsApplicationKey){A.on(A.publishedEvents.SCALE,function(e){var t=e.ratio;I.updateScale(t)}),w.on(w.publishedEvents.PAGE_SCROLL,function(e){I.trackPageScroll({page_slug:e.slug,page_num:B.documentVersion.getPageNumberBySlug(e.slug),topY:e.topY,bottomY:e.bottomY,pageHeight:e.pageHeight})}),w.on(w.publishedEvents.PAGE_ACTIVATED,function(e){I.viewExperience({page_slug:e.slug,page_num:B.documentVersion.getPageNumberBySlug(e.slug),grace_period_expired:!1}),B.documentVersion.isAutoTransitioning()||I.viewPage({page_slug:e.slug,page_name:e.pageName,page_num:B.documentVersion.getPageNumberBySlug(e.slug),topY:e.topY,bottomY:e.bottomY,pageHeight:e.pageHeight})});var e=function(e){var t={experience_slug:B.issue.get("slug"),experience_version_slug:B.documentVersion.get("slug"),page_slug:e.pageSlug,page_num:B.documentVersion.getPageNumberBySlug(e.pageSlug),component_slug:e.componentSlug,video_slug:e.videoSlug};return e.videoLength&&(t.video_length=e.videoLength),t};w.on(w.publishedEvents.PAGE_VIDEO_PLAY,function(n){I.playVideo(t.extend(e(n),{video_position:n.videoPosition})),L.announceVideoPlayed(n.componentSlug)}),w.on(w.publishedEvents.PAGE_VIDEO_PROGRESS_TIME,function(n){I.trackVideoProgressTime(t.extend(e(n),{video_position:n.videoPosition,video_play_time:n.videoPlayTime}))}),w.on(w.publishedEvents.PAGE_VIDEO_PROGRESS_PERCENT,function(n){I.trackVideoProgressPercent(t.extend(e(n),{video_progress_percent:n.progressPercent}))}),w.on(w.publishedEvents.PAGE_ACTION_GO_TO_URL,function(e){I.clickLink({page_slug:e.pageSlug,page_num:B.documentVersion.getPageNumberBySlug(e.pageSlug),component_slug:e.componentSlug,component_name:e.componentName,component_type:e.componentType,outgoing_url:e.url,outgoing_domain:e.domain})}),w.on(w.publishedEvents.PAGE_ACTION_OPEN_LIGHTBOX,function(e){I.clickLightbox({page_slug:e.pageSlug,page_num:B.documentVersion.getPageNumberBySlug(e.pageSlug),component_slug:e.componentSlug,component_name:e.componentName,component_type:e.componentType,lightbox_url:e.lightboxUrl,lightbox_width:e.lightboxWidth,lightbox_height:e.lightboxHeight,lightbox_has_close_button:e.lightboxHasCloseButton})}),w.on(w.publishedEvents.PAGE_ACTION_OPEN_PRODUCT_PANEL,function(e){I.clickProduct({page_slug:e.pageSlug,page_num:B.documentVersion.getPageNumberBySlug(e.pageSlug),component_slug:e.componentSlug,component_name:e.componentName,component_type:e.componentType,product_id:e.productPanelId})}),w.on(w.publishedEvents.PAGE_ACTION_OPEN_SHOPPING_CART,function(e){I.clickShoppingCart({page_slug:e.pageSlug,page_num:B.documentVersion.getPageNumberBySlug(e.pageSlug),component_slug:e.componentSlug,component_name:e.componentName,component_type:e.componentType})}),w.on(w.publishedEvents.PAGE_COMPONENT_INTERACTION,function(e){I.clickComponent({page_slug:e.pageSlug,page_num:B.documentVersion.getPageNumberBySlug(e.pageSlug),component_slug:e.componentSlug,component_name:e.componentName,component_type:e.componentType,click_x:e.clickX,click_y:e.clickY})}),w.on(w.publishedEvents.PAGE_COMPONENT_HOVER_INTERACTION,function(e){I.hoverComponent({page_slug:e.pageSlug,page_num:B.documentVersion.getPageNumberBySlug(e.pageSlug),component_slug:e.componentSlug,component_name:e.componentName,component_type:e.componentType})}),w.on(w.publishedEvents.PAGE_COMPONENT_FORM_SUBMITTED,function(e){I.formSubmit({page_slug:e.pageSlug,page_num:B.documentVersion.getPageNumberBySlug(e.pageSlug),component_slug:e.componentSlug,component_name:e.componentName,component_type:e.componentType,form_origin:e.formOrigin,form_origin_account_id:e.formOriginAccountId,form_origin_form_id:e.formOriginFormId,form_origin_form_name:e.formOriginFormName,interaction_triggered:e.interactionTriggered})}),S.on(S.publishedEvents.CHROME_SHOPPING_CART,function(e){I.clickShoppingCart({page_slug:A.getCurrentPageSlug(),page_num:A.getCurrentPageNumber()})}),h.on(w.publishedEvents.PAGE_ACTION_SHARE_PAGE,function(e){I.clickPageShare({page_slug:e.pageSlug,page_num:B.documentVersion.getPageNumberBySlug(e.pageSlug),component_slug:e.componentSlug,component_name:e.componentName,component_type:e.componentType,service:e.action})}),S.on(S.publishedEvents.CHROME_SHARE_PAGE,function(e){I.clickPageShare({page_slug:A.getCurrentPageSlug(),page_num:A.getCurrentPageNumber(),service:e.action})}),T.on(T.publishedEvents.BRANDING_CEROS_BRANDING_CLICK,function(){I.clickCerosBranding({page_slug:A.getCurrentPageSlug(),page_num:A.getCurrentPageNumber()})}),n(document).on("click",I.registerUserActivity)}};return{run:G}}),define("jquery",[],function(){"use strict";return window.jQuery}),define("webfont",[],function(){"use strict";return window.WebFont}),require.config({baseUrl:window.cerosContext.viewAssetsDomain,paths:{"@frontend":"../js/frontend",log:"shared/libs/ceros/log-1.0",jquery:"empty",lodash:"../js/libs/lodash/lodash",backbone:"../js/libs/backbone/backbone",whatInput:"../js/libs/what-input/what-input.min",ceros:"shared/libs/ceros/ceros-1.0",globals:"shared/libs/ceros/globals-1.0",animation:"shared/libs/ceros/animation-css3-1.0",animationTypes:"shared/libs/ceros/animation-types-1.0",sequenceBuilder:"shared/libs/ceros/animation-sequence-builder-1.0",color:"shared/libs/ceros/color-1.0",device:"../js/libs/device/DeviceProfile",browser:"../js/libs/device/MobileBrowserDetector",modernizr:"../js/libs/device/modernizr-custom-2.6.2",cssresource:"shared/libs/ceros/css-resource-1.0",playerApi:"shared/libs/ceros/player-api-1.0",socialSharing:"shared/libs/ceros/social-sharing-1.0",domReady:"shared/libs/require/plugins/domReady",text:"shared/libs/require/plugins/text",crypto:"shared/libs/crypto/crypto-2.2",hammer:"shared/libs/hammer/hammer",mustache:"../js/libs/mustache/mustache.amd",moment:"../js/libs/moment/moment","utils/ScaleConstants":"../js/libs/utils/ScaleConstants",iosorientationfix:"shared/libs/ios-orientation-fix/ios-orientation-fix",easing:"shared/libs/jquery/plugins/jquery.animation.easing",cssHooksTransform:"shared/libs/ceros/css-hooks-transform-1.0",cssHooksGradients:"shared/libs/ceros/css-hooks-gradients-1.0",polyfills:"shared/libs/ceros/polyfills-1.0",base64:"shared/libs/base64/base64",jqueryajaxie9corsfix:"shared/libs/jquery/fixes/jquery-ajax-ie9-cors-fix",hlsjs:"shared/video/hls.min",ExtentsUtils:"../js/libs/utils/ExtentsUtils",InteractionUtils:"../js/libs/utils/InteractionUtils",SyncedPropertiesMap:"../js/constants/SyncedPropertiesMap","utils/KeyboardUtils":"../js/libs/utils/KeyboardUtils","utils/Keycodes":"../js/libs/utils/Keycodes",urlUtils:"../js/libs/utils/UrlUtils",ThumbnailVariantUtils:"../js/libs/utils/ThumbnailVariantUtils",cookie:"../js/libs/utils/Cookies",hubspotFormUtils:"../js/libs/utils/HubspotFormUtils",marketoFormUtils:"../js/libs/utils/MarketoFormUtils",ImageUtils:"../js/libs/utils/ImageUtils",VectorImageUtils:"../js/libs/utils/VectorImageUtils",ImageCroppingUtils:"../js/libs/utils/ImageCroppingUtils",LazyMigrationUtils:"../js/libs/utils/LazyMigrationUtils",BasicCache:"../js/libs/utils/BasicCache",cerosMath:"../js/libs/utils/CerosMath",rect:"../js/libs/utils/Rect",jsBezier:"../js/libs/jsbezier/jsBezier-0.8",screenSize:"../js/libs/utils/ScreenSize","libs/analytics":"../js/libs/analytics","libs/font":"../js/libs/font","libs/image":"../js/libs/image","libs/media":"../js/libs/media","libs/typesetter":"../js/libs/typesetter","libs/uuid":"../js/libs/uuid","libs/device":"../js/libs/device","libs/utils":"../js/libs/utils","utils/TimerUtils":"../js/libs/utils/TimerUtils"},shim:{modernizr:{exports:"Modernizr"}},config:{text:{useXhr:function(e,t,n,i){"use strict";return!0}}}}),require.onError=function(e){"use strict";var t="error: "+e.requireType+" loading modules: "+e.requireModules;window.Rollbar&&window.Rollbar.error(t)},require(["modernizr","polyfills","easing","cssHooksTransform","cssHooksGradients"],function(){"use strict";require(["applications/html5-player/Player"],function(e){e.run()})}),define("applications/html5-player/bootstrap",function(){});